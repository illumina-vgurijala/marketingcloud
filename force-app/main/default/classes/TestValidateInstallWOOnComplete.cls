/**
 *    @author : Sheikh Shahnawaz
 *    @date   : 17-Dec-2019
 *    @description : Test Class for ValidateInstallWOOnComplete_WOHelper.
 *    Modification Log:
 *    ------------------------------------------------------------------------------------ 
 *    Developer                      Date                Description
 *    Sheikh Shahnawaz               22-june-2022         Initial Version.
 *    ------------------------------------------------------------------------------------             
 */

@isTest
public with sharing class TestValidateInstallWOOnComplete {
    public static final String STRING_WO_RECORDTYPE_REMOTE_SUPPORT = 'Remote Support';
    @testSetup static void setup() {

        Id myId = UserInfo.getUserId();
        cs_Apex_Settings__c csapex = new cs_Apex_Settings__c();
        csapex.Bypass_All_Validations__c = true;
        csapex.SetupOwnerId = myId;
        insert csapex;
        
        Account testAccount = TestDataAccount.initAccount();
        Account testAccount2 = TestDataAccount.initAccount();
        insert new List<Account> { testAccount, testAccount2 };
        Product2 prod = TestDataMaster.initProduct('43535');
        prod.Product_Category__c = 'NextSeq';
        prod.Family = 'NextSeq - NSQ - Dx';
        prod.Source_System__c = 'SAP';
        insert prod;
		System.assertNotEquals(null, prod.id);									  
        SVMXC__Installed_Product__c ip = TestDataFieldService.createInstalledProduct('test installed product', 'USD', 'Installed');
        ip.SVMXC__Product__c = prod.id;
        ip.SVMXC__Company__c = testAccount.Id;
        ip.Acceptance_Date__c = System.today();
        ip.SVMXC__Date_Installed__c = System.today();
        ip.Operation_Status__c = 'On';
        ip.SVMXC__Status__c = 'Installed';
        insert ip;
        
        SVMXC__SM_IB_Attributes_Template_Instance__c attributetemp = new SVMXC__SM_IB_Attributes_Template_Instance__c();
        attributetemp.SVMXC__SM_Installed_Product_Id__c = ip.id;
        attributetemp.SVMXC__SM_Attr_Payload__c = '{"fields":[{"title":"Upgrade Type","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"NextSeq Upgrade Type","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"UpgradeType-NextSeq","picklistSfId":"a1S78000000Cb7TEAS","picklistName":"Upgrade Type - NextSeq","defaultDisplayValue":""},{"label":"Last Upgrade Day","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"Day","picklistSfId":"a1S78000000Cb8lEAC","picklistName":"Day","defaultDisplayValue":""},{"label":"Last Upgrade Month","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"Month","picklistSfId":"a1S78000000Cb8vEAC","picklistName":"Month","defaultDisplayValue":""},{"label":"Last Upgrade Year","type":"Static","sequence":3,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"YearList","picklistSfId":"a1S78000000Cb8qEAC","picklistName":"Year List","defaultDisplayValue":""},{"label":"Mandatory field sample","type":"Static","sequence":4,"defaultValue":"Fields are mandatory","unit":"","readOnly":"YES","format":"Text","req":"0","maxNumber":"","minNumber":"","message":""}]},{"title":"Electronics","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"Electronic Notes","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"MPCA","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NextSeq-MPCA:NextSeq-NSQ-DX","picklistSfId":"a1S78000000CmO7EAK","picklistName":"NextSeq - MPCA: NextSeq-NSQ-DX","defaultDisplayValue":""},{"label":"LCD","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"LCD:NextSeq-NSQ-Dx","picklistSfId":"a1S78000000Cb7EEAS","picklistName":"LCD: NextSeq - NSQ - Dx","defaultDisplayValue":""}]},{"title":"Optical Systems","description":"to capture the details of Software / Firmware (Dx)","technicalAttributes":[{"label":"Imaging Module","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Imaging Module Configuration","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"ImagingModuleConfiguration:NextSeq-NSQ-DX","picklistSfId":"a1S78000000CmOHEA0","picklistName":"Imaging Module Configuration: NextSeq-NSQ-DX","defaultDisplayValue":""}]},{"title":"PC","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"BIOS version","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Hard Disk A (RUO)","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Hard Disk B (RUO) ","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Hard Disk C (Dx) ","type":"Static","sequence":3,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Hard Disk D (Dx)","type":"Static","sequence":4,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"SBC","type":"Static","sequence":5,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"SBC Bios Version","type":"Static","sequence":6,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"SBCBiosVersion:NextSeq-NSQ","picklistSfId":"a1S78000000Cb87EAC","picklistName":"SBC Bios Version : NextSeq - NSQ","defaultDisplayValue":""},{"label":"OS Version","type":"","sequence":7,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NextSeq-OSVersion","picklistSfId":"a1S78000000Cb7yEAC","picklistName":"NextSeq - OS Version","defaultDisplayValue":""}]},{"title":"Software / Firmware (RUO)","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"RTA version (RUO)","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"RTAversion(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7sEAC","picklistName":"RTA version (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"OS Image (RUO)","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"OSImage(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7nEAC","picklistName":"OS Image (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"FPGA Version (RUO)","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"FPGAVersion(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb8CEAS","picklistName":"FPGA Version (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"Recipe Fragment Version (RUO)","type":"Static","sequence":3,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"System Suite Installer (RUO) ","type":"Static","sequence":4,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"SystemSuiteInstaller(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7dEAC","picklistName":"System Suite Installer (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"BaseSpace Broker (RUO)","type":"Static","sequence":5,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"BaseSpaceBroker(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb8bEAC","picklistName":"BaseSpace Broker (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"NCS","type":"Static","sequence":6,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NCS:NextSeq-NSQ","picklistSfId":"a1S78000000Cb8gEAC","picklistName":"NCS : NextSeq - NSQ","defaultDisplayValue":""},{"label":"NSS","type":"Static","sequence":7,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NSS:NextSeq-NSQ","picklistSfId":"a1S78000000Cb8WEAS","picklistName":"NSS : NextSeq - NSQ","defaultDisplayValue":""},{"label":"2022 LRM Patch Applied?","type":"Static","sequence":8,"defaultValue":"","unit":"","readOnly":"","format":"Boolean","req":"0","maxNumber":"","minNumber":"","message":""}]},{"title":"Software / Firmware (Dx)","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"OS Image (Dx)","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"OSImage(Dx):NextSeq-NSQ","picklistSfId":"a1S78000000Cb8HEAS","picklistName":"OS Image (Dx) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"System Suite Installer (Dx)","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"SystemSuiteInstaller(Dx):NextSeq-NSQ","picklistSfId":"a1S78000000Cb8REAS","picklistName":"System Suite Installer (Dx) : NextSeq - NSQ","defaultDisplayValue":""}]},{"title":"Software - Local Run Manager Installations (Dx)","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"Germline Variant (Dx)","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"GermlineVariant(Dx):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7iEAC","picklistName":"Germline Variant (Dx) : NextSeq - NSQ","defaultDisplayValue":""},{"label":" Somatic Variant (Dx)","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"SomaticVariant(Dx):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7xEAC","picklistName":"Somatic Variant (Dx) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"VeriSeq NiPT LRM Dx","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"VeriSeqNiPTLRMDx","picklistSfId":"a1S78000000Cb82EAC","picklistName":"VeriSeq NiPT LRM Dx","defaultDisplayValue":""},{"label":"TruSight NIPT (Dx)","type":"","sequence":3,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"NextSeq-TruSightNIPT(Dx)","picklistSfId":"a1S78000000Cb74EAC","picklistName":"NextSeq - TruSight NIPT (Dx)","defaultDisplayValue":""},{"label":"TSO Comp LRM IUO (1)","type":"Static","sequence":4,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"TSOCompLRMIUO(1):NextSeq–NSQ","picklistSfId":"a1S78000000Cb7OEAS","picklistName":"TSO Comp LRM IUO (1) :  NextSeq – NSQ","defaultDisplayValue":""},{"label":"TSO Comp LRM IUO (2)","type":"Static","sequence":5,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"TSOCompLRMIUO(2):NextSeq–NSQ","picklistSfId":"a1S78000000Cb7JEAS","picklistName":"TSO Comp LRM IUO (2) :  NextSeq – NSQ","defaultDisplayValue":""},{"label":"TSO Comp LRM (Dx)","type":"Static","sequence":6,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"TSOCompLRM(Dx)","picklistSfId":"a1S78000000Cb6uEAC","picklistName":"TSO Comp LRM (Dx)","defaultDisplayValue":""},{"label":"DNA GenerateFASTQ Dx","type":"Static","sequence":7,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"DNAGenerateFASTQDx:NextSeq-NSQ-DX","picklistSfId":"a1S78000000CmOCEA0","picklistName":"DNA GenerateFASTQ Dx: NextSeq-NSQ-DX","defaultDisplayValue":""}]},{"title":"Software - Local Run Manager Installations (RUO)","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"VeriSeq NiPT LRM RUO","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"VeriSeqNiPTLRMRUO","picklistSfId":"a1S78000000Cb8MEAS","picklistName":"VeriSeq NiPT LRM RUO","defaultDisplayValue":""},{"label":"TSO500 RUO LRM","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"TSO500RUOLRM:NextSeq–NSQ","picklistSfId":"a1S78000000Cb7YEAS","picklistName":"TSO500 RUO LRM : NextSeq – NSQ","defaultDisplayValue":""}]},{"title":"Fluidics","description":"Fluidics","technicalAttributes":[{"label":"Pumps","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NextSeq-Pumps","picklistSfId":"a1S78000000Cb6zEAC","picklistName":"NextSeq - Pumps","defaultDisplayValue":""},{"label":"Valves","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""}]}],"picklist":{"UpgradeType-NextSeq":{"setDefaultValue":false,"values":["NextSeq SW NCS4.0 Only"]},"Day":{"setDefaultValue":false,"values":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"]},"Month":{"setDefaultValue":false,"values":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"YearList":{"setDefaultValue":false,"values":["2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021","2022","2023","2024","2025"]},"NextSeq-MPCA:NextSeq-NSQ-DX":{"setDefaultValue":false,"values":["MBB - MN 20028306","MBB - MN 20043077"]},"LCD:NextSeq-NSQ-Dx":{"setDefaultValue":false,"values":["MN 15040844S SPARE, LCD (Ampire)","MN 20051110 Spare LCD Display NSQ Dx RUO TP (AGL) "]},"ImagingModuleConfiguration:NextSeq-NSQ-DX":{"setDefaultValue":false,"values":["IM without gull wing FCC","IM with gull wing FCC"]},"SBCBiosVersion:NextSeq-NSQ":{"setDefaultValue":false,"values":["R1.00.W6a","R1.00.W1"]},"NextSeq-OSVersion":{"setDefaultValue":false,"values":["Windows 10","Windows 7 Pro","Windows 7 Embedded","Windows Vista","Windows XP"]},"RTAversion(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["v2.4.22"]},"OSImage(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["5.3.C08","5.3.C06","5.3.C10","5.3.C11"]},"FPGAVersion(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["0xc10f21","0xc10f23","Other","3.0.35","3.0.33","3.0.32","3.0.39","9.1.2","9.1.6","9.2.2","9.3.0","9.5.0","9.5.9","9.5.12","3.10.0","3.10.1","7.7.2.3","2015.2"]},"SystemSuiteInstaller(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["2.2","4.0.0","4.0.1","4.0.2"]},"BaseSpaceBroker(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["v2.8.22"]},"NCS:NextSeq-NSQ":{"setDefaultValue":false,"values":["v3.0.0.130"]},"NSS:NextSeq-NSQ":{"setDefaultValue":false,"values":["v3.0.0.130"]},"OSImage(Dx):NextSeq-NSQ":{"values":["N/A","31.1.C04","5.3.C11"],"setDefaultValue":false},"SystemSuiteInstaller(Dx):NextSeq-NSQ":{"setDefaultValue":false,"values":["1.3.0","1.3.1","1.3.3","1.4.0"]},"GermlineVariant(Dx):NextSeq-NSQ":{"values":["N/A","1.2.0","1.3.0.0","Needs Updating"],"setDefaultValue":false},"SomaticVariant(Dx):NextSeq-NSQ":{"values":["N/A","TBD","1.2.0","1.3.0.0"],"setDefaultValue":false},"VeriSeqNiPTLRMDx":{"setDefaultValue":false,"values":["1.1.1.219"]},"NextSeq-TruSightNIPT(Dx)":{"setDefaultValue":false,"values":["N/A","1.0.0.75"]},"TSOCompLRMIUO(1):NextSeq–NSQ":{"setDefaultValue":false,"values":["v2.0","v2.1","v2.2","vHRD","vHRR"]},"TSOCompLRMIUO(2):NextSeq–NSQ":{"setDefaultValue":false,"values":["vHRD","vHRR"]},"TSOCompLRM(Dx)":{"values":["EU_v2.3.3_ClaimsPkgv1.0.0","EU_v2.3.6_ClaimsPkgv2.1.0","EU_v2.3.5_ClaimsPkgv2.0.0"],"setDefaultValue":false},"DNAGenerateFASTQDx:NextSeq-NSQ-DX":{"setDefaultValue":false,"values":["1.0.0"]},"VeriSeqNiPTLRMRUO":{"setDefaultValue":false,"values":["1.0.1.22","1.0.2.27"]},"TSO500RUOLRM:NextSeq–NSQ":{"setDefaultValue":false,"values":["v2.0.0.141","v2.0.1.22"]},"NextSeq-Pumps":{"setDefaultValue":false,"values":["Polymer ","G2 Ceramic"]}}}';
        insert attributetemp;
      
    }

    static testmethod void checkBatchIBAttributesUpdate()
    {
        SVMXC__Installed_Product__c ip = [select Id from SVMXC__Installed_Product__c where SVMXC__Product__r.Family = 'NextSeq - NSQ - Dx'limit 1];

        SVMXC__SM_Attributes_Template__c attrTemplate = new SVMXC__SM_Attributes_Template__c();
        attrTemplate.SVMXC__SM_Template_Json__c = '{"fields":[{"title":"Upgrade Type","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"NextSeq Upgrade Type","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"UpgradeType-NextSeq","picklistSfId":"a1S78000000Cb7TEAS","picklistName":"Upgrade Type - NextSeq","defaultDisplayValue":""},{"label":"Last Upgrade Day","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"Day","picklistSfId":"a1S78000000Cb8lEAC","picklistName":"Day","defaultDisplayValue":""},{"label":"Last Upgrade Month","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"Month","picklistSfId":"a1S78000000Cb8vEAC","picklistName":"Month","defaultDisplayValue":""},{"label":"Last Upgrade Year","type":"Static","sequence":3,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"YearList","picklistSfId":"a1S78000000Cb8qEAC","picklistName":"Year List","defaultDisplayValue":""},{"label":"Mandatory field sample","type":"Static","sequence":4,"defaultValue":"Fields are mandatory","unit":"","readOnly":"YES","format":"Text","req":"0","maxNumber":"","minNumber":"","message":""}]},{"title":"Electronics","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"Electronic Notes","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"MPCA","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NextSeq-MPCA:NextSeq-NSQ-DX","picklistSfId":"a1S78000000CmO7EAK","picklistName":"NextSeq - MPCA: NextSeq-NSQ-DX","defaultDisplayValue":""},{"label":"LCD","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"LCD:NextSeq-NSQ-Dx","picklistSfId":"a1S78000000Cb7EEAS","picklistName":"LCD: NextSeq - NSQ - Dx","defaultDisplayValue":""}]},{"title":"Optical Systems","description":"to capture the details of Software / Firmware (Dx)","technicalAttributes":[{"label":"Imaging Module","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Imaging Module Configuration","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"ImagingModuleConfiguration:NextSeq-NSQ-DX","picklistSfId":"a1S78000000CmOHEA0","picklistName":"Imaging Module Configuration: NextSeq-NSQ-DX","defaultDisplayValue":""}]},{"title":"PC","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"BIOS version","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Hard Disk A (RUO)","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Hard Disk B (RUO) ","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Hard Disk C (Dx) ","type":"Static","sequence":3,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Hard Disk D (Dx)","type":"Static","sequence":4,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"SBC","type":"Static","sequence":5,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"SBC Bios Version","type":"Static","sequence":6,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"SBCBiosVersion:NextSeq-NSQ","picklistSfId":"a1S78000000Cb87EAC","picklistName":"SBC Bios Version : NextSeq - NSQ","defaultDisplayValue":""},{"label":"OS Version","type":"","sequence":7,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NextSeq-OSVersion","picklistSfId":"a1S78000000Cb7yEAC","picklistName":"NextSeq - OS Version","defaultDisplayValue":""}]},{"title":"Software / Firmware (RUO)","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"RTA version (RUO)","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"RTAversion(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7sEAC","picklistName":"RTA version (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"OS Image (RUO)","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"OSImage(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7nEAC","picklistName":"OS Image (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"FPGA Version (RUO)","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"FPGAVersion(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb8CEAS","picklistName":"FPGA Version (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"Recipe Fragment Version (RUO)","type":"Static","sequence":3,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"System Suite Installer (RUO) ","type":"Static","sequence":4,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"SystemSuiteInstaller(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7dEAC","picklistName":"System Suite Installer (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"BaseSpace Broker (RUO)","type":"Static","sequence":5,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"BaseSpaceBroker(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb8bEAC","picklistName":"BaseSpace Broker (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"NCS","type":"Static","sequence":6,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NCS:NextSeq-NSQ","picklistSfId":"a1S78000000Cb8gEAC","picklistName":"NCS : NextSeq - NSQ","defaultDisplayValue":""},{"label":"NSS","type":"Static","sequence":7,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NSS:NextSeq-NSQ","picklistSfId":"a1S78000000Cb8WEAS","picklistName":"NSS : NextSeq - NSQ","defaultDisplayValue":""},{"label":"2022 LRM Patch Applied?","type":"Static","sequence":8,"defaultValue":"","unit":"","readOnly":"","format":"Boolean","req":"0","maxNumber":"","minNumber":"","message":""}]},{"title":"Software / Firmware (Dx)","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"OS Image (Dx)","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"OSImage(Dx):NextSeq-NSQ","picklistSfId":"a1S78000000Cb8HEAS","picklistName":"OS Image (Dx) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"System Suite Installer (Dx)","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"SystemSuiteInstaller(Dx):NextSeq-NSQ","picklistSfId":"a1S78000000Cb8REAS","picklistName":"System Suite Installer (Dx) : NextSeq - NSQ","defaultDisplayValue":""}]},{"title":"Software - Local Run Manager Installations (Dx)","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"Germline Variant (Dx)","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"GermlineVariant(Dx):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7iEAC","picklistName":"Germline Variant (Dx) : NextSeq - NSQ","defaultDisplayValue":""},{"label":" Somatic Variant (Dx)","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"SomaticVariant(Dx):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7xEAC","picklistName":"Somatic Variant (Dx) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"VeriSeq NiPT LRM Dx","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"VeriSeqNiPTLRMDx","picklistSfId":"a1S78000000Cb82EAC","picklistName":"VeriSeq NiPT LRM Dx","defaultDisplayValue":""},{"label":"TruSight NIPT (Dx)","type":"","sequence":3,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"NextSeq-TruSightNIPT(Dx)","picklistSfId":"a1S78000000Cb74EAC","picklistName":"NextSeq - TruSight NIPT (Dx)","defaultDisplayValue":""},{"label":"TSO Comp LRM IUO (1)","type":"Static","sequence":4,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"TSOCompLRMIUO(1):NextSeq–NSQ","picklistSfId":"a1S78000000Cb7OEAS","picklistName":"TSO Comp LRM IUO (1) :  NextSeq – NSQ","defaultDisplayValue":""},{"label":"TSO Comp LRM IUO (2)","type":"Static","sequence":5,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"TSOCompLRMIUO(2):NextSeq–NSQ","picklistSfId":"a1S78000000Cb7JEAS","picklistName":"TSO Comp LRM IUO (2) :  NextSeq – NSQ","defaultDisplayValue":""},{"label":"TSO Comp LRM (Dx)","type":"Static","sequence":6,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"TSOCompLRM(Dx)","picklistSfId":"a1S78000000Cb6uEAC","picklistName":"TSO Comp LRM (Dx)","defaultDisplayValue":""},{"label":"DNA GenerateFASTQ Dx","type":"Static","sequence":7,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"DNAGenerateFASTQDx:NextSeq-NSQ-DX","picklistSfId":"a1S78000000CmOCEA0","picklistName":"DNA GenerateFASTQ Dx: NextSeq-NSQ-DX","defaultDisplayValue":""}]},{"title":"Software - Local Run Manager Installations (RUO)","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"VeriSeq NiPT LRM RUO","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"VeriSeqNiPTLRMRUO","picklistSfId":"a1S78000000Cb8MEAS","picklistName":"VeriSeq NiPT LRM RUO","defaultDisplayValue":""},{"label":"TSO500 RUO LRM","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"TSO500RUOLRM:NextSeq–NSQ","picklistSfId":"a1S78000000Cb7YEAS","picklistName":"TSO500 RUO LRM : NextSeq – NSQ","defaultDisplayValue":""}]},{"title":"Fluidics","description":"Fluidics","technicalAttributes":[{"label":"Pumps","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NextSeq-Pumps","picklistSfId":"a1S78000000Cb6zEAC","picklistName":"NextSeq - Pumps","defaultDisplayValue":""},{"label":"Valves","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""}]}],"picklist":{"UpgradeType-NextSeq":{"setDefaultValue":false,"values":["NextSeq SW NCS4.0 Only"]},"Day":{"setDefaultValue":false,"values":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"]},"Month":{"setDefaultValue":false,"values":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"YearList":{"setDefaultValue":false,"values":["2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021","2022","2023","2024","2025"]},"NextSeq-MPCA:NextSeq-NSQ-DX":{"setDefaultValue":false,"values":["MBB - MN 20028306","MBB - MN 20043077"]},"LCD:NextSeq-NSQ-Dx":{"setDefaultValue":false,"values":["MN 15040844S SPARE, LCD (Ampire)","MN 20051110 Spare LCD Display NSQ Dx RUO TP (AGL) "]},"ImagingModuleConfiguration:NextSeq-NSQ-DX":{"setDefaultValue":false,"values":["IM without gull wing FCC","IM with gull wing FCC"]},"SBCBiosVersion:NextSeq-NSQ":{"setDefaultValue":false,"values":["R1.00.W6a","R1.00.W1"]},"NextSeq-OSVersion":{"setDefaultValue":false,"values":["Windows 10","Windows 7 Pro","Windows 7 Embedded","Windows Vista","Windows XP"]},"RTAversion(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["v2.4.22"]},"OSImage(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["5.3.C08","5.3.C06","5.3.C10","5.3.C11"]},"FPGAVersion(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["0xc10f21","0xc10f23","Other","3.0.35","3.0.33","3.0.32","3.0.39","9.1.2","9.1.6","9.2.2","9.3.0","9.5.0","9.5.9","9.5.12","3.10.0","3.10.1","7.7.2.3","2015.2"]},"SystemSuiteInstaller(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["2.2","4.0.0","4.0.1","4.0.2"]},"BaseSpaceBroker(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["v2.8.22"]},"NCS:NextSeq-NSQ":{"setDefaultValue":false,"values":["v3.0.0.130"]},"NSS:NextSeq-NSQ":{"setDefaultValue":false,"values":["v3.0.0.130"]},"OSImage(Dx):NextSeq-NSQ":{"values":["N/A","31.1.C04","5.3.C11"],"setDefaultValue":false},"SystemSuiteInstaller(Dx):NextSeq-NSQ":{"setDefaultValue":false,"values":["1.3.0","1.3.1","1.3.3","1.4.0"]},"GermlineVariant(Dx):NextSeq-NSQ":{"values":["N/A","1.2.0","1.3.0.0","Needs Updating"],"setDefaultValue":false},"SomaticVariant(Dx):NextSeq-NSQ":{"values":["N/A","TBD","1.2.0","1.3.0.0"],"setDefaultValue":false},"VeriSeqNiPTLRMDx":{"setDefaultValue":false,"values":["1.1.1.219"]},"NextSeq-TruSightNIPT(Dx)":{"setDefaultValue":false,"values":["N/A","1.0.0.75"]},"TSOCompLRMIUO(1):NextSeq–NSQ":{"setDefaultValue":false,"values":["v2.0","v2.1","v2.2","vHRD","vHRR"]},"TSOCompLRMIUO(2):NextSeq–NSQ":{"setDefaultValue":false,"values":["vHRD","vHRR"]},"TSOCompLRM(Dx)":{"values":["EU_v2.3.3_ClaimsPkgv1.0.0","EU_v2.3.6_ClaimsPkgv2.1.0","EU_v2.3.5_ClaimsPkgv2.0.0"],"setDefaultValue":false},"DNAGenerateFASTQDx:NextSeq-NSQ-DX":{"setDefaultValue":false,"values":["1.0.0"]},"VeriSeqNiPTLRMRUO":{"setDefaultValue":false,"values":["1.0.1.22","1.0.2.27"]},"TSO500RUOLRM:NextSeq–NSQ":{"setDefaultValue":false,"values":["v2.0.0.141","v2.0.1.22"]},"NextSeq-Pumps":{"setDefaultValue":false,"values":["Polymer ","G2 Ceramic"]}}}';
        attrTemplate.SVMXC__SM_Title__c = 'NextSeq - NSQ - Dx Template';
        insert attrTemplate;
        Account acc = TestDataAccount.getAccount('Test Acc', 'USD');
        acc.Account_Group__c='Distributor';
        insert acc;
        //insert contact
        Contact con = TestDataPerson.getNewContact(acc.Id);
        System.assertNotEquals(null, con.id,' con.id  not null');
        //insert case        
        Case cs = TestDataCase.initServiceRequestCase(con);
        insert cs;
        SVMXC__Service_Order__c workOrder = TestDataFieldService.createWorkOrder(STRING_WO_RECORDTYPE_REMOTE_SUPPORT, cs.Id, 'Initiated');
        workOrder.SVMXC__Order_Type__c='Installation';
        workOrder.SVMXC__Component__c = ip.Id;
        workOrder.Is_Auto_Created__c = true;
        insert workOrder;
        Test.startTest();
        workOrder.SVMXC__Order_Status__c = 'Completed';
        workOrder.Evaluation__c = 'Done';
        workOrder.SVMXC__Work_Performed__c = 'Performed';
        workOrder.Verification_Result__c = 'Passed';
        workOrder.Training_Required__c = true;
        workOrder.Reason_for_No_Training__c = 'Customer Declined - Lab already trained';
        Update workOrder;
        ValidateInstallWOOnComplete_WOHelper.TechnicalAttributes attributes = new ValidateInstallWOOnComplete_WOHelper.TechnicalAttributes();
        attributes.label ='Test';
        attributes.type ='Test';
        attributes.sequence ='Test';
        attributes.defaultValue='Test';
        attributes.req ='Test';
        attributes.unit ='Test';
        attributes.readOnly ='Test';
        attributes.format ='Test';
        List<ValidateInstallWOOnComplete_WOHelper.TechnicalAttributes> lstAttributes = new List<ValidateInstallWOOnComplete_WOHelper.TechnicalAttributes>();
        lstAttributes.add(attributes);
        ValidateInstallWOOnComplete_WOHelper.TechnicalAttributeFields fields = new ValidateInstallWOOnComplete_WOHelper.TechnicalAttributeFields();

        
        fields.title ='Test';
        fields.description = 'Test';
        fields.technicalAttributes = lstAttributes;
        try {
            List<SVMXC__Installed_Product__c> lstIP =  [Select Id,SVMXC__Product__c ,SVMXC__Product__r.Family from  SVMXC__Installed_Product__c limit 10]; 
            System.assertNotEquals(null, lstIP,' lstIP returned not null');
         } catch(Exception e) {
             System.debug('Exception ex :  '+e);
         }
        Test.stopTest();
    }
    
    static testmethod void checkBatchIBAttributesUpdate2()
    {
        SVMXC__Installed_Product__c ip = [select Id from SVMXC__Installed_Product__c where SVMXC__Product__r.Family = 'NextSeq - NSQ - Dx'limit 1];

        SVMXC__SM_Attributes_Template__c attrTemplate = new SVMXC__SM_Attributes_Template__c();
        attrTemplate.SVMXC__SM_Template_Json__c = '{"fields":[{"title":"Upgrade Type","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"NextSeq Upgrade Type","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"1","maxNumber":"","minNumber":"","message":"","picklistId":"UpgradeType-NextSeq","picklistSfId":"a1S78000000Cb7TEAS","picklistName":"Upgrade Type - NextSeq","defaultDisplayValue":""},{"label":"Last Upgrade Day","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"Day","picklistSfId":"a1S78000000Cb8lEAC","picklistName":"Day","defaultDisplayValue":""},{"label":"Last Upgrade Month","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"Month","picklistSfId":"a1S78000000Cb8vEAC","picklistName":"Month","defaultDisplayValue":""},{"label":"Last Upgrade Year","type":"Static","sequence":3,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"YearList","picklistSfId":"a1S78000000Cb8qEAC","picklistName":"Year List","defaultDisplayValue":""},{"label":"Mandatory field sample","type":"Static","sequence":4,"defaultValue":"Fields are mandatory","unit":"","readOnly":"YES","format":"Text","req":"0","maxNumber":"","minNumber":"","message":""}]},{"title":"Electronics","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"Electronic Notes","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"MPCA","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NextSeq-MPCA:NextSeq-NSQ-DX","picklistSfId":"a1S78000000CmO7EAK","picklistName":"NextSeq - MPCA: NextSeq-NSQ-DX","defaultDisplayValue":""},{"label":"LCD","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"LCD:NextSeq-NSQ-Dx","picklistSfId":"a1S78000000Cb7EEAS","picklistName":"LCD: NextSeq - NSQ - Dx","defaultDisplayValue":""}]},{"title":"Optical Systems","description":"to capture the details of Software / Firmware (Dx)","technicalAttributes":[{"label":"Imaging Module","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Imaging Module Configuration","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"ImagingModuleConfiguration:NextSeq-NSQ-DX","picklistSfId":"a1S78000000CmOHEA0","picklistName":"Imaging Module Configuration: NextSeq-NSQ-DX","defaultDisplayValue":""}]},{"title":"PC","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"BIOS version","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Hard Disk A (RUO)","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Hard Disk B (RUO) ","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Hard Disk C (Dx) ","type":"Static","sequence":3,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"Hard Disk D (Dx)","type":"Static","sequence":4,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"SBC","type":"Static","sequence":5,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"SBC Bios Version","type":"Static","sequence":6,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"SBCBiosVersion:NextSeq-NSQ","picklistSfId":"a1S78000000Cb87EAC","picklistName":"SBC Bios Version : NextSeq - NSQ","defaultDisplayValue":""},{"label":"OS Version","type":"","sequence":7,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NextSeq-OSVersion","picklistSfId":"a1S78000000Cb7yEAC","picklistName":"NextSeq - OS Version","defaultDisplayValue":""}]},{"title":"Software / Firmware (RUO)","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"RTA version (RUO)","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"RTAversion(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7sEAC","picklistName":"RTA version (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"OS Image (RUO)","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"OSImage(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7nEAC","picklistName":"OS Image (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"FPGA Version (RUO)","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"FPGAVersion(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb8CEAS","picklistName":"FPGA Version (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"Recipe Fragment Version (RUO)","type":"Static","sequence":3,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""},{"label":"System Suite Installer (RUO) ","type":"Static","sequence":4,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"SystemSuiteInstaller(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7dEAC","picklistName":"System Suite Installer (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"BaseSpace Broker (RUO)","type":"Static","sequence":5,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"BaseSpaceBroker(RUO):NextSeq-NSQ","picklistSfId":"a1S78000000Cb8bEAC","picklistName":"BaseSpace Broker (RUO) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"NCS","type":"Static","sequence":6,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NCS:NextSeq-NSQ","picklistSfId":"a1S78000000Cb8gEAC","picklistName":"NCS : NextSeq - NSQ","defaultDisplayValue":""},{"label":"NSS","type":"Static","sequence":7,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NSS:NextSeq-NSQ","picklistSfId":"a1S78000000Cb8WEAS","picklistName":"NSS : NextSeq - NSQ","defaultDisplayValue":""},{"label":"2022 LRM Patch Applied?","type":"Static","sequence":8,"defaultValue":"","unit":"","readOnly":"","format":"Boolean","req":"0","maxNumber":"","minNumber":"","message":""}]},{"title":"Software / Firmware (Dx)","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"OS Image (Dx)","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"OSImage(Dx):NextSeq-NSQ","picklistSfId":"a1S78000000Cb8HEAS","picklistName":"OS Image (Dx) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"System Suite Installer (Dx)","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"SystemSuiteInstaller(Dx):NextSeq-NSQ","picklistSfId":"a1S78000000Cb8REAS","picklistName":"System Suite Installer (Dx) : NextSeq - NSQ","defaultDisplayValue":""}]},{"title":"Software - Local Run Manager Installations (Dx)","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"Germline Variant (Dx)","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"GermlineVariant(Dx):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7iEAC","picklistName":"Germline Variant (Dx) : NextSeq - NSQ","defaultDisplayValue":""},{"label":" Somatic Variant (Dx)","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"SomaticVariant(Dx):NextSeq-NSQ","picklistSfId":"a1S78000000Cb7xEAC","picklistName":"Somatic Variant (Dx) : NextSeq - NSQ","defaultDisplayValue":""},{"label":"VeriSeq NiPT LRM Dx","type":"Static","sequence":2,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"VeriSeqNiPTLRMDx","picklistSfId":"a1S78000000Cb82EAC","picklistName":"VeriSeq NiPT LRM Dx","defaultDisplayValue":""},{"label":"TruSight NIPT (Dx)","type":"","sequence":3,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"NextSeq-TruSightNIPT(Dx)","picklistSfId":"a1S78000000Cb74EAC","picklistName":"NextSeq - TruSight NIPT (Dx)","defaultDisplayValue":""},{"label":"TSO Comp LRM IUO (1)","type":"Static","sequence":4,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"TSOCompLRMIUO(1):NextSeq–NSQ","picklistSfId":"a1S78000000Cb7OEAS","picklistName":"TSO Comp LRM IUO (1) :  NextSeq – NSQ","defaultDisplayValue":""},{"label":"TSO Comp LRM IUO (2)","type":"Static","sequence":5,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"TSOCompLRMIUO(2):NextSeq–NSQ","picklistSfId":"a1S78000000Cb7JEAS","picklistName":"TSO Comp LRM IUO (2) :  NextSeq – NSQ","defaultDisplayValue":""},{"label":"TSO Comp LRM (Dx)","type":"Static","sequence":6,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"TSOCompLRM(Dx)","picklistSfId":"a1S78000000Cb6uEAC","picklistName":"TSO Comp LRM (Dx)","defaultDisplayValue":""},{"label":"DNA GenerateFASTQ Dx","type":"Static","sequence":7,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":"0","maxNumber":"","minNumber":"","message":"","picklistId":"DNAGenerateFASTQDx:NextSeq-NSQ-DX","picklistSfId":"a1S78000000CmOCEA0","picklistName":"DNA GenerateFASTQ Dx: NextSeq-NSQ-DX","defaultDisplayValue":""}]},{"title":"Software - Local Run Manager Installations (RUO)","description":"to capture the details of Software - Local Run Manager Installations (RUO)","technicalAttributes":[{"label":"VeriSeq NiPT LRM RUO","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"VeriSeqNiPTLRMRUO","picklistSfId":"a1S78000000Cb8MEAS","picklistName":"VeriSeq NiPT LRM RUO","defaultDisplayValue":""},{"label":"TSO500 RUO LRM","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"TSO500RUOLRM:NextSeq–NSQ","picklistSfId":"a1S78000000Cb7YEAS","picklistName":"TSO500 RUO LRM : NextSeq – NSQ","defaultDisplayValue":""}]},{"title":"Fluidics","description":"Fluidics","technicalAttributes":[{"label":"Pumps","type":"Static","sequence":0,"defaultValue":"","unit":"","readOnly":"","format":"Picklist","req":null,"maxNumber":"","minNumber":"","message":"","picklistId":"NextSeq-Pumps","picklistSfId":"a1S78000000Cb6zEAC","picklistName":"NextSeq - Pumps","defaultDisplayValue":""},{"label":"Valves","type":"Static","sequence":1,"defaultValue":"","unit":"","readOnly":"","format":"Text","req":null,"maxNumber":"","minNumber":"","message":""}]}],"picklist":{"UpgradeType-NextSeq":{"setDefaultValue":false,"values":["NextSeq SW NCS4.0 Only"]},"Day":{"setDefaultValue":false,"values":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31"]},"Month":{"setDefaultValue":false,"values":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"YearList":{"setDefaultValue":false,"values":["2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021","2022","2023","2024","2025"]},"NextSeq-MPCA:NextSeq-NSQ-DX":{"setDefaultValue":false,"values":["MBB - MN 20028306","MBB - MN 20043077"]},"LCD:NextSeq-NSQ-Dx":{"setDefaultValue":false,"values":["MN 15040844S SPARE, LCD (Ampire)","MN 20051110 Spare LCD Display NSQ Dx RUO TP (AGL) "]},"ImagingModuleConfiguration:NextSeq-NSQ-DX":{"setDefaultValue":false,"values":["IM without gull wing FCC","IM with gull wing FCC"]},"SBCBiosVersion:NextSeq-NSQ":{"setDefaultValue":false,"values":["R1.00.W6a","R1.00.W1"]},"NextSeq-OSVersion":{"setDefaultValue":false,"values":["Windows 10","Windows 7 Pro","Windows 7 Embedded","Windows Vista","Windows XP"]},"RTAversion(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["v2.4.22"]},"OSImage(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["5.3.C08","5.3.C06","5.3.C10","5.3.C11"]},"FPGAVersion(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["0xc10f21","0xc10f23","Other","3.0.35","3.0.33","3.0.32","3.0.39","9.1.2","9.1.6","9.2.2","9.3.0","9.5.0","9.5.9","9.5.12","3.10.0","3.10.1","7.7.2.3","2015.2"]},"SystemSuiteInstaller(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["2.2","4.0.0","4.0.1","4.0.2"]},"BaseSpaceBroker(RUO):NextSeq-NSQ":{"setDefaultValue":false,"values":["v2.8.22"]},"NCS:NextSeq-NSQ":{"setDefaultValue":false,"values":["v3.0.0.130"]},"NSS:NextSeq-NSQ":{"setDefaultValue":false,"values":["v3.0.0.130"]},"OSImage(Dx):NextSeq-NSQ":{"values":["N/A","31.1.C04","5.3.C11"],"setDefaultValue":false},"SystemSuiteInstaller(Dx):NextSeq-NSQ":{"setDefaultValue":false,"values":["1.3.0","1.3.1","1.3.3","1.4.0"]},"GermlineVariant(Dx):NextSeq-NSQ":{"values":["N/A","1.2.0","1.3.0.0","Needs Updating"],"setDefaultValue":false},"SomaticVariant(Dx):NextSeq-NSQ":{"values":["N/A","TBD","1.2.0","1.3.0.0"],"setDefaultValue":false},"VeriSeqNiPTLRMDx":{"setDefaultValue":false,"values":["1.1.1.219"]},"NextSeq-TruSightNIPT(Dx)":{"setDefaultValue":false,"values":["N/A","1.0.0.75"]},"TSOCompLRMIUO(1):NextSeq–NSQ":{"setDefaultValue":false,"values":["v2.0","v2.1","v2.2","vHRD","vHRR"]},"TSOCompLRMIUO(2):NextSeq–NSQ":{"setDefaultValue":false,"values":["vHRD","vHRR"]},"TSOCompLRM(Dx)":{"values":["EU_v2.3.3_ClaimsPkgv1.0.0","EU_v2.3.6_ClaimsPkgv2.1.0","EU_v2.3.5_ClaimsPkgv2.0.0"],"setDefaultValue":false},"DNAGenerateFASTQDx:NextSeq-NSQ-DX":{"setDefaultValue":false,"values":["1.0.0"]},"VeriSeqNiPTLRMRUO":{"setDefaultValue":false,"values":["1.0.1.22","1.0.2.27"]},"TSO500RUOLRM:NextSeq–NSQ":{"setDefaultValue":false,"values":["v2.0.0.141","v2.0.1.22"]},"NextSeq-Pumps":{"setDefaultValue":false,"values":["Polymer ","G2 Ceramic"]}}}';
        attrTemplate.SVMXC__SM_Title__c = 'NextSeq - NSQ - Dx Template';
        insert attrTemplate;
        Account acc = TestDataAccount.getAccount('Test Acc', 'USD');
        acc.Account_Group__c='Distributor';
        insert acc;
        //insert contact
        Contact con = TestDataPerson.getNewContact(acc.Id);
        System.assertNotEquals(null, con.id,' con.id  not null');
        //insert case        
        Case cs = TestDataCase.initServiceRequestCase(con);
        insert cs;
        Test.startTest();
        SVMXC__Service_Order__c workOrder = TestDataFieldService.createWorkOrder(STRING_WO_RECORDTYPE_REMOTE_SUPPORT, cs.Id, 'Initiated');
        workOrder.SVMXC__Order_Type__c='Installation';
        workOrder.SVMXC__Component__c = ip.Id;
        workOrder.Is_Auto_Created__c = true;
        insert workOrder;
        workOrder.SVMXC__Order_Status__c = 'Completed';
        workOrder.Evaluation__c = 'Done';
        workOrder.SVMXC__Work_Performed__c = 'Performed';
        workOrder.Verification_Result__c = 'Passed';
        workOrder.Training_Required__c = false;
        workOrder.Reason_for_No_Training__c = 'Customer Declined - Lab already trained';
         try { 
            update workOrder; 
		} catch (DmlException e) 
		{ 
            System.assert(e.getMessage().contains('There are required Technical Attributes')); 
        }
        ValidateInstallWOOnComplete_WOHelper.TechnicalAttributes attributes = new ValidateInstallWOOnComplete_WOHelper.TechnicalAttributes();
        attributes.label ='Test';
        attributes.type ='Test';
        attributes.sequence ='Test';
        attributes.defaultValue='Test';
        attributes.req ='Test';
        attributes.unit ='Test';
        attributes.readOnly ='Test';
        attributes.format ='Test';
        List<ValidateInstallWOOnComplete_WOHelper.TechnicalAttributes> lstAttributes = new List<ValidateInstallWOOnComplete_WOHelper.TechnicalAttributes>();
        lstAttributes.add(attributes);
        ValidateInstallWOOnComplete_WOHelper.TechnicalAttributeFields fields = new ValidateInstallWOOnComplete_WOHelper.TechnicalAttributeFields();

        
        fields.title ='Test';
        fields.description = 'Test';
        fields.technicalAttributes = lstAttributes;
        try {
            List<SVMXC__Installed_Product__c> lstIP =  [Select Id,SVMXC__Product__c ,SVMXC__Product__r.Family from  SVMXC__Installed_Product__c limit 10]; 
            System.assertNotEquals(null, lstIP,' lstIP returned not null');
         } catch(Exception e) {
             System.debug('Exception ex :  '+e);
         }
        Test.stopTest();
    }
}