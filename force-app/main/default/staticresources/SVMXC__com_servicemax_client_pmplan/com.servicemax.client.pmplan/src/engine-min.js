(function(){var a=SVMX.Package("com.servicemax.client.pmplan.engine");a.init=function(){var b=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("PMPLAN");a.Class("DeliveryEngineImpl",com.servicemax.client.sfmconsole.api.AbstractDeliveryEngine,{__metaModel:null,__root:null,__loadMask:null,__isContainerExternal:null,__parent:null,__translation:null,__view:null,__constructor:function(){this.__base();this.__isContainerExternal=false;},initAsync:function(c){var d=SVMX.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();this.__eventBus=SVMX.create("com.servicemax.client.pmplan.impl.PMPLANEngineEventBus",{});d.createNamedInstanceAsync("CONTROLLER",{handler:function(e){d.createNamedInstanceAsync("MODEL",{handler:function(f){e.setModel(f);d.createNamedInstanceAsync("PMPLAN.VIEW",{handler:function(g){this.__view=g;c.handler.call(c.context);},context:this,additionalParams:{eventBus:this.getEventBus()}});},context:this});},context:this,additionalParams:{eventBus:this.__eventBus}});},getEventBus:function(){return this.__eventBus;},translate:function(c){return b.T(c);},getAllTranslation:function(){return this.__translation;},__appCurrentState:"",changeApplicationState:function(c){if(this.__appCurrentState===c){return;}this.__appCurrentState=c;if(c=="block"){if(!this.__loadMask){this.__loadMask=new com.servicemax.client.ui.components.utils.LoadMask({parent:this.__root});}this.__loadMask.show({});this.__loadMask.setZIndex(50000);}else{if(c=="unblock"&&this.__loadMask!==null){if(this.__loadMask!==null){this.__loadMask.hide();}}}},reset:function(){this.getRoot().destroy();this.__root=null;this.run(this.options);},triggerEvent:function(c){this.__eventBus.triggerEvent(c);},run:function(g){var d=SVMX.toObject(SVMX.getClient().getApplicationParameter("svmx-pmplan-userinfo"));var c=SVMX.getClient();var f=SVMX.create("com.servicemax.client.lib.api.Event","GLOBAL.HANDLE_USER_INFO",this,d);c.triggerEvent(f);this.changeApplicationState("block");this.options=g||{};this.__planId=SVMX.getUrlParameter("pmPlanId");this.__sourceId=SVMX.getUrlParameter("sourceId");this.__mode=SVMX.getUrlParameter("mode");var e={};e.pmPlanId=this.__planId;e.sourceId=this.__sourceId;e.mode=this.__mode;evt=SVMX.create("com.servicemax.client.lib.api.Event","PMPLAN.GET_PMPLAN_DATA",this,{request:e,responder:SVMX.create("com.servicemax.client.pmplan.responders.GetPMPlanData",this)});this.triggerEvent(evt);},onGetPMPlanDataCompleted:function(c){this.changeApplicationState("unblock");this.__pmplanData=c;this.__metaModel=SVMX.create("com.servicemax.client.pmplan.engine.PMPLANMetaModel",this,c);this.__root=this.__view.createComponent("ROOTCONTAINER",{deliveryEngine:this,__engine:this});this.__root.render(SVMX.getDisplayRootId());},searchObject:function(c,d){this.changeApplicationState("block");evt=SVMX.create("com.servicemax.client.lib.api.Event","PMPLAN.OBJECT_SEARCH",this,{request:c,responder:SVMX.create("com.servicemax.client.pmplan.responders.SearchObject",this,d)});this.triggerEvent(evt);},onSearchObjectCompleted:function(c,d){this.changeApplicationState("unblock");d&&d(c);},getPMTemplateData:function(c,d){this.changeApplicationState("block");evt=SVMX.create("com.servicemax.client.lib.api.Event","PMPLAN.GET_PMTEMPLATE_DATA",this,{request:c,responder:SVMX.create("com.servicemax.client.pmplan.responders.GetPMTemplateData",this,d)});this.triggerEvent(evt);},onGetPMTemplateData:function(c,d){this.changeApplicationState("unblock");d&&d(c);},savePMPlan:function(c,d){this.changeApplicationState("block");evt=SVMX.create("com.servicemax.client.lib.api.Event","PMPLAN.SAVE_PMPLAN_DATA",this,{request:c,responder:SVMX.create("com.servicemax.client.pmplan.responders.SavePMPlanData",this,d)});this.triggerEvent(evt);},onSavePMPlanCompleted:function(c,d){this.changeApplicationState("unblock");d&&d(c);},getCoverageScheduleData:function(c,d){this.changeApplicationState("block");evt=SVMX.create("com.servicemax.client.lib.api.Event","PMPLAN.GET_COVERAGE_SCHEDULE_DATA",this,{request:c,responder:SVMX.create("com.servicemax.client.pmplan.responders.GetCoverageScheduleData",this,d)});this.triggerEvent(evt);},onGetCoverageScheduleDataCompleted:function(c,d){this.changeApplicationState("unblock");d&&d(c);},getCoverageTechnicalAtt:function(c,d){this.changeApplicationState("block");evt=SVMX.create("com.servicemax.client.lib.api.Event","PMPLAN.GET_COVERAGE_TECHNICAL_ATTRIBUTE",this,{request:c,responder:SVMX.create("com.servicemax.client.pmplan.responders.GetCoverageTechnicalAtt",this,d)});this.triggerEvent(evt);},onGetCoverageTechnicalAttCompleted:function(c,d){this.changeApplicationState("unblock");d&&d(c);},validateExpression:function(c,d){this.changeApplicationState("block");evt=SVMX.create("com.servicemax.client.lib.api.Event","PMPLAN.VALIDATE_EXPRESSION",this,{request:c,responder:SVMX.create("com.servicemax.client.pmplan.responders.ValidateExpression",this,d)});this.triggerEvent(evt);},onValidateExpressionCompleted:function(c,d){this.changeApplicationState("unblock");
d&&d(c);},getAccount:function(){if(this.__pmplanData.success&&this.__pmplanData.pmPlanRecord.accountList!=null){return this.__pmplanData.pmPlanRecord.accountList;}else{return[];}},getServiceContract:function(){if(this.__pmplanData.success&&this.__pmplanData.pmPlanRecord.serviceContractList!=null){return this.__pmplanData.pmPlanRecord.serviceContractList;}else{return[];}},getCoverageType:function(){if(this.__pmplanData.success&&this.__pmplanData.pmPlanRecord.coverageType!=null){return this.__pmplanData.pmPlanRecord.coverageType;}else{return[];}},getScheduleType:function(){if(this.__pmplanData.success&&this.__pmplanData.pmPlanRecord.scheduleType!=null){return this.__pmplanData.pmPlanRecord.scheduleType;}else{return[];}},getSLAlist:function(){if(this.__pmplanData.success&&this.__pmplanData.pmPlanRecord.slaList!=null){return this.__pmplanData.pmPlanRecord.slaList;}else{return[];}},getLocationlist:function(){if(this.__pmplanData.success&&this.__pmplanData.pmPlanRecord.locationList!=null){return this.__pmplanData.pmPlanRecord.locationList;}else{return[];}},getPMTemplatelist:function(){if(this.__pmplanData.success&&this.__pmplanData.pmPlanRecord.pmTemplateList!=null){return this.__pmplanData.pmPlanRecord.pmTemplateList;}else{return[];}},getWOPurposelist:function(){if(this.__pmplanData.success&&this.__pmplanData.pmPlanRecord.woPurposeList!=null){return this.__pmplanData.pmPlanRecord.woPurposeList;}else{return[];}},getActivityDateList:function(){if(this.__pmplanData.success&&this.__pmplanData.pmPlanRecord.activityDateList!=null){return this.__pmplanData.pmPlanRecord.activityDateList;}else{return[];}},getCovergaeList:function(){if(this.__pmplanData.success&&this.__pmplanData.pmPlanRecord.coverageList!=null){return this.__pmplanData.pmPlanRecord.coverageList;}else{return[];}},getMetaModel:function(){return this.__metaModel;},getRoot:function(){return this.__root;},onResize:function(c){this.getRoot().resize(c);}},{});a.Class("PMPLANMetaModel",com.servicemax.client.lib.api.Object,{__parent:null,__data:null,__constructor:function(c,d){this.__parent=c;this.__data=d;},destroy:function(){this.__data=null;}},{});};})();