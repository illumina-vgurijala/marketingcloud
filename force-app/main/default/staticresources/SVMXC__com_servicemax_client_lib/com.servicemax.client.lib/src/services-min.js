(function(a){var b=SVMX.Package("com.servicemax.client.lib.services");b.Class("ProfilingService",com.servicemax.client.lib.api.EventDispatcher,{__performance:null,__timingHash:null,__serverEntries:null,__defaultEvents:null,__supportedBrowser:false,__constructor:function(c,e,d){if(b.ProfilingService.__instance!=null){return b.ProfilingService.__instance;}b.ProfilingService.__instance=this;this.__base(c,e,d);this.__supportedBrowser=this.__checkBrowser();this.__performance=window.performance;this.__serverEntries=[];this.__defaultEvents={REFRESH_CONTENT:true,DATA_UPDATED:true};this.__timingHash={redirect:{begin:"redirectStart",end:"redirectEnd"},cache:{begin:"fetchStart",end:"domainLookupStart"},dns:{begin:"domainLookupStart",end:"domainLookupEnd"},tcp:{begin:"connectStart",end:"connectEnd"},request:{begin:"requestStart",end:"responseEnd"},response:{begin:"responseStart",end:"responseEnd"},unload:{begin:"unloadStart",end:"unloadEnd"},dom:{begin:"domLoading",end:"domComplete"},content:{begin:"domContentLoadedEventStart",end:"domContentLoadedEventEnd"},load:{begin:"loadEventStart",end:"loadEventEnd"},total:{begin:"navigationStart",end:"loadEventEnd"}};},__checkBrowser:function(){var d=false;var e=this.__getBrowser().toLowerCase();var c=this.__getBrowserVersion().toLowerCase();switch(e){case"chrome":d=true;break;case"firefox":d=true;break;case"ie":if(!isNaN(c)&&c!=""){c=parseInt(c);d=(c>8);}break;}return d;},__getBrowser:function(){var l=navigator.userAgent,g;var d="chrome|opera|firefox|safari|trident|msie";var c="\\s*([0-9]+)";var o=new RegExp("("+d+")/?"+c,"i");var p=o.exec(l)||[];var e="IE";var i="Opera";var n="Chrome";var k="";var m=/\bOPR\/(\d+)/;if(p[1]===n){g=l.match(m);if(g!=null){k=i+" "+g[1];}}else{if(/trident/i.test(p[1])){g=/\brv[ :]+(\d+)/g.exec(l)||[];k=e;}}if(!k){var j=/version\/(\d+)/i;var f=[p[1],p[2]];var h=[navigator.appName,navigator.appVersion,"-?"];p=p[2]?f:h;if((g=l.match(j))!=null){p.splice(1,1,g[1]);}k=p[0];}return k;},__getBrowserVersion:function(){var j=navigator.userAgent,f;var d="chrome|opera|firefox|safari|trident|msie";var c="\\s*([0-9]+)";var m=new RegExp("("+d+")/?"+c,"i");var n=m.exec(j)||[];var l="Chrome";var h="Opera";var o="";var k=/\bOPR\/(\d+)/;if(n[1]===l){f=j.match(k);if(f!=null){o=h+" "+f[1];}}else{if(/trident/i.test(n[1])){f=/\brv[ :]+(\d+)/g.exec(j)||[];o=f[1]||"0";}}if(!o){var i=/version\/(\d+)/i;var e=[n[1],n[2]];var g=[navigator.appName,navigator.appVersion,"-?"];n=n[2]?e:g;if((f=j.match(i))!=null){n.splice(1,1,f[1]);}o=n[1];}return o;},__findEntryKeyType:function(c){c=c||0;var e=["PerformanceMeasure","PerformanceEntry"];var d=this.__findEntryTypeKeyByName(e[c]);if(d.length>0){return d;}return this.__findEntryKeyType(++c);},__getMeasureDataBy:function(g,d){var f=[];var h=this.__findEntryKeyType();var c=this.getEntriesByType(h);var j=null;var k="";for(var e=0;e<c.length;e++){j=c[e].name.split("_");if(j.length>0){k=j[d];if(d>1){j.shift();j.shift();k=j.join("_");}if(d==-1){k=j[0]+"_"+j[1];}if(k==g){f.push(c[e]);}}}return f;},__isEntryTypeObject:function(d,e){for(var c=0;c<d.length;c++){if((d[c].action==e.action)&&(d[c].type==e.type)){return true;}}return false;},__isEntryTypes:function(d,e){for(var c=0;c<d.length;c++){if(d[c].name==e){return true;}}return false;},__findEntryTypeKeyByName:function(e){var d=this.getEntryTypes();for(var c=0;c<d.length;c++){if(d[c].name==e){return d[c].entry;}}return"";},__parseMeasurementName:function(c){var e=c.split("_");if(e.length!=3){return{};}var f=e[0];var d=e[1];var c=e[2];if(e.length>3){e.shift();e.shift();c=e.join("_");}return{action:f,type:d,name:c};},__getServerEntriesBy:function(e,j){var h={reqtype:true,entryType:true,name:true,description:true,endtime:true,begintime:true};var d=[];if(!h[e]){return d;}var g=this.__serverEntries;for(var c=0;c<g.length;c++){var f=g[c];if(j==f[e]){d.push(f);}}return d;},raiseEvent:function(g,e,d){if(this.__defaultEvents[g]){var f="com.servicemax.client.lib.api.Event";var i=e||undefined;var h=d||{request:{},responder:{}};var c=SVMX.create(f,g,i,h);this.triggerEvent(c);}},getDefaultEvents:function(){return this.__defaultEvents;},getTimingOptions:function(){return this.__timingHash;},getNativeProfiler:function(){return this.__performance;},getNativeProfiler:function(){return this.__performance;},getEntryTypes:function(){var e=[];var c=this.getEntries();var d=0;var f=null;for(;d<c.length;d++){if(d==0){f={name:SVMX.typeOf(c[d]),entry:c[d].entryType};e.push(f);}else{f={name:SVMX.typeOf(c[d]),entry:c[d].entryType};if(!this.__isEntryTypes(e,f.name)){e.push(f);}}}return e;},getMeasureEntryTypes:function(){var e=[];var g=this.__findEntryKeyType();var c=this.getEntriesByType(g);var f=null;for(var d=0;d<c.length;d++){f=this.__parseMeasurementName(c[d].name);if(!f.name){continue;}delete f.name;if(d==0){e.push(f);}else{if(!this.__isEntryTypeObject(e,f)){e.push(f);}}}return e;},getMeasureDataByType:function(c){return this.__getMeasureDataBy(c,1);},getMeasureDataByAction:function(c){return this.__getMeasureDataBy(c,0);
},getMeasureDataByName:function(c){return this.__getMeasureDataBy(c,2);},getMeasureDataByText:function(c){return this.__getMeasureDataBy(c,-1);},getTimes:function(){var d=[];var i=this.__timingHash;var f=this.__performance.timing;for(var c in i){var h={};var e=i[c];var g=f[e.end]-f[e.begin];h.name=c;h.duration=g;d.push(h);}return d;},getTimesByType:function(c){var e=this.__timingHash[c];if(!e){return 0;}var d=this.__performance.timing;var f=d[e.end]-d[e.begin];return(f<0)?0:f;},getEntries:function(){var c=[];c=a.merge(a.merge(c,this.__performance.getEntries()),this.__serverEntries);return c;},getEntriesByName:function(c){var d=this.__getServerEntriesBy("name",c);this.__performance.getEntriesByName&&a.merge(d,this.__performance.getEntriesByName(c));return d;},getEntriesByType:function(d){var c=this.__getServerEntriesBy("entryType",d);this.__performance.getEntriesByType&&a.merge(c,this.__performance.getEntriesByType(d));return c;},getMeasurementByName:function(d){var c=this.getEntriesByType("measure");var f=[];var e=0;for(;e<c.length;e++){if(c[e].name===d){f.push(c[e]);}}return f;},begin:function(d,e,f){if(!d){return false;}if(SVMX.typeOf(d)!="string"){return false;}f=(SVMX.typeOf(f)!="string")?"nonspecAction":f;e=(SVMX.typeOf(e)!="string")?"nonspecType":e;var c=[f,e,d].join("_");return this.mark(c,"begin");},end:function(d,e,f){if(!d){return false;}if(SVMX.typeOf(d)!="string"){return false;}f=(SVMX.typeOf(f)!="string")?"nonspecAction":f;e=(SVMX.typeOf(e)!="string")?"nonspecType":e;var c=[f,e,d].join("_");if(this.getEntriesByName(c+"_begin").length>0){return this.mark(c,"end",true,true);}return this;},mark:function(d,g,f,c){var e={begin:"begin",end:"end"};var h=e[g]?(d+"_"+e[g]):d;this.__performance.mark&&this.__performance.mark(h);if(f){this.measure(d);}if(c){this.clearMarks(d);}return this;},measure:function(d,e,c){var g=e?e:d+"_begin";var f=c?c:d+"_end";this.__performance.measure&&this.__performance.measure(d,g,f);return this;},clearMarks:function(c){this.__performance.clearMarks&&this.__performance.clearMarks(c);if(c){var e=c+"_begin";var d=c+"_end";this.__performance.clearMarks&&this.__performance.clearMarks(e);this.__performance.clearMarks&&this.__performance.clearMarks(d);}return this;},clearMeasure:function(c){this.__performance.clearMeasure&&this.__performance.clearMeasure(c);return this;},exportToFile:function(){},addServerEntry:function(d){if(SVMX.typeOf(d)=="Object"&&this.__supportedBrowser){var e={reqtype:true,name:true,description:true,endtime:true,begintime:true};for(var c in d){if(!e[c]){return false;}}this.__serverEntries.push(this.__processServerEntryData(d));}},__processServerEntryData:function(h){var g={rawdata:h};var e={reqtype:"entryType",name:"name",begintime:"startTime"};var i="";for(var c in h){if(e[c]){key=e[c];i=h[c];if(c=="reqtype"){i=i.toLowerCase();}g[key]=i;}}var d=this.__convertToDateTimeObject(h.endtime);var f=this.__convertToDateTimeObject(h.begintime);g.duration=Math.abs(d-f);g.startTime=f.getTime()-performance.timing.navigationStart;return g;},__convertToDateTimeObject:function(c){var d=this.__extractDateTime(c);return new Date(d.Y,d.M,d.D,d.hh,d.mm,d.ss,d.ms);},__extractDateTime:function(d){var e=d.split("T");var c={date:e[0],time:e[1]};a.extend(c,this.__extractDate(c.date),this.__extractTime(c.time));return c;},__extractDate:function(c){var d=c.split("-");return{Y:(d[0]*1),M:(d[1]*1),D:(d[2]*1)};},__extractTime:function(d){var e=d.split(": ");if(e.length==1){e=d.split(":");}var c=e[2].split(".");return{hh:(e[0]*1),mm:(e[1]*1),ss:(c[0]*1),ms:(c[1].substr(0,c[1].length-1)*1)};},clearServerEntries:function(){this.__serverEntries.length=0;}},{__instance:null,getInstance:function(){var c=null;if(b.ProfilingService.__instance==null){c=new b.ProfilingService();}else{c=b.ProfilingService.__instance;}return c;}});b.Class("LoggingService",com.servicemax.client.lib.api.Object,{__loggers:null,__uncreatedLoggers:null,__logTargetSettings:null,__constructor:function(){if(b.LoggingService.__instance!=null){return b.LoggingService.__instance;}b.LoggingService.__instance=this;this.__loggers={};},setTargetSettings:function(c){b.LoggingService.clearTargets();this.generateLogTargets(c.targets);var d;this.__logTargetSettings=c.loggers;for(var e in this.__loggers){var c=this.getLoggerSettings(e);this.__loggers[e].setTargetSettings(c);}},generateMissingLogTargets:function(c){if(this.__uncreatedLoggers){this.generateLogTargets(this.__uncreatedLoggers);}},generateLogTargets:function(d){this.__uncreatedLoggers={};var c=false;var e=b.LoggingService.__targets;SVMX.forEachProperty(d,function(i,g){if(!SVMX.array.contains(this.__targets,function(j){return j.targetName==i;})){var h=g["class-name"];var f=SVMX.getClass(h,true);if(!f){this.__uncreatedLoggers[i]=g;c=true;}else{g.options.targetName=i;SVMX.create(h,g.options);}}},this);if(!c){this.__uncreatedLoggers=null;}},getLoggerSettings:function(f){if(this.__logTargetSettings){return a.extend({},this.__logTargetSettings.DEFAULT||{},this.__logTargetSettings[f]||{});
}else{var d=this.getTargets();var c={};for(var e=0;e<d.length;e++){c[d[e].targetName]=d[e].defaultLogLevel;}return c;}},getLogger:function(e){if(SVMX.TEST){return global.console;}var d=null;if(e==undefined||e==null){e="SVMXCONSOLECORE";}if(this.__loggers[e]==undefined){var c=this.getLoggerSettings(e);d=new b.Logger(this,e,c);this.__loggers[e]=d;}else{d=this.__loggers[e];}return d;},getTargets:function(e){var d=[];var c=b.LoggingService.__targets;if(e){for(var f=0;f<c.length;f++){if(e[c[f].targetName]){d.push(c[f]);}}}else{for(var f=0;f<c.length;f++){if(c[f].isDefaultTarget){d.push(c[f]);}}}return d;}},{__targets:[],__instance:null,getInstance:function(d){var c=null;if(b.LoggingService.__instance==null){c=new b.LoggingService(d);}else{c=b.LoggingService.__instance;}return c;},registerTarget:function(d,c){SVMX.array.remove(b.LoggingService.__targets,function(e){return d.targetName==e.targetName;},true);b.LoggingService.__targets.push(d);SVMX.timer.job("generateMissingLogTargets",10,function(){b.LoggingService.getInstance().generateMissingLogTargets();});},clearTargets:function(){b.LoggingService.__targets=[];}});b.Class("AbstractLogTarget",com.servicemax.client.lib.api.Object,{targetName:"",isDefaultTarget:false,defaultLogLevel:"ERROR",__constructor:function(c){if(!c){c={};}this.targetName=c.targetName;b.LoggingService.registerTarget(this);},log:function(d,c){}},{});b.Class("BrowserConsoleLogTarget",b.AbstractLogTarget,{isDefaultTarget:true,defaultLogLevel:"DEBUG",__constructor:function(c){if(!c){c={targetName:"Browser"};}this.__base(c);},log:function(f,d){var c=window.console;if(!c){return;}var e=d.type;if(f instanceof Error){f=f.stack?f.stack.toString():f.toString();}var g=d.timeStamp+": "+d.source+" "+f;if(e=="INFO"||e=="CRITICAL"){c.info(g);}else{if(e=="ERROR"){c.error(g);}else{if(e=="WARNING"){c.warn(g);}else{if(e=="DEBUG"){if(c.debug){c.debug(g);}else{c.info("DEBUG=>INFO "+g);}}else{c.log(g);}}}}}},{});new b.BrowserConsoleLogTarget({targetName:"Browser"});b.Class("AlertLogTarget",b.AbstractLogTarget,{__constructor:function(c){this.__base(c);},log:function(f,d){var c=window.console;if(!c){return;}var e=d.type;if(f instanceof Error){f=f.stack?f.stack.toString():f.toString();}var g=d.timeStamp+": "+d.source+" "+f;alert(e+": "+g);}},{});b.Class("Logger",com.servicemax.client.lib.api.Object,{__parent:null,__source:"",__targetSettings:null,__constructor:function(d,e,c){this.__parent=d;this.__source=e;this.setTargetSettings(c);},setTargetSettings:function(c){this.__targetSettings=c;},__shouldSkipLogging:function(f,h){var d=false,c={DEBUG:5,INFO:4,WARNING:3,ERROR:2,CRITICAL:1,NONE:0};var e=this.__targetSettings[h];if(!e){return true;}var i=c[e];var g=c[f];if(i<g){d=true;}return d;},getTimestamp:function(){return com.servicemax.client.lib.datetimeutils?com.servicemax.client.lib.datetimeutils.DatetimeUtil.macroDrivenDatetime("Now","MM-DD-YYYY","HH:mm:ss"):new Date().toString();},info:function(f){var e=this.__parent.getTargets(this.__targetSettings),c=this.getTimestamp();for(var d=0;d<e.length;d++){if(!this.__shouldSkipLogging("INFO",e[d].targetName)){e[d].log(f,{type:"INFO",source:this.__source,timeStamp:c});}}},debug:function(f){var e=this.__parent.getTargets(this.__targetSettings),c=this.getTimestamp();for(var d=0;d<e.length;d++){if(!this.__shouldSkipLogging("DEBUG",e[d].targetName)){e[d].log(f,{type:"DEBUG",source:this.__source,timeStamp:c});}}},error:function(f){var e=this.__parent.getTargets(this.__targetSettings),c=this.getTimestamp();for(var d=0;d<e.length;d++){if(!this.__shouldSkipLogging("ERROR",e[d].targetName)){e[d].log(f,{type:"ERROR",source:this.__source,timeStamp:c});}}},warning:function(f){var e=this.__parent.getTargets(this.__targetSettings),c=this.getTimestamp();for(var d=0;d<e.length;d++){if(!this.__shouldSkipLogging("WARNING",e[d].targetName)){e[d].log(f,{type:"WARNING",source:this.__source,timeStamp:c});}}},warn:function(c){this.warning(c);},critical:function(f){var e=this.__parent.getTargets(this.__targetSettings),c=this.getTimestamp();for(var d=0;d<e.length;d++){if(!this.__shouldSkipLogging("CRITICAL",e[d].targetName)){e[d].log(f,{type:"CRITICAL",source:this.__source,timeStamp:c});}}}},{});b.Class("ResourceLoaderEvent",com.servicemax.client.lib.api.Event,{__constructor:function(c,e,d){this.__base(c,e,d);}},{});b.Class("ResourceLoader",com.servicemax.client.lib.api.EventDispatcher,{__constructor:function(){this.__base();},loadAsync:function(c){return a.ajax({type:"GET",dataType:c.responseType,data:c.data,cache:c.cache,url:c.url,context:this,async:true,success:function(f,d,e){this._loadSuccess(f,d);},error:function(f,d,g){this._loadError(f,d,g);}});},_loadSuccess:function(d,c){var e=new b.ResourceLoaderEvent("LOAD_COMPLETE",this,d);this.triggerEvent(e);},_loadError:function(d,c,f){var g=new b.ResourceLoaderEvent("LOAD_ERROR",this);this.triggerEvent(g);}},{});b.Class("ResourceLoaderService",com.servicemax.client.lib.api.Object,{__constructor:function(){if(b.ResourceLoaderService.__instance!=null){return b.ResourceLoaderService.__instance;
}b.ResourceLoaderService.__instance=this;},createResourceLoader:function(){return new b.ResourceLoader();}},{__instance:null,getInstance:function(){var c=null;if(b.ResourceLoaderService.__instance==null){c=new b.ResourceLoaderService();}else{c=b.ResourceLoaderService.__instance;}return c;}});})(jQuery);