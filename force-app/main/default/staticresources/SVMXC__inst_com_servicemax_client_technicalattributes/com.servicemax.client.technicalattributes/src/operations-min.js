(function(){var a=SVMX.Package("com.servicemax.client.technicalattributes.operations");a.init=function(){var b=com.servicemax.client.technicalattributes.impl.Module;a.Class("GetMetaData",com.servicemax.client.mvc.api.Operation,{__constructor:function(){this.__base();},performAsync:function(d,c){technicalAttributeOnWeb.JsrGetMetadata("",function(e,f){c.result(e);},this);}},{});a.Class("GetTemplateData",com.servicemax.client.mvc.api.Operation,{__constructor:function(){this.__base();},performAsync:function(f,c){var e=this;var d=f.recordId;technicalAttributeOnWeb.JsrGetAttributesTemplateInstanceForIB(d,function(g,h){c.result(g);},this);}},{});a.Class("SaveTechnicalAttribute",com.servicemax.client.mvc.api.Operation,{__constructor:function(){this.__base();},performAsync:function(d,c){technicalAttributeOnWeb.JsrSaveTechnicalAttributeDetails(d.instanceObject,function(e,f){c.result(e);},this);}},{});a.Class("GetHistoryRecord",com.servicemax.client.mvc.api.Operation,{__constructor:function(){this.__base();},performAsync:function(e,c){var d=b.instance;b.instance.createServiceRequest({handler:function(g){var p=SVMX.getCustomFieldName("SM_Attr_Payload");var k=SVMX.getCustomFieldName("SM_Captured_On");var q=e.timeZone;g.bind("REQUEST_COMPLETED",function(u){var v=u.data.records;if(v.length>0){var w=v[0];var z=w[k];var x=w[p];var y={};y.capturedOn=z;y.template=x;c.result(y);}else{c.result([]);}},this);g.bind("REQUEST_ERROR",function(u){c.result([]);},this);var s=SVMX.getCustomFieldName("SM_IB_Attributes_History");var h=SVMX.getCustomFieldName("SM_Installed_Product_Id");var l="";var m;if(e.presentCapturedOnDate){m=e.presentCapturedOnDate;var j=moment.tz(m,q);var f=j._d;f=new Date(f.valueOf()+f.getTimezoneOffset()*60000);var i;if(e.isPreviousRecord){i=Ext.Date.format(f,"Y-m-d 00:00:00");}else{i=Ext.Date.format(f,"Y-m-d 23:59:59");}var o=new Date(i);var r=new Date(o.valueOf()-j._offset*60000);var t=Ext.Date.format(r,"Y-m-d\\TH:i:s.000\\Z");m=t;}if(e.isPreviousRecord){l=" AND "+k+" < "+m+" order by "+k+" desc limit 1  ";}else{l=" AND "+k+" > "+m+" order by "+k+" asc limit 1  ";}var n=encodeURI("select "+k+","+p+" from "+s+" where "+h+" = '"+e.recordId+"'"+l);g.callApiAsync({url:"query?q="+n});},context:this},this);}},{});};})();