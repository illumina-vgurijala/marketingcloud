(function(){var a=SVMX.Package("com.servicemax.client.spareparts.ui.desktop.api");a.init=function(){var b=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("SPAREPARTS");Ext.define("com.servicemax.client.spareparts.ui.desktop.api.RootContainer",{extend:"com.servicemax.client.ui.components.composites.impl.SVMXSection",cls:"spareparts-root-container",width:"100%",id:"spareparts",layout:"anchor",constructor:function(c){c=Ext.apply({title:b.T("TAG001","Spare Parts Setup"),titleAlign:"center",collapsible:false,header:{items:[{xtype:"svmx.button",itemId:"BackButton",cls:"spareparts-back-btn",padding:"0",text:b.T("TAG002","Back to Setup Home"),handler:function(i,g,d,f){var h="/apex/"+SVMX.OrgNamespace+"__CONF_SetupHome";if((typeof sforce!="undefined")&&(sforce!=null)){h="/lightning/n/"+SVMX.OrgNamespace+"__ServiceMax_Setup";sforce.one.navigateToURL(h);}else{window.location.href=h;}}}]},},c||{});this.callParent(arguments);},initComponent:function(){this.callParent(arguments);var H=this;var y=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXToolbar",{width:"100%",dock:"top",autoHeight:true,});var C=SVMX.create("Ext.Toolbar.Fill",{});y.add(C);H.profilePicklistStore=SVMX.create("Ext.data.Store",{fields:[{name:"Id"},{name:"name"}],proxy:{type:"memory"},data:this.__engine.__profileData!=null?this.__engine.__profileData:[],});var s=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{id:"profilePicklist",name:"profilePicklistName",fieldLabel:b.T("TAG003","Select Profile"),labelField:"label",valueField:"Id",width:350,cls:"spareparts-select-profile",displayField:"name",labelSeparator:"",defaultAlign:"center",queryMode:"local",store:H.profilePicklistStore,listConfig:{getInnerTpl:function(K){return"{[Ext.String.htmlEncode(values."+K+")]}";}},listeners:{select:function(Q,K,N){var O=Ext.getCmp("spareparts");Ext.getCmp("firstFieldSetForFields").setDisabled(false);Ext.getCmp("secondFieldSetForFields").setDisabled(false);Ext.getCmp("enableLocatePart").setDisabled(false);Ext.getCmp("locatePartLabel").show();Ext.getCmp("mobileInvLink").show();Ext.getCmp("enableDescriptionField").setValue(false);Ext.getCmp("enableAttachmentField").setValue(false);var M=[];var P={Id:"miles",name:b.T("TAG045","Miles")};var L={Id:"kilometer",name:b.T("TAG046","kilometer")};M.push(P,L);O.distanceStore.loadData(M);O.__engine.getSparePartConfig(K[0].data.Id,function(R){if(R.success){var S=[];var V=[];var U=[];R.listproductfields.forEach(function(X,W){if(X.fieldtype.toLowerCase()=="string"){V.push(X);U.push(X);}if(X.fieldtype.toLowerCase()=="textarea"){V.push(X);}else{S.push(X);}});O.productPicklistValues.loadData(S);O.descriptionPicklistValues.loadData(V);O.attachmentPicklistValues.loadData(U);Ext.getCmp("columnone").setValue("Name");Ext.getCmp("columntwo").setValue("ProductCode");Ext.getCmp("columnthree").setValue("Family");Ext.getCmp("columnfour").setValue(SVMX.OrgNamespace+"__Product_Line__c");Ext.getCmp("columnDetailone").setValue("Name");Ext.getCmp("columnDetailtwo").setValue("ProductCode");Ext.getCmp("columnDetailthree").setValue("Family");Ext.getCmp("columnDetailDescription").setValue("");Ext.getCmp("columnDetailAttachment").setValue("");Ext.getCmp("enableLocatePart").setValue(R.locatepartsetup.isenabled);if(R.locatepartsetup.radius==null||R.locatepartsetup.radius==""){Ext.getCmp("searchRadius").setValue("0");Ext.getCmp("distanceStorePicklist").setValue("miles");}else{Ext.getCmp("searchRadius").setValue(R.locatepartsetup.radius);Ext.getCmp("distanceStorePicklist").setValue(R.locatepartsetup.distanceinunit);}O.locationTypeStore.loadData(R.locatepartsetup.listlocationtype);Ext.getCmp("locationTypePicklist").setValue("Field");if(R.locatepartsetup!=null&&R.locatepartsetup.locationtype!=null&&R.locatepartsetup.locationtype!=""){Ext.getCmp("locationTypePicklist").setValue(R.locatepartsetup.locationtype);}O.inventoryProcessStore.loadData(R.liststockinventoryprocess);Ext.getCmp("inventoryProcessPicklist").setValue(R.locatepartsetup.inventoryprocess);if(R.layout!=null&&R.layout.partsfields!=null&&R.layout.partsfields!=""&&R.layout.partsfields!=[]){R.layout.partsfields.forEach(function(X,W){if(X.sequence==1){Ext.getCmp("columnone").setValue(X.fieldname);}if(X.sequence==2){Ext.getCmp("columntwo").setValue(X.fieldname);}if(X.sequence==3){Ext.getCmp("columnthree").setValue(X.fieldname);}if(X.sequence==4){Ext.getCmp("columnfour").setValue(X.fieldname);}});}if(R.layout!=null&&R.layout.partsdetailfields!=null&&R.layout.partsdetailfields!=""&&R.layout.partsdetailfields!=[]){R.layout.partsdetailfields.forEach(function(X,W){if(X.sequence==1){Ext.getCmp("columnDetailone").setValue(X.fieldname);}if(X.sequence==2){Ext.getCmp("columnDetailtwo").setValue(X.fieldname);}if(X.sequence==3){Ext.getCmp("columnDetailthree").setValue(X.fieldname);}if(X.sequence==4){var Y=Ext.getCmp("columnDetailDescription");Y.setValue(X.fieldname);if(Y.getValue()!=null&&Y.getValue()!=""){Ext.getCmp("enableDescriptionField").setValue(true);
}}});}if(R.layout!=null&&R.layout.attachmentfilename!=null&&R.layout.attachmentfilename!=""){Ext.getCmp("columnDetailAttachment").setValue(R.layout.attachmentfilename);Ext.getCmp("enableAttachmentField").setValue(true);}var T=Ext.getCmp("downloadRulePanelCmp");T.loadData(R.listproductstockstatus,R.listquantityfields,R.layout!=null?R.layout.downloadcriteria:"");Ext.getCmp("saveBtn").setDisabled(false);}else{SVMX.getCurrentApplication().getApplicationQuickMessageHandler().showQuickMessage(Ext.String.htmlEncode(R.messagelist[0]),7000,"success");}});}}});y.add(s);var C=SVMX.create("Ext.Toolbar.Fill",{});y.add(C);var m=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXButton",{text:b.T("TAG011","Save"),scale:"medium",style:"margin-left: 3px !important",cls:"spareparts-save-btn",height:30,disabled:true,id:"saveBtn",handler:function(){var Q=false;var M={};M.profileId=Ext.getCmp("profilePicklist").getValue();M.locatepartsetup={};M.locatepartsetup.isenabled=Ext.getCmp("enableLocatePart").getValue();M.locatepartsetup.radius=Ext.getCmp("searchRadius").getValue();var O=Ext.getCmp("locationTypePicklist").getValue();if(O!=null&&O!=""){M.locatepartsetup.locationtype=Ext.getCmp("locationTypePicklist").getValue();}else{Ext.getCmp("locationTypePicklist").markInvalid(b.T("TAG044","Location Type is mandatory"));Q=true;}M.locatepartsetup.inventoryprocess=Ext.getCmp("inventoryProcessPicklist").getValue();M.locatepartsetup.distanceinunit=Ext.getCmp("distanceStorePicklist").getValue();M.layout={};M.layout.partsfields=[];var S=H.picklistRecord("columnone","1",false,"productPicklistValues");if(S==null){Ext.getCmp("columnone").markInvalid(b.T("TAG032","Column 1 is mandatory"));Q=true;}else{M.layout.partsfields.push(S);}var K=H.picklistRecord("columntwo","2",false,"productPicklistValues");if(K!=null){M.layout.partsfields.push(K);}else{Ext.getCmp("columntwo").markInvalid(b.T("TAG032","Column 2 is mandatory"));Q=true;}var U=H.picklistRecord("columnthree","3",false,"productPicklistValues");if(U!=null){M.layout.partsfields.push(U);}else{Ext.getCmp("columnthree").markInvalid(b.T("TAG032","Column 3 is mandatory"));Q=true;}var P=H.picklistRecord("columnfour","4",false,"productPicklistValues");if(P!=null){M.layout.partsfields.push(P);}else{Ext.getCmp("columnfour").markInvalid(b.T("TAG032","Column 4 is mandatory"));Q=true;}M.layout.partsdetailfields=[];var N=H.picklistRecord("columnDetailone","1",true,"productPicklistValues");if(N!=null){M.layout.partsdetailfields.push(N);}else{Ext.getCmp("columnDetailone").markInvalid(b.T("TAG032","Title is mandatory"));Q=true;}var T=H.picklistRecord("columnDetailtwo","2",true,"productPicklistValues");if(T!=null){M.layout.partsdetailfields.push(T);}else{Ext.getCmp("columnDetailtwo").markInvalid(b.T("TAG032","Detail 1 is mandatory"));Q=true;}var R=H.picklistRecord("columnDetailthree","3",true,"productPicklistValues");if(R!=null){M.layout.partsdetailfields.push(R);}else{Ext.getCmp("columnDetailthree").markInvalid(b.T("TAG032","Detail 2 is mandatory"));Q=true;}var L=H.picklistRecord("columnDetailDescription","4",false,"descriptionPicklistValues");if(L!=null){M.layout.partsdetailfields.push(L);}else{if(Ext.getCmp("enableDescriptionField").getValue()){Ext.getCmp("columnDetailDescription").markInvalid(b.T("TAG032","Description field is mandatory"));Q=true;}}M.layout.downloadcriteria=[];var V=Ext.getCmp("sparePartsGrid").getStore();V.data.items.forEach(function(W){if(W.data.productstockstatus!=""&&W.data.productstockstatus!=null){M.layout.downloadcriteria.push(W.data);}else{Q=true;SVMX.getCurrentApplication().getApplicationQuickMessageHandler().showQuickMessage(b.T("TAG033","Enter Product Stock Status"),7000,"success");}});if(Ext.getCmp("enableAttachmentField").getValue()){if(Ext.getCmp("columnDetailAttachment").getValue()!=null&&Ext.getCmp("columnDetailAttachment").getValue()!=""){M.layout.attachmentfilename=Ext.getCmp("columnDetailAttachment").getValue();}else{Ext.getCmp("columnDetailAttachment").markInvalid(b.T("TAG032","Attachment field is mandatory"));Q=true;}}if(!Q){H.__engine.saveSparePartConfig(M,function(W){if(!W.success){SVMX.getCurrentApplication().getApplicationQuickMessageHandler().showQuickMessage(Ext.String.htmlEncode(W.messagelist[0]),7000,"success");}else{SVMX.getCurrentApplication().getApplicationQuickMessageHandler().showQuickMessage(b.T("TAG023","Save Successful"),7000,"success");}});}}});var r=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXButton",{text:b.T("TAG010","Cancel"),scale:"medium",style:"margin-left: 3px !important",cls:"spareparts-cancel-btn",height:30,handler:function(){var K="/apex/"+SVMX.OrgNamespace+"__CONF_SetupHome";if((typeof sforce!="undefined")&&(sforce!=null)){sforce.one.navigateToURL(K);}else{window.location.href=K;}}});y.add(m);y.add(r);y.add({cursor:"pointer",scale:"large",cls:"spareparts-help",tooltip:b.T("TAG038","Spare parts help link"),href:b.T("TAG039","http://helplink"),width:32,height:32,margin:"0 0 0 15px",});H.add(y);var o=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXCheckbox",{labelSeparator:"",name:"enableLocatePart",id:"enableLocatePart",boxLabelAlign:"before",boxLabel:b.T("TAG006","Enable Locate Part"),width:"calc(25% + 20px)",cls:"spareparts-checkbox-label",disabled:true,listeners:{change:function(K,L){if(!L){Ext.getCmp("searchRadius").setValue("0");
Ext.getCmp("locationTypePicklist").setValue("Field");Ext.getCmp("inventoryProcessPicklist").setValue("");Ext.getCmp("distanceStorePicklist").setValue("miles");}Ext.getCmp("searchRadius").setDisabled(!L);Ext.getCmp("locationTypePicklist").setDisabled(!L);Ext.getCmp("inventoryProcessPicklist").setDisabled(!L);Ext.getCmp("distanceStorePicklist").setDisabled(!L);}}});var i=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXLabel",{text:b.T("TAG036",'For this feature to work, "Enable Location Tracking" under Mobile Configuration should be True'),cls:"spareparts-checkbox-note",hidden:true,id:"locatePartLabel"});var j=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXLabel",{html:'<a href="/apex/'+SVMX.OrgNamespace+'__CONF_MobileConfig" target = "_blank" class="spareparts-view-configuration">'+b.T("TAG037","View Mobile Configuration Setup")+"</a><br/>",hidden:true,id:"mobileInvLink"});var q=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXNumber",{labelSeparator:"",name:"searchRadius",id:"searchRadius",disabled:!(Ext.getCmp("enableLocatePart").getValue()),minValue:0,enforceMaxLength:true,maxLength:4,fieldLabel:b.T("TAG007","Set Part Search Radius")});H.distanceStore=SVMX.create("Ext.data.Store",{fields:[{name:"Id"},{name:"name"}],proxy:{type:"memory"},data:[],});var d=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{id:"distanceStorePicklist",name:"distanceStorePicklist",labelField:"label",valueField:"Id",displayField:"name",labelSeparator:"",defaultAlign:"center",editable:false,disabled:!(Ext.getCmp("enableLocatePart").getValue()),queryMode:"local",store:H.distanceStore,});var g=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXSection",{layout:"column",cls:"spareparts-input-container",width:"50%",columns:2,header:false,border:false,items:[q,d],});H.locationTypeStore=SVMX.create("Ext.data.Store",{fields:[{name:"Id"},{name:"name"}],proxy:{type:"memory"},data:[],});var B=SVMX.create("com.servicemax.client.spareparts.ui.desktop.editors.SparePartsMultiSelectPicklist",{id:"locationTypePicklist",name:"locationTypePicklist",cls:"spareparts-input-container location-type-for-part-search",width:"50%",fieldLabel:b.T("TAG008","Select Location Type for Part Search"),labelField:"label",valueField:"Id",displayField:"name",defaultAlign:"center",editable:false,multiSelect:true,msgTarget:"under",disabled:!(Ext.getCmp("enableLocatePart").getValue()),store:H.locationTypeStore,});H.inventoryProcessStore=SVMX.create("Ext.data.Store",{fields:[{name:"Id"},{name:"name"}],proxy:{type:"memory"},data:[],});var u=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{id:"inventoryProcessPicklist",name:"inventoryProcessPicklist",cls:"spareparts-input-container",width:"50%",fieldLabel:b.T("TAG009","Select Stock Transfer Inventory Transaction"),labelField:"label",valueField:"Id",displayField:"name",labelSeparator:"",defaultAlign:"center",multiSelect:false,editable:false,disabled:!(Ext.getCmp("enableLocatePart").getValue()),queryMode:"local",store:H.inventoryProcessStore,listConfig:{getInnerTpl:function(K){return"{[Ext.String.htmlEncode(values."+K+")]}";}},});var z=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXSection",{title:b.T("TAG004","Setup"),id:"locatePart",bodyPadding:10,items:[o,i,j,g,B,u],});var E=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXLabel",{text:b.T("TAG012","Parts Table - Used for Trunk Stock and Parts Catalog"),});H.productPicklistValues=SVMX.create("Ext.data.Store",{fields:[{name:"Id"},{name:"name"},{name:"fieldtype"}],id:"productPicklistValues",proxy:{type:"memory"},data:[],});var A=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{id:"columnone",name:"columnone",labelField:"label",valueField:"Id",displayField:"name",labelSeparator:"",defaultAlign:"center",labelAlign:"top",allowBlank:false,editable:false,msgTarget:"under",fieldLabel:b.T("TAG013","Column 1 - Primary Column"),queryMode:"local",store:H.productPicklistValues,listConfig:{getInnerTpl:function(K){return"{[Ext.String.htmlEncode(values."+K+")]}";}},});var k=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{id:"columntwo",name:"columntwo",labelField:"label",valueField:"Id",displayField:"name",labelSeparator:"",defaultAlign:"center",labelAlign:"top",allowBlank:false,editable:false,msgTarget:"under",fieldLabel:b.T("TAG014","Column 2"),queryMode:"local",store:H.productPicklistValues,listConfig:{getInnerTpl:function(K){return"{[Ext.String.htmlEncode(values."+K+")]}";}},});var x=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{id:"columnthree",name:"columnthree",labelField:"label",valueField:"Id",displayField:"name",labelSeparator:"",defaultAlign:"center",labelAlign:"top",allowBlank:false,editable:false,msgTarget:"under",fieldLabel:b.T("TAG015","Column 3"),queryMode:"local",store:H.productPicklistValues,listConfig:{getInnerTpl:function(K){return"{[Ext.String.htmlEncode(values."+K+")]}";
}},});var J=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{id:"columnfour",name:"columnfour",labelField:"label",valueField:"Id",displayField:"name",labelSeparator:"",defaultAlign:"center",labelAlign:"top",allowBlank:false,editable:false,msgTarget:"under",fieldLabel:b.T("TAG016","Column 4 show only in landscape orientation"),queryMode:"local",store:H.productPicklistValues,listConfig:{getInnerTpl:function(K){return"{[Ext.String.htmlEncode(values."+K+")]}";}},});var p=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXLabel",{text:b.T("TAG017","Parts Detail View"),});var e=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{id:"columnDetailone",name:"columnDetailone",labelField:"label",valueField:"Id",displayField:"name",labelSeparator:"",defaultAlign:"center",labelAlign:"top",allowBlank:false,editable:false,msgTarget:"under",fieldLabel:b.T("TAG018","Title"),queryMode:"local",store:H.productPicklistValues,listConfig:{getInnerTpl:function(K){return"{[Ext.String.htmlEncode(values."+K+")]}";}},});var D=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{id:"columnDetailtwo",name:"columnDetailtwo",labelField:"label",valueField:"Id",displayField:"name",labelSeparator:"",defaultAlign:"center",labelAlign:"top",allowBlank:false,editable:false,msgTarget:"under",fieldLabel:b.T("TAG019","Detail 1"),queryMode:"local",store:H.productPicklistValues,listConfig:{getInnerTpl:function(K){return"{[Ext.String.htmlEncode(values."+K+")]}";}},});var n=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{id:"columnDetailthree",name:"columnDetailthree",labelField:"label",valueField:"Id",displayField:"name",labelSeparator:"",defaultAlign:"center",labelAlign:"top",allowBlank:false,editable:false,msgTarget:"under",fieldLabel:b.T("TAG020","Detail 2"),queryMode:"local",store:H.productPicklistValues,listConfig:{getInnerTpl:function(K){return"{[Ext.String.htmlEncode(values."+K+")]}";}},});var w=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXCheckbox",{labelSeparator:"",name:"enableDescriptionField",id:"enableDescriptionField",boxLabelAlign:"before",cls:"spareparts-enable-checklist",boxLabel:b.T("TAG021","Include Description"),listeners:{change:function(K,L){if(!L){Ext.getCmp("columnDetailDescription").setValue("");}else{Ext.getCmp("columnDetailDescription").setValue("Description");}Ext.getCmp("columnDetailDescription").setDisabled(!L);}}});H.descriptionPicklistValues=SVMX.create("Ext.data.Store",{fields:[{name:"Id"},{name:"name"},{name:"fieldtype"}],id:"descriptionPicklistValues",proxy:{type:"memory"},data:[],});var h=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{id:"columnDetailDescription",name:"columnDetailDescription",labelField:"label",valueField:"Id",displayField:"name",labelSeparator:"",defaultAlign:"center",msgTarget:"under",labelAlign:"top",editable:false,disabled:true,fieldLabel:b.T("TAG022","Description"),queryMode:"local",store:H.descriptionPicklistValues,listConfig:{getInnerTpl:function(K){return"{[Ext.String.htmlEncode(values."+K+")]}";}},});var l=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXCheckbox",{labelSeparator:"",name:"enableAttachmentField",id:"enableAttachmentField",cls:"spareparts-enable-checklist",boxLabelAlign:"before",boxLabel:b.T("TAG034","Include Attachment"),width:"50%",listeners:{change:function(K,L,M){if(L&&Ext.getCmp("columnDetailAttachment").getValue()==""){Ext.MessageBox.confirm({title:b.T("TAG041","Confirm"),msg:b.T("TAG040","Each attachment will require an individual API call and will contribute towards Salesforce API limits. Do you want to continue?"),fn:function(N){if(N=="yes"){Ext.getCmp("columnDetailAttachment").setValue("Name");}else{K.setValue(false);L=false;Ext.getCmp("columnDetailAttachment").setDisabled(true);Ext.getCmp("columnDetailAttachment").setValue("");}},buttonText:{yes:b.T("TAG042","Yes"),no:b.T("TAG043","No"),},});}if(!L){Ext.getCmp("columnDetailAttachment").setValue("");}Ext.getCmp("columnDetailAttachment").setDisabled(!L);}}});H.attachmentPicklistValues=SVMX.create("Ext.data.Store",{fields:[{name:"Id"},{name:"name"},{name:"fieldtype"}],id:"attachmentPicklistValues",proxy:{type:"memory"},data:[],});var v=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{id:"columnDetailAttachment",name:"columnDetailAttachment",labelField:"label",valueField:"Id",displayField:"name",labelSeparator:"",defaultAlign:"center",labelAlign:"top",msgTarget:"under",editable:false,disabled:true,fieldLabel:b.T("TAG035","Attachment File Name"),queryMode:"local",store:H.descriptionPicklistValues,listConfig:{getInnerTpl:function(K){return"{[Ext.String.htmlEncode(values."+K+")]}";}},});var G={xtype:"fieldset",columnWidth:0.5,border:false,defaults:{anchor:"100%"},layout:"anchor",style:"top: 10px;",disabled:true,id:"firstFieldSetForFields",items:[E,A,k,x,J]};var F={xtype:"fieldset",columnWidth:0.5,border:false,defaults:{anchor:"100%"},layout:"anchor",style:"top: 10px;",disabled:true,id:"secondFieldSetForFields",items:[p,e,D,n,w,h,l,v]};
var c=SVMX.create("com.servicemax.client.spareparts.ui.desktop.downloadrule.DownloadrulePanel",{id:"downloadRulePanelCmp",cls:"spareparts-downloadRule",collapsible:false,region:"center",width:"100%",layout:"anchor",__parent:this,defaults:{bodyPadding:0,anchor:"100%"}});var I=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXSection",{id:"selectFields",collapsible:false,region:"center",layout:"column",border:false,defaults:{bodyPadding:8,},items:[G,F],});var f=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXSection",{title:b.T("TAG005","Layout"),id:"downloadCriteria",collapsible:false,region:"center",layout:"column",border:false,defaults:{bodyPadding:8,},items:[I,c],});var t=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXTabPanel",{activeTab:0,id:"setupTabPanel",anchor:"100% 100%",border:false,defaults:{autoScroll:true,frame:false,border:false,padding:"0 0 0 0"},items:[z,f],});H.add(t);},picklistRecord:function(g,j,h,e){var d=Ext.getStore(e);if(Ext.getCmp(g).getValue()!=null&&Ext.getCmp(g).getValue()!=""){var f=d.findExact("Id",Ext.getCmp(g).getValue());if(f!=-1){var i=d.getAt(f);var c={};c.showlabel=h;c.sequence=j;c.fieldname=i.data.Id;c.objectname="Product2";c.fieldtype=i.data.fieldtype;return c;}else{return null;}}else{return null;}},});Ext.define("com.servicemax.client.spareparts.ui.desktop.editors.SparePartsMultiSelectPicklist",{extend:com.servicemax.client.ui.components.controls.impl.SVMXMultiSelectPicklist,alias:"widget.spareparts.multipicklist",delimiter:",",selectOnFocus:true,constructor:function(c){if(!c){c={};}var e=this;var d=450;c=Ext.apply(c,{editable:true,queryMode:"local",displayField:"name",valueField:"Id",editable:false,listConfig:{xtype:"svmx.listcomposite",hideHeaders:true,selModel:SVMX.create("Ext.selection.CheckboxModel",{checkOnly:false,width:30,mode:"SIMPLE",}),columns:[{dataIndex:"name",width:d,renderer:function(h,g,f,i){valuesToSelect=e.getValue();if(valuesToSelect!=undefined&&valuesToSelect!=null){if(valuesToSelect.indexOf(f.data.Id)>-1){this.getSelectionModel().select(i,true,true);}}return Ext.String.htmlEncode(h);},menuDisabled:true,}],},});this.callParent([c]);},});};})();(function(){var a=SVMX.Package("com.servicemax.client.spareparts.ui.desktop.downloadrule");a.init=function(){var b=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("SPAREPARTS");Ext.define("com.servicemax.client.spareparts.ui.desktop.downloadrule.DownloadrulePanel",{extend:"Ext.form.FormPanel",id:"downloadrule",constructor:function(c){c=Ext.apply({title:b.T("TAG024","Download Criteria")},c||{});this.callParent([c]);},initComponent:function(){this.callParent(arguments);var c=this;this.__downloadCriteriaGrid=SVMX.create("com.servicemax.client.spareparts.ui.desktop.downloadRule.CriteriaGrid",{});c.add(this.__downloadCriteriaGrid);},loadData:function(d,c,h){Ext.getCmp("addRowButton").setDisabled(false);var f=Ext.getStore("productStockStatus");f.loadData(d);var e=Ext.getStore("quantityFields");e.loadData(c);var g=Ext.getStore("downloadCriteria_store");if(h==null||h==""){h=[];}g.loadData(h);if(d.length!=h.length){Ext.getCmp("addRowButton").setDisabled(false);}}});Ext.define("com.servicemax.client.spareparts.ui.desktop.downloadRule.CriteriaGrid",{extend:"com.servicemax.client.ui.components.composites.impl.SVMXListComposite",xtype:"cell-editing",frame:true,viewConfig:{markDirty:false},initComponent:function(){this.cellEditing=new Ext.grid.plugin.CellEditing({clicksToEdit:1,listeners:{beforeedit:function(f,i){var j=Ext.getStore("productStockStatus");j.clearFilter();if(i.colIdx==1){j.data.items.forEach(function(l,k){l.data.isUsed=false;});var h=i.rowIdx;var g=Ext.getCmp("sparePartsGrid").getStore().data.items;g.forEach(function(m,l){if(l!=h){var k=j.findExact("Id",m.data.productstockstatus);if(k!=-1){j.getAt(k).data.isUsed=true;}}});}},}});var e=SVMX.create("Ext.data.Store",{fields:[{name:"Id"},{name:"name"},{name:"isUsed"}],id:"productStockStatus",proxy:{type:"memory"}});this.productStockCombo=new Ext.form.field.ComboBox({typeAhead:true,triggerAction:"all",displayField:"name",valueField:"Id",queryMode:"local",typeAhead:true,editable:false,triggerAction:"all",selectOnTab:true,store:e,listConfig:{getInnerTpl:function(f){return"{[Ext.String.htmlEncode(values."+f+")]}";}},listeners:{expand:function(f){f.store.filter("isUsed",false);}}});var c=SVMX.create("Ext.data.Store",{fields:[{name:"Id"},{name:"name"}],id:"quantityFields",proxy:{type:"memory"}});this.quantityFieldCombo=new Ext.form.field.ComboBox({typeAhead:false,triggerAction:"all",displayField:"name",valueField:"Id",queryMode:"local",editable:false,triggerAction:"all",selectOnTab:true,store:c,listConfig:{getInnerTpl:function(f){return"{[Ext.String.htmlEncode(values."+f+")]}";}}});var d=SVMX.create("Ext.data.Store",{fields:[{name:"Id"},{name:"name"}],id:"serializedStore",proxy:{type:"memory"},data:[{Id:true,name:b.T("TAG025","Yes")},{Id:false,name:b.T("TAG026","No")}]});
this.serializedCombo=new Ext.form.field.ComboBox({typeAhead:true,triggerAction:"all",displayField:"name",valueField:"Id",queryMode:"local",typeAhead:false,editable:false,triggerAction:"all",selectOnTab:true,store:d,listConfig:{getInnerTpl:function(f){return"{[Ext.String.htmlEncode(values."+f+")]}";}}});this.picklistRenderer=function(f){return function(h){var g=f.store.find(f.valueField,h);var i=f.store.getAt(g);return((i===null||i===undefined)?"":Ext.String.htmlEncode(i.get(f.displayField)));};};Ext.apply(this,{width:"60%",autoScroll:true,margin:"5",plugins:[this.cellEditing],id:"sparePartsGrid",cls:"spareparts-download-criteria",store:new Ext.data.Store({storeId:"downloadCriteria_store",fields:["productstockstatus","quantityfield","includeserializedstock",],}),columns:[{xtype:"actioncolumn",width:40,height:40,align:"center",sortable:false,menuDisabled:true,items:[{tooltip:b.T("TAG027","Delete"),scope:this,iconCls:"spareparts-delete-row-icon",cls:"spareparts-delete-row-icon",handler:this.onRemoveClick}]},{flex:1,text:b.T("TAG028","Product Stock Status"),dataIndex:"productstockstatus",align:"left",resizable:true,readOnly:true,editor:this.productStockCombo,renderer:this.picklistRenderer(this.productStockCombo)},{flex:1,text:b.T("TAG029","Quantity"),dataIndex:"quantityfield",align:"left",resizable:true,readOnly:true,editor:this.quantityFieldCombo,renderer:this.picklistRenderer(this.quantityFieldCombo)},{flex:1,text:b.T("TAG030","Include Serialized Stocks"),dataIndex:"includeserializedstock",align:"left",resizable:true,readOnly:true,editor:this.serializedCombo,renderer:this.picklistRenderer(this.serializedCombo)},],selModel:{selType:"cellmodel"},bbar:[{text:"+ "+b.T("TAG031","Add Row"),id:"addRowButton",scope:this,disabled:true,handler:this.onAddClick,cls:"spareparts-blue-link"}]});this.callParent();},onAddClick:function(f){var k=this.getStore().getCount();var g=Ext.getCmp("sparePartsGrid");var i=this.getStore().getAt(k-1);if(i!=null&&i!=""){if(i.data.productstockstatus==""){var c=g.getNode(k-1).childNodes[1].getAttribute("class");g.getNode(k-1).childNodes[1].setAttribute("class",c+" make-cell-dirty-lt");g.getNode(k-1).childNodes[1].setAttribute("data-qtip",b.T("TAG032","This is a required field."));}else{var e=Ext.getStore("productStockStatus");e.clearFilter();var h=e.getCount();if(k<h){var d={productstockstatus:"",quantityfield:"",includeserializedstock:false};this.getStore().insert(k,d);if(k==h-1){f.setDisabled(true);}}}}else{var j={productstockstatus:"",quantityfield:"",includeserializedstock:false};this.getStore().insert(k,j);}},onRemoveClick:function(d,g,e,f){var c=this.getStore();c.removeAt(g);Ext.getCmp("addRowButton").setDisabled(false);}});};})();(function(){var a=SVMX.Package("com.servicemax.client.spareparts.ui.desktop.impl");a.Class("Module",com.servicemax.client.lib.api.ModuleActivator,{__constructor:function(){this.__base();},beforeInitialize:function(){},initialize:function(){com.servicemax.client.spareparts.ui.desktop.api.init();com.servicemax.client.spareparts.ui.desktop.downloadrule.init();}},{instance:null});})();