(function(){var a=SVMX.Package("com.servicemax.client.iot.admin.othersettings");a.init=function(){Ext.define("com.servicemax.client.iot.admin.eventsGrid",{extend:"com.servicemax.client.installigence.ui.components.SVMXGrid",metadata:null,deletedIds:null,constructor:function(b){var c=this;this.deletedIds=[];b.columns=[];b.columns.push(this.createTextBoxColumn({text:$TR.EVENT_NAME,dataIndex:"eventName",width:400,flex:1}));b.columns.push(this.createTextBoxColumn({text:$TR.CLASS_NAME,dataIndex:"className",width:400,flex:1}));b.columns.push({menuDisabled:true,sortable:true,xtype:"actioncolumn",width:50,items:[{iconCls:"delet-icon",tooltip:$TR.DELETE}],handler:function(e,i,d){var g=e.getStore();var h=g.getAt(i);var f=h.data.eventId;if(f){c.deletedIds.push(f);}g.remove(h);},renderer:function(f,e,d){b.columns[b.columns.length-1].items[0].iconCls="delet-icon";}});this.metadata=b.metadata;this.callParent([b]);this.loadData();},getDeletedEvents:function(){return this.deletedIds;},loadData:function(){var b=this;b.store.loadData(b.filterMapToObjectEvents());b.store.commitChanges();},filterMapToObjectEvents:function(){var b=this.metadata.events.filter(function(c){return c.className!=="COMM_IoTRestApiEngine";});return b;},createTextBoxColumn:function(b){var d=this;var c=SVMX.create("com.servicemax.client.installigence.ui.components.SVMXTextField",{allowBlank:true,editable:true,maskRe:/[^ ]/});var b=b||{};b.sortable=true;b.editable=true;b.getEditor=function(e){return c;};return b;}});Ext.define("com.servicemax.client.iot.admin.OtherSettings",{extend:"com.servicemax.client.installigence.ui.components.SVMXPanel",eventsGrid:null,constructor:function(d){var f=this;this.refresh();var e=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXStore",{fields:["eventId","eventName","className"],data:[]});this.eventsGrid=SVMX.create("com.servicemax.client.iot.admin.eventsGrid",{cls:"grid-panel-borderless panel-radiusless iot-setup-ta-grid",selType:"cellmodel",plugins:[SVMX.create("com.servicemax.client.installigence.ui.components.SVMXCellEditorPlugin",{clicksToEdit:2})],viewConfig:{markDirty:false},sortable:true,store:e,metadata:d.metadata});var c=SVMX.create("com.servicemax.client.installigence.ui.components.SVMXFormPanel",{style:"margin: 1px 0",layout:"fit",cls:"grid-panel-borderless",defaults:{anchor:"40%"}});c.add(this.eventsGrid);var g=SVMX.create("com.servicemax.client.installigence.ui.components.SVMXToolbar",{style:"border-width: 0"});var b=SVMX.create("com.servicemax.client.installigence.ui.components.SVMXButton",{text:$TR.ADD,cls:"iot-setup-add-button",handler:function(){f.onAddRecords();}});g.add("->");g.add(b);d=d||{};d.items=[];d.items.push(g);d.items.push(c);d.title=$TR.MAP_TO_APEX;d.id="OS";this.callParent([d]);},onAddRecords:function(c){this.eventsGrid.addItems({});this.eventsGrid.getView().refresh();var d=this.eventsGrid.store.data.items.length-1;var b=this.eventsGrid.getView();Ext.get(b.getRow(d)).scrollIntoView(b.getEl(),null,true);b.select(d);},getData:function(){var e=this.eventsGrid.getStore();e=e.getModifiedRecords();var c=[];var d=0,b=e.length;for(d=0;d<b;d++){delete e[d].data.id;if(!$.isEmptyObject(e[d].data)){c.push(e[d].data);}}return{data:c,deletedEvents:this.eventsGrid.getDeletedEvents()};},refresh:function(){var b=this;SVMX.getClient().bind("SAVE_SUCCESS",function(c){b.eventsGrid.metadata=c.data;var d=metadata.sforceObjectDescribes;for(var e=0;e<d.length;e++){b.eventsGrid.metadata[d[e].objectAPIName]=d[e];}b.eventsGrid.loadData();},this);},getAllEventName:function(){var e=[];var d=this;var c=d.eventsGrid.getStore().data.items;for(var b=0;b<c.length;b++){if(c[b].data.eventName){e.push(c[b].data.eventName);}}return e;},createTextField:function(b){return SVMX.create("com.servicemax.client.installigence.ui.components.SVMXTextField",{allowBlank:true,editable:true,margin:"5, 5",labelAlign:"right",fieldLabel:b,labelWidth:200,width:550,listeners:{change:function(d,c){}}});}});};})();