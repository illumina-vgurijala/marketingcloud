(function(){var a=SVMX.Package("com.servicemax.client.installigence.admin.objectsearch");a.init=function(){a.Class("ObjectSearch",com.servicemax.client.lib.api.Object,{__d:null,__inited:false,__config:null,__objectInfo:null,__store:null,__grid:null,__win:null,__constructor:function(b){this.__inited=false;this.__config=b;},find:function(){this.__d=$.Deferred();this.__showUI();return this.__d;},__init:function(){},__initComplete:function(){this.__inited=true;this.__showUI();},__find:function(c){SVMX.getCurrentApplication().blockUI();var b=SVMX.create("com.servicemax.client.lib.api.Event","INSTALLIGENCEADMIN."+this.__config.mvcEvent,this,{request:{context:this,handler:this.__findComplete,text:c.text}});SVMX.getCurrentApplication().getEventBus().triggerEvent(b);},__findComplete:function(b){this.__store.loadData(b);SVMX.getCurrentApplication().unblockUI();},__showUI:function(){this.__win=this.__getUI();this.__win.show(this.__config.sourceComponent);this.__find({});},__tryResolve:function(){var e=this.__grid.getSelectionModel().getSelection();if(e.length==0){return;}var d=[],c,b=e.length;for(c=0;c<b;c++){d.push(e[c].data);}this.__d.resolve(d);this.__win.close();},__getUI:function(){var p=this.__config.columns,g,e=p.length,o=this;var m=this.__config.objectDescribe,q=this.__config.objectDescribe.fields;var h=[];for(g=0;g<e;g++){h.push(p[g].name);}var r=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXStore",{fields:h,data:[]});var d=[],n,f;for(g=0;g<e;g++){n=p[g];for(f=0;f<q.length;f++){if(q[f].fieldAPIName===n.name){d.push({text:q[f].fieldLabel,dataIndex:n.name,flex:1});}}}var b=SVMX.create("com.servicemax.client.installigence.ui.components.SVMXGrid",{store:r,selModel:{selType:"checkboxmodel",checkOnly:true,mode:"SINGLE"},columns:d,flex:1,width:"100%"});var s=SVMX.create("com.servicemax.client.installigence.ui.components.SVMXTextField",{width:"70%",emptyText:$TR.SEARCH_EMPTY_TEXT,enableKeyEvents:true,listeners:{keyup:function(i,j,c){if(j.getKey()==j.ENTER){o.__find({text:s.getValue()});}}}});var k=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXWindow",{layout:{type:"vbox"},height:400,width:700,title:m.objectLabel,dockedItems:[{dock:"top",xtype:"toolbar",margin:"0",items:[s,{xtype:"button",text:"Go",handler:function(){o.__find({text:s.getValue()});}}]}],maximizable:true,items:[b],modal:true,buttons:[{text:$TR.CREATE,handler:function(){o.__tryResolve();}},{text:$TR.CANCEL,handler:function(){k.close();}}]});this.__store=r;this.__grid=b;return k;}},{});};})();