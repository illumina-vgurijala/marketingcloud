(function(){var a=SVMX.Package("com.servicemax.client.sfwdelivery.commands");a.init=function(){a.Class("GetWizardInfo",com.servicemax.client.mvc.api.Command,{__constructor:function(){this.__base();},executeAsync:function(c,b){this._executeOperationAsync(c,b,{operationId:"SFWDELIVERY.GET_WIZARD_INFO"});}},{});};})();(function(){var a=SVMX.Package("com.servicemax.client.sfwdelivery.engine");a.init=function(){var b=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("SFWDELIVERY");a.Class("DeliveryEngineImpl",com.servicemax.client.sfmconsole.api.AbstractDeliveryEngine,{__logger:null,__root:null,__eventBus:null,__dataModel:null,__loadMask:null,__translation:null,__view:null,__getRecord:null,__constructor:function(){this.__base();this.__logger=SVMX.getLoggingService().getLogger("SFW-ENGINE-IMPL");},initAsync:function(c){if(c.getRecord){this.__getRecord=SVMX.proxy(c.context,c.getRecord);}var d=SVMX.getClient().getServiceRegistry().getService("com.servicemax.client.niservice").getInstance();d.createNamedInstanceAsync("CONTROLLER",{handler:function(e){d.createNamedInstanceAsync("MODEL",{handler:function(f){e.setModel(f);d.createNamedInstanceAsync("SFWDELIVERY.VIEW",{handler:function(g){this.__view=g;c.handler.call(c.context);},context:this,additionalParams:{eventBus:this.getEventBus()}});},context:this});},context:this,additionalParams:{eventBus:this.getEventBus()}});},getEventBus:function(){if(!this.__eventBus){this.__eventBus=SVMX.create("com.servicemax.client.sfwdelivery.impl.SFWDeliveryEngineEventBus",{});}return this.__eventBus;},getDataModel:function(){if(!this.__dataModel){this.__dataModel=SVMX.create("com.servicemax.client.sfwdelivery.engine.WizardInfoModel",this);}return this.__dataModel;},getRoot:function(){return this.__root;},run:function(c){this.__logger.debug("Wizard is running!!!");this.options=c||{};this.__root=this.__view.createComponent("ROOTCONTAINER",{deliveryEngine:this,dataModel:this.getDataModel(),msgInit:this.options.msgInit,msgEmpty:this.options.msgEmpty});if(this.options.onReady==null){this.__root.render(SVMX.getDisplayRootId());this.options.recordId=SVMX.getUrlParameter("RecordId");if(!SVMX.getClient().getApplicationParameter("svmx-sfm-no-window-resize")){SVMX.onWindowResize(function(){var d={width:Ext.getBody().getViewSize().width,height:Ext.getBody().getViewSize().height};this.onResize(d);},this);}}if(this.options.recordId){this.update(this.options.recordId);}else{if(this.options.onReady){this.options.onReady.handler.call(this.options.onReady.context||this);}}},translate:function(d){var c=this.__translation[d];if(c===undefined){c=d;}return c;},reload:function(){this.update(this.options.recordId,this.options.objectName);},update:function(d,f){if(!d){return;}this.options.recordId=d;this.options.objectName=f;var e=SVMX.getClient().getServiceRegistry().getService("com.servicemax.client.sfw.platformspecifics").getInstance().getSupportedActionTypes();var c=SVMX.create("com.servicemax.client.lib.api.Event","SFWDELIVERY.GET_WIZARD_INFO",this,{request:{RecordId:d,Record:this.__getRecord?this.__getRecord():null,objectName:f,ActionTypes:e},responder:SVMX.create("com.servicemax.client.sfwdelivery.responders.GetWizardInfoResponder",this)});if(this.getRoot()){this.getRoot().setSpinnerMsg();}this.getEventBus().triggerEvent(c);},clearContent:function(){var c=this.getRoot();if(c){c.clearMessagePanel();}},onGetWizardInfoCompleted:function(d){this.getDataModel().processData(d);if(this.getRoot()){this.getRoot().run();if(d.SFWs.length){this.getRoot().clearMessagePanel();}}if(this.options.onReady){this.options.onReady.handler.call(this.options.onReady.context||this);}var c=SVMX.create("com.servicemax.client.lib.api.Event","DATA_LOADED",this,this.getDataModel());this.getEventBus().triggerEvent(c);},onGetWizardInfoFailed:function(c){this.getRoot().setEmptyMsg();},onResize:function(c){if(this.getRoot()){this.getRoot().resize(c);}}},{});a.Class("WizardInfoModel",com.servicemax.client.lib.api.Object,{__wizardModels:null,record:null,recordId:null,__deliveryEngine:null,availableActions:null,__constructor:function(c){this.__deliveryEngine=c;},processData:function(d){this.recordId=d.RecordId;this.record=d.Record;this.availableActions=d.availableActions||[];this.__wizardModels=[];for(var c=0;c<d.SFWs.length;c++){this.__wizardModels[c]=SVMX.create("com.servicemax.client.sfwdelivery.engine.SFWDetailModel",this,d.SFWs[c]);}},getWizards:function(){return this.__wizardModels;},getDeliveryEngine:function(){return this.__deliveryEngine;}},{});a.Class("SFWDetailModel",com.servicemax.client.lib.api.Object,{__parent:null,__data:null,__actionModels:[],__constructor:function(e,f){this.__parent=e;this.__data=f;if(this.__data.SFWDef[SVMX.OrgNamespace+"__Name__c"]){this.__data.SFWDef[SVMX.OrgNamespace+"__Name__c"]=Ext.String.htmlEncode(this.__data.SFWDef[SVMX.OrgNamespace+"__Name__c"]);}var c=[];for(var d=0;d<f.actions.length;d++){c[d]=SVMX.create("com.servicemax.client.sfwdelivery.engine.SFWActionModel",this,f.actions[d]);
}this.__actionModels=c;},getId:function(){return this.__data.SFWDef.Id;},getName:function(){return this.__data.SFWDef[SVMX.OrgNamespace+"__Name__c"];},getActions:function(){return this.__actionModels;},getRoot:function(){return this.__parent;}},{});a.Class("SFWActionModel",com.servicemax.client.lib.api.Object,{__parent:null,__data:null,enabled:true,actionType:null,enableConfirmationDialog:false,modeOfExecution:null,handOver:false,confirmationMessage:null,__constructor:function(c,d){this.__parent=c;this.__data=d;if(d.Enabled===false){this.enabled=false;}else{this.enabled=true;}if(this.__data.actionDef[SVMX.OrgNamespace+"__Name__c"]){this.__data.actionDef[SVMX.OrgNamespace+"__Name__c"]=Ext.String.htmlEncode(this.__data.actionDef[SVMX.OrgNamespace+"__Name__c"]);}if(this.__data.actionDef[SVMX.OrgNamespace+"__Description__c"]){this.__data.actionDef[SVMX.OrgNamespace+"__Description__c"]=Ext.String.htmlEncode(this.__data.actionDef[SVMX.OrgNamespace+"__Description__c"]);}if(this.__data.actionDef[SVMX.OrgNamespace+"__Confirmation_Message__c"]){this.__data.actionDef[SVMX.OrgNamespace+"__Confirmation_Message__c"]=Ext.String.htmlEncode(this.__data.actionDef[SVMX.OrgNamespace+"__Confirmation_Message__c"]);}this.actionType=d.actionDef[SVMX.OrgNamespace+"__Action_Type__c"];this.customActionType=d.actionDef[SVMX.OrgNamespace+"__Custom_Action_Type__c"];this.enableConfirmationDialog=d.actionDef[SVMX.OrgNamespace+"__Enable_Confirmation_Dialog__c"];this.modeOfExecution=d.actionDef[SVMX.OrgNamespace+"__Mode_Of_Execution__c"];this.handOver=d.actionDef[SVMX.OrgNamespace+"__Handover__c"];this.confirmationMessage=d.actionDef[SVMX.OrgNamespace+"__Confirmation_Message__c"];},getId:function(){return this.__data.actionDef.Id;},getName:function(){return this.__data.actionDef[SVMX.OrgNamespace+"__Name__c"];},getData:function(){return this.__data;},getRoot:function(){return this.__parent.getRoot();}},{});};})();(function(){var a=SVMX.Package("com.servicemax.client.sfwdelivery.impl");a.Class("Module",com.servicemax.client.lib.api.ModuleActivator,{__constructor:function(){this.__base();this._logger=SVMX.getLoggingService().getLogger("SFW-IMPL");},beforeInitialize:function(){com.servicemax.client.sfwdelivery.engine.init();com.servicemax.client.sfwdelivery.commands.init();com.servicemax.client.sfwdelivery.responders.init();},initialize:function(){},afterInitialize:function(){}});a.Class("SFWDeliveryEngineEventBus",com.servicemax.client.lib.api.EventDispatcher,{__constructor:function(){this.__base();},triggerEvent:function(b){SVMX.getLoggingService().getLogger("SFWDeliveryEngineEventBus").info("Trigger event : "+b.type);return this.__base(b);}},{});})();(function(){var a=SVMX.Package("com.servicemax.client.sfwdelivery.responders");a.init=function(){a.Class("GetWizardInfoResponder",com.servicemax.client.mvc.api.Responder,{__parent:null,__constructor:function(b){this.__base();this.__parent=b;},result:function(b){this.__parent.onGetWizardInfoCompleted(b);},fault:function(b){this.__parent.onGetWizardInfoFailed(b);}},{});};})();(function(){var a=SVMX.Package("com.servicemax.client.sfwdelivery.wizarddata");a.init=function(){SVMX.define("com.servicemax.client.sfwdelivery.wizarddata.SFWData",{extend:"com.servicemax.client.lib.api.Object",alias:"widget.sfw.data",constructor:function(b){this.callParent([b]);},initComponent:function(){}});};})();