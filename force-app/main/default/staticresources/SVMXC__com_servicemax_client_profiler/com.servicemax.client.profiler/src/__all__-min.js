(function(){var a=SVMX.Package("com.servicemax.client.profiler.api");a.init=function(){var d=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation");var c=SVMX.getProfilingService();var b=function(D,B){var h=[];if(B.length>0){for(var p in B[0]){h.push(p);}}var v=[];var r=[];var m=0;var g="";var w="";var n=0;var q=h.length;var t=100;for(var z=0;z<q;z++){m+=t;g+='<Column ss:AutoFitWidth="1" />';w+='<Cell ss:StyleID="headercell"><Data ss:Type="String">'+h[z]+'</Data><NamedCell ss:Name="Print_Titles"></NamedCell></Cell>';v.push("String");r.push("");}var A=v.length-n;var o={height:9000,width:Math.floor(m*30)+50};var y=B.length+2;var l="".concat('<Worksheet ss:Name="'+D+'">',"<Names>",'<NamedRange ss:Name="Print_Titles" ss:RefersTo="=\''+D+"'!R1:R2\">","</NamedRange></Names>",'<Table ss:ExpandedColumnCount="'+(A+2),'" ss:ExpandedRowCount="'+y+'" x:FullColumns="1" x:FullRows="1" ss:DefaultColumnWidth="100" ss:DefaultRowHeight="15">',g,'<Row ss:Height="38">','<Cell ss:MergeAcross="'+(A-1)+'" ss:StyleID="title">','<Data ss:Type="String" xmlns:html="http://www.w3.org/TR/REC-html40">',"<html:b>"+D+'</html:b></Data><NamedCell ss:Name="Print_Titles">',"</NamedCell></Cell>","</Row>",'<Row ss:AutoFitHeight="1">',w+"</Row>");var f=null;for(var z=0;z<B.length;z++){l+="<Row>";var s=(z&1)?"odd":"even";f=B[z];var u=0;for(var x=0;x<h.length;x++){var C=f[h[x]];if(v[u]!=="None"){l+='<Cell ss:StyleID="'+s+r[u]+'"><Data ss:Type="'+v[u]+'">';l+=C;l+="</Data></Cell>";}u++;}l+="</Row>";}o.xml=l.concat("</Table>",'<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">',"<PageLayoutZoom>0</PageLayoutZoom>","<Selected/>","<Panes>","<Pane>","<Number>3</Number>","<ActiveRow>2</ActiveRow>","</Pane>","</Panes>","<ProtectObjects>False</ProtectObjects>","<ProtectScenarios>False</ProtectScenarios>","</WorksheetOptions>","</Worksheet>");return o;};var e=function(f,k){var l=[];var o=f||"Profiler Data";var i=500;var m;var h;for(var n in k){var g=k[n];var j=b(n,g);m=m||j.width;h=m||j.height;l.push(j.xml);}return"".concat('<?xml version="1.0"?>','<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:html="http://www.w3.org/TR/REC-html40">','<DocumentProperties xmlns="urn:schemas-microsoft-com:office:office"><Title>'+o+"</Title></DocumentProperties>",'<OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office"><AllowPNG/></OfficeDocumentSettings>','<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">',"<WindowHeight>"+h+"</WindowHeight>","<WindowWidth>"+m+"</WindowWidth>","<ProtectStructure>False</ProtectStructure>","<ProtectWindows>False</ProtectWindows>","</ExcelWorkbook>","<Styles>",'<Style ss:ID="Default" ss:Name="Normal">','<Alignment ss:Vertical="Bottom"/>',"<Borders/>",'<Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="12" ss:Color="#000000"/>',"<Interior/>","<NumberFormat/>","<Protection/>","</Style>",'<Style ss:ID="title">',"<Borders />",'<Font ss:Bold="1" ss:Size="18" />','<Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1" />','<NumberFormat ss:Format="@" />',"</Style>",'<Style ss:ID="headercell">','<Font ss:Bold="1" ss:Size="10" />','<Alignment ss:Horizontal="Center" ss:WrapText="1" />','<Interior ss:Color="#A3C9F1" ss:Pattern="Solid" />',"</Style>",'<Style ss:ID="even">','<Interior ss:Color="#FFFFFF" ss:Pattern="Solid" />',"</Style>",'<Style ss:ID="evendate" ss:Parent="even">','<NumberFormat ss:Format="yyyy-mm-dd" />',"</Style>",'<Style ss:ID="evenint" ss:Parent="even">','<Numberformat ss:Format="0" />',"</Style>",'<Style ss:ID="evenfloat" ss:Parent="even">','<Numberformat ss:Format="0.00" />',"</Style>",'<Style ss:ID="odd">','<Interior ss:Color="#CCFFFF" ss:Pattern="Solid" />',"</Style>",'<Style ss:ID="groupSeparator">','<Interior ss:Color="#D3D3D3" ss:Pattern="Solid" />',"</Style>",'<Style ss:ID="odddate" ss:Parent="odd">','<NumberFormat ss:Format="yyyy-mm-dd" />',"</Style>",'<Style ss:ID="oddint" ss:Parent="odd">','<NumberFormat Format="0" />',"</Style>",'<Style ss:ID="oddfloat" ss:Parent="odd">','<NumberFormat Format="0.00" />',"</Style>","</Styles>",l.join(""),"</Workbook>");};a.Class("ProfilerConsole",com.servicemax.client.lib.api.Object,{__data:null,__stores:null,__fields:null,__gridconfig:null,__constructor:function(){if(!!a.ProfilerConsole.__instance){return a.ProfilerConsole.__instance;}a.ProfilerConsole.__instance=this;this.__data={};this.__stores={};this.__fields={};this.__mainpanel=null;this.__gridconfig={PerformanceResourceTiming:{name:{order:1,flex:1,width:300},entryType:{hidden:true},duration:{xtype:"numbercolumn",format:"0.00",width:150},initiatorType:{hidden:false},startTime:{order:2,xtype:"numbercolumn",format:"0.00",width:150},endTime:{order:3,xtype:"numbercolumn",format:"0.00",width:150}},PerformanceMeasure:{name:{order:1,flex:1,width:300},entryType:{hidden:true},duration:{xtype:"numbercolumn",format:"0.00",width:150},startTime:{order:2,xtype:"numbercolumn",format:"0.00",width:150}},PerformanceEntry:{name:{order:1,flex:1,width:300},entryType:{hidden:true},duration:{xtype:"numbercolumn",format:"0.00",width:150},startTime:{order:2,xtype:"numbercolumn",format:"0.00",width:150}}};
this.__init();},__processClientPerformanceData:function(){var n=c.getEntryTypes();for(var m=0;m<n.length;m++){var j=n[m].name;var o=c.getEntriesByType(n[m].entry);switch(j){case"PerformanceMeasure":case"PerformanceEntry":var f=c.getMeasureEntryTypes();var l="";var h=null;for(var g=0;g<f.length;g++){l=f[g].action+"_"+f[g].type;h=c.getMeasureDataByText(l);this.__createDataStore(h,l);this.__data[l]=this.__filterMeasurementDataName(h);}break;case"Object":j="PerformanceServer";break;default:}this.__createDataStore(o,j);this.__data[j]=o;}return this;},__processRawData:function(){this.__processClientPerformanceData();return this;},__copyEntryObject:function(g){var h={};for(var f in g){h[f]=g[f];}return h;},__filterMeasurementDataName:function(l){var h=[];var f="";var k=null;var j=null;for(var g=0;g<l.length;g++){j=this.__copyEntryObject(l[g]);f=l[g].name;k=f.split("_");k.shift();k.shift();j.name=k.join("_");h.push(j);}return h;},__updateDataStore:function(h,f){f=f||false;var g=this.__stores[h];var i=this.__data[h];g.loadRawData(i,f);return this;},__getFieldList:function(g,h){var i=[];var j=null;var k=h||[];for(var f in g){if(this.__isIncluded(f,k)){i.push({name:f});}}return i;},__isIncluded:function(h,g){for(var f=0;f<g.length;f++){if(h==g[f]){return false;}}return true;},__capFirstCharacter:function(f){return f.charAt(0).toUpperCase()+f.slice(1);},__getGridColumns:function(g,f){var k=[];var h="";var l=null;var j=0;var m=this.__gridconfig[g]||{};for(;j<f.length;j++){h=f[j].name;l=m[h]||{hidden:true};k.push(Ext.apply({dataIndex:h,text:this.__capFirstCharacter(h)},l));}k.sort(function(o,n){var p=o.order||100;var i=n.order||100;return p>i;});return k;},__createDataStore:function(j,i){if(j.length==0){return false;}if(!!this.__stores[i]){return false;}var h=["rawdata"];var f=this.__getFieldList(j[0],h);var g=Ext.create("Ext.data.Store",{fields:f,proxy:{type:"memory",reader:{type:"json",root:"items"}},listeners:{load:function(){}}});this.__stores[i]=g;this.__fields[i]=f;},__init:function(){c.bind("REFRESH_CONTENT",this.__onUpdateUI,this);},__onUpdateUI:function(g){var f=a.ProfilerConsole.__instance;f.__processRawData();if(!!f.__mainpanel){var h=this.__createTabs();f.__mainpanel.removeAll();f.__mainpanel.add(h);}},__createTabPanel:function(f){var g=this;var h={cls:"svmx-profiler-ui-container",minHeight:50,resizeHandles:"s",collapsible:true,collapsed:true,resizable:true,baseCls:"x-panel",title:"ServiceMax Profiler",renderTo:Ext.getBody(),tools:[{type:"refresh",tooltip:"Reload Page",hidden:true,handler:function(k,j,i){}}],bbar:["->",{xtype:"button",text:"Download Report",baseCls:"x-panel",listeners:{click:function(){g.__exportData();}}}],listeners:{boxready:function(i){var k=i.tools;var j=k[0];k.shift();var l=$("#"+f.id).parent();$("#client_display_root").before(l);this.doLayout();},expand:function(i){if(!i.activeTab){i.setActiveTab(0);}}}};f=Ext.apply(h,f);return Ext.create("Ext.tab.Panel",h);},__exportData:function(){var j=this.__data;var h=new Date();var g="Profiler Data "+h.getTime();var i=e(g,j);var f=new Blob([i],{type:"application/vnd.ms-excel;charset=utf-8"});saveAs(f,g+".xls");},__createGrid:function(h,g,l){var j=this;var m=l||g;var k=this.__stores[g];var f=this.__fields[g];var i=this.__getGridColumns(m,f);return Ext.create("Ext.grid.Panel",{itemId:"grid-"+g,title:g,header:false,baseCls:"x-panel",store:k,columns:i,listeners:{boxReady:function(n){n.ownerCt.doLayout();}}});},__assembleTabPanel:function(f,i){var h=this;var g=this.__createGrid({},f,i);return{itemId:"panel-data-"+f,title:f,closable:false,height:200,autoScroll:true,items:[g],baseCls:"x-panel",listeners:{boxReady:function(j){},activate:function(j){h.__updateDataStore(f);}}};},__createTabs:function(){var g=[];var k=this.__data;var m=null;var j=null;var f=null;var l={};var h={};for(m in k){if(m=="PerformanceResourceTiming"){j=this.__assembleTabPanel(m);l[m]=this.__stores[m].sum("duration");h[m]=this.__data[m].length;g.push(j);}else{var o={PerformanceMeasure:true,PerformanceEntry:true};if(!o[m]){var n="PerformanceMeasure";j=this.__assembleTabPanel(m,n);g.push(j);}}}var i="<br>  Duration: "+(performance.timing.loadEventEnd-performance.timing.navigationStart)+"<br>    Unload: "+(performance.timing.unloadEventEnd-performance.timing.unloadEventStart)+"<br>  Redirect: "+(performance.timing.redirectEnd-performance.timing.redirectStart)+"<br> App Cache: "+(performance.timing.domainLookupStart-performance.timing.fetchStart)+"<br>       DNS: "+(performance.timing.domainLookupEnd-performance.timing.domainLookupStart)+"<br>       TCP: "+(performance.timing.connectEnd-performance.timing.connectStart)+"<br>   Request: "+(performance.timing.responseStart-performance.timing.requestStart)+"<br>  Response: "+(performance.timing.responseEnd-performance.timing.responseStart)+"<br>Processing: "+(performance.timing.loadEventStart-performance.timing.responseEnd)+"<br>    Onload: "+(performance.timing.loadEventEnd-performance.timing.loadEventStart)+"<br>";j={itemId:"panel-data-summary",title:"Page Summary",closable:false,height:200,autoScroll:true,html:i,baseCls:"x-panel",listeners:{boxReady:function(p){},activate:function(p){}}};
g.splice(0,0,j);return g;},init:function(f,h){if($("#client_display_root").children().length>0){var g=this;setTimeout(function(){g.__processRawData();g.__mainpanel=g.__createTabPanel(f);var j=g.__mainpanel;var i=g.__createTabs();j.add(i);},250);}else{var g=this;if(this.timer){clearTimeout(this.timer);}this.timer=setTimeout(function(){g.init(f,h);},250);}}},{__instance:null,getInstance:function(){var f=null;if(a.ProfilerConsole.__instance==null){f=new a.ProfilerConsole();}else{f=a.ProfilerConsole.__instance;}return f;}});};})();(function(b){var a=SVMX.Package("com.servicemax.client.profiler.impl");a.Class("Module",com.servicemax.client.lib.api.ModuleActivator,{__constructor:function(){this.__base();this.__profiler=SVMX.getProfilingService();SVMX.getClient().bind("READY",this.__onClientReady,this);b("#client_display_root").ready(function(){console.log("ready");});},__onClientReady:function(){this.__init();},__init:function(){SVMX.getClient().unbind("READY",this.__onClientReady,this);var d=SVMX.create("com.servicemax.client.profiler.api.ProfilerConsole");var c={id:"profiler_panel",baseCls:"x-panel",title:"ServiceMax Profiler Console"};d.init(c);},beforeInitialize:function(){com.servicemax.client.profiler.api.init();},initialize:function(){},afterInitialize:function(){}},{});})(jQuery);