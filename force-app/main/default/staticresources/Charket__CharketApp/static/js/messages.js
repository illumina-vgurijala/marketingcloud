(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"/CaJ":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"notifyTemplateLabel":"模板消息","searchNotifyLabel":"搜索模板消息","lastDateLabel":"最近创建日期","oldestDateLabel":"最早创建日期","deleteNotifyTitleLabel":"删除模板消息","deleteNotifyContentLabel":"你确定要删除这个模板消息吗?","deleteSuccessLabel":"模板消息已删除。","saveSuccessLabel":"模板消息已保存。"},"en":{"notifyTemplateLabel":"Notification Templates","searchNotifyLabel":"Search Notification Templates","lastDateLabel":"Last Created Date","oldestDateLabel":"First Created Date","deleteNotifyTitleLabel":"Delete Notification","deleteNotifyContentLabel":"Are you sure you want to delete this notification?","deleteSuccessLabel":"The notification was deleted.","saveSuccessLabel":"The notification was updated."}}'),delete t.options._Ctor}},"/FlB":function(t,e,s){},"/I/F":function(t,e,s){"use strict";s.d(e,"d",(function(){return a})),s.d(e,"a",(function(){return n})),s.d(e,"b",(function(){return o})),s.d(e,"c",(function(){return r}));var i=s("00Ee");function a(t,e,s){return Object(i.a)({method:"MassMessageRemoteActions.previewByWeChatId",args:[t,e,s]})}function n(t,e){return Object(i.a)({method:"MassMessageRemoteActions.cancelSchedulerMass",args:[t,e]})}function o(t,e){return Object(i.a)({method:"MassMessageRemoteActions.deleteMassMessage",args:[t,e]})}function r(){return Object(i.a)({method:"MassMessageRemoteActions.getMassStatus",args:[]})}},"/afw":function(t,e,s){"use strict";s.r(e);var i=s("wG3i"),a=s.n(i),n=s("+Bun"),o=s.n(n),r=s("vQrK"),l=s.n(r),c=s("692z"),d=s("F5n6"),u=s("ngIk"),h=s("dcdS"),p=s("oWfJ"),m=s("w2Vt"),g=s("autp"),f=s.n(g),v=s("jfyV"),w=s("wA34"),b=s("L2JU"),_=s("cybb"),y={computed:l()({},Object(b.c)({currentAccount:"sidebar/currentAccount",currentUser:"user/currentUser"})),props:{notifications:{type:Array,default:()=>[]}},components:{Popovers:v.a,NotificationDetail:w.a},data:()=>({selectNotify:{},isPopoverShow:!1,popoverDirection:"left-top",notifies:[]}),created(){this.notifies=this.notifications},methods:{formatDatetimeFilter:()=>_.e,showPopover(t,e,s){clearTimeout(this.closePopoverHandle);let i=document.querySelector(".notification-popover"),a=document.querySelector(".notification-popover .slds-popover__body"),n=document.querySelector("#charket-notification-list").parentElement,o=n.scrollTop,r=s.srcElement.offsetWidth;const l=s.srcElement.parentElement.offsetWidth;i.style.left=r>l?l+40+"px":r+40+"px",f()(()=>{let t=n.clientHeight,s=a.clientHeight;t-30*e-23<s&&t>s?(i.style.top=30*e+70-s-o+"px",this.popoverDirection="left-bottom"):(i.style.top=30*e+23-o+"px",this.popoverDirection="left-top")},100),this.selectNotify=t,this.isPopoverShow=!0},closePopover(t){let e=t?0:500;this.closePopoverHandle=f()(()=>{document.querySelector(".notification-popover .slds-popover__body").scrollTop=0,this.isPopoverShow=!1,this.selectNotify={},this.closePopoverHandle=null},e)},enterPopover(){clearTimeout(this.closePopoverHandle)},getMenuItems(t){return[{value:"MassSend",label:this.$t("massSendLabel"),target:t},{value:"Edit",label:this.$t("global.editBtn"),target:t},{value:"CopyID",label:this.$t("global.copyIDLabel"),target:t},{value:"Delete",label:this.$t("global.deleteBtn"),target:t}]},onClickMenuItem(t){const{value:e,target:s}=t;"MassSend"===e?this.$router.push({path:"/".concat(this.currentAccount.Id,"/mass"),query:{notifyId:s.Id}}):"Edit"===e?this.$emit("edit-notify",s):"CopyID"===e?this.$_charket_copyText(s.Id,this.$t("global.copySuccess"),this.$t("global.copyFailed")):"Delete"===e&&this.$emit("delete-notify",s)}}},C=(s("gfwF"),s("KHd+")),S=s("yupr"),T=Object(C.a)(y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{attrs:{id:"charket-notification-list"}},[s("section",{staticClass:"notification-section"},[s("table",{staticClass:"slds-table slds-table_bordered slds-no-row-hover slds-table--header-fixed notification-table",attrs:{role:"grid"}},[s("thead",[s("tr",{staticClass:"slds-line-height_reset"},[s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("titleLabel")}},[t._v(t._s(t.$t("titleLabel")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("keywordLabel")}},[t._v(t._s(t.$t("keywordLabel")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("urlLabel")}},[t._v(t._s(t.$t("urlLabel")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("noteLabel")}},[t._v(t._s(t.$t("noteLabel")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("createdLabel")}},[t._v(t._s(t.$t("createdLabel")))])]),t._v(" "),s("th",{staticStyle:{width:"54px"},attrs:{scope:"col"}})])]),t._v(" "),s("tbody",{staticStyle:{transform:"none"}},t._l(t.notifies,(function(e,i){return s("tr",{staticClass:"slds-hint-parent"},[s("th",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate"},[s("a",{attrs:{href:"/"+e.Id,target:"_blank"},on:{mouseenter:function(s){return t.showPopover(e,i,s)},mouseleave:function(e){return t.closePopover()}}},[t._v(t._s(e.Title))])])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",attrs:{title:e.KeywordNames}},t._l(e.KeywordNames,(function(e){return s("span",{staticClass:"keyword"},[t._v(t._s(e))])})),0)]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[e.NotificationURL?s("div",{staticClass:"slds-truncate",attrs:{title:e.NotificationURL}},[s("a",{attrs:{href:e.NotificationURL,target:"_blank"}},[t._v(t._s(e.NotificationURL))])]):t._e(),t._v(" "),e.MiniProgramPageId?s("div",{staticClass:"slds-truncate",attrs:{title:e.MiniProgramPageName}},[s("icon",{attrs:{name:"miniProIcon",width:"16px",height:"16px","fill-color":"#706e6b","charket-icon":""}}),t._v(" "),s("span",{staticClass:"slds-text-body_regular detail-value"},[t._v(t._s(e.MiniProgramPageName))])],1):t._e()]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",attrs:{title:e.Note}},[t._v(t._s(e.Note))])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate"},[e.CreatedByUser?s("span",{attrs:{title:e.CreatedByUser+", "+t.formatDatetimeFilter()(e.CreatedDate,t.currentUser.TimeZoneSidKey)}},[t._v(t._s(e.CreatedByUser)+", "+t._s(t._f("formatDatetimeFilter")(e.CreatedDate,t.currentUser.TimeZoneSidKey)))]):s("span",{attrs:{title:t.formatDatetimeFilter()(e.CreatedDate,t.currentUser.TimeZoneSidKey)}},[t._v(t._s(t._f("formatDatetimeFilter")(e.CreatedDate,t.currentUser.TimeZoneSidKey)))])])]),t._v(" "),s("td",{staticClass:"td-position",staticStyle:{width:"3.25rem"},attrs:{role:"gridcell"}},[s("ld-action-menu",{attrs:{items:t.getMenuItems(e)},on:{click:function(e){return t.onClickMenuItem(e)}}})],1)])})),0)]),t._v(" "),s("popovers",{staticClass:"notification-popover",attrs:{direction:t.popoverDirection,"position-style":"position: absolute;min-height: 50px; width: 320px;","body-style":"padding: 0;","is-viewed":t.isPopoverShow,"show-modal":!1}},[s("div",{on:{mouseenter:function(e){return t.enterPopover()},mouseleave:function(e){return t.closePopover(!0)}}},[t.isPopoverShow?s("notification-detail",{attrs:{notify:t.selectNotify,"has-border":!1}}):t._e()],1)])],1)])}),[],!1,null,"4bcb593b",null);"function"==typeof S.default&&Object(S.default)(T);var I=T.exports,x=s("fb3H"),L=s("pUDi"),M=s("zUtI"),P=s("4B+h"),N=s("LQ5e"),$=s.n(N),k=s("jkSJ"),D={mixins:[p.a],computed:l()({},Object(b.c)({accessable:"account/notificationTemplate"})),data(){return{tabList:[{name:"NOTIFICATION TEMPLATES",label:this.$t("notifyTemplateLabel")}],accountId:"",notificationMetadata:{notifications:[],count:20,total:0,currentNotificationPagination:[]},hasMoreNotifications:!1,dateOptionData:{options:[{Name:this.$t("lastDateLabel"),value:"Last Created Date"},{Name:this.$t("oldestDateLabel"),value:"Oldest Created Date"}],currentOptions:[{Name:this.$t("lastDateLabel")}]},condition:{OrderBy:"Last Created Date",SearchKey:""},currentPageNumber:1,isInitNotificationLoading:!1,showWechatNotify:!1,showNewNotification:!1,selectedNotify:{},notifyId:"",canSave:!0,selectedMiniProgramPage:{}}},components:{NoRecord:c.a,Pagination:d.a,InputSelect:u.a,Dropdown:h.a,LoadingSpinner:m.a,NotificationList:I,WechatNotification:x.a,NewNotification:L.a},created(){var t;this.accountId=this.$route.params.accountId,this.switchAccount({wechatAccountId:this.accountId,router:this.$router}),o()(t=this.$route.name).call(t,"notification-template")>=0&&("notification-template-select"!==this.$route.name?this.$router.replace({path:"/".concat(this.accountId,"/notifications")}):this.selectWechatNotify()),this.accessable?this.fetchData():this.$router.push({name:"home",params:{accountId:this.$route.params.accountId}})},methods:l()({},Object(b.b)("sidebar",["switchAccount"]),{async fetchData(){this.isInitNotificationLoading=!0;try{const t=await Object(M.e)(this.accountId,this.currentPageNumber,this.notificationMetadata.count,a()(this.condition));if(this.isInitNotificationLoading=!1,t.ok){const e=JSON.parse($.a.unescape(t.data));this.notificationMetadata.notifications=e.templates,this.notificationMetadata.currentNotificationPagination=e.paging.pages,this.notificationMetadata.total=e.paging.total.Count,this.hasMoreNotifications=e.paging.total.HasMore}else Object(P.f)(t)}catch(t){Object(P.f)(t)}},refreshData(){this.fetchData(),this.showNewNotification=!1,this.selectedNotify={},this.$router.replace({path:"/".concat(this.accountId,"/notifications")})},searchNotification(){this.currentPageNumber=1,this.fetchData()},clearSearchKey(){this.condition.SearchKey="",this.currentPageNumber=1,this.fetchData()},selectPicklist(t){this.condition.OrderBy=t[0].value,this.currentPageNumber=1,this.dateOptionData.currentOptions=t,this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1,this.fetchData()},target(t){this.currentPageNumber=t,this.fetchData(),document.getElementsByClassName("right-page-section")[0].scrollTop=0},selectWechatNotify(){this.$router.replace({path:"/".concat(this.accountId,"/notifications/select")}),this.showWechatNotify=!0},closeWechatNotify(){this.showWechatNotify=!1,this.$router.replace({path:"/".concat(this.accountId,"/notifications")})},newNotification(t){this.showWechatNotify=!1,this.showNewNotification=!0,this.$router.replace({path:"/".concat(this.accountId,"/notifications/new")}),this.selectedNotify=t},closeNewNotification(){this.showNewNotification=!1,this.selectedNotify={},this.$router.replace({path:"/".concat(this.accountId,"/notifications")})},async getMergeableSObject(t){try{return{apiName:(await k.q.getMergeableSObject(t)).name,label:t,showSelect:!1,options:[]}}catch(t){}},async editNotify(t){this.isInitNotificationLoading=!0;try{const e=await Object(M.d)(t.Id);if(e.ok){this.selectedNotify=JSON.parse($.a.unescape(e.data))[0];let t={};this.selectedNotify.ObjectName&&(t=await this.getMergeableSObject(this.selectedNotify.ObjectName)||{}),this.selectedNotify.mergeFieldObject=t,this.selectedNotify.MiniProgramPageId?this.selectedMiniProgramPage=await k.l.getById(this.selectedNotify.MiniProgramPageId):this.selectedMiniProgramPage={},this.showNewNotification=!0,this.$router.replace({path:"/".concat(this.accountId,"/notifications/new")})}else Object(P.f)(e)}catch(t){Object(P.f)(t)}finally{this.isInitNotificationLoading=!1}},openDeleteNotify(t){this.notifyId=t.Id;const e=this.$confirm({title:this.$t("deleteNotifyTitleLabel"),content:this.$t("deleteNotifyContentLabel")});e.$on("ok",async()=>{try{const t=await Object(M.b)(this.notifyId);this.notifyId="",t.ok?(e.close(),this.$router.app.$emit("open-toast-notification",{content:this.$t("deleteSuccessLabel"),type:"success"}),this.fetchData()):(e.resume(),Object(P.f)(t))}catch(t){e.resume(),Object(P.f)(t)}})},async saveNotification(){if(this.canSave=!1,this.selectedNotify.Id){const t=this.$refs.newNotifyPage.prepareUpdatedData();try{const e=await Object(M.h)(this.selectedNotify.Id,a()(t));this.canSave=!0,e.ok?(this.showNewNotification=!1,this.selectedNotify={},this.$router.app.$emit("open-toast-notification",{content:this.$t("saveSuccessLabel"),type:"success"}),this.fetchData(),this.$router.replace({path:"/".concat(this.accountId,"/notifications")})):Object(P.f)(e)}catch(t){this.canSave=!0,Object(P.f)(t)}}else{const t=this.$refs.newNotifyPage.prepareCreatedData();try{const e=await Object(M.a)(this.accountId,a()(t));this.canSave=!0,e.ok?(this.showNewNotification=!1,this.selectedNotify={},this.$router.app.$emit("open-toast-notification",{content:this.$t("saveSuccessLabel"),type:"success"}),this.fetchData(),this.$router.replace({path:"/".concat(this.accountId,"/notifications")})):Object(P.f)(e)}catch(t){this.canSave=!0,Object(P.f)(t)}}}})},A=(s("Kpe1"),s("qBq6")),E=Object(C.a)(D,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"notification-template-page"},[s("scoped-tabs",{attrs:{tabs:t.tabList,"current-tab-name":"NOTIFICATION TEMPLATES"},on:{switch:t.refreshData}},[s("div",{attrs:{slot:"button-group"},slot:"button-group"},[t.showNewNotification?t._e():s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.selectWechatNotify()}}},[t._v(t._s(t.$t("global.newBtn")))]),t._v(" "),t.showNewNotification?s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:!t.canSave},on:{click:function(e){return t.closeNewNotification()}}},[t._v(t._s(t.$t("global.cancelBtn")))]):t._e(),t._v(" "),t.showNewNotification?s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:!t.canSave},on:{click:function(e){return t.saveNotification()}}},[t._v(t._s(t.$t("global.saveBtn")))]):t._e()])]),t._v(" "),t.showNewNotification?t._e():s("main",{staticClass:"notify-list"},[s("section",{staticClass:"slds-border_bottom slds-grid slds-grid_vertical-align-center filter-section"},[t.notificationMetadata.total>1?s("span",[t._v(t._s(t._f("addSeparators")(t.notificationMetadata.total))),t.hasMoreNotifications?s("i",{staticClass:"show-plus-sign"},[t._v("+")]):t._e(),t._v(" "+t._s(t.$tc("global.itemLabel",2))+"\n      ")]):t._e(),t._v(" "),t.notificationMetadata.total<=1?s("span",[t._v(t._s(t.notificationMetadata.total)+" "+t._s(t.$tc("global.itemLabel",1)))]):t._e(),t._v(" "),s("section",{staticClass:"slds-col_bump-left search"},[s("search-input",{attrs:{placeholder:t.$t("searchNotifyLabel")},on:{search:t.searchNotification,clear:t.clearSearchKey},model:{value:t.condition.SearchKey,callback:function(e){t.$set(t.condition,"SearchKey",e)},expression:"condition.SearchKey"}})],1),t._v(" "),s("section",{staticClass:"filter"},[s("input-select",{attrs:{currents:t.dateOptionData.currentOptions},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1)]),t._v(" "),t.isInitNotificationLoading||0===t.notificationMetadata.total?t._e():s("div",{staticClass:"slds-table--header-fixed_container notify-content"},[s("div",{staticClass:"slds-scrollable_y scroll-content"},[s("notification-list",{attrs:{notifications:t.notificationMetadata.notifications},on:{"edit-notify":t.editNotify,"delete-notify":t.openDeleteNotify}}),t._v(" "),t.isInitNotificationLoading?t._e():s("pagination",{attrs:{paginations:t.notificationMetadata.currentNotificationPagination,"page-number":t.currentPageNumber},on:{target:t.target}})],1)])]),t._v(" "),t.showNewNotification?s("main",{staticClass:"slds-scrollable_y notify-list"},[t.showNewNotification?s("new-notification",{ref:"newNotifyPage",attrs:{notify:t.selectedNotify,"selected-mini-program":t.selectedMiniProgramPage}}):t._e()],1):t._e(),t._v(" "),s("loading-spinner",{attrs:{"is-loading":t.isInitNotificationLoading,"custom-style":"top: 40px;z-index: 1"}}),t._v(" "),t.isInitNotificationLoading||0!==t.notificationMetadata.total||t.showNewNotification?t._e():s("no-record",{attrs:{"custom-style":"top: 80px;"}}),t._v(" "),t.showWechatNotify?s("wechat-notification",{on:{close:t.closeWechatNotify,next:t.newNotification}}):t._e(),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.dateOptionData.options,currents:t.dateOptionData.currentOptions,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth,"has-sort-by":!0},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e()],1)}),[],!1,null,"84889b4c",null);"function"==typeof A.default&&Object(A.default)(E);e.default=E.exports},"/rEz":function(t,e,s){"use strict";var i=s("AI8O"),a=s.n(i);e.default=a.a},"0jZ9":function(t,e,s){"use strict";var i=s("+SX9"),a=s("/I/F"),n={props:{accountId:{type:String,default:""},previewedMsgId:{type:String,default:""},isSaving:{type:Boolean,default:!1}},components:{ErrorToast:i.a},data:()=>({wechatId:"",isPreviewing:!1,isPreviewShow:!1,errorToastMsg:""}),methods:{open(){this.isPreviewShow=!0},close(){this.isPreviewShow=!1,this.wechatId="",this.errorToastMsg=""},async preview(){this.errorToastMsg="",this.isPreviewing=!0;try{const t=await Object(a.d)(this.accountId,this.previewedMsgId,this.wechatId);t.ok?(this.$router.app.$emit("open-toast-notification",{content:this.$t("notifyContent"),type:"success"}),this.isPreviewShow=!1,this.isPreviewing=!1,this.wechatId=""):(this.errorToastMsg=t.error.message||t.error,this.isPreviewing=!1)}catch(t){this.errorToastMsg=t.message,this.isPreviewing=!1}}}},o=(s("xIZP"),s("KHd+")),r=s("hQq0"),l=Object(o.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"slds-modal slds-modal_large",class:{"slds-fade-in-open":t.isPreviewShow},attrs:{id:"ShowPreviewPopup","aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container show-selected-container preview-width",attrs:{role:"document",tabindex:"0"}},[s("div",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close preview-close-btn",attrs:{disabled:t.isPreviewing},on:{click:function(e){return t.close()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.$t("previewTitle")))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium preview-middle-height"},[t.errorToastMsg?s("error-toast",{staticClass:"error-toast",attrs:{content:t.errorToastMsg}}):t._e(),t._v(" "),s("div",{staticClass:"wechat-id",class:{"error-margin":t.errorToastMsg}},[s("span",[t._v(t._s(t.$t("wechatLabel")))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.wechatId,expression:"wechatId"}],staticClass:"slds-input",attrs:{type:"text",name:""},domProps:{value:t.wechatId},on:{input:function(e){e.target.composing||(t.wechatId=e.target.value)}}})])],1),t._v(" "),s("div",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isPreviewing},on:{click:function(e){return t.close()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",class:{"upload-btn-width":t.isSaving},attrs:{disabled:t.isPreviewing||!t.wechatId||t.isSaving},on:{click:function(e){return t.preview()}}},[s("div",{staticClass:"slds-spinner_container position-spinner",class:{"hide-loading":!t.isSaving}},[t._m(0)]),t._v("\n          "+t._s(t.isSaving?t.$t("savingBtn"):t.$t("global.previewBtn"))+"\n        ")])])])]),t._v(" "),s("div",{staticClass:"slds-backdrop",class:{"slds-backdrop_open":t.isPreviewShow}})])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"slds-spinner slds-spinner_small more-size-loading",attrs:{role:"alert"}},[e("div",{staticClass:"slds-spinner__dot-a"}),this._v(" "),e("div",{staticClass:"slds-spinner__dot-b"})])}],!1,null,"ebb17ee0",null);"function"==typeof r.default&&Object(r.default)(l);e.a=l.exports},"18ia":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"sendMsgTitle":"发送通知","sendMsgWarning":"正在发送。离开此页将会停止发送!","loadingLabel":"检查中","sendMsgSuccess":"你的通知已经提交。","sendMsgCount":"总数: {0}, 排队中: {1}, 成功: {2}, 失败: {3}。"},"en":{"sendMsgTitle":"Sending Notification","sendMsgWarning":"Sending in progress. Leaving this page will stop the progress!","loadingLabel":"Checking","sendMsgSuccess":"Your notifications have been submitted.","sendMsgCount":"Total: {0}, Queued: {1}, Sent: {2}, Failed: {3}."}}'),delete t.options._Ctor}},"1vOb":function(t,e,s){"use strict";var i=s("Hi2j"),a=s.n(i);e.default=a.a},"2n3x":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"defaultContent":"<p id=\\"initContent\\">开始输入...</p>"},"en":{"defaultContent":"<p id=\\"initContent\\">Start Typing...</p>"}}'),delete t.options._Ctor}},"3nmp":function(t,e,s){"use strict";var i=s("R9hF"),a=s.n(i),n=s("dUVM"),o=s.n(n),r=s("8Vev"),l=s.n(r),c=s("4LGG"),d=s.n(c),u=s("kZKX"),h=s.n(u),p=s("q1Z7"),m=s("QBew"),g=s("OZZp"),f=s("zEt/"),v=s.n(f),w=s("i+Lc"),b=s.n(w),_=s("20nU"),y=s("XIlo"),C=s("OB6B");var S={openRoute(t){let{wechatAccountId:e,path:s}=t;const i=["#",e,b()(s).call(s,"/")?s.substring(1):s].join("/");y.a.isInLightningConsole?C.a.openWindow(["/apex/",_.a.sfdc_namespace?"".concat(_.a.sfdc_namespace,"__"):"","CharketApp?isdtp=p1",i].join("")):window.open([window.location.origin,window.location.pathname,window.location.search,i].join(""))}},T=s("SLhn"),I=s.n(T),x=s("0G99"),L=s.n(x),M=s("cybb"),P=s("M9dV");const N=["Image","Skill","Pass","Video","Voice Message","Text Message","Coupon","Notification Template","Structured Message","Mini Program Page"],$=new h.a([["Image","global.imageLabel"],["Skill","global.skillLabel"],["Pass","global.passLabel"],["Video","global.videoLabel"],["Voice Message","global.voiceLabel"],["Text Message","global.textLabel"],["Coupon","global.couponLabel"],["Notification Template","global.notifyLabel"],["Structured Message","global.strucLabel"],["Mini Program Page","global.miniProgramLabel"]]),k=new h.a([["Image","global.popupHeader.selectImage"],["Skill","global.popupHeader.selectSkill"],["Pass","global.popupHeader.selectPass"],["Video","global.popupHeader.selectVideo"],["Voice Message","global.popupHeader.selectVoiceClip"],["Text Message","global.popupHeader.selectTextMessage"],["Coupon","global.popupHeader.selectCoupon"],["Notification Template","global.popupHeader.selectNotificationTemplateLabel"],["Structured Message","global.popupHeader.selectStructuredMessage"],["Mini Program Page","global.popupHeader.selectMiniProgram"]]);var D=class{constructor(t){this.componentInstance=t}static getAllChoosers(){return[...N]}getExclusivelyConfig(t){let e=null;switch(t){case"Skill":e={add:{title:this.componentInstance.$t("exclusive.skillAddTitle"),content:this.componentInstance.$t("exclusive.skillAddContent"),ok:this.componentInstance.$t("global.yesBtn"),cancel:this.componentInstance.$t("global.noBtn")},remove:{title:this.componentInstance.$t("exclusive.skillRemoveTitle"),content:this.componentInstance.$t("exclusive.skillRemoveContent"),ok:this.componentInstance.$t("global.yesBtn"),cancel:this.componentInstance.$t("global.noBtn")}}}return e}getReplyModeConfig(t){if("false"!==t&&!1!==t&&null!=t)return{label:this.componentInstance.$t("replyModeLabel"),modes:[{label:this.componentInstance.$t("replyModeAll"),value:"All"},{label:this.componentInstance.$t("replyModeRandom"),value:"Random"}]}}getChooserConfigs(t){return d()(t).call(t,t=>{const{type:e}=t,s={type:e,name:this.componentInstance.$t($.get(e)),exclusive:this.getExclusivelyConfig(e),layout:this.createLayout(e,t.limitLabel),dataProvider:this.createDataProvider(e),limitOfItems:t.limit||null};if("Text Message"===e){s.showTabs=!0;const e=this.getSubConfigsOfTextMessageChooser(),{textConfig:i}=t;if(i){const t={};L()(i).call(i,s=>{t[s]=e.designer[s]}),s.configs={designer:t,editor:e.editor}}else s.configs=e}return s})}getSubConfigsOfTextMessageChooser(){return{designer:{link:{iconTitle:this.componentInstance.$t("designer.linkIcon"),title:this.componentInstance.$t("global.title"),linkURL:this.componentInstance.$t("designer.linkUrl"),invalidUrl:this.componentInstance.$t("designer.illegalUrl"),primaryButton:this.componentInstance.$t("global.confirmBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn"),change:this.componentInstance.$t("designer.changeBtn"),remove:this.componentInstance.$t("designer.removeBtn")},miniProgramPage:{iconTitle:this.componentInstance.$t("designer.miniProgramIcon"),title:this.componentInstance.$t("global.title"),linkUrl:this.componentInstance.$t("designer.linkUrl"),invalidUrl:this.componentInstance.$t("designer.illegalUrl"),appId:this.componentInstance.$t("designer.appId"),pagePath:this.componentInstance.$t("designer.pagePath"),primaryButton:this.componentInstance.$t("global.confirmBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn"),change:this.componentInstance.$t("designer.changeBtn"),remove:this.componentInstance.$t("designer.removeBtn"),dataProvider:this.createDataProvider("Mini Program Link")},action:{iconTitle:this.componentInstance.$t("designer.actionIcon"),name:this.componentInstance.$t("designer.name"),value:this.componentInstance.$t("designer.value"),primaryButton:this.componentInstance.$t("global.confirmBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn")},mergeField:{iconTitle:this.componentInstance.$t("designer.mergeFieldIcon"),title:this.componentInstance.$t("designer.selectAField"),placeholder:this.componentInstance.$t("designer.findObjectPlaceholder"),filterPlaceholder:this.componentInstance.$t("designer.labelFilterPlaceholder"),fieldTitle:this.componentInstance.$t("designer.fieldTitle"),type:this.componentInstance.$t("designer.type"),apiName:this.componentInstance.$t("designer.apiName"),primaryButton:this.componentInstance.$t("global.chooseBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn"),noMatches:this.componentInstance.$t("designer.noMatchesFound"),currentSelection:this.componentInstance.$t("designer.currentSelection"),dataProvider:this.createDataProvider("Merge Field")}},editor:{title:this.componentInstance.$t("global.popupHeader.editTextMessage"),cancelButton:this.componentInstance.$t("global.cancelBtn"),okButton:this.componentInstance.$t("global.saveBtn")}}}createLayout(t,e){const s={title:this.componentInstance.$t(k.get(t)),noRecords:this.componentInstance.$t("global.noRecords"),editButton:this.componentInstance.$t("global.editBtn"),searchPlaceholder:this.componentInstance.$t("global.searchPlaceholder"),primaryButton:this.componentInstance.$t("global.confirmBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn")},i={title:"Voice Message"===t?this.componentInstance.$t("uploader.voiceTitle"):this.componentInstance.$t("uploader.".concat(t.toLowerCase(),"Title")),label:this.componentInstance.$t("uploader.titleLabel"),descriptionLabel:this.componentInstance.$t("uploader.descriptionLabel"),secondaryButton:this.componentInstance.$t("uploader.cancelBtn"),sizeLimitError:this.componentInstance.$t("uploader.tooLarge"),upload:this.componentInstance.$t("uploader.uploadBtn"),uploading:this.componentInstance.$t("uploader.uploadingBtn")};switch(t){case"Text Message":s.tabs={new:{title:this.componentInstance.$t("global.popupHeader.createTextMessage"),tabLabel:this.componentInstance.$t("newTextMessage")},list:{title:this.componentInstance.$t("global.popupHeader.selectTextMessage"),tabLabel:this.componentInstance.$t("textMessages")}},s.iconLabel=this.componentInstance.$t("global.textLabel");break;case"Skill":s.headers=[{text:this.componentInstance.$t("nameLabel"),value:"name"},{text:this.componentInstance.$t("knowledgeSourceLabel"),value:"knowledgeSource"},{text:this.componentInstance.$t("relatedToLabel"),value:"relatedTo"},{text:this.componentInstance.$t("descriptionLabel"),value:"description"},{text:this.componentInstance.$t("validForLabel"),value:"validFor"},{text:this.componentInstance.$t("displayInLiveChatLabel"),value:"isDisplayInLiveChat"},{text:this.componentInstance.$t("internalLabel"),value:"isInternal"},{text:this.componentInstance.$t("lastModifiedByLabel"),value:"lastModifiedBy"}],s.iconLabel=this.componentInstance.$t("global.skillLabel");break;case"Pass":s.headers=[{text:this.componentInstance.$t("name"),value:"name"},{text:this.componentInstance.$t("startDate"),value:"localizedStartTime"},{text:this.componentInstance.$t("endDate"),value:"localizedEndTime"},{text:this.componentInstance.$t("quantity"),value:"quantity"},{text:this.componentInstance.$t("createdBy"),value:"compoundCreatedBy"}],s.iconLabel=e||this.componentInstance.$t("global.passLabel");break;case"Coupon":s.headers=[{text:this.componentInstance.$t("type"),value:"type"},{text:this.componentInstance.$t("name"),value:"name"},{text:this.componentInstance.$t("expirationDate"),value:"expirationDate"},{text:this.componentInstance.$t("quantity"),value:"quantity"},{text:this.componentInstance.$t("status"),value:"status"}],s.iconLabel=this.componentInstance.$t("global.couponLabel");break;case"Notification Template":s.headers=[{text:this.componentInstance.$t("titleLabel"),value:"title"},{text:this.componentInstance.$t("keywordLabel"),value:"keywordNames"},{text:this.componentInstance.$t("urlLabel"),value:"notificationURL"},{text:this.componentInstance.$t("noteLabel"),value:"note"},{text:this.componentInstance.$t("createdLabel"),value:"createdBy"}],s.iconLabel=this.componentInstance.$t("global.notifyLabel");break;case"Image":s.uploader=i,s.iconLabel=this.componentInstance.$t("global.imageLabel"),s.hasAction=!0;break;case"Voice Message":s.uploader=i,s.iconLabel=this.componentInstance.$t("global.voiceLabel"),s.hasAction=!0;break;case"Video":s.uploader=i,s.iconLabel=this.componentInstance.$t("global.videoLabel"),s.hasAction=!0;break;case"Mini Program Page":s.iconLabel=this.componentInstance.$t("global.miniProgramLabel");break;case"Structured Message":s.iconLabel=this.componentInstance.$t("global.strucLabel"),s.syncedTooltip=this.componentInstance.$t("global.syncedWithWeChatPlatform")}return s}createDataProvider(t){const e={wechatAccount:this.componentInstance.wechatAccount,pageName:this.componentInstance.pageName,structuredType:this.componentInstance.structuredType};switch(t){case"Text Message":e.success=()=>{this.componentInstance.$toast({content:this.componentInstance.$t("changeSavedNofity"),type:"success"})},e.error=t=>{this.componentInstance.$handleError(t)};break;case"Skill":e.formatter=t=>{var e;t.compoundRelatedTo={id:t.relatedTo?t.relatedTo.id:"",name:t.relatedTo?t.relatedTo.name:""},"Survey"===t.knowledgeSource&&t.relatedTo&&t.relatedTo.id?(t.compoundRelatedTo.href="javascript: void(0);",t.compoundRelatedTo.onClick=t=>{this.componentInstance.$router.push({name:"survey-editor",params:{surveyId:t.relatedTo.id}})}):t.relatedTo&&t.relatedTo.id&&(t.compoundRelatedTo.href="/".concat(t.relatedTo.id));const s=Object(M.e)(t.lastModifiedDate,this.componentInstance.$user.TimeZoneSidKey);return t.compoundLastModifiedBy=t.lastModifiedBy.name?I()(e="".concat(t.lastModifiedBy.name,", ")).call(e,s):s,t};break;case"Structured Message":e.formatter=t=>(t.localizedWeChatLastModifiedTime=Object(M.e)(t.weChatLastModifiedTime,this.componentInstance.$user.TimeZoneSidKey),t);break;case"Pass":e.formatter=t=>{var e;const s=Object(M.e)(t.createdDate,this.componentInstance.$user.TimeZoneSidKey);return t.compoundCreatedBy=I()(e="".concat(t.createdByUser,", ")).call(e,s),t.localizedStartTime=Object(M.e)(t.startTime,this.componentInstance.$user.TimeZoneSidKey),t.localizedEndTime=Object(M.e)(t.endTime,this.componentInstance.$user.TimeZoneSidKey),t};break;case"Coupon":const t=this.componentInstance.$t("to");e.formatter=e=>{var s,i;const a=Object(M.e)(e.beginDate,this.componentInstance.$user.TimeZoneSidKey),n=Object(M.e)(e.endDate,this.componentInstance.$user.TimeZoneSidKey);return e.expirationDate=I()(s=I()(i="".concat(a," ")).call(i,t," ")).call(s,n),e};break;case"Notification Template":e.formatter=t=>{var e;return t.localizedCreatedDate=Object(M.e)(t.createdDate,this.componentInstance.$user.TimeZoneSidKey),t.createdBy=I()(e="".concat(t.createdByUser,", ")).call(e,t.localizedCreatedDate),t};break;case"Voice Message":case"Video":e.formatter=t=>(t.localizedUpdateDateTime=Object(M.e)(t.updateDateTime,this.componentInstance.$user.TimeZoneSidKey),t)}return P.a.create(t,e)}},A=s("itEF"),E=s("wG3i"),O=s.n(E),F=s("FYrm"),j=s("w+Ta"),B=s("hOMy"),U={props:{accountId:{type:String,default:()=>""}},components:{CreateWeChatPass:F.a,LdModal:B.LdModal},data:()=>({isSavingPass:!1}),methods:{onClickActivator(){this.$refs.Modal.open()},closeModal(t){this.$emit("close",t),this.$refs.Modal.close()},async saveNewPass(){const t=this.accountId||this.$route.params.accountId,e=this.$refs.pass.getPass();if(t&&e)try{this.isSavingPass=!0;const s=await Object(j.f)(t,O()(e));if(s.ok){this.$router.app.$emit("open-toast-notification",{content:this.$t("passForApproval"),type:"success"});const t=s.data;this.$parent.$parent.$parent.$emit("new-pass-created"),this.closeModal(t)}else this.$refs.Modal.showError(s.error)}catch(t){const e=this.$parseErrorMessage(t);this.$refs.Modal.showError(e)}finally{this.isSavingPass=!1}}}},R=(s("nOmU"),s("KHd+")),V=s("Dk61"),H=Object(R.a)(U,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"new-pass-popup"},[s("span",{on:{click:t.onClickActivator}},[t._t("activator")],2),t._v(" "),s("ld-modal",{ref:"Modal",attrs:{title:t.$t("newPassTitle"),width:"auto","min-width":900,"max-width":"90%",persistent:t.isSavingPass}},[s("template",{slot:"content"},[s("create-we-chat-pass",{ref:"pass",attrs:{"acc-id":t.accountId,"is-popup":!0}})],1),t._v(" "),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSavingPass},on:{click:function(e){return t.closeModal()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isSavingPass},on:{click:function(e){return t.saveNewPass()}}},[t._v(t._s(t.$t("global.saveBtn")))])])],2)],1)}),[],!1,null,"dcb5ef76",null);"function"==typeof V.default&&Object(V.default)(H);var q=H.exports,W=s("fb3H"),z=s("wbfU"),J={props:{accountId:String},components:{WechatNotification:W.a,NewNotificationPopup:z.a},data:()=>({isWeChatNotificationVisible:!1,isNewNotificationPopupVisible:!1,selectedWeChatNotification:null}),methods:{onClickActivator(){this.isWeChatNotificationVisible=!0},onWeChatNotificationClose(){this.isWeChatNotificationVisible=!1},onWeChatNotificationNext(t){this.selectedWeChatNotification=t,this.isWeChatNotificationVisible=!1,this.isNewNotificationPopupVisible=!0},onNewNotificationPopupClose(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")?this.$parent.$parent.$parent.$emit("new-notification-template-created"):this.isWeChatNotificationVisible=!0,this.isNewNotificationPopupVisible=!1}}},G=Object(R.a)(J,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isWeChatNotificationVisible?s("wechat-notification",{attrs:{"account-id":t.accountId},on:{close:t.onWeChatNotificationClose,next:t.onWeChatNotificationNext}}):t._e(),t._v(" "),t.isNewNotificationPopupVisible?s("new-notification-popup",{attrs:{"acc-id":t.accountId,notify:t.selectedWeChatNotification},on:{close:t.onNewNotificationPopupClose}}):t._e(),t._v(" "),s("div",{on:{click:t.onClickActivator}},[t._t("activator")],2)],1)}),[],!1,null,null,null).exports;const K=new h.a([["Mini Program",["Text Message","Image","Mini Program Page","Skill"]],["Subscription Account",["Text Message","Image","Structured Message","Voice Message","Video","Mini Program Page","Pass","Coupon","Skill"]],["Service Account",["Text Message","Image","Structured Message","Voice Message","Video","Mini Program Page","Notification Template","Pass","Coupon","Skill"]]]);var Z={components:{WechatResponseDesigner:p.WechatResponseDesigner,LdButton:m.LdButton,LdIcon:g.LdIcon,NewPassPopup:q,NotificationTemplateCreator:G},model:{prop:"value",event:"input"},props:{value:{type:Object,default:()=>({})},limitOfItems:{type:Number,default:999},wechatAccount:{type:Object,required:!0},choosers:{type:Array,required:!0},multiple:{type:Boolean,default:()=>!1},enableReplyMode:{type:[Boolean,String],default:()=>!1},pageName:{type:String,default:""},iconSize:{type:String,default:"small"},structuredType:{type:String,default:"news"}},data:()=>({helperInstance:null,wechatResponse:{},addSvg:v.a}),computed:{unifiedChoosers(){var t;return d()(t=this.choosers).call(t,t=>"string"==typeof t?{type:t}:t)},supportedChoosers(){var t;return this.wechatAccount.type?l()(t=this.unifiedChoosers).call(t,t=>{var e;let{type:s}=t;return o()(e=K.get(this.wechatAccount.type)).call(e,s)}):this.unifiedChoosers},chooserConfigs(){return this.helper.getChooserConfigs(this.supportedChoosers)},replyModeConfig(){return this.helper.getReplyModeConfig(this.enableReplyMode)},helper(){return this.helperInstance||(this.helperInstance=new D(this)),this.helperInstance},accountId(){return this.wechatAccount.id}},watch:{wechatResponse:{handler(t){if(t.isInternalChange&&this.value&&t.content===this.value.content)return;const e=this.multiple?A.a.from(t):A.a.createItem(t);this.$emit("input",e)},deep:!0},value:{deep:!0,immediate:!0,handler(t){this.wechatResponse=a()({isInternalChange:!0},t)}}},methods:{onClickNewStructuredMessage(){S.openRoute({wechatAccountId:this.$wechatAccount.id,path:"message/structured-messages/new"})}}},Y=(s("Ek5D"),s("xswR")),X=s("ItEM"),Q=s("fOvr"),tt=s("1vOb"),et=s("4bTK"),st=s("DR4q"),it=Object(R.a)(Z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("wechat-response-designer",{attrs:{choosers:t.chooserConfigs,multiple:t.multiple,"reply-mode-config":t.replyModeConfig,"limit-of-items":t.limitOfItems,"icon-size":t.iconSize},model:{value:t.wechatResponse,callback:function(e){t.wechatResponse=e},expression:"wechatResponse"}},[s("ld-button",{attrs:{slot:"structured-message-create-button",neutral:""},on:{click:t.onClickNewStructuredMessage},slot:"structured-message-create-button"},[s("ld-icon",{staticClass:"plus-icon",attrs:{size:"xx-small",color:"current",content:t.addSvg}})],1),t._v(" "),s("new-pass-popup",{attrs:{slot:"pass-create-button","account-id":t.accountId},slot:"pass-create-button"},[s("ld-button",{attrs:{slot:"activator",neutral:""},slot:"activator"},[t._v("\n      "+t._s(t.$t("global.newBtn"))+"\n    ")])],1),t._v(" "),s("notification-template-creator",{attrs:{slot:"notification-template-create-button","account-id":t.accountId},slot:"notification-template-create-button"},[s("ld-button",{attrs:{slot:"activator",neutral:""},slot:"activator"},[t._v("\n      "+t._s(t.$t("global.newBtn"))+"\n    ")])],1)],1)}),[],!1,null,"486a8157",null);"function"==typeof Y.default&&Object(Y.default)(it),"function"==typeof X.default&&Object(X.default)(it),"function"==typeof Q.default&&Object(Q.default)(it),"function"==typeof tt.default&&Object(tt.default)(it),"function"==typeof et.default&&Object(et.default)(it),"function"==typeof st.default&&Object(st.default)(it);var at=it.exports;e.a=at},"3p9M":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"message":"消息","sendTo":"发送至","status":"状态","submittedBy":"提交信息","scheduledDate":"定时","action":"操作","item":"项目","totalFollowers":"关注者总数","successTotal":"成功总数","failedTotal":"失败总数","cancelMassSend":"取消群发消息","deleteMassSend":"删除群发消息","sureToCancel":"你确定要取消这条群发消息吗？","sureToDelete":"你确定要删除这条群发消息吗？","moreInfoLabel":"更多信息"},"en":{"message":"Message","sendTo":"Send To","status":"Status","submittedBy":"Submitted By","scheduledDate":"Scheduled Date","action":"Action","item":"item{0}","totalFollowers":"Total Followers","successTotal":"Success Total","failedTotal":"Failed Total","cancelMassSend":"Cancel Mass Send","deleteMassSend":"Delete Mass Send","sureToCancel":"Are you sure you want to cancel this mass send?","sureToDelete":"Are you sure you want to delete this mass message?","moreInfoLabel":"More Info"}}'),delete t.options._Ctor}},"4bTK":function(t,e,s){"use strict";var i=s("t29s"),a=s.n(i);e.default=a.a},"4sRh":function(t,e,s){"use strict";var i=s("9eOI");s.n(i).a},"55Ot":function(t,e,s){"use strict";var i=s("ZR3b");s.n(i).a},"5DGR":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"titleLabel":"标题","keywordLabel":"关键字","urlLabel":"通知地址","noteLabel":"备注","createdLabel":"创建人","massSendLabel":"群发","editLabel":"编辑","deleteLabel":"删除"},"en":{"titleLabel":"Title","keywordLabel":"Keywords","urlLabel":"Notification URL","noteLabel":"Note","createdLabel":"Created By","massSendLabel":"Mass Send","editLabel":"Edit","deleteLabel":"Delete"}}'),delete t.options._Ctor}},"6Jqe":function(t,e,s){"use strict";var i=s("oIjN"),a=s.n(i);e.default=a.a},"6erD":function(t,e,s){"use strict";var i=s("uVVx"),a=s.n(i);e.default=a.a},"8YXT":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"selectNotificationTemplateLabel":"选择微信模板","newTemplateLabel":"在微信中添加一个新模板"},"en":{"selectNotificationTemplateLabel":"Select WeChat Template","newTemplateLabel":"Choose a new template from WeChat."}}'),delete t.options._Ctor}},"94pc":function(t,e,s){},"9eOI":function(t,e,s){},A3YL:function(t,e,s){"use strict";var i=s("F5n2"),a=s.n(i);e.default=a.a},A7Fh:function(t,e,s){"use strict";var i=s("3p9M"),a=s.n(i);e.default=a.a},A7GL:function(t,e,s){},AI8O:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"tag":"标签","campaign":"市场活动","memberStatus":"成员状态","relateTo":"相关","noRelated":"无关联","lead":"潜在客户","contact":"联系人"},"en":{"tag":"Tag","campaign":"Campaign","memberStatus":"Member Status","relateTo":"Relate To","noRelated":"No Related","lead":"Lead","contact":"Contact"}}'),delete t.options._Ctor}},AScg:function(t,e,s){},BR3B:function(t,e,s){},BV7i:function(t,e,s){"use strict";var i=s("18ia"),a=s.n(i);e.default=a.a},BtIw:function(t,e,s){},DPCc:function(t,e,s){"use strict";s.r(e);var i=s("SLhn"),a=s.n(i),n=s("wG3i"),o=s.n(n),r=s("Yvyk"),l=s.n(r),c=s("+Bun"),d=s.n(c),u=s("8Vev"),h=s.n(u),p=s("vQrK"),m=s.n(p),g=s("HnSg"),f=s("692z"),v=s("F5n6"),w=s("w2Vt"),b=s("ngIk"),_=s("dcdS"),y=s("oWfJ"),C=s("EMO1"),S=s("ip3M"),T=s.n(S),I=s("+BhS"),x=s("za7x"),L=s("Ktw+"),M=s("xEMq"),P=s("jkSJ"),N=s("4B+h"),$=s("LQ5e"),k=s.n($),D={props:{accountId:{type:String,default:()=>""},createdInfo:{type:Object,defaut:()=>({type:"new",id:null})},isMiniPro:{type:Boolean,default:()=>!1}},inject:["showErrorImg"],components:{ImagePopup:I.a,Icon:x.a,LoadingSpinner:w.a,MessageUploader:L.a},async mounted(){if(this.isModalOpen=!0,"edit"===this.createdInfo.type)this.miniProTitle=this.$t("editMiniProTitle"),this.isLoading=!0,await this.$try(async()=>{const t=await P.k.getById(this.createdInfo.id);this.miniProgramPageDetails.thumbnailId=t.thumbnailId,this.miniProgramPageDetails.wechatImageUrl=t.url,this.miniProgramPageDetails.miniProgramAppId=t.miniProgramAppId,this.miniProgramPageDetails.pagePath=t.pagePath,this.miniProgramPageDetails.title=t.title,this.miniProgramPageDetails.name=t.name,this.miniProgramPageDetails.wechatAttachmentId=t.wechatAttachmentId,this.miniProgramPageDetails.messageId=t.messageId}),this.isLoading=!1;else if(this.isMiniPro){this.isLoading=!0;try{let t=await Object(M.b)(this.accountId);if(t.ok){let e=JSON.parse(k.a.unescape(t.data));this.miniProgramPageDetails.miniProgramAppId=e.appId}else Object(N.f)(t)}catch(t){Object(N.f)(t)}finally{this.isLoading=!1}}},data(){return{miniProTitle:this.$t("newMiniProTitle"),isModalOpen:!1,isSavingMiniPro:!1,miniProgramPageDetails:{title:"",miniProgramAppId:"",wechatImageUrl:"",pagePath:"",thumbnailId:"",name:"",messageId:"",wechatAttachmentId:""},showErrorTip:!1,isLoading:!1,errorObj:{titleEmpty:!1,appIdEmpty:!1,pagePathEmpty:!1,wechatImageUrlEmpty:!1}}},methods:{closeNewMiniProModal(){this.$emit("close-mini-pro",!1)},openImagePopup(t){this.showErrorTip=!1,this.$refs.imagepopupmodel.openModal("","image","")},getSelectedMessage(t){this.miniProgramPageDetails.thumbnailId=t[0].mediaId,this.miniProgramPageDetails.wechatImageUrl=t[0].url},deleteCoverImage(){this.miniProgramPageDetails.wechatImageUrl="",this.miniProgramPageDetails.thumbnailId=""},closeErrorTip(){this.showErrorTip=!1},getMiniPro(){var t=this;let e=!1;const s=function(e,s){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a=()=>{t.showErrorTip=!1,e.classList.remove(s),e.removeEventListener("keydown",a),e.removeEventListener("blur",a)};t.showErrorTip=i,e.classList.add(s),e.addEventListener("keydown",a),e.addEventListener("blur",a)};if(this.errorObj.titleEmpty=""===this.miniProgramPageDetails.title,this.errorObj.appIdEmpty=""===this.miniProgramPageDetails.miniProgramAppId,this.errorObj.pagePathEmpty=""===this.miniProgramPageDetails.pagePath,this.errorObj.wechatImageUrlEmpty=""===this.miniProgramPageDetails.wechatImageUrl,e=!!(()=>{for(const t of T()(this.errorObj))if(t)return t})(),e&&(this.errorObj.titleEmpty?(this.$refs.miniProTitle.focus(),s(this.$refs.miniProTitle,"input-empty")):this.errorObj.appIdEmpty?(this.$refs.miniProAppId.focus(),s(this.$refs.miniProAppId,"input-empty")):this.errorObj.pagePathEmpty?(this.$refs.miniProPagePath.focus(),s(this.$refs.miniProPagePath,"input-empty")):this.errorObj.wechatImageUrlEmpty&&(this.showErrorTip=!0),this.errorObj),!e)return this.miniProgramPageDetails},async saveMiniProgramPage(){this.isSavingMiniPro=!0;const t=this.getMiniPro();if(t&&"new"===this.createdInfo.type)try{const e=await Object(M.e)(this.accountId,o()(t));this.isSavingMiniPro=!1,e.ok?(this.$emit("close-mini-pro",!0),this.$router.app.$emit("open-toast-notification",{content:this.$t("miniProSaveLabel"),type:"success"})):Object(N.f)(e)}catch(t){this.isSavingMiniPro=!1,Object(N.f)(t)}else if(t&&"edit"===this.createdInfo.type)try{const e=await Object(M.i)(this.accountId,o()(t));this.isSavingMiniPro=!1,e.ok?(this.$emit("close-mini-pro",!0),this.$router.app.$emit("open-toast-notification",{content:this.$t("miniProSaveLabel"),type:"success"})):Object(N.f)(e)}catch(t){this.isSavingMiniPro=!1,Object(N.f)(t)}else this.isSavingMiniPro=!1},onUploadCompleted(t){this.$root.$emit("upload-file-success"),this.miniProgramPageDetails.thumbnailId=t.mediaId,this.miniProgramPageDetails.wechatImageUrl=t.url}}},A=(s("LAgH"),s("KHd+")),E=s("kajw"),O=Object(A.a)(D,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-mini-pro-popup"},[s("div",{staticClass:"slds-modal slds-modal_large",class:{"slds-fade-in-open":t.isModalOpen},attrs:{id:"messagePopup","aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container mini-pro-container"},[s("header",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon slds-modal__close slds-button_icon-inverse",on:{click:function(e){return t.closeNewMiniProModal()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium slds-hyphenate",attrs:{id:"modal-heading-01"}},[t._v(t._s(t.miniProTitle))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium modal-content-custom",attrs:{id:"modal-content-id-1"}},[s("div",{staticClass:"slds-grid new-mini-program-page-box",attrs:{id:"newMiniProgramPage"}},[s("div",{staticClass:"new-mini-program-page-list"},[s("loading-spinner",{attrs:{"is-loading":t.isLoading,"custom-style":"position: relative;top: 50%;height:50px;"}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"slds-box new-mini-program-page"},[s("div",{staticClass:"new-mini-program-page-detail"},[s("div",{staticClass:"slds-truncate new-mini-program-title"},[t._v(t._s(t.miniProgramPageDetails.title?t.miniProgramPageDetails.title:t.$t("title")))]),t._v(" "),s("div",{staticClass:"new-mini-program-page-image"},[t.miniProgramPageDetails.wechatImageUrl?t._e():s("div",{staticClass:"default-image"},[s("icon",{attrs:{name:"image",width:"48px",height:"48px","fill-color":"#ffffff","charket-icon":""}})],1),t._v(" "),t.miniProgramPageDetails.wechatImageUrl?s("div",{staticClass:"cover-image"},[s("img",{staticClass:"w-cover-img",attrs:{src:t._f("imgFilter")(t.miniProgramPageDetails.wechatImageUrl),alt:""},on:{error:function(e){return t.showErrorImg(e)}}})]):t._e()])]),t._v(" "),s("div",{staticClass:"slds-grid slds-border_top new-mini-program-type"},[s("icon",{staticClass:"type-icon",attrs:{name:"miniProIcon",width:"16px",height:"16px","fill-color":"#706e6b","charket-icon":""}}),t._v(" "),s("div",{staticClass:"slds-truncate new-mini-program-type-content"},[t._v(t._s(t.$t("global.miniProgramLabel")))])],1)])],1),t._v(" "),s("div",{staticClass:"slds-grid slds-col slds-border_left new-mini-program-page-content"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showErrorTip,expression:"showErrorTip"}],staticClass:"error-tip",style:{top:"12px"},on:{click:function(e){return t.closeErrorTip()}}},[t._v("\n              "+t._s(t.$t("reviewError"))+"\n            ")]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical slds-col new-mini-program-page-wrapper slds-scrollable_y"},[s("div",{staticClass:"slds-grid slds-grid_vertical new-mini-program-page-head",class:{"error-head":t.showErrorTip}},[s("div",{staticClass:"new-mini-program-page-item"},[s("div",{staticClass:"mini-pro-item-title"},[s("i",[t._v("*")]),t._v("\n                    "+t._s(t.$t("title"))+"\n                  ")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.miniProgramPageDetails.title,expression:"miniProgramPageDetails.title"}],ref:"miniProTitle",staticClass:"slds-input",attrs:{type:"text",name:""},domProps:{value:t.miniProgramPageDetails.title},on:{input:function(e){e.target.composing||t.$set(t.miniProgramPageDetails,"title",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"new-mini-program-page-item"},[s("div",{staticClass:"mini-pro-item-title"},[s("i",[t._v("*")]),t._v("\n                    "+t._s(t.$t("appIdLabel"))+"\n                  ")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.miniProgramPageDetails.miniProgramAppId,expression:"miniProgramPageDetails.miniProgramAppId"}],ref:"miniProAppId",staticClass:"slds-input",attrs:{type:"text",name:""},domProps:{value:t.miniProgramPageDetails.miniProgramAppId},on:{input:function(e){e.target.composing||t.$set(t.miniProgramPageDetails,"miniProgramAppId",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"new-mini-program-page-item"},[s("div",{staticClass:"mini-pro-item-title"},[s("i",[t._v("*")]),t._v("\n                    "+t._s(t.$t("pagePathLabel"))+"\n                  ")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.miniProgramPageDetails.pagePath,expression:"miniProgramPageDetails.pagePath"}],ref:"miniProPagePath",staticClass:"slds-input",attrs:{type:"text",name:""},domProps:{value:t.miniProgramPageDetails.pagePath},on:{input:function(e){e.target.composing||t.$set(t.miniProgramPageDetails,"pagePath",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"slds-border_top slds-col new-mini-program-page-footer"},[s("div",{staticClass:"new-mini-program-page-publish-style"},[s("div",{staticClass:"slds-grid slds-grid_vertical mini-pro-cover-image"},[s("div",{staticClass:"select-title"},[s("i",[t._v("*")]),t._v("\n                      "+t._s(t.$t("coverImage"))+"\n                      "),s("span",[t._v(t._s(t.$t("recommendedSize",[520,416])))])]),t._v(" "),s("div",{staticClass:"select-button"},[s("message-uploader",{staticClass:"slds-button slds-button_neutral upload-file-btn",attrs:{type:"image","wechat-account-id":t.accountId},on:{completed:t.onUploadCompleted}},[s("span",{staticClass:"upload-file-btn__label"},[t._v(t._s(t.$t("global.uploadBtn")))])]),t._v(" "),s("button",{staticClass:"slds-button slds-button_neutral library-btn",on:{click:function(e){return t.openImagePopup("coverPic")}}},[t._v(t._s(t.$t("chooseFromLibrary")))])],1),t._v(" "),t.miniProgramPageDetails&&t.miniProgramPageDetails.wechatImageUrl?s("div",{staticClass:"cover-image-first"},[s("img",{staticClass:"w-cover-img",attrs:{src:t._f("imgFilter")(t.miniProgramPageDetails.wechatImageUrl),alt:""},on:{error:function(e){return t.showErrorImg(e)}}}),t._v(" "),s("div",{staticClass:"cover-image-toolbar"},[s("div",{staticClass:"button-delete",on:{click:function(e){return e.stopPropagation(),t.deleteCoverImage()}}},[s("icon",{attrs:{name:"deleteIcon",width:"18px",height:"18px","fill-color":"#ffffff","charket-icon":""}})],1)])]):t._e()])])])])]),t._v(" "),s("image-popup",{ref:"imagepopupmodel",attrs:{"acc-id":t.accountId,"header-content":t.$t("global.popupHeader.selectImage"),"popup-type":"image","is-multi-select":!1},on:{getSelectedMessage:t.getSelectedMessage}})],1)]),t._v(" "),s("footer",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSavingMiniPro},on:{click:function(e){return t.closeNewMiniProModal()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isSavingMiniPro},on:{click:function(e){return t.saveMiniProgramPage()}}},[t._v(t._s(t.$t("global.saveBtn")))])])])]),t._v(" "),s("div",{staticClass:"slds-backdrop",class:{"slds-backdrop_open":t.isModalOpen},attrs:{id:"Modal"}})])}),[],!1,null,"8e6749c4",null);"function"==typeof E.default&&Object(E.default)(O);var F=O.exports,j=s("YjsE"),B=s("NAIw"),U=s("ZKhp"),R=s("Y/WH"),V=s("xxvK"),H=s("0jZ9"),q=s("BXKR"),W={props:{currentMsgName:{type:String,default:()=>""},currentMsgId:{type:String,default:()=>""}},components:{Icon:x.a,LimitedInput:q.a},mounted(){this.newMsgName=this.currentMsgName},data:()=>({isSavingName:!1,newMsgName:""}),methods:{async saveMsgName(){this.isSavingName=!0;try{const t=await Object(M.h)(this.newMsgName,this.currentMsgId);this.isSavingName=!1,t.ok?(this.$emit("close-change-name",!0),this.$router.app.$emit("open-toast-notification",{content:this.$t("notifyContent"),type:"success"})):Object(N.f)(t)}catch(t){this.isSavingName=!1,Object(N.f)(t)}},closeModal(){this.$emit("close-change-name")},formatedText(t){this.newMsgName=t}}},z=(s("qHqx"),s("iDmT")),J=Object(A.a)(W,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-msg-name-popup"},[s("div",{staticClass:"slds-modal slds-modal_large slds-fade-in-open",attrs:{id:"message-name-popup","aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container"},[s("header",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon slds-modal__close slds-button_icon-inverse",on:{click:function(e){return t.closeModal()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium slds-hyphenate",attrs:{id:"modal-heading-01"}},[t._v(t._s(t.$t("editTitle")))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium modal-content-custom",attrs:{id:"modal-content-id-1"}},[s("div",{staticClass:"slds-form-element__control new-name-section"},[s("limited-input",{attrs:{content:t.newMsgName,sum:80},on:{"formated-text":function(e){return t.formatedText(e)}}})],1)]),t._v(" "),s("footer",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSavingName},on:{click:function(e){return t.closeModal()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isSavingName||t.newMsgName.length<=0},on:{click:function(e){return t.saveMsgName()}}},[t._v(t._s(t.$t("global.saveBtn")))])])])]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open",attrs:{id:"Modal"}})])}),[],!1,null,"36c0ffa8",null);"function"==typeof z.default&&Object(z.default)(J);var G=J.exports,K={name:"sync-menu",props:{items:{type:Array,required:!0,default:()=>[]},label:{type:String,required:!0,default:""}},data:()=>({showMenu:!1}),methods:{onClickSyncButton(){this.showMenu=!this.showMenu},onClickOutside(){this.showMenu=!1},onClickItem(t){this.$emit("click",t),this.showMenu=!1}}},Z=(s("4sRh"),Object(A.a)(K,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.onClickOutside,expression:"onClickOutside"}],staticClass:"slds-dropdown-trigger slds-dropdown-trigger_click slds-is-open",attrs:{id:"message-sync-menu"}},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.onClickSyncButton()}}},[t._v("\n    "+t._s(t.label)+"\n    "),s("icon",{staticClass:"slds-button__icon slds-button__icon_right",attrs:{name:"down","fill-color":"#706e6b",width:".8125rem",height:".8125rem"}})],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showMenu,expression:"showMenu"}],staticClass:"slds-dropdown slds-dropdown_actions slds-dropdown_right"},[s("ul",{staticClass:"slds-dropdown__list slds-dropdown_right",attrs:{role:"menu","aria-label":"Show More"}},t._l(t.items,(function(e,i){return s("li",{key:i,staticClass:"slds-dropdown__item",attrs:{role:"presentation"},on:{click:function(s){return t.onClickItem(e)}}},[s("a",{attrs:{href:"javascript:void(0);",role:"menuitem",tabindex:"0"}},[s("span",{staticClass:"slds-truncate item-label",attrs:{title:e.label}},[t._v(t._s(e.label))])])])})),0)])])}),[],!1,null,"6be9f96d",null).exports),Y=s("xt0/"),X=s("feiH"),Q=s("CjVY"),tt=s.n(Q),et=s("L2JU"),st=s("cybb");const it={template:'<div class="slds-grid slds-grid_align-center message-actions-container"><div :title="btnTitle.edit" v-if="showEditButton" class="stru-edit-icon" @click="edit()"><icon name="editIcon" width="20px" height="20px" fill-color="#ffffff"></icon></div><div :title="btnTitle.copy" class="copy-icon" @click="copyId()"><icon name="copy" width="20px" height="20px" fill-color="#ffffff"></icon></div><div :title="btnTitle.del" class="delete-icon" @click="deleteMessage()"><icon name="deleteIcon" width="20px" height="20px" fill-color="#ffffff"></icon></div></div>',props:{messageId:{type:String,default:""},structuredMessageType:{type:String,default:""},showEditButton:{type:Boolean,default:!1},messageName:{type:String,default:""},btnTitle:{type:Object,default:{}}},methods:{deleteMessage(){this.$emit("delete",this.messageId)},edit(){this.messageName?this.$emit("change-name",this.messageName,this.messageId):this.$emit("edit",this.structuredMessageType,this.messageId)},copyId(){this.$emit("copy-id",this.messageId)}}};var at={mixins:[X.a,y.a],components:{LimitedTextarea:g.a,NoRecord:f.a,LoadingSpinner:w.a,NewStructureMessage:C.a,NewMiniProPopup:F,InputSelect:b.a,Dropdown:_.a,EditBox:it,StruMessageDetail:j.a,VideoDetailCard:B.VideoDetailCard,VoiceDetailCard:U.VoiceDetailCard,MiniProgramDetail:R.a,PreviewMsgModal:H.a,Pagination:v.a,VideoPlayModal:V.a,ChangeNameModal:G,SyncMenu:Z,MessageUploader:L.a,ImagePreview:Y.ImagePreview},computed:m()({},Object(et.c)({unreadCount:"livechat/unreadCount",currentAccount:"sidebar/currentAccount",currentUser:"user/currentUser"}),{leaveConfirmTitle:function(){return"new"===this.struCreatedInfo.type?this.$t("createStrucMsgLabel"):this.$t("editStrucMsgLabel")},isMiniProgramAcc(){return"Mini Program"===this.currentAccount.Type},filterMsgTypes(){if(this.isMiniProgramAcc){var t;let e=["IMAGES","MINI PROGRAM PAGES","TEXTS"];return h()(t=this.msgTypes).call(t,t=>d()(e).call(e,t.name)>-1)}return this.msgTypes},searchLabel(){return{"STRUCTURED MESSAGES":this.$t("searchStrucMsgLabel"),IMAGES:this.$t("searchImageLabel"),"VOICE CLIPS":this.$t("searchVoiceLabel"),VIDEOS:this.$t("searchVideoLabel"),TEXTS:this.$t("searchTextLabel"),"MINI PROGRAM PAGES":this.$t("searchMiniProgramLabel")}[this.currentType]},currentUploadMsgType(){return"IMAGES"===this.currentType?"image":"VIDEOS"===this.currentType?"video":"VOICE CLIPS"===this.currentType?"voice":""},isMessageUploaderVisible(){return"IMAGES"===this.currentType||"VIDEOS"===this.currentType||"VOICE CLIPS"===this.currentType}}),inject:["showErrorImg"],data(){return{msgTypes:[{name:"STRUCTURED MESSAGES",label:this.$t("strucMsgLabel")},{name:"IMAGES",label:this.$t("imageLabel")},{name:"MINI PROGRAM PAGES",label:this.$t("miniProgramPagesLabel")},{name:"VOICE CLIPS",label:this.$t("voiceLabel")},{name:"VIDEOS",label:this.$t("videoLabel")},{name:"TEXTS",label:this.$t("textLabel")}],currentType:"STRUCTURED MESSAGES",structureMsgSyncItems:[{label:this.$t("allLabel"),value:"All"},{label:this.$t("lastModifiedTenLabel"),value:"10"},{label:this.$t("lastModifiedFiftyLabel"),value:"50"}],messageTypes:["Image","Video","Voice Message","Structured Message","Text Message","Mini Program Page"],messages:[],totalMessage:0,hasMoreMessage:!1,currentMessagesPagination:[],currentPageNumber:1,structureMessageCount:12,imageCount:56,videoCount:20,voiceCount:20,textCount:20,miniProgramCount:12,searchKey:"",isInitMessageLoading:!0,canSync:!0,syncPopupHeader:"",syncPopupContent:"",waitSyncConfirm:this.$t("global.syncNotifyContent"),currentPlayVideo:"",viewImage:!1,currentViewImage:{},previewImgIcon:s("wUCt"),isShowNewTextPopup:!1,newsType:null,textMsgId:"",textMsgTextBody:"",canSaveTextMsg:!0,canSave:!1,textPopupTitle:"",showNewStructureMessage:!1,showNewMiniProgramPage:!1,isSavingStru:!1,struCreatedInfo:{type:"new",id:null},miniProCreatedInfo:{type:"new",id:null},structuredType:"All",structuredFilterOption:[],currentFilterOptions:[{Name:this.$t("allLabel")}],deleteMessageConfirm:"",previewedMsgId:"",fetchWatcher:null,showChangeNameModal:!1,currentMsgName:"",currentMsgId:"",btnTitle:{edit:this.$t("global.editBtn"),copy:this.$t("global.copyIDLabel"),del:this.$t("global.deleteBtn")},textLimit:2e3,syncCount:""}},mounted(){if("message-new-structured-messages"===this.$route.name){const t=this.$watch("isInitMessageLoading",e=>{e||(this.showCreatedStruModal(),t())})}},created(){this.switchAccount({wechatAccountId:this.$route.params.accountId,router:this.$router}),l.a.all([this.initData(),this.getStatus()])},watch:{currentPageNumber:function(){this.initData({currentPageNumber:this.currentPageNumber})}},methods:m()({},Object(et.b)("sidebar",["switchAccount"]),{async getStatus(){try{const t=await Object(M.d)();if(t.ok){const e=JSON.parse(k.a.unescape(t.data));this.structuredFilterOption=e.StructuredMessageType,this.structuredFilterOption.unshift({Name:this.$t("allLabel"),Value:"All"})}else Object(N.f)(t)}catch(t){Object(N.f)(t)}},initData(){let{currentPageNumber:t=1,isNeedFetchData:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.accountId=this.$route.params.accountId,this.isInitMessageLoading=!0,this.currentPageNumber=t,e&&(this.$route.path==="/".concat(this.accountId,"/message/structured-messages")||this.$route.path==="/".concat(this.accountId,"/message/structured-messages/new")?(this.currentType="STRUCTURED MESSAGES",this.fetchMessages(this.structureMessageCount,this.messageTypes[3])):this.$route.path==="/".concat(this.accountId,"/message/images")?(this.currentType="IMAGES",this.fetchMessages(this.imageCount,this.messageTypes[0])):this.$route.path==="/".concat(this.accountId,"/message/voices")?(this.currentType="VOICE CLIPS",this.fetchMessages(this.voiceCount,this.messageTypes[2])):this.$route.path==="/".concat(this.accountId,"/message/videos")?(this.currentType="VIDEOS",this.fetchMessages(this.videoCount,this.messageTypes[1])):this.$route.path==="/".concat(this.accountId,"/message/texts")?(this.currentType="TEXTS",this.fetchMessages(this.textCount,this.messageTypes[4])):this.$route.path==="/".concat(this.accountId,"/message/mini-program-pages")&&(this.currentType="MINI PROGRAM PAGES",this.fetchMessages(this.miniProgramCount,this.messageTypes[5])))},changeTab(t){this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1;const e=()=>{this.currentType=t,this.isInitMessageLoading=!0,this.currentPageNumber=1,this.searchKey="",this.$refs.searchInput.value="",this.showNewStructureMessage&&(this.showNewStructureMessage=!1),"VOICE CLIPS"!==this.currentType&&this.clearPlayAudio(),this.getMessagesData()};if(this.showNewStructureMessage){this.$refs.quillEditor.checkDifferent()?(this.$refs.sureToSaveStruConfirm.open(),this.$on("cancelSaveStru",()=>{this.showNewStructureMessage=!1,e(),this.$off("cancelSaveStru")})):e()}else e();this.structuredType="All",this.currentFilterOptions=[{Name:this.$t("allLabel")}]},async fetchMessages(t,e){try{const s=await P.k.getMessagesWithPaging({wechatAccountId:this.accountId,pageNumber:this.currentPageNumber,pageSize:t,type:e,keyword:this.searchKey,filter:this.structuredType});if(this.messages=s.messages,"VOICE CLIPS"===this.currentType)for(const t of this.messages)this.$set(t,"imageIcon",this.defaultVoiceIcon);if(this.totalMessage=s.paging.total.Count,this.hasMoreMessage=s.paging.total.HasMore,this.currentMessagesPagination=s.paging.pages,"Structured Message"===e&&this.$nextTick((function(){this.renderGrid()})),"TEXTS"===this.currentType)for(let t of this.messages)t.textBodyTitle=tt.a.decorateText(t.textBody,"Plain Text")}catch(t){this.messages=[],this.totalMessage=0,this.currentMessagesPagination=[],this.$handleError(t)}finally{this.isInitMessageLoading=!1}},getMessagesData(){"STRUCTURED MESSAGES"===this.currentType?(this.structuredType="All",this.$router.replace({path:"/".concat(this.accountId,"/message/structured-messages")}),this.fetchMessages(this.structureMessageCount,this.messageTypes[3])):"IMAGES"===this.currentType?(this.$router.replace({path:"/".concat(this.accountId,"/message/images")}),this.fetchMessages(this.imageCount,this.messageTypes[0])):"VOICE CLIPS"===this.currentType?(this.$router.replace({path:"/".concat(this.accountId,"/message/voices")}),this.fetchMessages(this.voiceCount,this.messageTypes[2])):"VIDEOS"===this.currentType?(this.$router.replace({path:"/".concat(this.accountId,"/message/videos")}),this.fetchMessages(this.videoCount,this.messageTypes[1])):"TEXTS"===this.currentType?(this.$router.replace({path:"/".concat(this.accountId,"/message/texts")}),this.fetchMessages(this.textCount,this.messageTypes[4])):"MINI PROGRAM PAGES"===this.currentType&&(this.$router.replace({path:"/".concat(this.accountId,"/message/mini-program-pages")}),this.fetchMessages(this.miniProgramCount,this.messageTypes[5]))},target(t){this.currentPageNumber=t,document.getElementsByClassName("right-page-section")[0].scrollTop=0},searchMessages(){this.initData(),"VOICE CLIPS"===this.currentType&&this.clearPlayAudio()},openSyncMessageConfirmation(){let t="",e="";"STRUCTURED MESSAGES"===this.currentType?(t=this.$tc("strucMsgLowerLabel",1),e=this.$t("strucsMsgLabel")):"IMAGES"===this.currentType?(t=this.$tc("imageLowerLabel",1),e=this.$t("imagesLabel")):"VIDEOS"===this.currentType?(t=this.$tc("videoLowerLabel",1),e=this.$t("videosLabel")):"VOICE CLIPS"===this.currentType&&(t=this.$tc("voiceLowerLabel",1),e=this.$t("voicesLabel")),this.syncPopupHeader="".concat(this.$t("syncBtnLabel"))+t,this.syncPopupContent=this.$t("syncContentLabel",[e]),this.$refs.sureToSyncPopup.open()},getMenuItems(t){return[{value:"Edit",label:this.$t("global.editBtn"),target:t},{value:"CopyID",label:this.$t("global.copyIDLabel"),target:t},{value:"Delete",label:this.$t("global.deleteBtn"),target:t}]},getDisplayedDatetime(t){return Object(st.e)(t,this.currentUser.TimeZoneSidKey)},onClickMenuItem(t){const{value:e,target:s}=t;"Edit"===e?this.openEditTextPopup(s):"CopyID"===e?this.$_charket_copyText(s.messageId,this.$t("global.copySuccess"),this.$t("global.copyFailed")):"Delete"===e&&this.deleteLibraryMessage(s.messageId)},openEditTextPopup(t){t?(this.textMsgId=t.messageId,this.textMsgTextBody=t.textBody,this.textPopupTitle=this.$t("editTextMsgLabel")):(this.textMsgTextBody="",this.textMsgId="",this.textPopupTitle=this.$t("createTextMsgLabel")),this.isShowNewTextPopup=!0,this.isInitMessageLoading=!1},closeEditTextPopup(){this.isShowNewTextPopup=!1},async saveTextMsg(){if(this.canSaveTextMsg=!1,this.textMsgId)try{const t=await Object(M.k)(this.textMsgTextBody,this.textMsgId);t.ok?(this.isShowNewTextPopup=!1,this.$router.app.$emit("open-toast-notification",{content:this.$t("yourSaveLabel"),type:"success"}),this.initData()):Object(N.f)(t),this.canSaveTextMsg=!0}catch(t){Object(N.f)(t),this.canSaveTextMsg=!0}else try{const t=await Object(M.g)(this.accountId,this.textMsgTextBody);t.ok?(this.isShowNewTextPopup=!1,this.$router.app.$emit("open-toast-notification",{content:this.$t("textMsgSaveLabel"),type:"success"}),this.initData()):Object(N.f)(t),this.canSaveTextMsg=!0}catch(t){this.canSaveTextMsg=!0,Object(N.f)(t)}},async confirmSyncMessages(){this.canSync=!1;try{await P.k.sync({type:this.currentType,wechatAccountId:this.accountId,count:this.syncCount}),this.$refs.waitSyncConfirm.open()}catch(t){Object(N.f)(t)}finally{this.$refs.sureToSyncPopup.close(),this.canSync=!0,this.syncCount=""}},closeWaitConfirm(){this.$refs.waitSyncConfirm.close()},closePlayVideo(){this.currentPlayVideo=""},playAudio(t){const e=document.querySelector("#voiceLibraryAudio");this.toPlayAudio(t,e)},clearPlayAudio(){const t=document.querySelector("#voiceLibraryAudio");this.toClearAudio(t)},playVideo(t){t.url&&(this.currentPlayVideo=t)},viewCurrentImage(t){this.currentViewImage=t,this.$refs.ImagePreview.open()},renderGrid(){this.$nextTick(()=>{const t=document.getElementsByClassName("select-news-li");let e,s,i=0;for(let a=0;a<t.length;a++)a>0&&(t[a-3]&&(e=t[a-3].offsetTop+t[a-3].offsetHeight+20,t[a].style.top=e+"px"),a%3>0&&(s=t[a-1].offsetLeft+t[a-1].offsetWidth+20,t[a].style.left=s+"px")),i=Math.max(i,t[a].offsetTop+t[a].offsetHeight);const a=document.getElementsByClassName("msg-middle")[0];a&&(a.style.height=i+"px")})},clearSearchText(){this.searchKey="",this.initData()},createStructureMessage(t){this.newsType=t,this.struCreatedInfo.type="new",this.struCreatedInfo.id=null,this.$refs.newStruPopup.close(),this.showNewStructureMessage=!0},cancelCreatingStru(){this.$refs.quillEditor.checkDifferent()?(this.$refs.sureToSaveStruConfirm.open(),this.$on("cancelSaveStru",()=>{this.$refs.sureToSaveStruConfirm.close(),this.showNewStructureMessage=!1,this.struCreatedInfo.type="new",this.$off("stayOnEdit"),this.$off("cancelSaveStru")})):this.showNewStructureMessage=!1},showCreatedStruModal(){this.newsType=null,this.$refs.newStruPopup.open()},waitToFetchData(){this.fetchWatcher&&this.fetchWatcher(),this.fetchWatcher=this.$watch("showNewStructureMessage",()=>{this.initData(),this.fetchWatcher(),this.fetchWatcher=null})},async saveStructureMessage(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$refs.sureToSaveStruConfirm.close(),this.isSavingStru=!0;const e=this.$refs.quillEditor.getEditorContent();if(e){for(let t of e.wechatAttachment){var s;t.url&&d()(s=t.url).call(s,"/servlet/servlet.FileDownload?file=")>-1?t.attachmentId=t.url.match(/file=(\S*)/)[1]:t.attachmentId="","mpnews"===this.newsType&&delete t.url}if("new"===this.struCreatedInfo.type)try{const s=await Object(M.f)(this.accountId,o()(e),this.newsType);if(this.isSavingStru=!1,s.ok)if(t){this.struCreatedInfo.type="edit";const t=JSON.parse(k.a.unescape(s.data));this.previewedMsgId=t.Id;let e=await Object(M.c)(this.previewedMsgId);this.$refs.quillEditor.dealWithEditstru(JSON.parse(k.a.unescape(e.data))),this.waitToFetchData()}else this.showNewStructureMessage=!1,this.$router.app.$emit("open-toast-notification",{content:this.$t("strucMsgSaveLabel"),type:"success"}),this.initData();else t&&this.$refs.previewModal.close(),Object(N.f)(s)}catch(e){this.isSavingStru=!1,t&&this.$refs.previewModal.close(),Object(N.f)(e)}else if("edit"===this.struCreatedInfo.type){if(this.$refs.quillEditor.checkDifferent())try{const s=await Object(M.j)(this.accountId,o()(e),this.newsType);if(this.isSavingStru=!1,s.ok)if(t){const t=JSON.parse(k.a.unescape(s.data));this.previewedMsgId=t.Id;let e=await Object(M.c)(this.previewedMsgId);this.$refs.quillEditor.dealWithEditstru(JSON.parse(k.a.unescape(e.data))),this.waitToFetchData()}else this.showNewStructureMessage=!1,this.$router.app.$emit("open-toast-notification",{content:this.$t("strucMsgUpdateLabel"),type:"success"}),this.initData();else Object(N.f)(s),t&&this.$refs.previewModal.close()}catch(e){this.isSavingStru=!1,t&&this.$refs.previewModal.close(),Object(N.f)(e)}else this.showNewStructureMessage=!1,this.isSavingStru=!1}}else this.isSavingStru=!1},previewStruMsg(){const t=this.$refs.quillEditor.checkDifferent(),e=this.$refs.quillEditor.getEditorContent();if(t&&e)this.saveStructureMessage(!0),this.$refs.previewModal.open();else{const t=this.$refs.quillEditor.getEditorContent();if(t){const e=t;this.previewedMsgId=e.messageId,this.$refs.quillEditor.dealWithEditstru(e),this.$refs.previewModal.open()}}},deleteLibraryMessage(t){var e;this.$refs.deleteStruConfirm.open();let s=null,i=null;"STRUCTURED MESSAGES"===this.currentType?(s=this.$tc("strucMsgLowerLabel",2),i=this.$tc("strucMsgLowerLabel",1)):"IMAGES"===this.currentType?(s=this.$tc("imageLowerLabel",2),i=this.$tc("imageLowerLabel",1)):"VOICE CLIPS"===this.currentType?(s=this.$tc("voiceLowerLabel",2),i=this.$tc("voiceLowerLabel",1)):"VIDEOS"===this.currentType?(s=this.$tc("videoLowerLabel",2),i=this.$tc("videoLowerLabel",1)):"TEXTS"===this.currentType?(s=this.$tc("textLowerLabel",2),i=this.$tc("textLowerLabel",1)):"MINI PROGRAM PAGES"===this.currentType&&(s=this.$tc("miniProgramLowerLabel",2),i=this.$tc("miniProgramLowerLabel",1)),this.deleteMessageConfirm=a()(e="".concat(this.$t("deleteModalTitleLabel"))).call(e,s,"?"),this.$on("deleteStru",async()=>{this.$off("deleteStru");try{const s=await Object(M.a)(t);var e;if(s.ok)this.initData(),this.$router.app.$emit("open-toast-notification",{content:a()(e="".concat(i)).call(e,this.$t("msgDeleteLabel")),type:"success"});else Object(N.f)(s)}catch(t){Object(N.f)(t)}})},sureToDeleteStru(){this.$refs.deleteStruConfirm.close(),this.$emit("deleteStru")},editStructureMessage(t,e){this.newsType="WeChat Structured Message"===t?"mpnews":"news",this.struCreatedInfo={type:"edit",id:e},this.showNewStructureMessage=!0},cancelToSaveStru(){this.$emit("cancelSaveStru"),this.$refs.sureToSaveStruConfirm.close()},stayOnEditStru(){this.$refs.sureToSaveStruConfirm.close()},closeLeaveConfirm(){this.$emit("stayOnEdit")},selectPicklist(t){this.currentFilterOptions=t,this.structuredType=t[0].Value,this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1,this.initData()},onLimitedTextareaChange(t){let{content:e,size:s}=t;this.textMsgTextBody=e,this.canSave=!(0===s||s>this.textLimit)},showCreatedMiniProgramPage(){this.miniProCreatedInfo={type:"new",id:null},this.showNewMiniProgramPage=!0},editMiniProgramPage(t,e){this.miniProCreatedInfo={type:"edit",id:e},this.showNewMiniProgramPage=!0},closeMiniProPopup(t){this.showNewMiniProgramPage=!1,t&&this.initData()},changeMsgName(t,e){this.showChangeNameModal=!0,this.currentMsgName=t,this.currentMsgId=e},closeChangeName(t){this.showChangeNameModal=!1,t&&this.initData()},decorateTextMessage:t=>tt.a.decorateText(t),onClickSyncMenu(t){this.syncCount=t.value,this.openSyncMessageConfirmation()},onUploadCompleted(t){this.$root.$emit("upload-file-success"),this.changeTab(this.currentType),this.initData({isNeedFetchData:!1}),this.$root.$emit("open-toast-notification",{content:this.$t("fileSaveLabel"),type:"success"})},onClickCancelSync(){this.$refs.sureToSyncPopup.close()},onClickCancelDelete(){this.$refs.deleteStruConfirm.close()}}),beforeRouteLeave(t,e,s){var i;let a=!1;this.showNewStructureMessage&&(a=this.$refs.quillEditor.checkDifferent()),!this.showNewStructureMessage&&d()(i=t.path).call(i,"\\".concat(this.accountId,"\\message")<0)||!a?s(!0):(this.$refs.sureToSaveStruConfirm.open(),this.$on("cancelSaveStru",()=>{s(!0),this.$off("stayOnEdit"),this.$off("cancelSaveStru")}),this.$on("stayOnEdit",()=>{s(!1),this.$off("cancelSaveStru"),this.$off("stayOnEdit")}))}},nt=(s("MODQ"),s("jjsR"),s("o4o+")),ot=Object(A.a)(at,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"message-library-page",attrs:{id:"charket-message-library"}},[s("ld-modal",{ref:"newStruPopup",staticClass:"new-stru-container",attrs:{title:t.$t("newStrucMsgLabel"),footless:!0},scopedSlots:t._u([{key:"content",fn:function(){return[s("div",{staticClass:"slds-p-around_medium"},[s("div",{staticClass:"slds-grid slds-grid_align-spread new-stru-popup",class:{"slds-grid_align-space":t.isMiniProgramAcc},attrs:{slot:"modalMainContent"},slot:"modalMainContent"},[t.isMiniProgramAcc?t._e():s("div",{staticClass:"slds-grid slds-grid_vertical wechat",on:{click:function(e){return t.createStructureMessage("mpnews")}}},[s("div",{staticClass:"icon"},[s("icon",{attrs:{name:"weChatStru",height:"80px",width:"70px","fill-color":"#ffffff"}})],1),t._v(" "),s("div",{staticClass:"title"},[t._v("\n              "+t._s(t.$t("articleLabel"))+"\n            ")]),t._v(" "),s("div",{staticClass:"description"},[t._v("\n              "+t._s(t.$t("syncMsgLabel"))+"\n            ")])]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical link",on:{click:function(e){return t.createStructureMessage("news")}}},[s("div",{staticClass:"icon"},[s("icon",{attrs:{name:"linkStru",height:"80px",width:"70px","fill-color":"#ffffff"}})],1),t._v(" "),s("div",{staticClass:"title"},[t._v("\n              "+t._s(t.$t("linkMsgLabel"))+"\n            ")]),t._v(" "),s("div",{staticClass:"description"},[t._v("\n              "+t._s(t.$t("sfMsgLabel"))+"\n            ")])])])])]},proxy:!0}])}),t._v(" "),s("scoped-tabs",{attrs:{tabs:t.filterMsgTypes,"current-tab-name":t.currentType},on:{switch:t.changeTab}},[s("div",{attrs:{slot:"button-group"},slot:"button-group"},["TEXTS"===t.currentType||"MINI PROGRAM PAGES"===t.currentType||t.showNewStructureMessage||t.isMiniProgramAcc?t._e():s("sync-menu",{attrs:{items:t.structureMsgSyncItems,label:t.$t("global.syncBtn")},on:{click:t.onClickSyncMenu}}),t._v(" "),"TEXTS"===t.currentType?s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.openEditTextPopup()}}},[t._v(t._s(t.$t("global.newBtn")))]):t._e(),t._v(" "),t.isMessageUploaderVisible?s("message-uploader",{staticClass:"slds-button slds-button_neutral upload-file-btn",attrs:{type:t.currentUploadMsgType,"wechat-account-id":t.accountId},on:{completed:t.onUploadCompleted}},[s("span",{staticClass:"upload-file-btn__label"},[t._v(t._s(t.$t("global.newBtn")))])]):t._e(),t._v(" "),"MINI PROGRAM PAGES"===t.currentType?s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.showCreatedMiniProgramPage()}}},[t._v(t._s(t.$t("global.newBtn")))]):t._e(),t._v(" "),"STRUCTURED MESSAGES"!==t.currentType||t.showNewStructureMessage?t._e():s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.showCreatedStruModal()}}},[t._v(t._s(t.$t("global.newBtn")))]),t._v(" "),"STRUCTURED MESSAGES"===t.currentType&&t.showNewStructureMessage?s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSavingStru},on:{click:function(e){return t.cancelCreatingStru()}}},[t._v(t._s(t.$t("global.cancelBtn")))]):t._e(),t._v(" "),"STRUCTURED MESSAGES"===t.currentType&&t.showNewStructureMessage&&"mpnews"===t.newsType?s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSavingStru},on:{click:function(e){return t.previewStruMsg()}}},[t._v(t._s(t.$t("savePreviewLabel")))]):t._e(),t._v(" "),"STRUCTURED MESSAGES"===t.currentType&&t.showNewStructureMessage?s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isSavingStru},on:{click:function(e){return t.saveStructureMessage(!1)}}},[t._v(t._s(t.$t("global.saveBtn")))]):t._e()],1)]),t._v(" "),s("loading-spinner",{attrs:{"is-loading":t.isInitMessageLoading,"custom-style":"top: 40px;"}}),t._v(" "),t.isInitMessageLoading||0!==t.totalMessage||t.showNewStructureMessage?t._e():s("no-record",{attrs:{"custom-style":"top: 80px"}}),t._v(" "),t.showNewMiniProgramPage?s("new-mini-pro-popup",{attrs:{createdInfo:t.miniProCreatedInfo,"account-id":t.accountId,"is-mini-pro":t.isMiniProgramAcc},on:{"close-mini-pro":t.closeMiniProPopup}}):t._e(),t._v(" "),"STRUCTURED MESSAGES"===t.currentType&&t.showNewStructureMessage?s("new-structure-message",{ref:"quillEditor",attrs:{newsType:t.newsType,createdInfo:t.struCreatedInfo}}):t._e(),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.showNewStructureMessage,expression:"!showNewStructureMessage"}],staticClass:"msg-page-list"},[s("div",{staticClass:"slds-grid slds-border_bottom struc-msg-header"},[t.totalMessage>1?s("div",{staticClass:"struc-msg-count"},[t._v(t._s(t._f("addSeparators")(t.totalMessage))),t.hasMoreMessage?s("i",{staticClass:"show-plus-sign"},[t._v("+")]):t._e(),t._v(" "+t._s(t.$tc("global.itemLabel",2))+"\n      ")]):t._e(),t._v(" "),t.totalMessage<=1?s("div",{staticClass:"struc-msg-count"},[t._v(t._s(t.totalMessage)+" "+t._s(t.$tc("global.itemLabel",1)))]):t._e(),t._v(" "),"STRUCTURED MESSAGES"!==t.currentType||t.showNewStructureMessage||t.isMiniProgramAcc?t._e():s("input-select",{attrs:{currents:t.currentFilterOptions},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}}),t._v(" "),s("div",{staticClass:"slds-col_bump-left struc-msg-search"},[s("search-input",{ref:"searchInput",attrs:{placeholder:t.searchLabel},on:{search:t.searchMessages,clear:t.clearSearchText},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}})],1)],1),t._v(" "),s("div",{staticClass:"msg-content slds-scrollable_y"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"STRUCTURED MESSAGES"===t.currentType&&!t.showNewStructureMessage,expression:"currentType === 'STRUCTURED MESSAGES' && !showNewStructureMessage"}],staticClass:"structured-messages-tab"},[t.isInitMessageLoading||0===t.totalMessage?t._e():s("div",{staticClass:"msg-middle structure-section"},[s("ul",{staticClass:"select-news-ul"},t._l(t.messages,(function(e){return s("li",{staticClass:"select-news-li"},[s("div",{staticClass:"toolbar"},[s("edit-box",{attrs:{"btn-title":t.btnTitle,"message-id":e.id,"show-edit-button":!0,"structured-message-type":e.type},on:{delete:t.deleteLibraryMessage,edit:t.editStructureMessage,"copy-id":function(e){t.$_charket_copyText(e,t.$t("global.copySuccess"),t.$t("global.copyFailed"))}}})],1),t._v(" "),s("stru-message-detail",{attrs:{"structure-message":e,"allow-actions":!0}})],1)})),0)])]),t._v(" "),"IMAGES"===t.currentType?s("div",{staticClass:"images-tab"},[t.isInitMessageLoading||0===t.totalMessage?t._e():s("div",{staticClass:"msg-middle image-msg-middle"},[s("ul",{staticClass:"slds-grid slds-wrap select-img-ul"},t._l(t.messages,(function(e){return s("li",{staticClass:"select-img-li"},[s("div",{staticClass:"li-img",class:{"li-img-bg":!e.url},on:{click:function(s){return t.viewCurrentImage(e)}}},[s("img",{attrs:{src:t._f("imgFilter")(e.url)},on:{error:function(e){return t.showErrorImg(e)}}})]),t._v(" "),s("div",{staticClass:"slds-truncate li-desc"},[t._v(t._s(e.name))]),t._v(" "),s("edit-box",{attrs:{"btn-title":t.btnTitle,"message-id":e.messageId,"show-edit-button":!0,"message-name":e.name},on:{delete:t.deleteLibraryMessage,"copy-id":function(e){t.$_charket_copyText(e,t.$t("global.copySuccess"),t.$t("global.copyFailed"))},"change-name":t.changeMsgName}})],1)})),0)])]):t._e(),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:"MINI PROGRAM PAGES"===t.currentType,expression:"currentType === 'MINI PROGRAM PAGES'"}],staticClass:"mini-program-tab"},[t.isInitMessageLoading||0===t.totalMessage?t._e():s("ul",{staticClass:"slds-grid slds-wrap select-mini-program-ul"},t._l(t.messages,(function(e){return s("li",{staticClass:"select-mini-program-li"},[s("div",{staticClass:"toolbar"},[s("edit-box",{attrs:{"btn-title":t.btnTitle,"message-id":e.messageId,"show-edit-button":!0},on:{delete:t.deleteLibraryMessage,edit:t.editMiniProgramPage,"copy-id":function(e){t.$_charket_copyText(e,t.$t("global.copySuccess"),t.$t("global.copyFailed"))}}})],1),t._v(" "),s("mini-program-detail",{attrs:{"mini-program-page":e}})],1)})),0)]),t._v(" "),"VOICE CLIPS"===t.currentType?s("div",{staticClass:"voices-tab"},[t.isInitMessageLoading||0===t.totalMessage?t._e():s("ul",{staticClass:"slds-grid slds-wrap message-voice-ul"},t._l(t.messages,(function(e){return s("li",{staticClass:"slds-grid message-voice-li"},[s("voice-detail-card",{attrs:{title:e.name,image:e.imageIcon,date:t._f("formatDatetimeFilter")(e.updateDateTime,t.$user.TimeZoneSidKey)},on:{play:function(s){return t.playAudio(e)}}}),t._v(" "),s("edit-box",{attrs:{"btn-title":t.btnTitle,"message-id":e.messageId,"show-edit-button":!0,"message-name":e.name},on:{delete:t.deleteLibraryMessage,"copy-id":function(e){t.$_charket_copyText(e,t.$t("global.copySuccess"),t.$t("global.copyFailed"))},"change-name":t.changeMsgName}})],1)})),0)]):t._e(),t._v(" "),"VIDEOS"===t.currentType?s("div",{staticClass:"videos-tab"},[t.isInitMessageLoading||0===t.totalMessage?t._e():s("ul",{staticClass:"slds-grid slds-wrap message-voice-ul"},t._l(t.messages,(function(e){return s("li",{staticClass:"message-video-li"},[s("video-detail-card",{attrs:{title:e.name,date:t.getDisplayedDatetime(e.updateDateTime),description:e.description},on:{play:function(s){return t.playVideo(e)}}}),t._v(" "),s("edit-box",{attrs:{"btn-title":t.btnTitle,"message-id":e.messageId},on:{delete:t.deleteLibraryMessage,"copy-id":function(e){t.$_charket_copyText(e,t.$t("global.copySuccess"),t.$t("global.copyFailed"))}}})],1)})),0)]):t._e(),t._v(" "),"TEXTS"===t.currentType?s("div",{staticClass:"texts-tab"},[t.isInitMessageLoading||0===t.totalMessage?t._e():s("table",{staticClass:"slds-table slds-table_bordered slds-no-row-hover table-top-line slds-table_fixed-layout",attrs:{role:"grid"}},[s("tbody",{staticClass:"text-table-body"},t._l(t.messages,(function(e){return s("tr",{staticClass:"slds-hint-parent"},[s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate text-body",attrs:{title:e.textBodyTitle},domProps:{innerHTML:t._s(t.decorateTextMessage(e.textBody))}})]),t._v(" "),s("td",{staticClass:"td-position",staticStyle:{width:"3.25rem"},attrs:{role:"gridcell"}},[s("ld-action-menu",{attrs:{items:t.getMenuItems(e)},on:{click:function(e){return t.onClickMenuItem(e)}}})],1)])})),0)])]):t._e(),t._v(" "),t.isInitMessageLoading||t.showNewStructureMessage?t._e():s("pagination",{attrs:{paginations:t.currentMessagesPagination,"page-number":t.currentPageNumber},on:{target:t.target}})],1)]),t._v(" "),s("ld-modal",{ref:"sureToSyncPopup",attrs:{title:t.syncPopupHeader},scopedSlots:t._u([{key:"content",fn:function(){return[s("p",{staticClass:"slds-p-around_medium slds-align_absolute-center"},[t._v(t._s(t.syncPopupContent))])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{neutral:"",disabled:!t.canSync},on:{click:function(e){return t.onClickCancelSync()}}},[t._v("\n        "+t._s(t.$t("global.cancelBtn"))+"\n      ")]),t._v(" "),s("ld-button",{attrs:{brand:"",disabled:!t.canSync},on:{click:function(e){return t.confirmSyncMessages()}}},[t._v("\n        "+t._s(t.$t("global.syncBtn"))+"\n      ")])]},proxy:!0}])}),t._v(" "),s("ld-modal",{ref:"waitSyncConfirm",attrs:{title:t.syncPopupHeader},scopedSlots:t._u([{key:"content",fn:function(){return[s("p",{staticClass:"slds-p-around_medium slds-align_absolute-center"},[t._v(t._s(t.waitSyncConfirm))])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{brand:""},on:{click:function(e){return t.closeWaitConfirm()}}},[t._v("\n        "+t._s(t.$t("global.confirmBtn"))+"\n      ")])]},proxy:!0}])}),t._v(" "),s("ld-modal",{ref:"deleteStruConfirm",attrs:{title:t.$t("deleteMsgLabel")},scopedSlots:t._u([{key:"content",fn:function(){return[s("p",{staticClass:"slds-p-around_medium slds-align_absolute-center"},[t._v(t._s(t.deleteMessageConfirm))])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{neutral:""},on:{click:function(e){return t.onClickCancelDelete()}}},[t._v("\n        "+t._s(t.$t("global.cancelBtn"))+"\n      ")]),t._v(" "),s("ld-button",{attrs:{brand:""},on:{click:function(e){return t.sureToDeleteStru()}}},[t._v("\n        "+t._s(t.$t("global.deleteBtn"))+"\n      ")])]},proxy:!0}])}),t._v(" "),s("ld-modal",{ref:"sureToSaveStruConfirm",attrs:{title:t.leaveConfirmTitle},on:{close:t.closeLeaveConfirm},scopedSlots:t._u([{key:"content",fn:function(){return[s("p",{staticClass:"slds-p-around_medium slds-align_absolute-center"},[t._v(t._s(t.$t("unsavedLabel")))])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{neutral:""},on:{click:function(e){return t.cancelToSaveStru()}}},[t._v("\n        "+t._s(t.$t("discardChangeLabel"))+"\n      ")]),t._v(" "),s("ld-button",{attrs:{brand:""},on:{click:function(e){return t.stayOnEditStru()}}},[t._v("\n        "+t._s(t.$t("stayPageLabel"))+"\n      ")])]},proxy:!0}])}),t._v(" "),t.isShowNewTextPopup?s("div",[s("div",{staticClass:"slds-modal slds-modal_large slds-fade-in-open",attrs:{"aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container show-selected-container new-width",attrs:{role:"document",tabindex:"0"}},[s("div",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close",on:{click:function(e){return t.closeEditTextPopup()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.textPopupTitle))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium new-height"},[s("limited-textarea",{attrs:{content:t.textMsgTextBody,sum:t.textLimit},on:{change:t.onLimitedTextareaChange}})],1),t._v(" "),s("div",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:!t.canSaveTextMsg},on:{click:function(e){return t.closeEditTextPopup()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:!t.canSaveTextMsg||!t.canSave},on:{click:function(e){return t.saveTextMsg()}}},[t._v(t._s(t.$t("global.saveBtn")))])])])]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open",attrs:{id:"ShowPreview"}})]):t._e(),t._v(" "),""!==t.currentPlayVideo?s("video-play-modal",{attrs:{"current-play-video":t.currentPlayVideo},on:{close:function(e){return t.closePlayVideo()}}}):t._e(),t._v(" "),s("audio",{attrs:{src:t.currentPlayAudio.url,id:"voiceLibraryAudio"}}),t._v(" "),s("image-preview",{ref:"ImagePreview",attrs:{url:t._f("imgFilter")(t.currentViewImage.url),name:t.currentViewImage.name}}),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.structuredFilterOption,currents:t.currentFilterOptions,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e(),t._v(" "),s("preview-msg-modal",{ref:"previewModal",attrs:{"account-id":t.accountId,"previewed-msg-id":t.previewedMsgId,"is-saving":t.isSavingStru}}),t._v(" "),t.showChangeNameModal?s("change-name-modal",{attrs:{"current-msg-name":t.currentMsgName,"current-msg-id":t.currentMsgId},on:{"close-change-name":t.closeChangeName}}):t._e()],1)}),[],!1,null,"834acf3a",null);"function"==typeof nt.default&&Object(nt.default)(ot);e.default=ot.exports},DR4q:function(t,e,s){"use strict";var i=s("hG8I"),a=s.n(i);e.default=a.a},Dk61:function(t,e,s){"use strict";var i=s("I0LH"),a=s.n(i);e.default=a.a},E4UP:function(t,e,s){"use strict";var i=s("pI6M");s.n(i).a},EMO1:function(t,e,s){"use strict";var i=s("GfEe"),a=s.n(i),n=s("ip3M"),o=s.n(n),r=s("+dyS"),l=s.n(r),c=s("ejTr"),d=s.n(c),u=s("3O4B"),h=s.n(u),p=s("wG3i"),m=s.n(p),g=s("XmpP"),f={mixins:[s("dOfv").a]},v=(s("xecf"),s("KHd+")),w=s("pehn"),b=Object(v.a)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"rich-editor-page"},[s("div",{staticClass:"slds-grid slds-grid_vertical editor-toolbar"},[s("div",{staticClass:"slds-grid top-bar"},[s("div",{staticClass:"slds-grid re-undo"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onUndo()}}},[s("icon",{attrs:{name:"undo",width:"17px",height:"17px","fill-color":0!==t.toolStates.undo?"#d0d0d0":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onRedo()}}},[s("icon",{attrs:{name:"redo",width:"17px",height:"17px","fill-color":0!==t.toolStates.redo?"#d0d0d0":"#aaa","charket-icon":""}})],1)]),t._v(" "),s("a",{staticClass:"slds-grid font-size",attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openFontSizeList()}}},[s("div",{staticClass:"font-size-value"},[t._v("\n          "+t._s(t.toolValues.fontsize)+"\n        ")]),t._v(" "),s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showFontSizeList,expression:"showFontSizeList"}],staticClass:"font-size-list"},t._l(t.fontSizeList,(function(e){return s("li",{style:{fontSize:e},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.onFontsizeChange(e)}}},[t._v(t._s(e))])})),0)],1),t._v(" "),s("div",{staticClass:"slds-grid quot-dash"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onBlockquote()}}},[s("icon",{attrs:{name:"quot",width:"17px",height:"17px","fill-color":t.toolStates.blockquote?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onHorizontal()}}},[s("icon",{attrs:{name:"dash",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}})],1)]),t._v(" "),s("div",{staticClass:"slds-grid clear-or-brush"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onRemoveFormat()}}},[s("icon",{attrs:{name:"clearFormat",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onFormatmatch()}}},[s("icon",{attrs:{name:"brushFormat",width:"17px",height:"17px","fill-color":t.toolStates.formatmatch?"#5268ee":"#aaa","charket-icon":""}})],1)]),t._v(" "),s("div",{staticClass:"insert-image"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.getImages()}}},[s("icon",{attrs:{name:"image",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}})],1)])]),t._v(" "),s("div",{staticClass:"slds-grid bottom-bar"},[s("div",{staticClass:"slds-grid slds-wrap font-style"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onBold()}}},[s("icon",{attrs:{name:"bold",width:"19px",height:"19px","fill-color":t.toolStates.bold?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onItalic()}}},[s("icon",{attrs:{name:"italic",width:"19px",height:"19px","fill-color":t.toolStates.italic?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onUnderline()}}},[s("icon",{attrs:{name:"underline",width:"19px",height:"19px","fill-color":t.toolStates.underline?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),s("div",{staticClass:"slds-grid font-color"},[s("a",{staticClass:"slds-grid slds-grid_vertical",attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onFontColor(t.recentForeColor.hex)}}},[s("icon",{attrs:{name:"textColor",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("div",{staticClass:"color-bar",style:{backgroundColor:t.recentForeColor.hex}})],1),t._v(" "),s("button",{attrs:{name:"button",type:"button",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openFontColorList()}}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("color-picker",{ref:"colorList",attrs:{value:t.recentForeColor.hex?t.recentForeColor:t.defaultColor},on:{"get-color":t.onFontColor}})],1),t._v(" "),s("div",{staticClass:"slds-grid bg-color"},[s("a",{staticClass:"slds-grid slds-grid_vertical",attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onBgColor(t.recentBackColor.hex)}}},[s("icon",{attrs:{name:"text",width:"15px",height:"15px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("div",{staticClass:"color-bar",style:{backgroundColor:t.recentBackColor.hex}})],1),t._v(" "),s("button",{attrs:{name:"button",type:"button",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openBgColorList()}}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("color-picker",{ref:"bgColorList",attrs:{value:t.recentBackColor.hex?t.recentBackColor:t.defaultColor},on:{"get-color":t.onBgColor}})],1)]),t._v(" "),s("div",{staticClass:"slds-grid style-paragraph"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onParagraphStyle("indent")}}},[s("icon",{attrs:{name:"textIndent",width:"17px",height:"17px","fill-color":t.toolStates.indent?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),t._l(t.paragraphStyle,(function(e){return s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(s){return s.preventDefault(),t.onParagraphStyle(e.value)}}},[s("icon",{attrs:{name:e.label,width:"17px",height:"17px","fill-color":t.toolValues.justify===e.value?"#5268ee":"#aaa","charket-icon":""}})],1)}))],2),t._v(" "),s("div",{staticClass:"slds-grid style-list"},[s("div",{staticClass:"ol-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openOlList()}}},[s("icon",{attrs:{name:"olList",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showOlList,expression:"showOlList"}]},t._l(t.toolOptions.orderedlist,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.setListStyle("ol",e.value)}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.insertunorderedlist===e.value,expression:"toolValues.insertunorderedlist === style.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)]),t._v(" "),s("div",{staticClass:"ul-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openUlList()}}},[s("icon",{attrs:{name:"ulList",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showUlList,expression:"showUlList"}]},t._l(t.toolOptions.unorderedlist,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.setListStyle("ul",e.value)}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.insertunorderedlist===e.value,expression:"toolValues.insertunorderedlist === style.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)])]),t._v(" "),s("div",{staticClass:"slds-grid paragraph-line-space"},[s("div",{staticClass:"line-height-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openLineHeightList()}}},[s("icon",{attrs:{name:"lineHeight",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showLineHeightList,expression:"showLineHeightList"}]},t._l(t.toolOptions.lineheight,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.onLineHeight(e.value)}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.lineheight===e.value,expression:"toolValues.lineheight === val.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)]),t._v(" "),s("div",{staticClass:"spacing-top-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openSpacingTopList()}}},[s("icon",{attrs:{name:"pMarginTop",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showSpacingTopList,expression:"showSpacingTopList"}]},t._l(t.toolOptions.rowspacing,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.onRowSpacing(e.value,"top")}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.rowspacingtop===e.value,expression:"toolValues.rowspacingtop === val.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)]),t._v(" "),s("div",{staticClass:"spacing-bottom-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openSpacingBottomList()}}},[s("icon",{attrs:{name:"pMarginBottom",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showSpacingBottomList,expression:"showSpacingBottomList"}]},t._l(t.toolOptions.rowspacing,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.onRowSpacing(e.value,"bottom")}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.rowspacingbottom===e.value,expression:"toolValues.rowspacingbottom === val.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)])]),t._v(" "),s("div",{staticClass:"slds-grid image-float"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onImageFloat("none")}}},[s("icon",{attrs:{name:"imageFloatNone",width:"17px",height:"17px","fill-color":t.imagefloatvisible?"#aaa":"#d0d0d0","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onImageFloat("left")}}},[s("icon",{attrs:{name:"imageFloatLeft",width:"17px",height:"17px","fill-color":t.imagefloatvisible?"#aaa":"#d0d0d0","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onImageFloat("center")}}},[s("icon",{attrs:{name:"imageFloatCenter",width:"17px",height:"17px","fill-color":t.imagefloatvisible?"#aaa":"#d0d0d0","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onImageFloat("right")}}},[s("icon",{attrs:{name:"imageFloatRight",width:"17px",height:"17px","fill-color":t.imagefloatvisible?"#aaa":"#d0d0d0","charket-icon":""}})],1)])])]),t._v(" "),s("div",{staticClass:"editor-container"},[s("div",{ref:"editor"})])])}),[],!1,null,"12dd7cd2",null);"function"==typeof w.default&&Object(w.default)(b);var _=b.exports,y=s("+BhS"),C=s("w2Vt"),S=s("Ktw+"),T=s("xEMq"),I=s("4B+h"),x=s("LQ5e"),L=s.n(x),M={components:{ImagePopup:y.a,Ueditor:_,LoadingSpinner:C.a,MessageUploader:S.a},props:{accountId:{type:String,default:()=>""},newsType:{type:String,defaut:"mpnews"},createdInfo:{type:Object,defaut:()=>({type:"new",id:null})},changeDocTitle:{type:Boolean,default:!0}},mixins:[g.a],inject:["showErrorImg"],async mounted(){if("edit"===this.createdInfo.type){this.isLoading=!0;try{const t=await Object(T.c)(this.createdInfo.id);t.ok?(this.dealWithEditstru(JSON.parse(L.a.unescape(t.data))),this.isLoading=!1):(this.isLoading=!1,Object(I.f)(t))}catch(t){this.isLoading=!1,Object(I.f)(t)}}else"new"===this.createdInfo.type&&(this.originalNews="mpnews"===this.newsType?JSON.parse(m()(this.mpNewsDetails)):JSON.parse(m()(this.newsDetails)),this.changeDocTitle&&("mpnews"===this.newsType?document.title="New WeChat Article":document.title="New Link Message"))},computed:{authorLength(){const t=this.mpNewsDetails.wechatAttachment[this.currentEditIndex].author;return this.getAuthorLength(t)},errorTop(){return("mpnews"===this.newsType?this.mpnewsErrorTop:12)+"px"},titlePadding(){return 8*("mpnews"===this.newsType?this.mpNewsDetails.wechatAttachment[this.currentEditIndex]:this.newsDetails.wechatAttachment[this.currentEditIndex]).title.length.toString().length+22+"px"},authorPadding(){const t=this.mpNewsDetails.wechatAttachment[this.currentEditIndex].author;return 7*this.getAuthorLength(t).toString().length+14+"px"},wechatAccountId(){return this.accountId||this.$route.params.accountId}},data:()=>({mpNewsDetails:{wechatAttachment:[{title:"",thumbnailId:"",author:"",description:"",showCoverPic:0,content:"",contentSourceUrl:"",viewedSourceUrl:!1,coverImgStyle:"full-width"}]},newsDetails:{wechatAttachment:[{title:"",description:"",url:"",structureMsgUrl:"",coverImgStyle:"full-width",thumbnailId:"",wechatImageUrl:""}]},originalNews:null,content:"",coverPictures:{},currentImageType:"",currentEditIndex:0,articlesTotal:1,errorObj:{titleEmpty:!1,titleOverLength:!1,authorOverLength:!1,contentEmpty:!1,contentSourceUrlEmpty:!1,coverImgEmpty:!1,summaryOverLength:!1,structuredMessageUrlEmpty:!1},isCoveredToolbar:!1,showErrorTip:!1,isLoading:!1,mpnewsErrorTop:88}),methods:{onUeditorChange(t){if(this.showErrorTip=!1,this.content=t,this.content){document.querySelector(".editor-container").classList.remove("container-empty")}},openImagePopup(t){this.showErrorTip=!1,this.currentImageType=t,this.$refs.imagepopupmodel.openModal("","image","")},dealWithEditstru(t){if("Link"===t.structuredMessageType){for(const e of t.wechatAttachment)e.coverImgStyle="full-width";t.attachmentIdsToDelete=[],this.newsDetails=t,this.originalNews=JSON.parse(m()(this.newsDetails))}else if("WeChat"===t.structuredMessageType){for(const e of t.wechatAttachment)this.coverPictures[e.thumbnailId]=e.url,e.viewedSourceUrl=!!e.contentSourceUrl,e.coverImgStyle="full-width";if(this.mpNewsDetails=t,this.content)this.mpNewsDetails.wechatAttachment[this.currentEditIndex].content=this.content,this.originalNews=JSON.parse(m()(this.mpNewsDetails));else{const t=this.$watch("content",()=>{this.mpNewsDetails.wechatAttachment[0].content=this.content,this.originalNews=JSON.parse(m()(this.mpNewsDetails)),t()});this.mpNewsDetails.wechatAttachment[0].content&&this.$refs.ueditor.updateContent(this.mpNewsDetails.wechatAttachment[0].content)}}this.articlesTotal=t.wechatAttachment.length},getSelectedMessage(t){"mpnews"===this.newsType?"coverPic"===this.currentImageType?(this.coverPictures[t[0].mediaId]=t[0].url,this.mpNewsDetails.wechatAttachment[this.currentEditIndex].thumbnailId=t[0].mediaId,this.mpNewsDetails.wechatAttachment[this.currentEditIndex].url=t[0].url):"contentPic"===this.currentImageType&&this.$refs.ueditor.inputImage(t[0].wechatImageUrl):(this.newsDetails.wechatAttachment[this.currentEditIndex].wechatImageUrl=t[0].wechatImageUrl,this.newsDetails.wechatAttachment[this.currentEditIndex].thumbnailId=t[0].mediaId,this.newsDetails.wechatAttachment[this.currentEditIndex].url=t[0].url)},changeCurrentEdit(t){if("mpnews"===this.newsType){if(this.mpNewsDetails.wechatAttachment[this.currentEditIndex].content=this.content,this.originalNews.wechatAttachment[t]&&this.mpNewsDetails.wechatAttachment[t].content===this.originalNews.wechatAttachment[t].content){const e=this.$watch("content",()=>{this.originalNews.wechatAttachment[t].content=this.content,e()})}this.$refs.ueditor.updateContent(this.mpNewsDetails.wechatAttachment[t].content)}this.currentEditIndex=t},addNewArticle(){"mpnews"===this.newsType?this.mpNewsDetails.wechatAttachment.push({title:"",thumbnailId:"",author:"",description:"",showCoverPic:0,content:null,contentSourceUrl:"",viewedSourceUrl:!1,coverImgStyle:"full-width"}):"news"===this.newsType&&this.newsDetails.wechatAttachment.push({title:"",description:"",url:"",structureMsgUrl:"",order:this.articlesTotal,coverImgStyle:"full-width",wechatImageUrl:""}),this.articlesTotal++,this.changeCurrentEdit(this.articlesTotal-1)},sortArticle(t,e){"mpnews"===this.newsType&&(this.mpNewsDetails.wechatAttachment[this.currentEditIndex].content=this.content);const s="mpnews"===this.newsType?this.mpNewsDetails:this.newsDetails;if("up"===e){var i,a;const e=h()(i=s.wechatAttachment).call(i,t-1,1);h()(a=s.wechatAttachment).call(a,t,0,e[0]),this.currentEditIndex===t?(this.currentEditIndex=t-1,this.changeCurrentEdit(this.currentEditIndex)):this.currentEditIndex===t-1&&(this.currentEditIndex=t,this.changeCurrentEdit(this.currentEditIndex))}else{var n,o;const e=h()(n=s.wechatAttachment).call(n,t+1,1);h()(o=s.wechatAttachment).call(o,t,0,e[0]),this.currentEditIndex===t?(this.currentEditIndex=t+1,this.changeCurrentEdit(this.currentEditIndex)):this.currentEditIndex===t+1&&(this.currentEditIndex=t,this.changeCurrentEdit(this.currentEditIndex))}},deleteArticle(t){if(this.changeCurrentEdit(t),this.articlesTotal--,"edit"===this.createdInfo.type&&"news"===this.newsType&&this.newsDetails.wechatAttachment[t].wechatAttachmentId&&(this.newsDetails.attachmentIdsToDelete.push(this.newsDetails.wechatAttachment[t].wechatAttachmentId),this.newsDetails.wechatAttachment[t].order<this.newsDetails.wechatAttachment.length-1))for(const e of this.newsDetails.wechatAttachment)e.order>this.newsDetails.wechatAttachment[t].order&&e.order--;var e,s;"mpnews"===this.newsType?h()(e=this.mpNewsDetails.wechatAttachment).call(e,t,1):h()(s=this.newsDetails.wechatAttachment).call(s,t,1);this.currentEditIndex===t&&(this.currentEditIndex=t-1,"mpnews"===this.newsType&&this.$refs.ueditor.updateContent(this.mpNewsDetails.wechatAttachment[t-1].content))},deleteCoverImage(){"mpnews"===this.newsType?this.mpNewsDetails.wechatAttachment[this.currentEditIndex].thumbnailId="":(this.newsDetails.wechatAttachment[this.currentEditIndex].url="",this.newsDetails.wechatAttachment[this.currentEditIndex].wechatImageUrl="")},getAuthorLength(t){let e=0;if(t){for(let s=0;s<t.length;s++)t.charCodeAt(s)>127||94===t.charCodeAt(s)?e+=2:e+=1;return Math.ceil(e/2)}return 0},imgLoad(t){const e=t.target.offsetHeight,s=t.target.offsetWidth,i="mpnews"===this.newsType?this.mpNewsDetails:this.newsDetails;0===this.currentEditIndex?i.wechatAttachment[this.currentEditIndex].coverImgStyle=e/s>=5/9?"full-width":"full-height":i.wechatAttachment[this.currentEditIndex].coverImgStyle=e>=s?"full-width":"full-height"},checkDifferent(){"mpnews"===this.newsType&&(this.mpNewsDetails.wechatAttachment[this.currentEditIndex].content=this.content);const t="mpnews"===this.newsType?this.mpNewsDetails:this.newsDetails;if(this.originalNews&&this.originalNews.wechatAttachment.length!==t.wechatAttachment.length)return!0;{var e;const s=(e,s)=>{for(let i of d()(e))if("coverImgStyle"!==i&&e[i]!==t.wechatAttachment[s][i])return!0};return l()(e=this.originalNews.wechatAttachment).call(e,s)}},getEditorContent(){var t=this;let e=!1;const s=()=>{for(const t of o()(this.errorObj))if(t)return t},i=function(e,s){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a=()=>{t.showErrorTip=!1,e.classList.remove(s),e.removeEventListener("keydown",a),e.removeEventListener("blur",a)};t.showErrorTip=i,e.classList.add(s),e.addEventListener("keydown",a),e.addEventListener("blur",a)};if("mpnews"===this.newsType){this.mpNewsDetails.wechatAttachment[this.currentEditIndex].content=this.content;for(let[t,o]of a()(n=this.mpNewsDetails.wechatAttachment).call(n)){var n;if(this.errorObj.titleEmpty=""===o.title,this.errorObj.titleOverLength=o.title.length>64,this.errorObj.authorOverLength=this.getAuthorLength(o.author)>8,this.errorObj.contentEmpty=0===o.content.length,o.viewedSourceUrl?this.errorObj.contentSourceUrlEmpty=!o.contentSourceUrl||0===o.contentSourceUrl.length:(this.errorObj.contentSourceUrlEmpty=!1,o.contentSourceUrl=null),this.errorObj.coverImgEmpty=""===o.thumbnailId,this.errorObj.summaryOverLength=o.description&&o.description.length>120,e=!!s(),e){if(this.changeCurrentEdit(t),this.errorObj.titleEmpty)this.$refs.mpnewsTitle.focus(),i(this.$refs.mpnewsTitle,"input-empty");else if(this.errorObj.contentEmpty){document.querySelector(".editor-container").classList.add("container-empty"),this.showErrorTip=!0,this.$refs.mpnewsTitle.scrollIntoView()}else if(this.errorObj.contentSourceUrlEmpty)this.$nextTick(()=>{this.$refs.mpnewsContentSource.focus(),i(this.$refs.mpnewsContentSource,"input-empty")});else if(this.errorObj.coverImgEmpty)this.showErrorTip=!0,this.$refs.mpnewsCoverImg.scrollIntoView();else if(this.errorObj.titleOverLength){const t=this.mpNewsDetails.wechatAttachment[this.currentEditIndex].title;this.mpNewsDetails.wechatAttachment[this.currentEditIndex].title="",this.$nextTick(()=>{this.$refs.mpnewsTitle.focus(),i(this.$refs.mpnewsTitle,"input-empty"),this.mpNewsDetails.wechatAttachment[this.currentEditIndex].title=t})}else if(this.errorObj.authorOverLength){const t=this.mpNewsDetails.wechatAttachment[this.currentEditIndex].author;this.mpNewsDetails.wechatAttachment[this.currentEditIndex].author="",this.$nextTick(()=>{this.$refs.mpnewsAuthor.focus(),i(this.$refs.mpnewsAuthor,"input-overlength"),this.mpNewsDetails.wechatAttachment[this.currentEditIndex].author=t})}else if(this.errorObj.summaryOverLength){const t=this.mpNewsDetails.wechatAttachment[this.currentEditIndex].description;this.mpNewsDetails.wechatAttachment[this.currentEditIndex].description="",this.$nextTick(()=>{this.$refs.mpnewsSummary.focus(),i(this.$refs.mpnewsSummary,"textarea-overlength"),this.mpNewsDetails.wechatAttachment[this.currentEditIndex].description=t})}this.errorObj;break}}if(!e){for(const t of this.mpNewsDetails.wechatAttachment)if(!t.description){const e=document.createElement("div");e.innerHTML=t.content;let s=null;e.textContent?s=e.textContent:e.text&&(s=e.text),s&&s.length>54&&(s=s.substring(0,54)),t.description=s}return this.mpNewsDetails}}else if("news"===this.newsType){for(let[t,n]of a()(r=this.newsDetails.wechatAttachment).call(r)){var r;if(this.errorObj.titleEmpty=""===n.title,this.errorObj.titleOverLength=n.title.length>64,this.errorObj.coverImgEmpty=""===n.url,this.errorObj.structuredMessageUrlEmpty=""===n.structureMsgUrl,this.errorObj.summaryOverLength=n.description&&n.description.length>120,e=!!s(),e){if(this.changeCurrentEdit(t),this.errorObj.titleEmpty)this.$refs.newsTitle.focus(),i(this.$refs.newsTitle,"input-empty");else if(this.errorObj.structuredMessageUrlEmpty)this.$refs.newsSource.focus(),i(this.$refs.newsSource,"input-empty");else if(this.errorObj.coverImgEmpty)this.showErrorTip=!0,this.$refs.mpnewsCoverImg.scrollIntoView();else if(this.errorObj.titleOverLength){const t=this.newsDetails.wechatAttachment[this.currentEditIndex].title;this.newsDetails.wechatAttachment[this.currentEditIndex].title="",this.$nextTick(()=>{this.$refs.newsTitle.focus(),this.newsDetails.wechatAttachment[this.currentEditIndex].title=t,i(this.$refs.newsTitle,"input-empty")})}else if(this.errorObj.summaryOverLength){const t=this.newsDetails.wechatAttachment[this.currentEditIndex].description;this.newsDetails.wechatAttachment[this.currentEditIndex].description="",this.$nextTick(()=>{this.$refs.newsSummary.focus(),this.newsDetails.wechatAttachment[this.currentEditIndex].description=t,i(this.$refs.newsSummary,"textarea-overlength")})}this.errorObj;break}}if(!e)return this.newsDetails}},ueditorReady(){const t=this.mpNewsDetails.wechatAttachment[this.currentEditIndex].content;t&&this.$refs.ueditor.updateContent(t)},showToolbarCover(){this.isCoveredToolbar=!0},hideToolBarCover(){this.isCoveredToolbar=!1},closeErrorTip(){this.showErrorTip=!1},selectMergeField(t){this.newsDetails.wechatAttachment[this.currentEditIndex].structureMsgUrl+=t,this.closeMergeField()},setLinkUrl(t){this.newsDetails.wechatAttachment[0].structureMsgUrl=t},onUploadCompleted(t){this.$root.$emit("upload-file-success"),"mpnews"===this.newsType?(this.mpNewsDetails.wechatAttachment[this.currentEditIndex].thumbnailId=t.mediaId,this.mpNewsDetails.wechatAttachment[this.currentEditIndex].url=t.url,this.coverPictures[t.mediaId]=t.url):(this.newsDetails.wechatAttachment[this.currentEditIndex].wechatImageUrl=t.wechatImageUrl,this.newsDetails.wechatAttachment[this.currentEditIndex].thumbnailId=t.mediaId,this.newsDetails.wechatAttachment[this.currentEditIndex].url=t.url)}},beforeDestroy(){"MessageLibrary"===this.$route.meta.permission&&(document.title="Message Library | charket")}},P=(s("tJr4"),s("YdbM"),s("Xn/o")),N=Object(v.a)(M,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-stru-box",attrs:{id:"newStructure"}},[s("div",{staticClass:"new-stru-list slds-scrollable_y"},[s("loading-spinner",{attrs:{"is-loading":t.isLoading,"custom-style":"position: relative;top: 50%;height:50px;"}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"stru-list-title"},[t._v("\n      "+t._s(t.$t("global.strucLabel"))+"\n    ")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"new-stru-first",class:{"selected-article":0===t.currentEditIndex},on:{click:function(e){return t.changeCurrentEdit(0)}}},["mpnews"===t.newsType?s("div",{staticClass:"first-stru-image"},[t.coverPictures[t.mpNewsDetails.wechatAttachment[0].thumbnailId]?t._e():s("div",{staticClass:"default-image"},[s("icon",{attrs:{name:"image",width:"48px",height:"48px","fill-color":"#ffffff","charket-icon":""}})],1),t._v(" "),t.coverPictures[t.mpNewsDetails.wechatAttachment[0].thumbnailId]?s("div",{staticClass:"cover-image"},[s("img",{class:["full-width"===t.mpNewsDetails.wechatAttachment[0].coverImgStyle?"w-cover-img":"h-cover-img"],attrs:{src:t._f("imgFilter")(t.coverPictures[t.mpNewsDetails.wechatAttachment[0].thumbnailId]),alt:""},on:{error:function(e){return t.showErrorImg(e)}}})]):t._e(),t._v(" "),s("div",{staticClass:"first-stru-title"},[t._v("\n          "+t._s(t.mpNewsDetails.wechatAttachment[0].title?t.mpNewsDetails.wechatAttachment[0].title:t.$t("title"))+"\n        ")])]):t._e(),t._v(" "),"news"===t.newsType?s("div",{staticClass:"first-stru-image"},[t.newsDetails.wechatAttachment[0].url?t._e():s("div",{staticClass:"default-image"},[s("icon",{attrs:{name:"image",width:"48px",height:"48px","fill-color":"#ffffff","charket-icon":""}})],1),t._v(" "),t.newsDetails.wechatAttachment[0].url?s("div",{staticClass:"cover-image"},[s("img",{class:["full-width"===t.newsDetails.wechatAttachment[0].coverImgStyle?"w-cover-img":"h-cover-img"],attrs:{src:t._f("imgFilter")(t.newsDetails.wechatAttachment[0].url),alt:""},on:{error:function(e){return t.showErrorImg(e)}}})]):t._e(),t._v(" "),s("div",{staticClass:"first-stru-title"},[t._v("\n          "+t._s(t.newsDetails.wechatAttachment[0].title?t.newsDetails.wechatAttachment[0].title:t.$t("title"))+"\n        ")])]):t._e(),t._v(" "),"news"===t.newsType&&t.newsDetails.wechatAttachment.length>1||"mpnews"===t.newsType&&t.mpNewsDetails.wechatAttachment.length>1?s("div",{staticClass:"stru-toolbar"},[s("div",{staticClass:"button-down",on:{click:function(e){return e.stopPropagation(),t.sortArticle(0,"down")}}},[s("icon",{attrs:{name:"arrowdown",width:"18px",height:"18px","fill-color":"#ffffff","charket-icon":""}})],1)]):t._e()]),t._v(" "),t._l(t.articlesTotal-1,(function(e){return s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"new-stru-others",class:{"selected-article":t.currentEditIndex===e},on:{click:function(s){return t.changeCurrentEdit(e)}}},["mpnews"===t.newsType?s("div",{staticClass:"other-stru-title"},[t._v("\n        "+t._s(t.mpNewsDetails.wechatAttachment[e].title?t.mpNewsDetails.wechatAttachment[e].title:t.$t("title"))+"\n      ")]):t._e(),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"other-stru-image"},[t.coverPictures[t.mpNewsDetails.wechatAttachment[e].thumbnailId]?t._e():s("div",{staticClass:"default-image"},[s("icon",{attrs:{name:"image",width:"30px",height:"30px","fill-color":"#ffffff","charket-icon":""}})],1),t._v(" "),s("img",{directives:[{name:"show",rawName:"v-show",value:t.coverPictures[t.mpNewsDetails.wechatAttachment[e].thumbnailId],expression:"coverPictures[mpNewsDetails.wechatAttachment[i].thumbnailId]"}],class:["full-width"===t.mpNewsDetails.wechatAttachment[e].coverImgStyle?"w-cover-img":"h-cover-img"],attrs:{src:t._f("imgFilter")(t.coverPictures[t.mpNewsDetails.wechatAttachment[e].thumbnailId]),alt:""},on:{error:function(e){return t.showErrorImg(e)}}})]):t._e(),t._v(" "),"news"===t.newsType?s("div",{staticClass:"other-stru-title"},[t._v("\n        "+t._s(t.newsDetails.wechatAttachment[e].title?t.newsDetails.wechatAttachment[e].title:t.$t("title"))+"\n      ")]):t._e(),t._v(" "),"news"===t.newsType?s("div",{staticClass:"other-stru-image"},[t.newsDetails.wechatAttachment[e].url?t._e():s("div",{staticClass:"default-image"},[s("icon",{attrs:{name:"image",width:"30px",height:"30px","fill-color":"#ffffff","charket-icon":""}})],1),t._v(" "),s("img",{directives:[{name:"show",rawName:"v-show",value:t.newsDetails.wechatAttachment[e].url,expression:"newsDetails.wechatAttachment[i].url"}],class:["full-width"===t.newsDetails.wechatAttachment[e].coverImgStyle?"w-cover-img":"h-cover-img"],attrs:{src:t._f("imgFilter")(t.newsDetails.wechatAttachment[e].url),alt:""},on:{error:function(e){return t.showErrorImg(e)}}})]):t._e(),t._v(" "),s("div",{staticClass:"stru-toolbar"},[s("div",{staticClass:"button-up",on:{click:function(s){return s.stopPropagation(),t.sortArticle(e,"up")}}},[s("icon",{attrs:{name:"arrowup",width:"18px",height:"18px","fill-color":"#ffffff","charket-icon":""}})],1),t._v(" "),e<t.articlesTotal-1?s("div",{staticClass:"button-down",on:{click:function(s){return s.stopPropagation(),t.sortArticle(e,"down")}}},[s("icon",{attrs:{name:"arrowdown",width:"18px",height:"18px","fill-color":"#ffffff","charket-icon":""}})],1):t._e(),t._v(" "),"mpnews"!==t.newsType||"edit"!==t.createdInfo.type?s("div",{staticClass:"button-delete",on:{click:function(s){return s.stopPropagation(),t.deleteArticle(e)}}},[s("icon",{attrs:{name:"deleteIcon",width:"18px",height:"18px","fill-color":"#ffffff","charket-icon":""}})],1):t._e()])])})),t._v(" "),t.articlesTotal<8&&("mpnews"!==t.newsType||"edit"!==t.createdInfo.type)&&!t.isLoading?s("div",{staticClass:"new-stru-others add-new-article",on:{click:function(e){return t.addNewArticle()}}},[s("div",{staticClass:"add-article-button"},[s("span",{staticClass:"slds-icon_container slds-icon-text-default"},[s("icon",{attrs:{name:"add",width:"20px",height:"20px","charket-icon":"","class-name":"add-icon"}})],1)])]):t._e()],2),t._v(" "),s("div",{staticClass:"slds-border_left new-stru-wrapper"},[s("div",{staticClass:"slds-grid new-stru-content"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showErrorTip,expression:"showErrorTip"}],staticClass:"slds-text-heading_small error-tip",style:{top:t.errorTop},on:{click:function(e){return t.closeErrorTip()}}},[t._v("\n        "+t._s(t.$t("reviewError"))+"\n      ")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isCoveredToolbar,expression:"isCoveredToolbar"}],staticClass:"toolbar-cover"}),t._v(" "),s("div",{staticClass:"slds-col slds-scrollable_y",class:{"slds-border_top mpnews-wrapper":"mpnews"===t.newsType,"slds-grid slds-grid_vertical only-news-wrapper":"news"===t.newsType,"error-head-mpnews":"mpnews"===t.newsType&&t.showErrorTip}},[s("div",{staticClass:"slds-grid slds-grid_vertical new-stru-head",class:{"error-head-news":t.showErrorTip&&"news"===t.newsType,"only-news-head":"news"===t.newsType}},["mpnews"===t.newsType?s("div",{staticClass:"slds-grid new-stru-title"},[s("i",[t._v("*")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].title,expression:"mpNewsDetails.wechatAttachment[currentEditIndex].title"}],ref:"mpnewsTitle",staticClass:"slds-col",style:{paddingRight:t.titlePadding},attrs:{type:"text",placeholder:t.$t("title")},domProps:{value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].title},on:{focus:function(e){return t.showToolbarCover()},input:function(e){e.target.composing||t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"title",e.target.value)}}}),t._v(" "),s("span",{staticClass:"slds-text-body_small",class:{overLength:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].title.length>64}},[t._v("\n              "+t._s(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].title.length)+"/64\n            ")])]):t._e(),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"slds-grid slds-grid_align-end new-stru-author"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].author,expression:"mpNewsDetails.wechatAttachment[currentEditIndex].author"}],ref:"mpnewsAuthor",style:{paddingRight:t.authorPadding},attrs:{type:"text",placeholder:t.$t("author")},domProps:{value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].author},on:{focus:function(e){return t.showToolbarCover()},input:function(e){e.target.composing||t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"author",e.target.value)}}}),t._v(" "),s("span",{staticClass:"slds-text-body_small",class:{overLength:t.authorLength>8}},[t._v(t._s(t.authorLength)+"/8")])]):t._e(),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"content-star"},[t._v("\n            *\n          ")]):t._e(),t._v(" "),"news"===t.newsType?s("div",{staticClass:"slds-grid slds-grid_align-end new-stru-title slds-border_bottom only-news-title"},[s("i",[t._v("*")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newsDetails.wechatAttachment[t.currentEditIndex].title,expression:"newsDetails.wechatAttachment[currentEditIndex].title"}],ref:"newsTitle",staticClass:"slds-col",style:{paddingRight:t.titlePadding},attrs:{type:"text",placeholder:t.$t("title")},domProps:{value:t.newsDetails.wechatAttachment[t.currentEditIndex].title},on:{input:function(e){e.target.composing||t.$set(t.newsDetails.wechatAttachment[t.currentEditIndex],"title",e.target.value)}}}),t._v(" "),s("span",{staticClass:"slds-text-body_small",class:{overLength:t.newsDetails.wechatAttachment[t.currentEditIndex].title.length>64}},[t._v("\n              "+t._s(t.newsDetails.wechatAttachment[t.currentEditIndex].title.length)+"/64\n            ")])]):t._e(),t._v(" "),"news"===t.newsType?s("div",{staticClass:"slds-grid slds-grid_vertical news-stru-url"},[s("div",{staticClass:"stru-url-title"},[s("i",[t._v("*")]),t._v("\n              "+t._s(t.$t("url"))+"\n            ")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newsDetails.wechatAttachment[t.currentEditIndex].structureMsgUrl,expression:"newsDetails.wechatAttachment[currentEditIndex].structureMsgUrl"}],ref:"newsSource",staticClass:"slds-input",attrs:{type:"text",name:""},domProps:{value:t.newsDetails.wechatAttachment[t.currentEditIndex].structureMsgUrl},on:{input:function(e){e.target.composing||t.$set(t.newsDetails.wechatAttachment[t.currentEditIndex],"structureMsgUrl",e.target.value)}}}),t._v(" "),s("div",{staticClass:"merge-field-icon down-btn",attrs:{title:t.$t("insertFieldLabel")},on:{click:function(e){return t.openMergeField()}}},[s("icon",{staticClass:"link-icon down-icon",attrs:{name:"insertTag",width:"16px",height:"16px","charket-icon":""}})],1)]):t._e()]),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"new-stru-section"},[s("ueditor",{ref:"ueditor",on:{getImages:function(e){return t.openImagePopup("contentPic")},onchange:t.onUeditorChange,ready:t.ueditorReady,editorFocus:function(e){return t.hideToolBarCover()}}}),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"slds-grid slds-grid_vertical new-stru-source"},[s("div",{staticClass:"slds-form-element__control"},[s("label",{staticClass:"slds-checkbox",attrs:{for:"stru-source-url"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].viewedSourceUrl,expression:"mpNewsDetails.wechatAttachment[currentEditIndex].viewedSourceUrl"}],staticClass:"slds-col",attrs:{type:"checkbox",name:"default",id:"stru-source-url"},domProps:{checked:Array.isArray(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].viewedSourceUrl)?t._i(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].viewedSourceUrl,null)>-1:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].viewedSourceUrl},on:{change:function(e){var s=t.mpNewsDetails.wechatAttachment[t.currentEditIndex].viewedSourceUrl,i=e.target,a=!!i.checked;if(Array.isArray(s)){var n=t._i(s,null);i.checked?n<0&&t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"viewedSourceUrl",s.concat([null])):n>-1&&t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"viewedSourceUrl",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"viewedSourceUrl",a)}}}),t._v(" "),s("span",{staticClass:"slds-checkbox_faux"}),t._v(" "),s("span",{staticClass:"slds-form-element__label stru-source-label"},[t._v(t._s(t.$t("sourceUrl")))])])]),t._v(" "),t.mpNewsDetails.wechatAttachment[t.currentEditIndex].viewedSourceUrl?s("input",{directives:[{name:"model",rawName:"v-model",value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].contentSourceUrl,expression:"mpNewsDetails.wechatAttachment[currentEditIndex].contentSourceUrl"}],ref:"mpnewsContentSource",staticClass:"slds-input slds-col",attrs:{type:"text"},domProps:{value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].contentSourceUrl},on:{input:function(e){e.target.composing||t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"contentSourceUrl",e.target.value)}}}):t._e()]):t._e()],1):t._e(),t._v(" "),s("div",{staticClass:"slds-col slds-border_top new-stru-footer"},[s("div",{staticClass:"new-stru-publish-style",class:{"only-mpnews-publish":"mpnews"===t.newsType,"only-news-publish":"news"===t.newsType}},[s("div",{ref:"mpnewsCoverImg",staticClass:"slds-grid slds-grid_vertical stru-cover-image"},[s("div",{staticClass:"slds-text-body_small select-title"},[s("i",[t._v("*")]),t._v("\n                "+t._s(t.$t("coverImage"))+"\n                "),s("span",[t._v(t._s(0===t.currentEditIndex?t.$t("recommendedSize",[900,500]):t.$t("recommendedSize",[200,200])))])]),t._v(" "),s("div",{staticClass:"select-button"},[s("message-uploader",{staticClass:"slds-button slds-button_neutral upload-file-btn",attrs:{type:"image","wechat-account-id":t.wechatAccountId},on:{completed:t.onUploadCompleted}},[s("span",{staticClass:"upload-file-btn__label"},[t._v(t._s(t.$t("global.uploadBtn")))])]),t._v(" "),s("button",{staticClass:"slds-button slds-button_neutral image-popup-btn",on:{click:function(e){return t.openImagePopup("coverPic")}}},[t._v(t._s(t.$t("chooseFromLibrary")))])],1),t._v(" "),t.mpNewsDetails.wechatAttachment[t.currentEditIndex]&&t.mpNewsDetails.wechatAttachment[t.currentEditIndex].thumbnailId||t.newsDetails.wechatAttachment[t.currentEditIndex]&&t.newsDetails.wechatAttachment[t.currentEditIndex].url?s("div",{class:[0===t.currentEditIndex?"cover-image-first":"cover-image-others"]},["mpnews"===t.newsType?s("img",{staticClass:"vt-cover-img",attrs:{src:t.coverPictures[t.mpNewsDetails.wechatAttachment[t.currentEditIndex].thumbnailId],alt:""},on:{load:function(e){return t.imgLoad(e)}}}):t._e(),t._v(" "),"news"===t.newsType?s("img",{staticClass:"vt-cover-img",attrs:{src:t.newsDetails.wechatAttachment[t.currentEditIndex].url,alt:""},on:{load:function(e){return t.imgLoad(e)}}}):t._e(),t._v(" "),"mpnews"===t.newsType?s("img",{class:["full-width"===t.mpNewsDetails.wechatAttachment[t.currentEditIndex].coverImgStyle?"w-cover-img":"h-cover-img"],attrs:{src:t._f("imgFilter")(t.coverPictures[t.mpNewsDetails.wechatAttachment[t.currentEditIndex].thumbnailId]),alt:""},on:{error:function(e){return t.showErrorImg(e)}}}):t._e(),t._v(" "),"news"===t.newsType?s("img",{class:["full-width"===t.newsDetails.wechatAttachment[t.currentEditIndex].coverImgStyle?"w-cover-img":"h-cover-img"],attrs:{src:t._f("imgFilter")(t.newsDetails.wechatAttachment[t.currentEditIndex].url),alt:""},on:{error:function(e){return t.showErrorImg(e)}}}):t._e(),t._v(" "),s("div",{staticClass:"cover-image-toolbar"},[s("div",{staticClass:"button-delete",on:{click:function(e){return e.stopPropagation(),t.deleteCoverImage()}}},[s("icon",{attrs:{name:"deleteIcon",width:"18px",height:"18px","fill-color":"#ffffff","charket-icon":""}})],1)])]):t._e(),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"slds-form-element__control"},[s("label",{staticClass:"slds-checkbox",attrs:{for:"stru-cover-pic"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].showCoverPic,expression:"mpNewsDetails.wechatAttachment[currentEditIndex].showCoverPic"}],attrs:{type:"checkbox",name:"default",id:"stru-cover-pic","true-value":1,"false-value":0},domProps:{checked:Array.isArray(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].showCoverPic)?t._i(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].showCoverPic,null)>-1:t._q(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].showCoverPic,1)},on:{change:function(e){var s=t.mpNewsDetails.wechatAttachment[t.currentEditIndex].showCoverPic,i=e.target,a=i.checked?1:0;if(Array.isArray(s)){var n=t._i(s,null);i.checked?n<0&&t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"showCoverPic",s.concat([null])):n>-1&&t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"showCoverPic",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"showCoverPic",a)}}}),t._v(" "),s("span",{staticClass:"slds-checkbox_faux"}),t._v(" "),s("span",{staticClass:"slds-form-element__label stru-cover-label"},[t._v(t._s(t.$t("showImageInContent")))])])]):t._e()]),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"stru-digest"},[s("div",{staticClass:"slds-text-body_small digest-title"},[t._v("\n                "+t._s(t.$t("summary"))+"\n              ")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].description,expression:"mpNewsDetails.wechatAttachment[currentEditIndex].description"}],ref:"mpnewsSummary",staticClass:"slds-textarea resize-vertical",attrs:{name:"name",rows:"8",cols:"80"},domProps:{value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].description},on:{input:function(e){e.target.composing||t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"description",e.target.value)}}}),t._v(" "),s("div",{staticClass:"word-rest-number",class:{overLength:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].description&&t.mpNewsDetails.wechatAttachment[t.currentEditIndex].description.length>120}},[t._v("\n                "+t._s(120-(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].description?t.mpNewsDetails.wechatAttachment[t.currentEditIndex].description.length:0))+"\n              ")])]):t._e(),t._v(" "),"news"===t.newsType?s("div",{staticClass:"slds-grid slds-grid_vertical stru-digest"},[s("div",{staticClass:"slds-text-body_small digest-title"},[t._v("\n                "+t._s(t.$t("summary"))+"\n              ")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newsDetails.wechatAttachment[t.currentEditIndex].description,expression:"newsDetails.wechatAttachment[currentEditIndex].description"}],ref:"newsSummary",staticClass:"slds-textarea resize-vertical",attrs:{name:"name",rows:"8",cols:"80"},domProps:{value:t.newsDetails.wechatAttachment[t.currentEditIndex].description},on:{input:function(e){e.target.composing||t.$set(t.newsDetails.wechatAttachment[t.currentEditIndex],"description",e.target.value)}}}),t._v(" "),s("div",{staticClass:"word-rest-number",class:{overLength:t.newsDetails.wechatAttachment[t.currentEditIndex].description&&t.newsDetails.wechatAttachment[t.currentEditIndex].description.length>120}},[t._v("\n                "+t._s(120-(t.newsDetails.wechatAttachment[t.currentEditIndex].description?t.newsDetails.wechatAttachment[t.currentEditIndex].description.length:0))+"\n              ")])]):t._e()])])])])]),t._v(" "),s("image-popup",{ref:"imagepopupmodel",attrs:{"acc-id":t.wechatAccountId,"header-content":t.$t("global.popupHeader.selectImage"),"popup-type":"image","is-multi-select":!1},on:{getSelectedMessage:t.getSelectedMessage}}),t._v(" "),t.showMergeField?s("select-field",{attrs:{"page-name":"STRUCTURED MESSAGES"},on:{"close-merge-field":function(e){return t.closeMergeField()},"select-merge-field":t.selectMergeField}}):t._e()],1)}),[],!1,null,"228b38a8",null);"function"==typeof P.default&&Object(P.default)(N);e.a=N.exports},Ek5D:function(t,e,s){"use strict";var i=s("94pc");s.n(i).a},F5n2:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"weChatLabel":"微信","backLabel":"返回","detailsLabel":"详情","templateSettingLabel":"模板设置","urlLabel":"链接","informationLabel":"附加信息","noteLabel":"备注","placeholderLabel":"可选的"},"en":{"weChatLabel":"WeChat","backLabel":"Back","detailsLabel":"Details","templateSettingLabel":"Template Settings","urlLabel":"URL","informationLabel":"Additional Information","noteLabel":"NOTE","placeholderLabel":"Optional"}}'),delete t.options._Ctor}},F5n6:function(t,e,s){"use strict";var i={props:{paginations:{type:Array},pageNumber:{type:Number,default:1}},data:()=>({currentPageNumber:1}),created(){this.currentPageNumber=this.pageNumber},methods:{changePageNumber(t,e){this.currentPageNumber="pre"===e?this.currentPageNumber-1:"next"===e?this.currentPageNumber+1:t,this.$emit("target",this.currentPageNumber)}}},a=(s("hkfk"),s("KHd+")),n=s("k/9o"),o=Object(a.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.paginations.length>1?s("ul",{staticClass:"slds-grid slds-grid_align-center pagination"},[s("li",{staticClass:"page-turning-pre",attrs:{title:t.$t("preTitle")}},[t.currentPageNumber>1?s("a",{staticClass:"page-turning",attrs:{id:"previousPage"},on:{click:function(e){return t.changePageNumber("","pre")}}},[s("icon",{attrs:{name:"left","text-color":"default",size:"x-small","charket-icon":""}})],1):s("a",{staticClass:"disabled page-turning",attrs:{id:"previousPageDisabled",disabled:"true"}},[s("icon",{attrs:{name:"left","text-color":"default",size:"x-small","charket-icon":""}})],1)]),t._v(" "),t._l(t.paginations,(function(e){return s("li",{staticClass:"middle-page-number"},[0!==e.PageNumber?s("a",{class:{currentPage:e.PageNumber===t.currentPageNumber},on:{click:function(s){return t.changePageNumber(e.PageNumber)}}},[t._v(t._s(e.PageNumber))]):s("a",[t._v("...")])])})),t._v(" "),s("li",{staticClass:"page-turning-pre",attrs:{title:t.$t("nextTitle")}},[t.paginations[t.paginations.length-1].PageNumber!==t.currentPageNumber?s("a",{staticClass:"page-turning",attrs:{id:"nextPage"},on:{click:function(e){return t.changePageNumber("","next")}}},[s("icon",{attrs:{name:"right","text-color":"default",size:"x-small","charket-icon":""}})],1):s("a",{staticClass:"disabled page-turning",attrs:{id:"nextPageDisabled",disabled:"true"}},[s("icon",{attrs:{name:"right","text-color":"default",size:"x-small","charket-icon":""}})],1)])],2):t._e()}),[],!1,null,"430ba9bf",null);"function"==typeof n.default&&Object(n.default)(o);e.a=o.exports},Fblv:function(t,e,s){"use strict";var i=s("O2ea");s.n(i).a},"HA+Y":function(t,e,s){},HaPu:function(t,e,s){"use strict";var i=s("8YXT"),a=s.n(i);e.default=a.a},Hi2j:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"type":"类型","name":"名称","expirationDate":"过期日期","quantity":"数量","status":"状态","to":"至"},"en":{"type":"Type","name":"Name","expirationDate":"Expiration Date","quantity":"Quantity","status":"Status","to":"to"}}'),delete t.options._Ctor}},I0LH:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"newPassTitle":"新建凭证","passForApproval":"凭证已提交审批！"},"en":{"newPassTitle":"New Pass","passForApproval":"The pass was submitted for approval."}}'),delete t.options._Ctor}},I4i6:function(t,e,s){},ItEM:function(t,e,s){"use strict";var i=s("tAMZ"),a=s.n(i);e.default=a.a},IzIm:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"title":"标题","author":"作者","reviewError":"检查此页面上的错误。","url":"链接","coverImage":"封面图","chooseFromLibrary":"从图片库选择","summary":"摘要","showImageInContent":"在内容中展示图片","sourceUrl":"原文链接","recommendedSize":"推荐尺寸为{0}像素 * {1}像素","insertFieldLabel":"插入合并字段"},"en":{"title":"Title","author":"Author","reviewError":"Review the errors on this page.","url":"URL","coverImage":"Cover Image","chooseFromLibrary":"Choose From Library","summary":"Summary","showImageInContent":"Show image in content","sourceUrl":"Source URL","recommendedSize":"The recommended image resolution is {0}px by {1}px.","insertFieldLabel":"Insert merge field"}}'),delete t.options._Ctor}},Kpe1:function(t,e,s){"use strict";var i=s("I4i6");s.n(i).a},LAgH:function(t,e,s){"use strict";var i=s("XJ2f");s.n(i).a},MODQ:function(t,e,s){"use strict";var i=s("tEgh");s.n(i).a},MYFI:function(t,e,s){},NflP:function(t,e,s){"use strict";var i=s("w/3m"),a=s.n(i);e.default=a.a},O2ea:function(t,e,s){},OWFR:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"name":"名称","startDate":"开始日期","endDate":"结束日期","quantity":"数量","createdBy":"最后修改信息"},"en":{"name":"Name","startDate":"Start Date","endDate":"End Date","quantity":"Quantity","createdBy":"Created By"}}'),delete t.options._Ctor}},Q2dq:function(t,e,s){"use strict";var i=s("A7GL");s.n(i).a},SIqq:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"objectTypeLabel":"对象类型","listViewLabel":"列表视图"},"en":{"objectTypeLabel":"Object Type","listViewLabel":"List View"}}'),delete t.options._Ctor}},"T2h/":function(t,e,s){"use strict";var i=s("hp0C");s.n(i).a},Tsgj:function(t,e,s){},W9Ow:function(t,e,s){},WHkT:function(t,e,s){},WJ6L:function(t,e,s){},XJ2f:function(t,e,s){},"Xn/o":function(t,e,s){"use strict";var i=s("IzIm"),a=s.n(i);e.default=a.a},Y2fc:function(t,e,s){"use strict";var i=s("BtIw");s.n(i).a},Y5h6:function(t,e,s){},YdbM:function(t,e,s){"use strict";var i=s("W9Ow");s.n(i).a},ZR3b:function(t,e,s){},aVPg:function(t,e,s){"use strict";var i=s("BR3B");s.n(i).a},atAB:function(t,e,s){},"c/J/":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"newMiniProTitle":"新建小程序卡片","editMiniProTitle":"编辑小程序卡片","miniProSaveLabel":"小程序卡片保存成功。","title":"标题","reviewError":"检查此页面上的错误。","appIdLabel":"App ID","pagePathLabel":"页面路径","coverImage":"封面图","chooseFromLibrary":"从图片库选择","recommendedSize":"推荐尺寸为{0}像素 * {1}像素"},"en":{"newMiniProTitle":"New Mini Program Page","editMiniProTitle":"Edit Mini Program Page","miniProSaveLabel":"Mini Program Page was saved.","title":"Title","reviewError":"Review the errors on this page.","appIdLabel":"App ID","pagePathLabel":"Page Path","coverImage":"Cover Image","chooseFromLibrary":"Choose From Library","recommendedSize":"The recommended image resolution is {0}px by {1}px."}}'),delete t.options._Ctor}},cfGg:function(t,e,s){"use strict";var i=s("SIqq"),a=s.n(i);e.default=a.a},dOfv:function(t,e,s){"use strict";var i=s("rZkV"),a=s.n(i),n=s("+Bun"),o=s.n(n),r=s("ejTr"),l=s.n(r),c=s("autp"),d=s.n(c),u=s("vkTm");e.a={components:{ColorPicker:u.a},mounted(){this.$nextTick(()=>{this.$refs.editor.id=this.id,this.editor=this.UE.getEditor(this.id,this.config),this.editor.ready(()=>{this.bindContentChange(),this.bindSelectionChange(),this.bindPaste(),this.bindFocusBlur(),this.editor.setContent(this.$t("defaultContent")),this.$emit("ready")})})},data(){return{id:"charket_editor"+Math.random(10),UE:window.UE||null,showFontSizeList:!1,showOlList:!1,showUlList:!1,showLineHeightList:!1,showSpacingTopList:!1,showSpacingBottomList:!1,editor:null,recentForeColor:{hex:null},recentBackColor:{hex:null},defaultColor:{hex:"#194d33"},fontSizeList:["12px","14px","15px","16px","18px","20px","24px"],paragraphStyle:[{label:"alignLeft",value:"left"},{label:"alignCenter",value:"center"},{label:"alignRight",value:"right"}],toolStates:{undo:-1,redo:-1,blockquote:0,horizontal:0,removeformat:0,formatmatch:0,bold:0,italic:0,underline:0,indent:0},toolValues:{fontsize:"16px",forecolor:"#ffffff",backcolor:"#ffffff",justify:"",imagefloat:"",lineheight:"",rowspacing:"",rowspacingtop:"",rowspacingbottom:"",insertorderedlist:"",insertunorderedlist:""},toolOptions:{rowspacing:[{label:"5",value:"5"},{label:"10",value:"10"},{label:"15",value:"15"},{label:"20",value:"20"},{label:"25",value:"25"}],lineheight:[{label:"1",value:"1"},{label:"1.5",value:"1.5"},{label:"1.75",value:"1.75"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"5",value:"5"}],orderedlist:[{label:"1,2,3...",value:"decimal"},{label:"a,b,c...",value:"lower-alpha"},{label:"i,ii,iii...",value:"lower-roman"},{label:"A,B,C...",value:"upper-alpha"},{label:"Ⅰ,Ⅱ,Ⅲ...",value:"upper-roman"}],unorderedlist:[{label:"○ "+this.$t("global.ueditor.circle"),value:"circle"},{label:"● "+this.$t("global.ueditor.disc"),value:"disc"},{label:"■ "+this.$t("global.ueditor.square"),value:"square"}]},listVisible:!0,toolbarMaskVisible:!1,imagefloatvisible:!1,config:{toolbars:[[]],enableAutoSave:!1,initialFrameWidth:null,initialFrameHeight:400,autoHeightEnabled:!0,imagePopup:!1,imageScaleEnabled:!1}}},methods:{closeAllList(){this.showFontSizeList=!1,this.showOlList=!1,this.showUlList=!1,this.showLineHeightList=!1,this.showSpacingTopList=!1,this.showSpacingBottomList=!1,this.$refs.colorList.close(),this.$refs.bgColorList.close()},openFontColorList(){this.closeAllList(),this.$refs.colorList.open()},openBgColorList(){this.closeAllList(),this.$refs.bgColorList.open()},openFontSizeList(){this.closeAllList(),this.showFontSizeList=!this.showFontSizeList;const t=()=>{this.showFontSizeList=!1,window.removeEventListener("click",t)};d()(()=>{window.addEventListener("click",t)},100)},openOlList(t){this.closeAllList(),this.showOlList=!this.showOlList;const e=()=>{this.showOlList=!1,window.removeEventListener("click",e)};d()(()=>{window.addEventListener("click",e)},200)},openUlList(){this.closeAllList(),this.showUlList=!this.showUlList;const t=()=>{this.showUlList=!1,window.removeEventListener("click",t)};d()(()=>{window.addEventListener("click",t)},200)},openLineHeightList(){this.closeAllList(),this.showLineHeightList=!0;const t=()=>{this.showLineHeightList=!1,window.removeEventListener("click",t)};d()(()=>{window.addEventListener("click",t)},200)},openSpacingTopList(){this.closeAllList(),this.showSpacingTopList=!0;const t=()=>{this.showSpacingTopList=!1,window.removeEventListener("click",t)};d()(()=>{window.addEventListener("click",t)},200)},openSpacingBottomList(){this.closeAllList(),this.showSpacingBottomList=!0;const t=()=>{this.showSpacingBottomList=!1,window.removeEventListener("click",t)};d()(()=>{window.addEventListener("click",t)},200)},bindContentChange(){this.editor.addListener("contentChange",()=>{this.$emit("onchange",this.getContent())})},bindSelectionChange(){this.editor.addListener("selectionchange",()=>{const t=l()(this.toolStates),e=l()(this.toolValues),s=t.length,i=e.length;for(let e=0;e<s;e++)this.toolStates[t[e]]=this.editor.queryCommandState(t[e]);for(let t=0;t<i;t++){var a;o()(a=e[t]).call(a,"rowspacing")>-1?this.toolValues[e[t]]=this.editor.queryCommandValue("rowspacing",e[t].replace("rowspacing","")):this.toolValues[e[t]]=this.editor.queryCommandValue(e[t])+""}const n=this.editor.selection.getRange().getClosedNode();n&&"IMG"===n.tagName?this.imagefloatvisible=!0:this.imagefloatvisible=!1})},bindPaste(){this.editor.addListener("beforepaste",(t,e)=>{const s=document.createElement("div");s.innerHTML=e.html;let i=null,n=0;i=(t=>{const e={};const s=t=>{if(t.childNodes.length>0)for(const i of t.childNodes)if("IMG"===i.nodeName)i.src&&(i.id="transUrl"+n,n++,e[i.id]=i.src);else if(1===i.nodeType){if(i.style.backgroundImage){i.id="transUrl"+n,n++;let t=i.style.backgroundImage;e[i.id]=a()(t).call(t,5,-2)}s(i)}};return s(t),e})(s),this.replaceImgUrl(i),e.html=s.innerHTML})},replaceImgUrl(t){},bindFocusBlur(){this.editor.addListener("focus",()=>{this.$emit("editorFocus"),this.closeAllList(),this.toolbarMaskVisible=!1,this.listVisible=!1;const t=this.editor.getContent();o()(t).call(t,'id="initContent"')>-1&&(this.editor.execCommand("cleardoc"),this.editor.reset())}),this.editor.addListener("blur",()=>{this.listVisible=!0,d()(()=>{var t;const e=this.editor.hasContents(["span","strong","hr","ul","ol","blockquote","em"]),s=o()(t=this.editor.body.innerHTML).call(t,'style="')>-1;e||s||this.editor.setContent(this.$t("defaultContent"))},100)})},onUndo(){this.editor.execCommand("undo")},onRedo(){this.editor.execCommand("redo")},onFontsize(t){this.checkPlaceHolder(),this.editor.execCommand("fontsize",t),this.showFontSizeList=!1},onBlockquote(){this.checkPlaceHolder(),this.editor.execCommand("blockquote")},onHorizontal(){this.checkPlaceHolder(),this.editor.execCommand("horizontal")},onRemoveFormat(){this.editor.execCommand("removeformat"),this.editor.iframe.focus()},onFormatmatch(){this.checkPlaceHolder(),this.editor.execCommand("formatmatch")},onBold(){this.checkPlaceHolder(),this.editor.execCommand("bold")},onItalic(){this.checkPlaceHolder(),this.editor.execCommand("italic")},onUnderline(){this.checkPlaceHolder(),this.editor.execCommand("underline")},onIndent(){this.checkPlaceHolder(),this.editor.execCommand("indent"),this.editor.iframe.focus()},onJustify(t){this.checkPlaceHolder(),this.editor.execCommand("justify",t),this.editor.iframe.focus()},onLineHeight(t){this.checkPlaceHolder(),this.editor.execCommand("lineheight",t),this.editor.iframe.focus()},onRowSpacing(t,e){this.checkPlaceHolder(),this.editor.execCommand("rowspacing",t,e),this.editor.iframe.focus()},onMaskShow(){this.toolbarMaskVisible=!0},onFontsizeChange(t){this.checkPlaceHolder(),this.toolValues.fontsize=t,this.showFontSizeList=!1,this.onFontsize(t),this.$refs.editor.focus()},onFontColor(t){this.checkPlaceHolder(),t&&("none"===t?this.editor.execCommand("removeformat","span","color"):(this.editor.execCommand("forecolor",t),this.recentForeColor={hex:t},this.editor.iframe.focus()))},onBgColor(t){this.checkPlaceHolder(),t&&("none"===t?this.editor.execCommand("removeformat","span","background-color"):(this.editor.execCommand("backcolor",t),this.recentBackColor={hex:t},this.editor.iframe.focus()))},onRemoveFormatColor(t,e,s){this.editor.execCommand("removeformat",e)},onParagraphStyle(t){this.checkPlaceHolder(),"indent"===t?this.editor.execCommand("indent"):(this.editor.execCommand("justify",t),this.toolValues.justify=t)},setListStyle(t,e){this.checkPlaceHolder(),this.editor.execCommand("insertunorderedlist",e),this.editor.iframe.focus()},onImageFloat(t){this.imagefloatvisible&&(this.editor.execCommand("imagefloat",t),this.toolValues.imagefloat=t)},inputImage(t){this.editor.iframe.focus();const e='<p><img src="'.concat(t,'" /></p>');this.editor.execCommand("inserthtml",e)},getImages(){this.$emit("getImages")},updateContent(t){t?this.editor.setContent(t):(this.editor.reset(),this.editor.setContent(this.$t("defaultContent")))},checkPlaceHolder(){var t;o()(t=this.editor.body.innerHTML).call(t,'id="initContent"')>-1&&this.editor.execCommand("cleardoc")},getContent(){return this.editor.getContent(()=>{var t;return!(o()(t=this.editor.body.innerHTML).call(t,'id="initContent"')>-1||!this.editor.hasContents(["span","strong","hr","ul","ol","blockquote","em"]))})}}}},fBrU:function(t,e,s){},fGFX:function(t,e,s){},fOvr:function(t,e,s){"use strict";var i=s("OWFR"),a=s.n(i);e.default=a.a},fb3H:function(t,e,s){"use strict";var i=s("w2Vt"),a=s("zUtI"),n=s("4B+h"),o=s("LQ5e"),r=s.n(o),l={props:{accountId:String,default:()=>""},components:{LoadingSpinner:i.a},data:()=>({notifies:[],isNotifyLoading:!1,selectedNotify:{}}),created(){this.isNotifyLoading=!0,this.fetchNotifies()},methods:{async fetchNotifies(){try{const t=await Object(a.g)(this.accountId||this.$route.params.accountId);if(t.ok){this.isNotifyLoading=!1,this.notifies=JSON.parse(r.a.unescape(t.data));for(let t of this.notifies)this.$set(t,"type","example"),this.$set(t,"isSelectedShow",!1);this.$nextTick((function(){this.renderGrid()}))}else this.isNotifyLoading=!1,Object(n.f)(t)}catch(t){Object(n.f)(t)}},closeNotify(){this.$emit("close")},renderGrid(){const t=document.getElementsByClassName("template-item");let e,s,i=0;for(let a=0;a<t.length;a++)a>0&&(t[a-3]&&(e=t[a-3].offsetTop+t[a-3].offsetHeight+20,t[a].style.top=e+"px"),a%3>0&&(s=t[a-1].offsetLeft+t[a-1].offsetWidth+20,t[a].style.left=s+"px")),i=Math.max(i,t[a].offsetTop+t[a].offsetHeight+60);const a=document.getElementsByClassName("template-content")[0];a&&(a.style.height=i-35+"px");for(let e=0;e<t.length;e++)t[e].style.height=t[e].offsetHeight+10+"px"},selectNotify(t,e){e.isSelectedShow=!e.isSelectedShow;for(let t of this.notifies)t.TemplateId!==e.TemplateId&&(t.isSelectedShow=!1);this.selectedNotify=e.isSelectedShow?e:{}},switchTemplate(t,e){t.type=e},goToWeChatPlatform(){this.$emit("close"),window.open("https://mp.weixin.qq.com")},next(){this.$emit("next",this.selectedNotify)}}},c=(s("vyV3"),s("KHd+")),d=s("HaPu"),u=Object(c.a)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{attrs:{id:"wechat-notification-list"}},[s("div",{staticClass:"slds-modal slds-modal_large slds-fade-in-open",attrs:{"aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container container-width",attrs:{role:"document",tabindex:"0"}},[s("div",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close",on:{click:function(e){return t.closeNotify()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.$t("selectNotificationTemplateLabel")))])]),t._v(" "),t.isNotifyLoading?t._e():s("div",{staticClass:"slds-modal__content"},[s("div",{staticClass:"template-content"},[s("ul",{staticClass:"select-template-list"},[t._l(t.notifies,(function(e){return s("li",{staticClass:"slds-box template-item",on:{click:function(s){return s.stopPropagation(),t.selectNotify(s,e)}}},[s("div",{staticClass:"template-container"},[s("div",{staticClass:"slds-grid template-section"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"example"===e.type&&e.Example,expression:"notify.type === 'example' && notify.Example"}]},[s("span",{staticClass:"slds-text-heading_small title"},[t._v(t._s(e.Title))]),t._v(" "),s("pre",{staticClass:"slds-text-body_regular content"},[t._v(t._s(e.Example))])]),t._v(" "),s("div",[s("span",{staticClass:"slds-text-heading_small title"},[t._v(t._s(e.Title))]),t._v(" "),s("pre",{staticClass:"slds-text-body_regular content"},[t._v(t._s(e.Content))])])])]),t._v(" "),s("div",{staticClass:"switch-section"},[s("p",{directives:[{name:"show",rawName:"v-show",value:e.Example,expression:"notify.Example"}],staticClass:"left",class:{selected:"example"===e.type},on:{click:function(s){return s.stopPropagation(),t.switchTemplate(e,"example")}}}),t._v(" "),s("p",{class:{selected:"content"===e.type||!e.Example},on:{click:function(s){return s.stopPropagation(),t.switchTemplate(e,"content")}}})]),t._v(" "),e.isSelectedShow?s("div",{staticClass:"selected-notify"},[s("div",{staticClass:"selected-bg"}),t._v(" "),s("div",{staticClass:"selected-icon"},[s("icon",{attrs:{name:"check","fill-color":"white",width:"48px",height:"48px"}})],1)]):t._e()])})),t._v(" "),s("li",{staticClass:"slds-box template-item default"},[s("span",{staticClass:"default-icon down-btn",on:{click:function(e){return t.goToWeChatPlatform()}}},[s("icon",{attrs:{name:"add","class-name":"down-icon",width:"32px",height:"32px"}})],1),t._v(" "),s("p",{staticClass:"default-value"},[t._v(t._s(t.$t("newTemplateLabel")))])])],2)])]),t._v(" "),s("loading-spinner",{attrs:{"is-loading":t.isNotifyLoading,"custom-style":"position: relative;padding: 40px;background-color: white"}}),t._v(" "),s("div",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.closeNotify()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:!t.selectedNotify.TemplateId},on:{click:function(e){return t.next()}}},[t._v(t._s(t.$t("global.nextBtn")))])])],1)]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open"})])])}),[],!1,null,"1a576594",null);"function"==typeof d.default&&Object(d.default)(u);e.a=u.exports},feiH:function(t,e,s){"use strict";var i=s("pqUP"),a=s.n(i),n=s("autp"),o=s.n(n);e.a={data:()=>({currentPlayAudio:{},audioStart:!1,audioPause:!1,defaultVoiceIcon:s("iTeh"),voiceAnimationTimer:null,voiceImgTag:0}),methods:{toPlayAudio(t,e){t.imageIcon||this.$set(t,"imageIcon",this.defaultVoiceIcon),clearInterval(this.voiceAnimationTimer),this.voiceImgTag=0;(function(t){for(let e in t)if(e)return!1;return!0})(this.currentPlayAudio)||(this.currentPlayAudio.imageIcon=this.defaultVoiceIcon);const i=()=>{clearInterval(this.voiceAnimationTimer),t.imageIcon=this.defaultVoiceIcon,this.audioStart=!1,this.audioPause=!0,e.removeEventListener("ended",i)},n=function t(){e.play(),e.addEventListener("ended",i),e.removeEventListener("canplay",t)};this.currentPlayAudio.mediaId!==t.mediaId&&(this.audioPause=!1,this.audioStart=!1),this.currentPlayAudio=t,o()(()=>{if(null!==e)if(e.paused){this.audioPause?(e.play(),e.addEventListener("ended",i),this.audioPause=!1):e.addEventListener("canplay",n);const t=[];t[0]=this.defaultVoiceIcon,t[1]=s("JCFT"),t[2]=s("oA5C"),t[3]=s("xnJK"),this.audioStart?(e.removeEventListener("canplay",n),this.audioStart=!1,this.currentPlayAudio={}):(this.voiceAnimationTimer=a()(()=>{this.currentPlayAudio.imageIcon=t[this.voiceImgTag],this.voiceImgTag++,this.voiceImgTag>3&&(this.voiceImgTag=0)},500),this.audioStart=!0)}else this.audioPause=!0,this.audioStart=!1,e.pause(),clearInterval(this.voiceAnimationTimer),this.currentPlayAudio.imageIcon=this.defaultVoiceIcon},100)},toClearAudio(t){t&&!t.paused&&t.pause(),this.voiceAnimationTimer&&clearInterval(this.voiceAnimationTimer),this.currentPlayAudio={}}}}},g6H1:function(t,e,s){"use strict";var i=s("vQrK"),a=s.n(i),n=s("XmpP"),o=s("HnSg"),r=s("YjsE"),l=s("NAIw"),c=s("ZKhp"),d=s("Y/WH"),u=s("xEMq"),h=s("4B+h"),p=s("CjVY"),m=s.n(p),g=s("cybb"),f=s("L2JU"),v=s("LsMU"),w={props:{currentType:{type:String,default:""},messages:{type:Array,default:()=>[]},hideTextBorder:{type:Boolean,default:!1},modalLeft:{type:Boolean,default:!1},pageName:{type:String,default:""}},mixins:[n.a],inject:["showErrorImg"],components:{LimitedTextarea:o.a,StruMessageDetail:r.a,VideoDetailCard:l.VideoDetailCard,VoiceDetailCard:c.VoiceDetailCard,MiniProgramDetail:d.a,SkillDetailCard:v.SkillDetailCard},computed:a()({},Object(f.c)({currentUser:"user/currentUser"})),watch:{messages(){"text"===this.currentType&&this.messages.length>0&&(this.textContent=this.messages[0].content?this.messages[0].content:this.messages[0].textBody)}},data:()=>({showEditTextPopup:!1,canSaveTextMsg:!0,textContent:"",canSave:!1,textLimit:2e3}),created(){"text"===this.currentType&&this.messages.length>0&&(this.textContent=this.messages[0].content||this.messages[0].textBody)},methods:{getDisplayedDatetime(t){return Object(g.e)(t,this.currentUser.TimeZoneSidKey)},decorateTextMessage:t=>m.a.decorateText(t),editText(){this.showEditTextPopup=!0},closeEditText(){this.showEditTextPopup=!1,this.showSetLink=!1,this.textContent=this.messages[0].content||this.messages[0].textBody},async saveText(){if(this.messages[0].id){this.canSaveTextMsg=!1;try{const t=await Object(u.k)(this.textContent,this.messages[0].id);this.canSaveTextMsg=!0,t.ok?(this.$emit("update",this.textContent),this.showEditTextPopup=!1,this.$router.app.$emit("open-toast-notification",{content:this.$t("notifyContent"),type:"success"})):Object(h.f)(t)}catch(t){this.canSaveTextMsg=!0,Object(h.f)(t)}}else this.showEditTextPopup=!1,this.$emit("update",this.textContent)},onLimitedTextareaChange(t){let{content:e,size:s}=t;this.textContent=e,this.canSave=!(0===s||s>this.textLimit)},selectMergeField(t){this.textContent=this.textContent+t,this.$root.$emit("merge-field-value",this.textContent),this.closeMergeField()}}},b=(s("hN3G"),s("KHd+")),_=s("NflP"),y=Object(b.a)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"charket-message-detail"}},["structureMessage"===t.currentType?s("div",{staticClass:"select-news-wrapper"},[s("stru-message-detail",{attrs:{"structure-message":t.messages[0]}})],1):t._e(),t._v(" "),"video"===t.currentType?s("div",{staticClass:"select-video-wrapper"},[s("video-detail-card",{attrs:{title:t.messages[0].name,date:t.getDisplayedDatetime(t.messages[0].updateDateTime),description:t.messages[0].description}})],1):t._e(),t._v(" "),"voice"===t.currentType&&t.messages[0]?s("div",{staticClass:"select-video-wrapper"},[s("voice-detail-card",{attrs:{title:t.messages[0].name,image:t.messages[0].imageIcon,date:t._f("formatDatetimeFilter")(t.messages[0].updateDateTime,t.$user.TimeZoneSidKey)}})],1):t._e(),t._v(" "),"image"===t.currentType&&t.messages[0]?s("div",[s("img",{staticClass:"select-image-url",attrs:{src:t._f("imgFilter")(t.messages[0].url)},on:{error:function(e){return t.showErrorImg(e)}}})]):t._e(),t._v(" "),"text"===t.currentType&&t.messages.length>0?s("div",{staticClass:"text-mes-content",class:{"text-no-border":t.hideTextBorder}},[s("pre",{staticClass:"text-pre text-body",domProps:{innerHTML:t._s(t.decorateTextMessage(t.textContent))}}),t._v(" "),t.hideTextBorder?t._e():s("span",{staticClass:"text-edit-icon down-btn",on:{click:function(e){return t.editText()}}},[s("icon",{attrs:{name:"editReplyIcon","class-name":"down-icon",width:"16px",height:"16px"}})],1)]):t._e(),t._v(" "),t.messages.length>0&&("coupon"===t.currentType||"pass"===t.currentType)?s("div",{staticClass:"slds-box slds-grid coupon-block"},[s("div",{staticClass:"logo-content"},[s("div",{staticClass:"coupon-logo",style:{"background-image":"url("+t.messages[0].logoUrl+")"}})]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical slds-truncate"},[s("div",{staticClass:"slds-truncate slds-text-heading_small coupon-name",attrs:{title:t.messages[0].name}},[t._v(t._s(t.messages[0].name))]),t._v(" "),"coupon"===t.currentType?s("div",{staticClass:"slds-truncate coupon-type"},[t._v(t._s(t.messages[0].type))]):t._e(),t._v(" "),"pass"===t.currentType?s("div",{staticClass:"slds-truncate coupon-type"},[t._v(t._s(t.messages[0].brandName))]):t._e()])]):t._e(),t._v(" "),t.messages.length>0&&"skill"===t.currentType?s("skill-detail-card",{attrs:{name:t.messages[0].name,outlined:!t.hideTextBorder,internal:t.messages[0].isInternal}}):t._e(),t._v(" "),"miniProgramPage"===t.currentType?s("div",{staticClass:"select-mini-program-page-wrapper"},[s("mini-program-detail",{attrs:{miniProgramPage:t.messages[0]}})],1):t._e(),t._v(" "),t.showEditTextPopup?s("div",[s("div",{staticClass:"slds-modal slds-modal_large slds-fade-in-open",attrs:{"aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container show-selected-container new-width",class:{"modal-left":t.modalLeft},attrs:{role:"document",tabindex:"0"}},[s("div",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close",on:{click:function(e){return t.closeEditText()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.$t("editTextTitle")))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium new-height"},[s("limited-textarea",{attrs:{content:t.textContent,sum:t.textLimit,"double-modal":t.modalLeft,"show-merge-field":!!t.pageName},on:{change:t.onLimitedTextareaChange,"open-field":t.openMergeField}})],1),t._v(" "),s("div",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:!t.canSaveTextMsg},on:{click:function(e){return t.closeEditText()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:!t.canSaveTextMsg||!t.canSave},on:{click:function(e){return t.saveText()}}},[t._v(t._s(t.$t("global.saveBtn")))])])])]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open"})]):t._e()],1)}),[],!1,null,"6eef78ba",null);"function"==typeof _.default&&Object(_.default)(y);e.a=y.exports},gfwF:function(t,e,s){"use strict";var i=s("atAB");s.n(i).a},hG8I:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"newTextMessage":"新建文本消息","textMessages":"文本消息","designer":{"linkIcon":"添加链接","miniProgramIcon":"添加小程序链接","actionIcon":"添加动作","mergeFieldIcon":"插入合并字段","changeBtn":"更改","removeBtn":"删除","linkUrl":"链接网址","illegalUrl":"不合法的网址","appId":"App ID","pagePath":"页面路径","name":"名称","value":"值","selectAField":"选择一个字段","fieldTitle":"你已选择以下字段","findObjectPlaceholder":"查找对象...","labelFilterPlaceholder":"键入以过滤列表...","type":"类型","apiName":"API名","currentSelection":"当前选择","noMatchesFound":"没有发现匹配项"}},"en":{"newTextMessage":"New Text Message","textMessages":"Text Messages","designer":{"linkIcon":"Add link","miniProgramIcon":"Add mini program link","actionIcon":"Add action","mergeFieldIcon":"Insert merge field","changeBtn":"Change","removeBtn":"Remove","linkUrl":"Link URL","illegalUrl":"Invalid URL","appId":"App ID","pagePath":"Page Path","name":"Name","value":"Value","selectAField":"Select A Field","fieldTitle":"You have selected the following field","findObjectPlaceholder":"Find An Object...","labelFilterPlaceholder":"Type here to filter the list...","type":"Type","apiName":"API Name","currentSelection":"Current Selection","noMatchesFound":"No matches found"}}}'),delete t.options._Ctor}},hN3G:function(t,e,s){"use strict";var i=s("hNF5");s.n(i).a},hNF5:function(t,e,s){},hQq0:function(t,e,s){"use strict";var i=s("q8qk"),a=s.n(i);e.default=a.a},hkfk:function(t,e,s){"use strict";var i=s("fGFX");s.n(i).a},hp0C:function(t,e,s){},iDmT:function(t,e,s){"use strict";var i=s("mm8Y"),a=s.n(i);e.default=a.a},jjsR:function(t,e,s){"use strict";var i=s("WJ6L");s.n(i).a},"k+Ky":function(t,e,s){"use strict";var i=s("WHkT");s.n(i).a},"k/9o":function(t,e,s){"use strict";var i=s("qVZU"),a=s.n(i);e.default=a.a},kajw:function(t,e,s){"use strict";var i=s("c/J/"),a=s.n(i);e.default=a.a},lNHh:function(t,e,s){"use strict";var i=s("svHN"),a=s.n(i);e.default=a.a},mm8Y:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"editTitle":"编辑名称","notifyContent":"修改已保存。"},"en":{"editTitle":"Edit Name","notifyContent":"Your changes are saved."}}'),delete t.options._Ctor}},nOmU:function(t,e,s){"use strict";var i=s("yWOo");s.n(i).a},"o4o+":function(t,e,s){"use strict";var i=s("sXZA"),a=s.n(i);e.default=a.a},oIjN:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"newMassMessage":"新建群发消息","massSent":"已群发","send":"发送","schedule":"定时","massSendTitle":"群发{0}","sureToSendNotify":"确定要发送这条消息吗？","sureToScheduleNotify":"确定要定时发送这条消息吗？","notifySubSuccess":"请求已经提交。发送当前模板消息所需要的时间依赖与 Salesforce 和微信服务器的系统可用资源。发送完成后，你将收到电子邮件通知。","msgSubSuccess":"请求已经提交。发送当前消息所需要的时间依赖与 Salesforce 和微信服务器的系统可用资源。发送完成后，你将收到电子邮件通知。","massMsgLabel":"群发消息","sureToSendMessage":"发送这条消息将消耗你每月4次的主动发送权限，你确定要发送吗？","notifyMsgTitle":"取消发送","notifyMsgContent":"你确定要取消这次发送吗?"},"en":{"newMassMessage":"New Mass Message","massSent":"Messages Sent","send":"Send","schedule":"Schedule","massSendTitle":"Mass Send {0}","sureToSendNotify":"Are you sure you want to send it?","sureToScheduleNotify":"Are you sure you want to schedule it?","notifySubSuccess":"Your request was submitted. Delivering this notification may take a while depending on Salesforce and WeChat servers’ resource availability. You will receive an email with notification delivery information.","msgSubSuccess":"Your request was submitted. Delivering this mass message may take a while depending on Salesforce and WeChat servers’ resource availability. You will receive an email with message delivery information.","massMsgLabel":"Mass Message","sureToSendMessage":"Sending this message will use one of your monthly quota of 4 business initiated messages. Are your sure you want to send it?","notifyMsgTitle":"Cancel Send","notifyMsgContent":"Are you sure you want to cancel this sending?"}}'),delete t.options._Ctor}},pI6M:function(t,e,s){},pUDi:function(t,e,s){"use strict";var i=s("SLhn"),a=s.n(i),n=s("3O4B"),o=s.n(n),r=s("WE60"),l=s.n(r),c=s("wG3i"),d=s.n(c),u=s("Ip10"),h=s.n(u),p=s("+Bun"),m=s.n(p),g=s("0G99"),f=s.n(g),v=s("vQrK"),w=s.n(v),b=s("mdEO"),_=s("TDue"),y=s("vkTm"),C=s("ngIk"),S=s("dcdS"),T=s("oWfJ"),I=s("L2JU"),x={components:{SelectField:_.a,ColorPicker:y.a,InputSelect:C.a,Dropdown:S.a,PhoneFrameCard:b.PhoneFrameCard},mixins:[T.a],props:{notify:{type:Object,default:()=>({contentTemplate:{keywords:[]}})},selectedMiniProgram:{type:Object,default:function(){return{}}},wechatAccountId:{type:String,default:()=>""}},data(){return{colorPickerPosition:"",newNotify:{},notifyColor:{first:"#000000",keywords:[],remark:"#000000"},colorType:"",mergeFieldType:"",keywords:[],notificationURL:"",note:"",showMergeField:!1,notifyFirst:"",notifyRemark:"",showFirst:"",showRemark:"",fieldObj:{},redirectOptionData:{options:[{Name:this.$t("urlLabel"),Value:"URL"},{Name:this.$t("global.miniProgramLabel"),Value:"Mini Program Page"}],currents:[{Name:this.$t("urlLabel"),Value:"URL"}]},selectedMiniProgramPage:{}}},computed:w()({},Object(I.c)({currentAccount:"sidebar/currentAccount"}),{isRedirectToURL(){return"URL"===this.redirectOptionData.currents[0].Value},isShowDetail(){return this.notificationURL||this.selectedMiniProgramPage.messageId}}),created(){this.newNotify=this.notify,this.notificationURL=this.newNotify.NotificationURL||"";let t=this.newNotify.Content.split(/{{.*?}}/gm),e=this.newNotify.Content.match(/{{.*?}}/gm),s=[];if(f()(t).call(t,(t,i)=>{s.push({name:t,value:e[i],key:e[i],color:"#000000"})}),this.$set(this.newNotify,"contentTemplate",s),this.notify.Id){var i,a;this.fieldObj=this.newNotify.mergeFieldObject;let t=h()(i=this.newNotify.contentTemplate).call(i,t=>{var e;return t.key&&0===m()(e=t.key).call(e,"{{first.")}),s=h()(a=this.newNotify.contentTemplate).call(a,t=>{var e;return t.key&&0===m()(e=t.key).call(e,"{{remark.")});t&&(t.color=this.newNotify.ContentMapping.first.color,t.value=this.newNotify.ContentMapping.first.value,this.notifyFirst=this.newNotify.ContentMapping.first.value,this.notifyColor.first=this.newNotify.ContentMapping.first.color),s&&(s.color=this.newNotify.ContentMapping.remark.color,s.value=this.newNotify.ContentMapping.remark.value,this.notifyRemark=this.newNotify.ContentMapping.remark.value,this.notifyColor.remark=this.newNotify.ContentMapping.remark.color),f()(e).call(e,(t,e)=>{if(0===m()(t).call(t,"{{first."))this.showFirst=t;else if(0===m()(t).call(t,"{{remark."))this.showRemark=t;else{var s;let e=t.match(/({{=?)(\S*)(?=.DATA)/g);const i=e[0].substr(2,e[0].length-1);this.keywords.push({label:i,value:this.newNotify.ContentMapping[i].value}),this.notifyColor.keywords.push(this.newNotify.ContentMapping[i].color);let a=h()(s=this.newNotify.contentTemplate).call(s,t=>t.key.replace(/{{/,"").replace(/.DATA}}/,"")===i);a.value=this.newNotify.ContentMapping[i].value,a.color=this.newNotify.ContentMapping[i].color}}),this.notificationURL=this.newNotify.ContentMapping.url||this.notificationURL}else f()(e).call(e,(t,e)=>{if(0===m()(t).call(t,"{{first."))this.showFirst=t;else if(0===m()(t).call(t,"{{remark."))this.showRemark=t;else{let e=t.match(/({{=?)(\S*)(?=.DATA)/g);this.keywords.push({label:e[0].substr(2,e[0].length-1),value:""}),this.notifyColor.keywords.push("#000000")}});this.note=this.newNotify.Note||"",this.selectedMiniProgram.messageId&&(this.redirectOptionData.currents=[{Name:this.$t("global.miniProgramLabel"),Value:"Mini Program Page"}],this.selectedMiniProgramPage=JSON.parse(d()(this.selectedMiniProgram)))},methods:{changeFirst(t){var e;h()(e=this.newNotify.contentTemplate).call(e,t=>{var e;return 0===m()(e=t.key).call(e,"{{first.")}).value=this.notifyFirst},changeRemark(){var t;h()(t=this.newNotify.contentTemplate).call(t,t=>{var e;return 0===m()(e=t.key).call(e,"{{remark.")}).value=this.notifyRemark},changeKey(t,e,s){var i;h()(i=this.newNotify.contentTemplate).call(i,t=>t.key.replace(/{{/,"").replace(/.DATA}}/,"")===s).value=t.target.value,this.keywords[e].value=t.target.value},onBgColor(t){if("first"===this.colorType){var e;this.notifyColor.first=t,h()(e=this.newNotify.contentTemplate).call(e,t=>{var e;return 0===m()(e=t.key).call(e,"{{first.")}).color=t}else if("remark"===this.colorType){var s;this.notifyColor.remark=t,h()(s=this.newNotify.contentTemplate).call(s,t=>{var e;return 0===m()(e=t.key).call(e,"{{remark.")}).color=t}else{var i,a,n;const e=l()(i=this.keywords).call(i,t=>t.label===this.colorType);o()(a=this.notifyColor.keywords).call(a,e,1,t),h()(n=this.newNotify.contentTemplate).call(n,t=>t.key.replace(/{{/,"").replace(/.DATA}}/,"")===this.colorType).color=t}},openColorPicker(t,e,s){var i;this.$refs.bgColorList.close(),this.colorType=s,this.colorPickerPosition=a()(i="position: absolute; left: ".concat(e,"px; top: ")).call(i,t,"px;"),this.$refs.bgColorList.open()},openSelectField(t){this.showMergeField=!0,this.mergeFieldType=t},closeSelectFiled(){this.showMergeField=!1},selectMergeField(t,e){if(this.fieldObj.label!==e.label&&(this.fieldObj=JSON.parse(d()(e))),"first"===this.mergeFieldType){var s;h()(s=this.newNotify.contentTemplate).call(s,t=>{var e;return 0===m()(e=t.key).call(e,"{{first.")}).value=this.notifyFirst+t,this.notifyFirst=this.notifyFirst+t}else if("remark"===this.mergeFieldType){var i;h()(i=this.newNotify.contentTemplate).call(i,t=>{var e;return 0===m()(e=t.key).call(e,"{{remark.")}).value=this.notifyRemark+t,this.notifyRemark=this.notifyRemark+t}else if("url"===this.mergeFieldType)this.notificationURL=t;else{var a,n;let e=h()(a=this.newNotify.contentTemplate).call(a,t=>{var e;return m()(e=t.key).call(e,this.mergeFieldType)>=0});const s=l()(n=this.keywords).call(n,t=>t.label===this.mergeFieldType);e.value=this.keywords[s].value,e.value=e.value+t,this.keywords[s].value=this.keywords[s].value+t}this.showMergeField=!1},prepareUpdatedData(){var t,e;let s={ContentMapping:{}};return s.Note=this.note,s.Title=this.newNotify.Title,this.showFirst&&(s.ContentMapping.first={value:this.notifyFirst,color:this.notifyColor.first}),f()(t=this.keywords).call(t,(t,e)=>{s.ContentMapping[t.label]={value:t.value,color:this.notifyColor.keywords[e]}}),this.showRemark&&(s.ContentMapping.remark={value:this.notifyRemark,color:this.notifyColor.remark}),this.isRedirectToURL?(s.NotificationURL=this.notificationURL,this.selectedMiniProgramPage={}):(this.notificationURL="",s.MiniProgramPageId=this.selectedMiniProgramPage.messageId||""),m()(e=this.notificationURL).call(e,"{!")>=0&&(s.NotificationURL="",s.ContentMapping.url=this.notificationURL),s},prepareCreatedData(){let t=this.prepareUpdatedData();return t.Content=this.newNotify.Content,this.newNotify.Industry&&(t.Industry=this.newNotify.Industry),this.newNotify.Sample&&(t.Sample=this.newNotify.Sample),t.TemplateId=this.newNotify.TemplateId,t},onChangeRedirectTo(t){this.redirectOptionData.currents=t,this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1},onMiniProgramChanged(t){this.selectedMiniProgramPage=t}}},L=(s("Fblv"),s("KHd+")),M=s("A3YL"),P=Object(L.a)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-grid slds-grid_vertical-align-start new-notification-page"},[s("phone-frame-card",{staticClass:"phone-model-outer",attrs:{name:t.currentAccount.Name}},[s("div",{attrs:{slot:"app-name"},slot:"app-name"},[t._v(t._s(t.$t("global.wechatLabel")))]),t._v(" "),s("span",{attrs:{slot:"back-label"},slot:"back-label"},[t._v(t._s(t.$t("global.backBtn")))]),t._v(" "),s("div",{staticClass:"phone-model-body",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"slds-box template-container"},[s("div",{staticClass:"template-section",class:{"has-padding":!t.isShowDetail}},[s("span",{staticClass:"slds-text-heading_small title",class:{"key-title":!t.showFirst}},[t._v(t._s(t.newNotify.Title))]),t._v(" "),t._l(t.newNotify.contentTemplate,(function(e){return[e.name?s("pre",{staticClass:"keyword"},[t._v(t._s(e.name))]):t._e(),t._v(" "),e.value?s("pre",{staticClass:"keyword",style:{color:e.color}},[t._v(t._s(e.value))]):t._e()]})),t._v(" "),t.isShowDetail?s("div",{staticClass:"detail-section",class:{"mini-program-detail":!t.isRedirectToURL}},[t.isRedirectToURL?t._e():s("icon",{staticClass:"mini-program-icon",attrs:{name:"miniProIcon",width:"16px",height:"16px","fill-color":"#706e6b","charket-icon":""}}),t._v(" "),t.isRedirectToURL?s("span",{staticClass:"slds-text-body_regular detail-value"},[t._v("\n              "+t._s(t.$t("detailsLabel"))+"\n            ")]):t._e(),t._v(" "),s("span",{staticClass:"detail-icon"},[s("icon",{attrs:{name:"chevronright","fill-color":"#b0adab",width:"14px",height:"14px"}})],1)],1):t._e()],2)])]),t._v(" "),s("div",{staticClass:"slds-col phone-model-footer",attrs:{slot:"action"},slot:"action"},[s("icon",{attrs:{name:"add","fill-color":"slds-icon_container slds-icon-text-default",width:"20px",height:"20px"}})],1)]),t._v(" "),s("div",{staticClass:"right"},[s("div",{staticClass:"right-content"},[s("span",{staticClass:"slds-text-heading_small content-title"},[t._v(t._s(t.$t("templateSettingLabel")))]),t._v(" "),t.showFirst?s("div",{staticClass:"input-section"},[s("label",[t._v("First")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.notifyFirst,expression:"notifyFirst"}],staticClass:"slds-textarea value first",style:{color:t.notifyColor.first},domProps:{value:t.notifyFirst},on:{keyup:function(e){return t.changeFirst(e)},input:function(e){e.target.composing||(t.notifyFirst=e.target.value)}}}),t._v(" "),s("span",{staticClass:"insert-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openSelectField("first")}}},[s("icon",{attrs:{name:"insertTag","class-name":"down-icon",width:"15px",height:"15px"}})],1),t._v(" "),s("span",{staticClass:"color-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openColorPicker(100,755,"first")}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1)]):t._e(),t._v(" "),t._l(t.keywords,(function(e,i){return s("div",{staticClass:"input-section"},[s("label",[t._v(t._s(e.label))]),t._v(" "),s("input",{staticClass:"slds-input value",style:{color:t.notifyColor.keywords[i]},attrs:{type:"text"},domProps:{value:e.value},on:{keyup:function(s){return t.changeKey(s,i,e.label)}}}),t._v(" "),s("span",{staticClass:"insert-icon short-icon down-btn",on:{click:function(s){return s.stopPropagation(),t.openSelectField(e.label)}}},[s("icon",{attrs:{name:"insertTag","class-name":"down-icon",width:"15px",height:"15px"}})],1),t._v(" "),t.showFirst?s("span",{staticClass:"color-icon short-icon down-btn",on:{click:function(s){return s.stopPropagation(),t.openColorPicker(212+70*i,755,e.label)}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1):t._e(),t._v(" "),t.showFirst?t._e():s("span",{staticClass:"color-icon short-icon down-btn",on:{click:function(s){return s.stopPropagation(),t.openColorPicker(110+70*i,755,e.label)}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1)])})),t._v(" "),t.showRemark?s("div",{staticClass:"input-section"},[s("label",[t._v("Remark")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.notifyRemark,expression:"notifyRemark"}],staticClass:"slds-textarea value",style:{color:t.notifyColor.remark},domProps:{value:t.notifyRemark},on:{keyup:function(e){return t.changeRemark()},input:function(e){e.target.composing||(t.notifyRemark=e.target.value)}}}),t._v(" "),s("span",{staticClass:"insert-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openSelectField("remark")}}},[s("icon",{attrs:{name:"insertTag","class-name":"down-icon",width:"15px",height:"15px"}})],1),t._v(" "),t.showFirst?s("span",{staticClass:"color-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openColorPicker(204+70*t.keywords.length,755,"remark")}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1):t._e(),t._v(" "),t.showFirst?t._e():s("span",{staticClass:"color-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openColorPicker(102+70*t.keywords.length,755,"remark")}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1)]):t._e(),t._v(" "),s("div",{staticClass:"input-section"},[s("label",[t._v("Redirect To")]),t._v(" "),s("div",{staticClass:"redirect-section"},[s("input-select",{staticClass:"redirect-section__picklist",attrs:{currents:t.redirectOptionData.currents},on:{"close-dropdown":t.closeDropdown,"open-dropdown":t.openDropdown,resize:t.resizeDropdown}}),t._v(" "),t.isRedirectToURL?s("div",{staticClass:"redirect-section__content"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.notificationURL,expression:"notificationURL"}],staticClass:"slds-input",attrs:{type:"text",placeholder:t.$t("placeholderLabel")},domProps:{value:t.notificationURL},on:{input:function(e){e.target.composing||(t.notificationURL=e.target.value)}}}),t._v(" "),s("span",{staticClass:"insert-icon down-btn",on:{click:function(e){return t.openSelectField("url")}}},[s("icon",{attrs:{name:"insertTag","class-name":"down-icon",width:"15px",height:"15px"}})],1)]):s("div",{staticClass:"redirect-section__content"},[s("mini-program-selector",{attrs:{selected:t.selectedMiniProgramPage,"wechat-account-id":t.wechatAccountId},on:{changed:function(e){return t.onMiniProgramChanged(e)}}})],1)],1)]),t._v(" "),s("span",{staticClass:"slds-text-heading_small content-title"},[t._v(t._s(t.$t("informationLabel")))]),t._v(" "),s("div",{staticClass:"input-section"},[s("label",[t._v(t._s(t.$t("noteLabel")))]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.note,expression:"note"}],staticClass:"slds-textarea value note",attrs:{placeholder:t.$t("placeholderLabel")},domProps:{value:t.note},on:{input:function(e){e.target.composing||(t.note=e.target.value)}}})])],2)]),t._v(" "),s("div",{style:t.colorPickerPosition},[s("color-picker",{ref:"bgColorList",attrs:{value:""},on:{"get-color":t.onBgColor}})],1),t._v(" "),t.showMergeField?s("select-field",{attrs:{"title-name":"Campaigin Members","field-obj":t.fieldObj,"primary-disabled":!!t.notify.Id},on:{"close-merge-field":function(e){return t.closeSelectFiled()},"select-merge-field":t.selectMergeField}}):t._e(),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.redirectOptionData.options,currents:t.redirectOptionData.currents,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth},on:{"select-option":function(e){return t.onChangeRedirectTo(e)},close:function(e){return t.closeDropdown()}}}):t._e()],1)}),[],!1,null,"57709f2e",null);"function"==typeof M.default&&Object(M.default)(P);e.a=P.exports},pehn:function(t,e,s){"use strict";var i=s("2n3x"),a=s.n(i);e.default=a.a},q8qk:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"previewTitle":"预览消息","wechatLabel":"微信号","savingBtn":"保存中","notifyContent":"你现在可以在微信应用程序中预览此消息。"},"en":{"previewTitle":"Preview Message","wechatLabel":"WeChat ID","savingBtn":"Saving...","notifyContent":"You can preview the message in the WeChat app now."}}'),delete t.options._Ctor}},qBq6:function(t,e,s){"use strict";var i=s("/CaJ"),a=s.n(i);e.default=a.a},qHqx:function(t,e,s){"use strict";var i=s("fBrU");s.n(i).a},qK12:function(t,e,s){"use strict";s.r(e);var i=s("rZkV"),a=s.n(i),n=s("vQrK"),o=s.n(n),r=s("SLhn"),l=s.n(r),c=s("dUVM"),d=s.n(c),u=s("Yvyk"),h=s.n(u),p=s("ngIk"),m=s("dcdS"),g=s("oWfJ"),f=s("g6H1"),v=s("NAIw"),w=s("YjsE"),b=s("ZKhp"),_=s("Wxjh"),y=s("F5n6"),C=s("w2Vt"),S=s("692z"),T=s("xxvK"),I=s("feiH"),x=s("/I/F"),L=s("4B+h"),M=s("LQ5e"),P=s.n(M),N=s("CjVY"),$=s.n(N),k=s("cybb"),D=s("L2JU"),A=s("xt0/"),E=s("jkSJ"),O={mixins:[I.a,g.a],computed:o()({},Object(D.c)({currentUser:"user/currentUser"})),components:{InputSelect:p.a,Dropdown:m.a,MessageDetail:f.a,Pagination:y.a,LoadingSpinner:C.a,NoRecord:S.a,VideoDetailCard:v.VideoDetailCard,StruMessageDetail:w.a,VoiceDetailCard:b.VoiceDetailCard,VideoPlayModal:T.a,ImagePreview:A.ImagePreview,NotificationTemplateDetailCard:_.NotificationTemplateDetailCard},mounted(){this.accountId=this.$route.params.accountId||"",this.accountId&&h.a.all([this.getMassSentList(),this.getStatus()]),this.$router.replace({path:"/".concat(this.accountId,"/mass/sent")})},inject:["showErrorImg"],filters:{filterMsgType:t=>"Structured Message"===t?"structureMessage":"Video"===t?"video":"Voice Message"===t?"voice":void 0},data(){return{accountId:"",sentList:[],currentPageNumber:1,messageCounts:10,currentSentListPagination:[],messagesTotal:0,hasMoreMassSent:!1,isLoadingSentList:!1,filterOptionData:{options:[],currentOptions:[{Name:this.$t("global.all")}]},statusFilter:"All",actionModalType:"",actionModalHead:"",actionModalContent:"",actionEventId:"",isWaitingAction:!1,currentPlayVideo:"",currentViewImage:{}}},methods:{isSendStatusIconVisible(t){var e;return!(!t.status||!t.status.value)&&("Send Success"===t.status.value||!!d()(e=["Approval Failed","Send Failed","Commit Failed"]).call(e,t.status.value)&&!!t.errorDetail)},isVideoDetailCardVisible:t=>t&&"Video"===t.type,getDisplayedDatetime(t){return Object(k.e)(t,this.currentUser.TimeZoneSidKey)},async getStatus(){try{const t=await Object(x.c)();if(t.ok){const e=JSON.parse(P.a.unescape(t.data));this.filterOptionData.options=e.MassStatus,this.filterOptionData.options.unshift({Name:this.$t("global.all"),Value:"All"})}else Object(L.f)(t)}catch(t){Object(L.f)(t)}},async getMassSentList(){this.isLoadingSentList=!0,await this.$try(async()=>{const t=await E.i.getEventsWithPaging({wechatAccountId:this.accountId,pageNumber:this.currentPageNumber,pageSize:this.messageCounts,statusFilter:this.statusFilter});this.sentList=t.events,this.hasMoreMassSent=t.paging.total.HasMore;for(const t of this.sentList){const s=Object(k.e)(t.createdDate,this.currentUser.TimeZoneSidKey);var e;if(t.createdByUser)t.createdBy=l()(e="".concat(t.createdByUser,", ")).call(e,s);else t.createdBy=s;t.scheduledDate=Object(k.e)(t.scheduledDate,this.currentUser.TimeZoneSidKey),t.message&&"Text Message"===t.message.type&&t.message.textBody&&(t.message.textBodyTitle=$.a.decorateText(t.message.textBody,"Plain Text")),t.template&&(t.template.localizedCreatedDate=Object(k.e)(t.template.createdDate,this.currentUser.TimeZoneSidKey))}this.currentSentListPagination=t.paging.pages,this.messagesTotal=t.paging.total.Count}),this.isLoadingSentList=!1},selectPicklist(t){this.filterOptionData.currentOptions=t,this.statusFilter=t[0].Value,this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1,this.currentPageNumber=1,this.getMassSentList()},goToTargetPage(t){this.currentPageNumber=t,this.getMassSentList(),document.getElementsByClassName("right-page-section")[0].scrollTop=0},getMenuItems(t){const e=[{value:"moreInfo",label:this.$t("moreInfoLabel"),target:t}];return"Pending"===t.status.value?e.push({value:"cancel",label:this.$t("global.cancelBtn"),target:t}):t.isDeletable&&e.push({value:"delete",label:this.$t("global.deleteBtn"),target:t}),e},onClickMenuItem(t){const{value:e,target:s}=t;"moreInfo"===e?window.open("/".concat(s.eventId)):this.openActionModal(s,e)},openActionModal(t,e){this.$refs.actionModal.open(),this.actionEventId=t.eventId,this.actionModalType=e,"cancel"===e?(this.actionModalHead=this.$t("cancelMassSend"),this.actionModalContent=this.$t("sureToCancel")):(this.actionModalHead=this.$t("deleteMassSend"),this.actionModalContent=this.$t("sureToDelete"))},async deleteMessage(){this.isWaitingAction=!0;try{const t=await Object(x.b)(this.accountId,this.actionEventId);this.solveActionResult(t)}catch(t){this.isWaitingAction=!1,Object(L.f)(t)}},async cancelSchedule(){this.isWaitingAction=!0;try{const t=await Object(x.a)(this.accountId,this.actionEventId);this.solveActionResult(t)}catch(t){this.isWaitingAction=!1,Object(L.f)(t)}},solveActionResult(t){this.isWaitingAction=!1,this.$refs.actionModal.close(),t.ok?this.getMassSentList():Object(L.f)(t)},playVideo(t){t.url&&(this.currentPlayVideo=t)},closePlayVideo(){this.currentPlayVideo=""},playAudio(t){const e=document.querySelector("#voicePopupAudio");this.toPlayAudio(t,e)},clearPlayAudio(){if("voice"===this.popupType){const t=document.querySelector("#voicePopupAudio");this.toClearAudio(t)}},viewImage(t){this.currentViewImage=t,this.$refs.ImagePreview.open()},decorateTextMessage:t=>$.a.decorateText(t)},beforeDestroy(){this.clearPlayAudio()}},F=(s("aVPg"),s("KHd+")),j=s("A7Fh"),B=Object(F.a)(O,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-grid slds-grid_vertical mass-sent-list-page"},[s("div",{staticClass:"slds-border_bottom slds-grid slds-grid_vertical-align-center sent-list-header"},[s("span",[t._v(t._s(t._f("addSeparators")(t.messagesTotal))),t.hasMoreMassSent?s("i",{staticClass:"show-plus-sign"},[t._v("+")]):t._e(),t._v("\n      "+t._s(t.messagesTotal>1?t.$t("item",["s"]):t.$t("item",[""]))+"\n    ")]),t._v(" "),s("div",{staticClass:"mass-sent-filter"},[s("input-select",{attrs:{currents:t.filterOptionData.currentOptions},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1)]),t._v(" "),t.isLoadingSentList||0===t.messagesTotal?t._e():s("div",{staticClass:"slds-table--header-fixed_container sent-list-content"},[s("div",{staticClass:"slds-scrollable_y scroll-content"},[s("table",{staticClass:"slds-table slds-table_bordered slds-table_cell-buffer slds-no-row-hover slds-table--header-fixed list-table"},[s("thead",[s("tr",{staticClass:"slds-line-height_reset"},[s("th",{staticClass:"slds-is-sortable slds-is-resizable message-tab-width",attrs:{scope:"col"}},[s("div",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("message")}},[t._v(t._s(t.$t("message")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable sent-to-width",attrs:{scope:"col"}},[s("div",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("sendTo")}},[t._v(t._s(t.$t("sendTo")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable status-tab-action",attrs:{scope:"col"}},[s("div",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("status")}},[t._v(t._s(t.$t("status")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{scope:"col"}},[s("div",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("submittedBy")}},[t._v(t._s(t.$t("submittedBy")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{scope:"col"}},[s("div",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("scheduledDate")}},[t._v(t._s(t.$t("scheduledDate")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable action-tab-width",attrs:{scope:"col"}},[s("div",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("action")}},[t._v(t._s(t.$t("action")))])])])]),t._v(" "),s("tbody",t._l(t.sentList,(function(e,i){return s("tr",{staticClass:"slds-hint-parent tab-item"},[s("td",{attrs:{role:"gridcell","data-label":"MESSAGE"}},[e.message&&"Text Message"===e.message.type?s("pre",{staticClass:"slds-truncate sent-msg-text",attrs:{title:e.message.textBodyTitle},domProps:{innerHTML:t._s(t.decorateTextMessage(e.message.textBody))}}):t._e(),t._v(" "),e.message&&(e.message.type||e.message.Type)&&"Image"!==e.message.type&&"Text Message"!==e.message.type?s("div",{},[t.isVideoDetailCardVisible(e.message)?s("video-detail-card",{attrs:{title:e.message.name,date:t.getDisplayedDatetime(e.message.updateDateTime),description:e.message.description},on:{play:function(s){return t.playVideo(e.message)}}}):t._e(),t._v(" "),!e.message||"WeChat Structured Message"!==e.message.type&&"Link Structured Message"!==e.message.type?t._e():s("stru-message-detail",{attrs:{"structure-message":e.message,"allow-actions":!0}}),t._v(" "),e.message&&"Voice Message"===e.message.type?s("voice-detail-card",{attrs:{title:e.message.name,image:e.message.imageIcon,date:t._f("formatDatetimeFilter")(e.message.updateDateTime,t.$user.TimeZoneSidKey)},on:{play:function(s){return t.playAudio(e.message)}}}):t._e()],1):t._e(),t._v(" "),e.pass?s("div",{staticClass:"message-detail-wrapper"},[s("message-detail",{attrs:{currentType:"pass",messages:[e.pass]}})],1):t._e(),t._v(" "),e.coupon?s("div",{staticClass:"message-detail-wrapper"},[s("message-detail",{attrs:{currentType:"coupon",messages:[e.coupon]}})],1):t._e(),t._v(" "),e.message&&"Image"===e.message.type?s("div",{staticClass:"sent-msg-image",on:{click:function(s){return t.viewImage(e.message)}}},[s("img",{attrs:{src:t._f("imgFilter")(e.message.url)},on:{error:function(e){return t.showErrorImg(e)}}})]):t._e(),t._v(" "),e.template?s("div",{staticClass:"sent-msg-notify"},[s("notification-template-detail-card",{attrs:{"notification-template":e.template}})],1):t._e()]),t._v(" "),s("td",{attrs:{role:"gridcell","data-label":"SEND TO"}},[s("div",{staticClass:"slds-grid slds-grid_vertical"},t._l(e.sendTo,(function(e){return e.name?s("div",{staticClass:"slds-grid"},["All"!==e.label?s("span",{staticClass:"slds-truncate"},[t._v(t._s(e.label)+": ")]):t._e(),t._v(" "),"Campaign"===e.label||"Follower"===e.label?s("a",{staticClass:"slds-truncate campaign-width",attrs:{href:"/"+e.id,target:"_blank"}},[t._v(t._s(e.name))]):s("span",{staticClass:"slds-truncate",class:{"related-width":"Related To"===e.label,"tag-width":"Tag"===e.label,"status-width":"Member Status"===e.label}},[t._v(t._s(e.name))])]):t._e()})),0)]),t._v(" "),s("td",{attrs:{role:"gridcell","data-label":"STATUS"}},[s("div",{staticClass:"slds-grid send-message-status"},[s("span",{class:{"sent-success-color":"Send Success"===e.status.value,"failed-color":"Approval Failed"===e.status.value||"Send Failed"===e.status.value||"Commit Failed"===e.status.value},attrs:{title:e.status.label}},[t._v(t._s(e.status.label))]),t._v(" "),t.isSendStatusIconVisible(e)?s("div",{staticClass:"send-status-icon down-btn"},[s("icon",{attrs:{name:"info",width:"18px",height:"18px","class-name":"down-icon"}}),t._v(" "),s("div",{staticClass:"slds-text-body_small sidebar-dropdown-position",class:{"slds-dropdown":i<9,"slds-nubbin_top":i<9,"slds-nubbin_left":i>=9,"slds-box dropdown-right":i>=9}},["Send Failed"===e.status.value||"Commit Failed"===e.status.value||"Approval Failed"===e.status.value?s("div",{staticClass:"send-failed-content"},[t._v(t._s(e.errorDetail))]):t._e(),t._v(" "),"Send Success"===e.status.value?s("ul",{staticClass:"slds-dropdown__list",attrs:{role:"menu"}},[s("li",{staticClass:"slds-dropdown__item"},[s("a",{attrs:{href:"javascript:void(0);",role:"menuitem"}},[s("p",{staticClass:"slds-truncate"},[t._v(t._s(t.$t("totalFollowers"))+": "+t._s(e.totalFollowers))])])]),t._v(" "),s("li",{staticClass:"slds-dropdown__item"},[s("a",{attrs:{href:"javascript:void(0);",role:"menuitem"}},[s("p",{staticClass:"slds-truncate"},[t._v(t._s(t.$t("successTotal"))+": "+t._s(e.successTotal))])])]),t._v(" "),s("li",{staticClass:"slds-dropdown__item"},[s("a",{attrs:{href:"javascript:void(0);",role:"menuitem"}},[s("p",{staticClass:"slds-truncate"},[t._v(t._s(t.$t("failedTotal"))+": "+t._s(e.failedTotal))])])])]):t._e()])],1):t._e()])]),t._v(" "),s("td",{attrs:{role:"gridcell","data-label":"SUBMITTED BY"}},[s("div",{staticClass:"slds-truncate",attrs:{title:e.createdBy}},[t._v("\n                "+t._s(e.createdBy)+"\n              ")])]),t._v(" "),s("td",{attrs:{role:"gridcell","data-label":"SCHEDULED DATE"}},[e.scheduledDate?s("div",{staticClass:"slds-truncate",attrs:{title:e.scheduledDate}},[t._v("\n                "+t._s(e.scheduledDate)+"\n              ")]):t._e()]),t._v(" "),s("td",{attrs:{role:"gridcell","data-label":"ACTION"}},[s("ld-action-menu",{attrs:{items:t.getMenuItems(e)},on:{click:function(e){return t.onClickMenuItem(e)}}})],1)])})),0)]),t._v(" "),t.isLoadingSentList?t._e():s("pagination",{attrs:{paginations:t.currentSentListPagination,"page-number":t.currentPageNumber},on:{target:t.goToTargetPage}})],1)]),t._v(" "),t.isLoadingSentList||0!==t.messagesTotal?t._e():s("no-record",{attrs:{"custom-style":"top: 80px;"}}),t._v(" "),s("ld-modal",{ref:"actionModal",attrs:{title:t.actionModalHead},scopedSlots:t._u([{key:"content",fn:function(){return[s("p",{staticClass:"slds-p-around_medium text-align-center"},[t._v(t._s(t.actionModalContent))])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{disabled:t.isWaitingAction,neutral:""},on:{click:function(e){return t.onClickCancelButton()}}},[t._v("\n        "+t._s(t.$t("global.cancelBtn"))+"\n      ")]),t._v(" "),"delete"===t.actionModalType?s("ld-button",{attrs:{disabled:t.isWaitingAction,brand:""},on:{click:function(e){return t.deleteMessage()}}},[t._v("\n        "+t._s(t.$t("global.confirmBtn"))+"\n      ")]):t._e(),t._v(" "),"cancel"===t.actionModalType?s("ld-button",{attrs:{disabled:t.isWaitingAction,brand:""},on:{click:function(e){return t.cancelSchedule()}}},[t._v("\n        "+t._s(t.$t("global.confirmBtn"))+"\n      ")]):t._e()]},proxy:!0}])}),t._v(" "),s("loading-spinner",{attrs:{"is-loading":t.isLoadingSentList,"custom-style":"top: 80px;"}}),t._v(" "),""!==t.currentPlayVideo?s("video-play-modal",{attrs:{"current-play-video":t.currentPlayVideo},on:{close:function(e){return t.closePlayVideo()}}}):t._e(),t._v(" "),s("audio",{attrs:{src:t.currentPlayAudio.url,id:"voicePopupAudio"}}),t._v(" "),s("image-preview",{ref:"ImagePreview",attrs:{url:t._f("imgFilter")(t.currentViewImage.url),name:t.currentViewImage.name}}),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.filterOptionData.options,currents:t.filterOptionData.currentOptions,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e()],1)}),[],!1,null,"4be7e0dc",null);"function"==typeof j.default&&Object(j.default)(B);var U=B.exports,R=s("R9hF"),V=s.n(R),H=s("wG3i"),q=s.n(H),W=s("3nmp"),z=s("Pjfr");const J={HasSelectedListView:!1,SelectedListView:{Id:"",Label:"",SObjectType:""}};var G={components:{LdPicklist:z.LdPicklist},data(){return{defaultObjectType:"",defaultListView:"",listViewOptions:this.fetchListView,filters:JSON.parse(q()(J)),objectTypeOptions:this.fetchObjectType}},watch:{"filters.SelectedListView.SObjectType"(t){this.$refs.ListView.reset(),this.onListViewChange(),t&&(this.listViewOptions=this.fetchListView)}},methods:{async fetchObjectType(){try{return await E.g.getListViewSupportedSObjects()}catch(t){this.$handleError(t)}},async fetchListView(){try{return await E.g.getListViews(this.filters.SelectedListView.SObjectType)}catch(t){this.$handleError(t)}},async onObjectTypeChange(t){this.filters.SelectedListView.SObjectType=t?t.value:"",this.$emit("object-type-changed")},onListViewChange(t){this.filters.HasSelectedListView=!!t,this.filters.SelectedListView.Id=t?t.value:"",this.filters.SelectedListView.Label=t?t.label:"",this.$emit("list-view-changed",this.filters)},reset(){this.$refs.ObjectType.reset(!0),this.$refs.ListView.reset(),this.filters=JSON.parse(q()(J)),this.$emit("reset",this.filters)}}},K=(s("yMTf"),s("T2h/"),s("cfGg")),Z=Object(F.a)(G,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-grid slds-grid_vertical filters"},[s("div",{staticClass:"slds-grid slds-grid_vertical filters__object-type"},[s("div",{staticClass:"slds-text-body_small filters__title"},[t._v("\n      "+t._s(t.$t("objectTypeLabel"))+"\n    ")]),t._v(" "),s("div",{staticClass:"filters__picklist"},[s("ld-picklist",{ref:"ObjectType",attrs:{options:t.objectTypeOptions,value:t.defaultObjectType,placeholder:t.$t("global.noneLabel"),"no-records-label":t.$t("global.noRecords"),"invert-select":!0},on:{change:function(e){return t.onObjectTypeChange(e)}}})],1)]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical filters__listview"},[s("div",{staticClass:"slds-text-body_small filters__title"},[t._v("\n      "+t._s(t.$t("listViewLabel"))+"\n    ")]),t._v(" "),s("div",{staticClass:"filters__picklist"},[s("ld-picklist",{ref:"ListView",attrs:{options:t.listViewOptions,value:t.defaultListView,placeholder:t.$t("global.noneLabel"),"no-records-label":t.$t("global.noRecords"),"invert-select":!0,disabled:!t.filters.SelectedListView.SObjectType},on:{change:function(e){return t.onListViewChange(e)}}})],1)])])}),[],!1,null,"15322bd8",null);"function"==typeof K.default&&Object(K.default)(Z);var Y=Z.exports,X=s("V9RP"),Q=s("2AFw"),tt=s("4IgH"),et={mixins:[g.a],components:{InputSelect:p.a,Dropdown:m.a,TagDropdown:X.a,Lookup:Q.a},mounted(){this.accountId=this.$route.params.accountId||""},watch:{dropdownRefId:async function(){if("Status"===this.dropdownType){if(this.statusOptionData.options.length<=0)try{this.dropdownOptionData.options=[],this.dropdownOptionData.currents=[];let t=await Object(tt.b)(this.selectedCampaignId);if(t=JSON.parse(P.a.unescape(t.data)),t.campaignMemberStatus.length>0)for(const e of t.campaignMemberStatus)this.statusOptionData.options.push({Name:e,value:e});this.dropdownOptionData.options=this.statusOptionData.options,this.dropdownOptionData.currents=this.statusOptionData.currents}catch(t){Object(L.f)(t)}this.dropdownOptionData.options=this.statusOptionData.options,this.dropdownOptionData.currents=this.statusOptionData.currents}else"Related"===this.dropdownType&&(this.dropdownOptionData.options=this.relatedOptionData.options,this.dropdownOptionData.currents=this.relatedOptionData.currents)}},data(){return{accountId:"",currentCampaignItem:null,campaignMetadata:{name:"Campaign",label:this.$tc("global.campaignName",1),labelPural:this.$tc("global.campaignName",2),icon:"campaign",linkField:{name:"Name",label:this.$tc("global.campaignName",1)},fields:[],newObjectLink:"/701/e"},selectedTagId:"",selectedCampaignId:"",relatedOptionData:{options:[{Name:this.$t("noRelated"),value:"No Related"},{Name:this.$t("lead"),value:"Lead"},{Name:this.$t("contact"),value:"Contact"}],currents:[{Name:this.$t("global.all")}]},filterJson:{HasSelectedCampaign:!1,HasSelectedTag:!1,HasSelectedRelatedTo:!1,SelectedCampaign:{Id:null,Name:"",status:null},SelectedTag:{Id:null,WechatTagId:0,Name:""},RelatedTo:null},tagOptions:[],statusOptionData:{options:[],currents:[]}}},computed:o()({},Object(D.c)({currentAccount:"sidebar/currentAccount"}),{showCampaignFilter(){return"Service Account"===this.currentAccount.Type}}),methods:{selectTags(t){this.tagOptions=t,t.length>0?(this.selectedTagId=t[0].Id,this.wechatTagId=t[0].WeChatId,this.$root.$emit("close-other-dropdown",null),this.showTagDropdown=!1):(this.selectedTagId="",this.wechatTagId="",this.filterJson.HasSelectedTag=!1,this.filterJson.SelectedTag.Id=""),this.selectedTagId&&(this.filterJson.HasSelectedTag=!0,this.filterJson.SelectedTag.Id=this.selectedTagId,this.filterJson.SelectedTag.Name=t[0].Name,this.filterJson.SelectedTag.WechatTagId=this.wechatTagId),this.$emit("select",this.filterJson)},onCampaignSelect(t){this.selectedCampaignId=t.id||"",t.id&&(this.filterJson.HasSelectedCampaign=!0,this.filterJson.SelectedCampaign.Id=t.id,this.filterJson.SelectedCampaign.Name=t.name,this.$emit("select",this.filterJson))},onCampaignRemove(){this.filterJson.HasSelectedCampaign=!1,this.filterJson.SelectedCampaign={Id:null,Name:"",status:null},this.selectedCampaignId="",this.statusOptionData.options=[],this.statusOptionData.currents=[],this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1,this.$emit("reset",this.filterJson)},selectPicklist(t){t.length>0?"Status"===this.dropdownType?(this.filterJson.SelectedCampaign.status=t[0].value,this.statusOptionData.currents=t):"Related"===this.dropdownType&&(this.relatedOptionData.currents=t,this.filterJson.HasSelectedRelatedTo=!0,this.filterJson.RelatedTo=t[0].value):"Status"===this.dropdownType?(this.statusOptionData.currents=[],this.filterJson.SelectedCampaign.status=null):"Related"===this.dropdownType&&(this.relatedOptionData.currents=[],this.filterJson.HasSelectedRelatedTo=!1,this.filterJson.RelatedTo=null),this.$emit("select",this.filterJson),this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1},resetAllFilters(){this.currentCampaignItem=null,this.selectedTagId="",this.selectedCampaignId="",this.relatedOptionData.currents=[],this.statusOptionData.options=[],this.statusOptionData.currents=[],this.tagOptions=[],this.$refs.campaignLookup&&this.$refs.campaignLookup.clear(),this.filterJson={HasSelectedCampaign:!1,HasSelectedTag:!1,HasSelectedRelatedTo:!1,SelectedCampaign:{Id:null,Name:"",status:null},SelectedTag:{Id:null,WechatTagId:0,Name:""},RelatedTo:null},this.$emit("reset",this.filterJson)}}},st=(s("E4UP"),s("/rEz")),it=Object(F.a)(et,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-grid slds-grid_vertical mass-filters-section"},[s("div",{staticClass:"slds-grid slds-grid_vertical filter-tag-section"},[s("div",{staticClass:"slds-text-body_small filter-title"},[t._v(t._s(t.$t("tag")))]),t._v(" "),s("div",{staticClass:"filter-tag-wrapper"},[s("input-select",{attrs:{currents:t.tagOptions,"default-label":t.$t("global.all")},on:{"close-dropdown":t.closeDropdown,"open-dropdown":t.openTagDropdown,resize:t.resizeDropdown}})],1)]),t._v(" "),t.showCampaignFilter?s("div",{staticClass:"slds-grid slds-grid_align-spread filter-campaign-section"},[s("div",{staticClass:"slds-grid slds-grid_vertical filter-campaign-member"},[s("div",{staticClass:"slds-text-body_small filter-title"},[t._v(t._s(t.$t("campaign")))]),t._v(" "),s("div",{staticClass:"filter-campaign-wrapper"},[s("lookup",{ref:"campaignLookup",attrs:{"ld-selected-item":t.currentCampaignItem,"ld-metadatas":t.campaignMetadata},on:{select:function(e){return t.onCampaignSelect(e)},remove:function(e){return t.onCampaignRemove()}}})],1)]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical filter-campaign-status"},[s("div",{staticClass:"slds-text-body_small filter-title"},[t._v(t._s(t.$t("memberStatus")))]),t._v(" "),s("div",{staticClass:"filter-status-wrapper"},[s("input-select",{attrs:{currents:t.statusOptionData.currents,"default-label":t.$t("global.all"),type:"Status","is-disabled":!t.selectedCampaignId},on:{"close-dropdown":t.closeDropdown,"open-dropdown":t.openDropdown,resize:t.resizeDropdown}})],1)])]):t._e(),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical filter-related-section"},[s("div",{staticClass:"slds-text-body_small filter-title"},[t._v(t._s(t.$t("relateTo")))]),t._v(" "),s("div",{staticClass:"filter-related-wrapper"},[s("input-select",{attrs:{currents:t.relatedOptionData.currents,"default-label":t.$t("global.all"),type:"Related"},on:{"close-dropdown":t.closeDropdown,"open-dropdown":t.openDropdown,resize:t.resizeDropdown}})],1)]),t._v(" "),t.showTagDropdown?s("tag-dropdown",{attrs:{"account-id":t.accountId,currents:t.tagOptions,"default-label":!0,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth},on:{"select-option":t.selectTags,close:t.closeDropdown}}):t._e(),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.dropdownOptionData.options,currents:t.dropdownOptionData.currents,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth,"default-label":!0},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e()],1)}),[],!1,null,"378df194",null);"function"==typeof st.default&&Object(st.default)(it);var at=it.exports,nt=s("4No8"),ot=s("7aFC"),rt=s("J+st"),lt=s("x/ns"),ct={components:{MassMessageFilters:at,CommonDatePicker:nt.a,DataSourceFilter:Y,WechatResponse:W.a,LdSpinner:lt.LdSpinner},mounted(){this.accountId=this.$route.params.accountId||"",this.accountId&&this.getSelectedFollowersNum(),this.initMassSend(),window.addEventListener("click",this.handleClickEventListener)},beforeDestroy(){window.removeEventListener("click",this.handleClickEventListener)},computed:o()({},Object(D.c)({currentUser:"user/currentUser",supportAllSend:"account/massSend",isCustomDomainEnabled:"charketApp/isCustomDomainEnabled",currentAccount:"sidebar/currentAccount"}),{wechatAccount(){return{id:this.currentAccount?this.currentAccount.Id:"",type:this.currentAccount?this.currentAccount.Type:""}},choosers(){const t=[{type:"Text Message",textConfig:["link","miniProgramPage","action"]},"Structured Message","Image","Voice Message","Video","Coupon"];return this.supportAllSend&&t.push("Notification Template"),t.push("Pass"),t},sendDisabled(){const t=null===this.message||!this.message.id,e="0"===this.selected||"--"===this.selected;let s=!0;return"now"===this.sendTimeType?s=t||e:t||e||(s=this.dateErrorList.length>0||!this.scheduleTime||this.scheduleErrorCount>0),s},isMessageEmpty(){return null===this.message||!this.message.id},datePickerSettings(){return{onlyDay:!1,defaultTime:this.scheduleTime}},selected(){return"ListView"===this.filterType&&!this.dataSourceFilters.HasSelectedListView||this.dataSourceFilters.HasSelectedListView&&this.isGettingSelected?"--":Object(ot.a)(this.selectedNum)}}),watch:{filterType(t){this.filterType,"All"===t?(this.$refs.massFilters.resetAllFilters(),this.$refs.DataSourceFilter.reset()):"Filter"===t?(this.$refs.DataSourceFilter.reset(),this.getSelectedFollowersNum()):"ListView"===t&&this.$refs.massFilters.resetAllFilters()},sendDisabled(t){this.$emit("set-send-disabled",t)},sendTimeType(t){this.$emit("set-time-type",t)},isMessageEmpty(t){this.$emit("set-preview-disabled",t)}},data:()=>({message:null,accountId:"",selectedNum:0,hasMore:!1,usedNum:0,filterType:"All",sendTimeType:"now",dataSourceFilters:{HasSelectedListView:!1,SelectedListView:{Id:"",Label:"",SObjectType:""}},filterJson:{HasSelectedCampaign:!1,HasSelectedTag:!1,HasSelectedRelatedTo:!1,SelectedCampaign:{Id:null,Name:"",status:null},SelectedTag:{Id:null,WechatTagId:0,Name:""},RelatedTo:null},dateErrorList:[],isLoadingNotify:!1,scheduleTime:null,scheduleErrorCount:0,isGettingSelected:!1}),methods:{getMassFilterJson(){return JSON.parse(q()(V()({},this.dataSourceFilters,this.filterJson)))},onObjectTypeChanged(){this.filterType="ListView"},onListViewChanged(t){this.dataSourceFilters=t,this.dataSourceFilters.HasSelectedListView&&this.getSelectedFollowersNum()},onDataSourceFiltersReset(t){this.dataSourceFilters=t},handleClickEventListener(){const t="/".concat(this.accountId,"/mass/new");this.$route.path!==t&&this.$router.replace({path:t})},setScheduleTime(t){this.scheduleTime=Number(t)>0?Number(t):null,this.scheduleTime&&this.scheduleTime<Object(k.b)(new Date,this.currentUser.TimeZoneSidKey).getTime()?(this.dateErrorList=[],this.dateErrorList.push(this.$t("datePastErrorLabel"))):this.dateErrorList=[]},setErrorCount(t){this.scheduleErrorCount=t},async getSelectedFollowersNum(){this.isGettingSelected=!0;const t=this.getMassFilterJson();try{const e=await E.i.getFilterResult({wechatAccountId:this.$route.params.accountId,filter:t,filterType:this.filterType});this.selectedNum=e.totalCount,this.hasMore=e.hasMore}catch(t){this.selectedNum=0,this.hasMore=!1,this.$handleError(t)}finally{this.isGettingSelected=!1}},async initMassSend(){this.$route.query.campaignId?(this.$refs.massFilters.currentCampaignItem={name:this.$route.query.campaignName,id:this.$route.query.campaignId},this.$refs.massFilters.selectedCampaignId=this.$route.query.campaignId,this.$refs.massFilters.onCampaignSelect({id:this.$route.query.campaignId,name:this.$route.query.campaignName}),this.getSelectedFollowersNum()):this.$route.query.notifyId&&(this.isLoadingNotify=!0,await this.$try(async()=>{this.message=await E.m.getById(this.$route.query.notifyId)}),this.isLoadingNotify=!1)},selectedFilter(t){this.filterType="Filter",this.filterJson=t,this.getSelectedFollowersNum()},resetMassFilter(){this.$refs.massFilters.resetAllFilters()},resetFilter(t){this.filterJson=t,"ListView"!==this.filterType&&this.getSelectedFollowersNum()},outPutSelectedMsg(){const t={type:"",message:null,timeToFire:null,filterJson:this.getMassFilterJson(),filterType:this.filterType};return t.type=this.message.type,t.message=this.message,"schedule"===this.sendTimeType&&(t.timeToFire=new Date(Object(rt.a)(this.scheduleTime,"yyyy/MM/dd HH:mm:ssXXX",{timeZone:this.currentUser.TimeZoneSidKey})).getTime()),t}}},dt=(s("55Ot"),s("6erD")),ut=Object(F.a)(ct,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mass-page slds-scrollable_y"},[s("div",{staticClass:"slds-box slds-grid new-mass-page"},[s("div",{staticClass:"mass-body-left"},[s("div",{staticClass:"slds-grid slds-grid_vertical"},[s("div",{staticClass:"slds-grid slds-grid_align-spread"},[s("div",{staticClass:"slds-text-body_small mass-title"},[t._v(t._s(t.$t("sendTo")))]),t._v(" "),s("div",{staticClass:"slds-text-body_regular follower-selected-num"},[s("span",{staticClass:"selected-num"},[t._v(t._s(t._f("addSeparators")(t.selected)))]),t._v(" "),t.hasMore?s("span",{staticClass:"plus"},[t._v("+")]):t._e(),t._v(" "),s("span",[t._v(t._s(t.$t("selected")))])])]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical"},[s("div",{staticClass:"slds-grid select-section"},[s("span",{staticClass:"slds-radio"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.filterType,expression:"filterType"}],attrs:{type:"radio",id:"All",name:"selectType",value:"All"},domProps:{checked:t._q(t.filterType,"All")},on:{change:function(e){t.filterType="All"}}}),t._v(" "),s("label",{staticClass:"slds-radio__label",attrs:{for:"All"}},[s("span",{staticClass:"slds-radio_faux"}),t._v(" "),s("span",{staticClass:"slds-form-element__label"},[t._v(t._s(t.$t("global.all")))])])])]),t._v(" "),s("div",{staticClass:"slds-grid select-section"},[s("span",{staticClass:"slds-radio"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.filterType,expression:"filterType"}],attrs:{type:"radio",id:"Filter",name:"selectType",value:"Filter"},domProps:{checked:t._q(t.filterType,"Filter")},on:{change:function(e){t.filterType="Filter"}}}),t._v(" "),s("label",{staticClass:"slds-radio__label",attrs:{for:"Filter"}},[s("span",{staticClass:"slds-radio_faux"}),t._v(" "),s("span",{staticClass:"slds-form-element__label"},[t._v(t._s(t.$t("filterFollowers")))])])]),t._v(" "),t.filterJson.HasSelectedTag||t.filterJson.HasSelectedCampaign||t.filterJson.HasSelectedRelatedTo?s("div",{staticClass:"slds-text-body_small reset-filter-btn",on:{click:function(e){return t.resetMassFilter()}}},[t._v(t._s(t.$t("resetFilters")))]):t._e()])])]),t._v(" "),s("div",{staticClass:"filter-select-section"},[s("mass-message-filters",{ref:"massFilters",on:{select:t.selectedFilter,reset:t.resetFilter}})],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isCustomDomainEnabled,expression:"isCustomDomainEnabled"}]},[s("div",{staticClass:"slds-grid slds-grid_vertical"},[s("div",{staticClass:"slds-grid select-section"},[s("span",{staticClass:"slds-radio"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.filterType,expression:"filterType"}],attrs:{type:"radio",id:"ListView",name:"selectType",value:"ListView"},domProps:{checked:t._q(t.filterType,"ListView")},on:{change:function(e){t.filterType="ListView"}}}),t._v(" "),s("label",{staticClass:"slds-radio__label",attrs:{for:"ListView"}},[s("span",{staticClass:"slds-radio_faux"}),t._v(" "),s("span",{staticClass:"slds-form-element__label"},[t._v(t._s(t.$t("dataSourceLabel")))])])])])]),t._v(" "),s("div",{staticClass:"filter-select-section"},[s("data-source-filter",{ref:"DataSourceFilter",on:{"object-type-changed":function(e){return t.onObjectTypeChanged(e)},"list-view-changed":function(e){return t.onListViewChanged(e)},reset:function(e){return t.onDataSourceFiltersReset(e)}}})],1)]),t._v(" "),s("div",{staticClass:"mass-left-bottom"},[s("div",{staticClass:"slds-text-body_small mass-title"},[t._v(t._s(t.$t("whenToSend")))]),t._v(" "),s("div",{staticClass:"select-time-type"},[s("div",{staticClass:"slds-grid select-section"},[s("span",{staticClass:"slds-radio"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.sendTimeType,expression:"sendTimeType"}],attrs:{type:"radio",id:"now",name:"selectTime",value:"now"},domProps:{checked:t._q(t.sendTimeType,"now")},on:{change:function(e){t.sendTimeType="now"}}}),t._v(" "),s("label",{staticClass:"slds-radio__label",attrs:{for:"now"}},[s("span",{staticClass:"slds-radio_faux"}),t._v(" "),s("span",{staticClass:"slds-form-element__label"},[t._v(t._s(t.$t("sendNow")))])])])]),t._v(" "),s("div",{staticClass:"slds-grid select-section"},[s("span",{staticClass:"slds-radio"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.sendTimeType,expression:"sendTimeType"}],attrs:{type:"radio",id:"Schedule",name:"selectTime",value:"schedule"},domProps:{checked:t._q(t.sendTimeType,"schedule")},on:{change:function(e){t.sendTimeType="schedule"}}}),t._v(" "),s("label",{staticClass:"slds-radio__label",attrs:{for:"Schedule"}},[s("span",{staticClass:"slds-radio_faux"}),t._v(" "),s("span",{staticClass:"slds-form-element__label"},[t._v(t._s(t.$t("scheduledLater")))])])]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical date-wrapper"},[s("common-date-picker",{attrs:{"custom-settings":t.datePickerSettings,"keep-watch":!1,"custom-errors":t.dateErrorList},on:{"get-time":function(e){return t.setScheduleTime(e)},"set-error-count":function(e){return t.setErrorCount(e)}}})],1)])])])]),t._v(" "),s("div",{staticClass:"slds-col mass-body-right"},[s("div",{staticClass:"slds-text-body_small mass-title"},[t._v(t._s(t.$t("whatToSend")))]),t._v(" "),s("ld-spinner",{directives:[{name:"show",rawName:"v-show",value:t.isLoadingNotify,expression:"isLoadingNotify"}],attrs:{container:"",medium:"",color:"brand"}}),t._v(" "),s("wechat-response",{directives:[{name:"show",rawName:"v-show",value:!t.isLoadingNotify,expression:"!isLoadingNotify"}],staticClass:"wechat-response",class:{"no-selected-message":t.isMessageEmpty},attrs:{"page-name":"Mass Message","structured-type":"mpnews","wechat-account":t.wechatAccount,choosers:t.choosers,"icon-size":"large"},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1)])])}),[],!1,null,"4df7ba02",null);"function"==typeof dt.default&&Object(dt.default)(ut);var ht=ut.exports,pt=s("sI2A"),mt=s.n(pt),gt={components:{Icon:s("za7x").a},props:{successCount:{type:Number,default:()=>0},failCount:{type:Number,default:()=>0},queueCount:{type:Number,default:()=>0},total:{type:Number,default:()=>100},isFinished:{type:Boolean,default:()=>!1},isLoading:{type:Boolean,default:()=>!1}},computed:{progressPercent(){let t="";return this.isFinished&&this.successCount+this.failCount+this.queueCount>=this.total?t=100:(t=mt()((this.successCount+this.failCount)/this.total*100),t>100&&(t=100)),"width: ".concat(t,"%;")}},methods:{cancelProgress(){this.$emit("cancel-progress")},confirmProgress(){this.$emit("success-send")}}},ft=(s("k+Ky"),s("BV7i")),vt=Object(F.a)(gt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"mass-send-progress-bar"}},[s("div",{staticClass:"slds-modal slds-modal_large slds-fade-in-open",attrs:{id:"progress-bar-modal","aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container modal-popup-container",attrs:{role:"document",tabindex:"0"}},[s("div",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close",on:{click:function(e){return t.cancelProgress()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.$t("sendMsgTitle")))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium progress-content"},[s("div",{staticClass:"toast-section"},[s("div",{staticClass:"slds-notify_container slds-is-relative"},[s("div",{staticClass:"slds-notify slds-notify_toast theme-warning",class:{"slds-theme_success":t.isFinished,"slds-theme_warning":!t.isFinished},attrs:{role:"alert"}},[s("span",{staticClass:"slds-assistive-text"},[t._v("warning")]),t._v(" "),s("span",{staticClass:"slds-icon_container slds-icon-utility-warning slds-m-right_small slds-no-flex slds-align-top"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:!t.isFinished,expression:"!isFinished"}],attrs:{name:"warning","class-name":"slds-icon slds-icon_smal"}}),t._v(" "),s("icon",{directives:[{name:"show",rawName:"v-show",value:t.isFinished,expression:"isFinished"}],staticClass:"notify-right",attrs:{name:"notification",width:"24px",height:"24px"}})],1),t._v(" "),s("div",{staticClass:"slds-notify__content"},[s("h2",{directives:[{name:"show",rawName:"v-show",value:!t.isFinished,expression:"!isFinished"}],staticClass:"slds-text-heading_small"},[t._v(t._s(t.$t("sendMsgWarning")))]),t._v(" "),s("h2",{directives:[{name:"show",rawName:"v-show",value:t.isFinished,expression:"isFinished"}],staticClass:"slds-text-heading_small"},[t._v(t._s(t.$t("sendMsgSuccess"))+"\n                  "+t._s(t.$t("sendMsgCount",[""+t.total,""+t.queueCount,""+t.successCount,""+t.failCount]))+"\n                ")])])])])]),t._v(" "),s("div",{staticClass:"slds-progress-bar",attrs:{"aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":"25",role:"progressbar"}},[s("span",{staticClass:"slds-progress-bar__value",style:t.progressPercent},[s("span",{staticClass:"slds-assistive-text"},[t._v("Progress: "+t._s(t.progressPercent))])]),t._v(" "),s("div",{staticClass:"progress-count"},[t._v(t._s(t.successCount+t.failCount+t.queueCount>=t.total?t.total:t.successCount+t.failCount+t.queueCount)+"/"+t._s(t.total))])])]),t._v(" "),s("div",{staticClass:"slds-modal__footer"},[s("button",{directives:[{name:"show",rawName:"v-show",value:!t.isFinished&&!t.isLoading,expression:"!isFinished && !isLoading"}],staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.cancelProgress()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isLoading}},[t._v("\n          "+t._s(t.$t("loadingLabel"))+"\n        ")]),t._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:t.isFinished&&!t.isLoading,expression:"isFinished && !isLoading"}],staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.confirmProgress()}}},[t._v(t._s(t.$t("global.confirmBtn")))])])])]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open"})])}),[],!1,null,"24658786",null);"function"==typeof ft.default&&Object(ft.default)(vt);var wt=vt.exports,bt=s("0jZ9"),_t=s("20nU"),yt={components:{MassSentList:U,NewMassMessage:ht,MassProgress:wt,PreviewMsgModal:bt.a},inject:["showErrorImg"],data(){return{currentTab:"NEW MASS MESSAGE",msgTabs:[{name:"NEW MASS MESSAGE",label:this.$t("newMassMessage")},{name:"MASSAGES SENT",label:this.$t("massSent")}],sendTimeType:"now",previewedMsgId:"",mass:{content:"",header:""},sendDisabled:!0,previewDisabled:!0,sendMsgInfo:{},sendFollowersNum:0,maxSendNum:500,showProgressBar:!1,successAsyncCount:0,failAsyncCount:0,queueCount:0,counter:0,isSendNotifiesFinished:!1,asyncCountEachTime:3,calloutsPerTransaction:5,sendNotifyEventId:"",requestCount:0,isLoadingFinished:!1,isParentEventCreated:!1}},created(){this.switchAccount({wechatAccountId:this.$route.params.accountId,router:this.$router}),this.initData()},methods:o()({},Object(D.b)("sidebar",["switchAccount"]),{initData(){this.accountId=this.$route.params.accountId,this.namespace=_t.a.sfdc_namespace?_t.a.sfdc_namespace+"__":"",this.sendDisabled=!0,this.previewDisabled=!0,"mass-new"===this.$route.name?this.currentTab="NEW MASS MESSAGE":"mass-sent"===this.$route.name&&(this.currentTab="MASSAGES SENT")},sendMsg(){this.sendMsgInfo=this.$refs.newMass.outPutSelectedMsg(),this.sendFollowersNum=this.$refs.newMass.selectedNum;let t="";switch(this.sendMsgInfo.type){case"Notification Template":t=this.$t("global.notifyLabel");break;case"Text Message":t=this.$t("global.textLabel");break;case"WeChat Structured Message":case"Link Structured Message":t=this.$t("global.strucLabel");break;case"Image":t=this.$t("global.imageLabel");break;case"Voice Message":t=this.$t("global.voiceLabel");break;case"Video":t=this.$t("global.videoLabel");break;case"Coupon":t=this.$t("global.couponLabel");break;case"Pass":t=this.$t("global.passLabel");break;default:"Type Error ".concat(this.sendMsgInfo.type)}this.mass.header=this.$t("massSendTitle",[t]),"now"===this.sendTimeType?this.mass.content=this.$t("sureToSendNotify"):this.mass.content=this.$t("sureToScheduleNotify"),this.$refs.modalpopup.open()},sendFinished(){this.changeMsgTab("MASSAGES SENT"),this.$router.replace({path:"/".concat(this.accountId,"/mass/sent")})},cancelSendNotify(){this.$refs.modalpopup.close(),this.showProgressBar=!1},async confrimSend(){if(this.successAsyncCount=0,this.failAsyncCount=0,this.queueCount=0,this.isSendNotifiesFinished=!1,this.isParentEventCreated=!1,"Notification Template"===this.sendMsgInfo.type&&this.sendMsgInfo.message.id)"now"===this.sendTimeType?this.$try(async()=>{await E.i.mustSendNotificationTemplateAsync({wechatAccountId:this.accountId,filter:this.sendMsgInfo.filterJson,filterType:this.sendMsgInfo.filterType})?(this.$refs.modalpopup.close(),this.asyncSendMassTemplate()):this.handleSendNotifies()}):(this.$refs.modalpopup.close(),this.asyncSendMassTemplate());else{this.$refs.modalpopup.close();try{let t;this.sendMsgInfo.message&&(t=this.sendMsgInfo.message.id),await this.$try(async()=>{await E.i.send({wechatAccountId:this.accountId,contentId:t,filter:this.sendMsgInfo.filterJson,filterType:this.sendMsgInfo.filterType,timeToFire:this.sendMsgInfo.timeToFire}),this.$root.$emit("open-toast-notification",{content:this.$t("msgSubSuccess"),type:"success"}),this.sendFinished()})}catch(t){Object(L.f)(t)}}},async handleSendNotifies(){await this.$try(async()=>{this.isParentEventCreated=!0;const t=await E.i.createNotificationTemplateParentEvent({wechatAccountId:this.accountId,templateId:this.sendMsgInfo.message.id,filter:this.sendMsgInfo.filterJson,filterType:this.sendMsgInfo.filterType});this.requestCount=0,this.isParentEventCreated=!1,this.$refs.modalpopup.close(),this.sendNotifyEventId=t.EventId,this.showProgressBar=!0,this.calloutsPerTransaction=t.CalloutsPerTransaction;const e=Math.ceil(t.SelectedFollowers.length/t.CalloutsPerTransaction);this.counter=this.asyncCountEachTime;const s=this,i=Math.min(e,this.asyncCountEachTime),a=t.SelectedFollowers;for(let n=0;n<i;n++)await Object(L.e)(300),this.asyncSendNotifies(s,t.EventId,t.CalloutsPerTransaction,e,n,a)}),this.isParentEventCreated&&(this.isParentEventCreated=!1,this.$refs.modalpopup.close())},async asyncSendNotifies(t,e,s,i,n,o){try{let r=a()(o).call(o,s*n,s*(n+1));await E.i.sendNotificationTemplate({wechatAccountId:t.accountId,id:t.sendMsgInfo.message.id,eventId:e,followers:r}),t.successAsyncCount+=t.calloutsPerTransaction,t.showProgressBar?t.counter<i?(t.asyncSendNotifies(t,e,s,i,t.counter,o),t.counter++):t.successAsyncCount+t.failAsyncCount>=t.sendFollowersNum&&(t.isLoadingFinished=!0,t.asyncGetMassSendTemplateResult(t)):t.isSendNotifiesFinished=!0}catch(a){null===a.result?t.isSendNotifiesFinished=!0:t.asyncSendNotifiesError(t,e,s,i,o),this.$handleError(a)}},asyncSendNotifiesError(t,e,s,i,a){t.failAsyncCount+=t.calloutsPerTransaction,t.showProgressBar?t.counter<i?(t.asyncSendNotifies(t,e,s,i,t.counter,a),t.counter++):t.successAsyncCount+t.failAsyncCount>=t.sendFollowersNum&&(t.isLoadingFinished=!0,t.asyncGetMassSendTemplateResult(t)):t.isSendNotifiesFinished=!0},async asyncGetMassSendTemplateResult(t){try{await Object(L.e)(5e3);const e=await E.i.getProgressOfNotificationTemplateParentEvent({parentEventId:t.sendNotifyEventId,requestCount:t.requestCount,totalCount:t.sendFollowersNum});e.Done?(t.isLoadingFinished=!1,t.isSendNotifiesFinished=!0,t.successAsyncCount=e.Sent,t.failAsyncCount=e.Failed,t.queueCount=e.Queued):(await Object(L.e)(5e3),t.requestCount++,t.asyncGetMassSendTemplateResult(t))}catch(e){t.isLoadingFinished=!1,t.isSendNotifiesFinished=!0,this.$handleError(e)}},async asyncSendMassTemplate(){this.$try(async()=>{await E.i.sendNotificationTemplateAsync({wechatAccountId:this.accountId,id:this.sendMsgInfo.message.id,filter:this.sendMsgInfo.filterJson,filterType:this.sendMsgInfo.filterType,timeToFire:this.sendMsgInfo.timeToFire}),this.$router.app.$emit("open-toast-notification",{content:this.$t("notifySubSuccess"),type:"success"}),this.sendFinished()})},previewMsg(){const t=this.$refs.newMass.outPutSelectedMsg();this.previewedMsgId=t.message.id,this.$refs.previewModal.open()},changeMsgTab(t){"MASSAGES SENT"===t?(this.initData(),this.currentTab===t&&this.$refs.sendListComponent&&this.$refs.sendListComponent.getMassSentList()):(this.sendTimeType="now","MASSAGES SENT"===this.currentTab&&this.$router.replace({path:"/".concat(this.accountId,"/mass/new")})),this.currentTab=t},setSendDisabled(t){this.sendDisabled=t},setPreviewDisabled(t){this.previewDisabled=t},setTimeType(t){this.sendTimeType=t},cancelProgress(){this.isSendNotifiesFinished?this.showProgressBar=!1:(this.mass.content=this.$t("notifyMsgContent"),this.mass.header=this.$t("notifyMsgTitle"),this.$refs.modalpopup.open())},confirmProgress(){this.showProgressBar=!1,this.$router.app.$emit("open-toast-notification",{content:this.$t("notifySubSuccess"),type:"success"}),this.sendFinished()},onClickCancelSend(){this.$refs.modalpopup.close()}})},Ct=(s("Y2fc"),s("Q2dq"),s("6Jqe")),St=Object(F.a)(yt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mass-message-page"},[s("scoped-tabs",{attrs:{tabs:t.msgTabs,"current-tab-name":t.currentTab},on:{switch:t.changeMsgTab}},["NEW MASS MESSAGE"===t.currentTab?s("div",{attrs:{slot:"button-group"},slot:"button-group"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.previewDisabled},on:{click:function(e){return t.previewMsg()}}},[t._v(t._s(this.$t("global.previewBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.sendDisabled},on:{click:function(e){return t.sendMsg()}}},[t._v(t._s("now"===t.sendTimeType?this.$t("send"):this.$t("schedule")))])]):t._e()]),t._v(" "),"NEW MASS MESSAGE"===t.currentTab?s("new-mass-message",{ref:"newMass",on:{"set-send-disabled":t.setSendDisabled,"set-preview-disabled":t.setPreviewDisabled,"set-time-type":t.setTimeType}}):t._e(),t._v(" "),s("preview-msg-modal",{ref:"previewModal",attrs:{"account-id":t.accountId,"previewed-msg-id":t.previewedMsgId}}),t._v(" "),"MASSAGES SENT"===t.currentTab?s("mass-sent-list",{ref:"sendListComponent"}):t._e(),t._v(" "),s("ld-modal",{ref:"modalpopup",attrs:{title:t.mass.header},scopedSlots:t._u([{key:"content",fn:function(){return[s("p",{staticClass:"slds-p-around_medium slds-align_absolute-center"},[t._v(t._s(t.mass.content))])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{neutral:""},on:{click:function(e){return t.onClickCancelSend()}}},[t._v("\n        "+t._s(t.$t("global.cancelBtn"))+"\n      ")]),t._v(" "),s("ld-button",{directives:[{name:"show",rawName:"v-show",value:!t.showProgressBar,expression:"!showProgressBar"}],attrs:{brand:"",disabled:t.isParentEventCreated},on:{click:function(e){return t.confrimSend()}}},[t._v("\n        "+t._s(t.$t("global.confirmBtn"))+"\n      ")]),t._v(" "),s("ld-button",{directives:[{name:"show",rawName:"v-show",value:t.showProgressBar,expression:"showProgressBar"}],attrs:{brand:""},on:{click:function(e){return t.cancelSendNotify()}}},[t._v("\n        "+t._s(t.$t("global.confirmBtn"))+"\n      ")])]},proxy:!0}])}),t._v(" "),t.showProgressBar?s("mass-progress",{attrs:{"success-count":t.successAsyncCount,"fail-count":t.failAsyncCount,"queue-count":t.queueCount,total:t.sendFollowersNum,"is-finished":t.isSendNotifiesFinished,"is-loading":t.isLoadingFinished},on:{"success-send":t.confirmProgress,"cancel-progress":t.cancelProgress}}):t._e()],1)}),[],!1,null,"e55296f0",null);"function"==typeof Ct.default&&Object(Ct.default)(St);e.default=St.exports},qVZU:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"preTitle":"上一页","nextTitle":"下一页"},"en":{"preTitle":"Previous Page","nextTitle":"Next Page"}}'),delete t.options._Ctor}},rEsM:function(t,e,s){"use strict";var i=s("HA+Y");s.n(i).a},sXZA:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"allLabel":"全部","articleLabel":"微信文章","syncMsgLabel":"此消息将被同步到微信平台。","linkMsgLabel":"链接消息","sfMsgLabel":"此消息仅在 Salesforce 中保存。点击此消息将把微信用户带到指定的链接。","strucMsgLabel":"图文消息","imageLabel":"图片","voiceLabel":"语音","videoLabel":"视频","textLabel":"文本","miniProgramPagesLabel":"小程序卡片","savePreviewLabel":"保存 & 预览","searchStrucMsgLabel":"搜索图文消息","searchImageLabel":"搜索图片","searchVoiceLabel":"搜索语音","searchVideoLabel":"搜索视频","searchTextLabel":"搜索文本消息","searchMiniProgramLabel":"搜索小程序卡片","discardChangeLabel":"丢弃改变","stayPageLabel":"停留在当前页面","createTextMsgLabel":"新建文本消息","editTextMsgLabel":"编辑文本消息","createStrucMsgLabel":"创建图文消息","newStrucMsgLabel":"新建图文消息","editStrucMsgLabel":"编辑图文消息","unsavedLabel":"你有未保存的更改。你确定要放弃这些更改吗?","deleteMsgLabel":"删除消息","strucMsgLowerLabel":"图文消息","imageLowerLabel":"图片","voiceLowerLabel":"语音消息","videoLowerLabel":"视频","textLowerLabel":"文本消息","miniProgramLowerLabel":"小程序卡片","syncContentLabel":"你确定要从微信平台同步{0}？","deleteModalTitleLabel":"确定要删除这个","msgDeleteLabel":"已删除。","textMsgSaveLabel":"文本消息已保存。","yourSaveLabel":"更改已保存。","textMsgDeleteLabel":"文本消息已删除。","fileSaveLabel":"文件已保存。","strucMsgSaveLabel":"图文消息已保存。","strucMsgUpdateLabel":"图文消息已更新。","syncBtnLabel":"同步","strucsMsgLabel":"图文消息","imagesLabel":"图片","voicesLabel":"语音消息","videosLabel":"视频","lastModifiedTenLabel":"最后更新的10条","lastModifiedFiftyLabel":"最后更新的50条"},"en":{"allLabel":"All","articleLabel":"WeChat Article","syncMsgLabel":"This message will be synchronized to WeChat.","linkMsgLabel":"Link Message","sfMsgLabel":"This message will be saved in Salesforce only. Clicking this message will take a WeChat user to the specified link(s).","strucMsgLabel":"Structured Messages","imageLabel":"Images","voiceLabel":"Voice Clips","videoLabel":"Videos","textLabel":"Text Messages","miniProgramPagesLabel":"Mini Program Pages","savePreviewLabel":"Save & Preview","searchStrucMsgLabel":"Search Structured Messages","searchImageLabel":"Search Images","searchVoiceLabel":"Search Voice Clips","searchVideoLabel":"Search Videos","searchTextLabel":"Search Text Messages","searchMiniProgramLabel":"Search Mini Program Pages","discardChangeLabel":"Discard Changes","stayPageLabel":"Stay on this Page","createTextMsgLabel":"Create Text Message","editTextMsgLabel":"Edit Text Message","createStrucMsgLabel":"Create Structured Message","newStrucMsgLabel":"New Structured Message","editStrucMsgLabel":"Edit Structured Message","unsavedLabel":"You have unsaved changes. Are you sure you want to discard these changes?","deleteMsgLabel":"Delete Message","strucMsgLowerLabel":"Structured Message | structured message","imageLowerLabel":"Image | image","voiceLowerLabel":"Voice Clip | voice clips","videoLowerLabel":"Video | video","textLowerLabel":"Text Message | text message","miniProgramLowerLabel":"Mini Program Page | mini program page","syncContentLabel":"Are you sure you want to sync {0} from WeChat?","deleteModalTitleLabel":"Are you sure you want to delete this ","msgDeleteLabel":" was deleted.","textMsgSaveLabel":"The text message was saved.","yourSaveLabel":"Changes were saved.","textMsgDeleteLabel":"The text message was deleted.","fileSaveLabel":"The file was saved.","strucMsgSaveLabel":"The structured message was saved.","strucMsgUpdateLabel":"The structured message was updated.","syncBtnLabel":"Sync ","strucsMsgLabel":"structured messages","imagesLabel":"images","voicesLabel":"voice clips","videosLabel":"videos","lastModifiedTenLabel":"10 Last Modified Items","lastModifiedFiftyLabel":"50 Last Modified Items"}}'),delete t.options._Ctor}},svHN:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"newNotifyLabel":"新建通知","saveNotifyLabel":"模板消息保存成功！"},"en":{"newNotifyLabel":"New Notification","saveNotifyLabel":"The notification was saved."}}'),delete t.options._Ctor}},t29s:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"urlLabel":"跳转链接","titleLabel":"标题","createdLabel":"创建人","keywordLabel":"关键字","noteLabel":"备注"},"en":{"urlLabel":"Notification URL","titleLabel":"Title","createdLabel":"Created By","keywordLabel":"Keywords","noteLabel":"Note"}}'),delete t.options._Ctor}},tAMZ:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"selectSkillLabel":"选择技能","nameLabel":"技能名称","knowledgeSourceLabel":"知识源","relatedToLabel":"相关项","descriptionLabel":"描述","validForLabel":"有效时间(分钟)","displayInLiveChatLabel":"在 Live Chat 中显示","internalLabel":"内部","lastModifiedByLabel":"上次修改人"},"en":{"selectSkillLabel":"Select Skill","nameLabel":"Name","knowledgeSourceLabel":"Knowledge Source","relatedToLabel":"Related To","descriptionLabel":"Description","validForLabel":"Valid For (mins)","displayInLiveChatLabel":"Display in Live Chat","internalLabel":"Internal","lastModifiedByLabel":"Last Modified By"}}'),delete t.options._Ctor}},tEgh:function(t,e,s){},tJr4:function(t,e,s){"use strict";var i=s("Tsgj");s.n(i).a},uVVx:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"sendTo":"发送至","selected":"已选","filterFollowers":"过滤关注者","resetFilters":"重置过滤器","whatToSend":"发送内容","whenToSend":"何时发送","sendNow":"立即发送","scheduledLater":"稍后发送","datePastErrorLabel":"计划日期和时间已经过期","dataSourceLabel":"数据源"},"en":{"sendTo":"To","selected":"selected","filterFollowers":"Filter Followers","resetFilters":"Reset Filters","whatToSend":"What To Send","whenToSend":"When To Send","sendNow":"Send now","scheduledLater":"Schedule for later","datePastErrorLabel":"The scheduled time must be a date/time in the future.","dataSourceLabel":"Data Source"}}'),delete t.options._Ctor}},vyV3:function(t,e,s){"use strict";var i=s("AScg");s.n(i).a},"w/3m":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"editTextTitle":"编辑文本消息","notifyContent":"修改已保存。"},"en":{"editTextTitle":"Edit Text Message","notifyContent":"Your changes are saved."}}'),delete t.options._Ctor}},wUCt:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA8CAMAAADxNwKKAAABd1BMVEUAAACZzMxV1aqZ5syO48ZKyqqT2M6M3sWN3cOM4chKyqWK28eJ38hLyqeR4MiO3shKyqZJy6iP38xIyqiQ38pIyaaN3MlIyqZIyqiO3chIyKZJyaeS4MtJyKeU38tKyKeW4M1JyqdJyac+wZlJyaiY4M1JyKea4s9Jyaec4c6d4tBJyadJyadJyaef4tCe4dBJyaeg49JJyaeg4tGi49NJyaeh49Gi5NKh49Kj5NOj5NOk5NM4vJI5vJQ+wZpGxqNHyKZIyKZIyaVJyaZJyadKyadKyahLyqhNyqlPy6pUzKxVza1Zzq9azq9cz7Bez7Fh0LJi0LNjzrBm0bVn0LRt1Lhx1bpy1bt417572L982MB+176G28WM3MaO3ciQ3sqU3sqY4M2c4s+f4tCh49Gk5NOn5dWs5te16du56t27696869++7ODM8Oba9O3c9e7d9e7e9e/i9vHl9/Ln+PTs+fbt+vbx+/j1/Pr2/Pv6/v37/v3///9FVItHAAAAPHRSTlMABQYKEhgaHyYqMDI4OkFGSElQUldZZ2p4eHmIipqdn62xs7S1vcTJ09Xd3+Pm5unr7O3v8fT09fj6/f4D2I8LAAABRklEQVRIx+3UVVNDMRCG4cXd3d2LU9z5oBR395KixYvuj+eOnvbM0E3ukPc280wyyU6IKKPS4fyutkyyV4Rw9aTaUHpYBNWVFKoqBEq1x4coh0Splthg5RQp1RhtolRDlIlSdREmStUYKVVupFSpkVLFRmqgwESp/lypGrMo1ZctVONHVtabJjzhmlWp7mSZGt0NYp0JIoWxlf1TC2uNEylgZHhoMFCVUAGYCFQoV5by/9VPVYsb9qbDKi/bmxeoR19wHyLlCVn0C9XW5ba+mnzmFxcAzGntdcHXAOC+39FRmAUAnPPD2aaGAgDsMTOf6KiFQ9fyKzPzlYZaeuKbO2ZmvpWrVf/XWLy7pGrq2BtoRvM29F7Z5wnuTaTMZv53qvUDe+6/9os2G6g8qjZQKZSlj+ojiUp0UUciEVFOrc6NNJXFEH0CT5lWikALzoMAAAAASUVORK5CYII="},wbfU:function(t,e,s){"use strict";var i=s("wG3i"),a=s.n(i),n=s("pUDi"),o=s("zUtI"),r=s("4B+h"),l={props:{notify:{type:Object,default:()=>({contentTemplate:{keywords:[]}})},accId:{type:String,default:()=>""}},components:{NewNotification:n.a},data:()=>({isSaveNotify:!1}),methods:{closeModal(t){this.$emit("close",t)},async saveNotify(){const t=this.accId||this.$route.params.accountId,e=this.$refs.newNotifyPage.prepareCreatedData();if(t)try{this.isSaveNotify=!0;const s=await Object(o.a)(t,a()(e));s.ok?(this.$router.app.$emit("open-toast-notification",{content:this.$t("saveNotifyLabel"),type:"success"}),this.closeModal(s),this.isSaveNotify=!1):(Object(r.f)(s),this.isSaveNotify=!1)}catch(t){Object(r.f)(t),this.isSaveNotify=!1}}}},c=(s("rEsM"),s("KHd+")),d=s("lNHh"),u=Object(c.a)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-notification-popup"},[s("section",{staticClass:"slds-modal slds-fade-in-open",attrs:{role:"dialog",tabindex:"-1","aria-labelledby":"modal-heading-01","aria-modal":"true","aria-describedby":"modal-content-id-1"}},[s("div",{staticClass:"slds-modal__container notify-width"},[s("header",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon slds-modal__close slds-button_icon-inverse",attrs:{disabled:t.isSaveNotify},on:{click:function(e){return t.closeModal()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium slds-hyphenate",attrs:{id:"modal-heading-01"}},[t._v(t._s(t.$t("newNotifyLabel")))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium modal-content-custom",attrs:{id:"modal-content-id-1"}},[s("new-notification",{ref:"newNotifyPage",attrs:{notify:t.notify,"wechat-account-id":t.accId}})],1),t._v(" "),s("footer",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSaveNotify},on:{click:function(e){return t.closeModal()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isSaveNotify},on:{click:function(e){return t.saveNotify()}}},[t._v(t._s(t.$t("global.saveBtn")))])])])]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open"})])}),[],!1,null,"5fadaa67",null);"function"==typeof d.default&&Object(d.default)(u);e.a=u.exports},xIZP:function(t,e,s){"use strict";var i=s("MYFI");s.n(i).a},xecf:function(t,e,s){"use strict";var i=s("/FlB");s.n(i).a},xncO:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"replyModeLabel":"回复模式","replyModeAll":"全部","replyModeRandom":"随机","nameLabel":"名称","changeSavedNofity":"修改已保存。","uploader":{"imageTitle":"上传图片","videoTitle":"上传视频","voiceTitle":"上传音频","titleLabel":"标题","descriptionLabel":"说明","cancelBtn":"取消","uploadBtn":"上传","uploadingBtn":"上传中","tooLarge":"最大文件大小为 2 MB。"},"exclusive":{"skillAddTitle":"移除已添加回复","skillAddContent":"技能无法和其他类型自动回复同时运行。添加当前技能会移除已添加回复。确定吗？","skillRemoveTitle":"移除已添加技能","skillRemoveContent":"技能无法和其他类型自动回复同时运行。添加当前回复会移除已添加技能。确定吗？"}},"en":{"replyModeLabel":"Reply Mode","replyModeAll":"All","replyModeRandom":"Random","nameLabel":"Name","changeSavedNofity":"Your changes are saved.","uploader":{"imageTitle":"Upload Image","videoTitle":"Upload Video","voiceTitle":"Upload Voice Clip","titleLabel":"Title","descriptionLabel":"Description","cancelBtn":"Cancel","uploadBtn":"Upload","uploadingBtn":"Uploading","tooLarge":"The maximum file size is 2 MB."},"exclusive":{"skillAddTitle":"Remove Added Responses","skillAddContent":"A skill cannot be executed along with any other auto responses. Adding this skill response removes all other auto responses. Are you sure?","skillRemoveTitle":"Remove Added Skill","skillRemoveContent":"A skill cannot be executed along with any other auto responses. Adding this auto response removes the previously added skill response. Are you sure?"}}}'),delete t.options._Ctor}},xswR:function(t,e,s){"use strict";var i=s("xncO"),a=s.n(i);e.default=a.a},yMTf:function(t,e,s){"use strict";var i=s("Y5h6");s.n(i).a},yWOo:function(t,e,s){},yupr:function(t,e,s){"use strict";var i=s("5DGR"),a=s.n(i);e.default=a.a},zUtI:function(t,e,s){"use strict";s.d(e,"c",(function(){return a})),s.d(e,"e",(function(){return n})),s.d(e,"g",(function(){return o})),s.d(e,"d",(function(){return r})),s.d(e,"b",(function(){return l})),s.d(e,"h",(function(){return c})),s.d(e,"a",(function(){return d})),s.d(e,"f",(function(){return u}));var i=s("00Ee");function a(t,e,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return Object(i.a)({method:"NotificationTemplateRemoteActions.getNotificationTemplates",args:[t,e,s,a]})}function n(t,e,s,a){return Object(i.a)({method:"NotificationTemplateRemoteActions.getTemplates",args:[t,e,s,a]})}function o(t){return Object(i.a)({method:"NotificationTemplateRemoteActions.getWeChatPrivateTemplates",args:[t]})}function r(t){return Object(i.a)({method:"NotificationTemplateRemoteActions.getTemplate",args:[t]})}function l(t){return Object(i.a)({method:"NotificationTemplateRemoteActions.deleteTemplate",args:[t]})}function c(t,e){return Object(i.a)({method:"NotificationTemplateRemoteActions.updateTemplate",args:[t,e]})}function d(t,e){return Object(i.a)({method:"NotificationTemplateRemoteActions.createTemplate",args:[t,e]})}function u(t){return Object(i.a)({method:"NotificationTemplateRemoteActions.getWeChatNotifications",args:[t]})}}}]);