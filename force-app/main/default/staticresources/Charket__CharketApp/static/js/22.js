(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"ATt/":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"noAgentAssigned":"你没有被设置为专员","askAdmin":"请联系管理员。","goToAgents":"跳转到专员页面","dropUploadTip":"放置以上传至Live Chat","noRelatedMessage":"没有微信消息"},"en":{"noAgentAssigned":"No agent is assigned to you","askAdmin":"Ask your Charket admin for help.","goToAgents":"Go to Agents","dropUploadTip":"Drop to Upload to Live Chat","noRelatedMessage":"No chat messages"}}'),delete t.options._Ctor}},B4VV:function(t,e,s){},BhwK:function(t,e,s){"use strict";var i=s("qaiJ");s.n(i).a},OASX:function(t,e,s){"use strict";var i=s("qOYv");s.n(i).a},R6fe:function(t,e,s){"use strict";var i=s("ATt/"),a=s.n(i);e.default=a.a},iQsN:function(t,e,s){"use strict";s.r(e);var i=s("+Bun"),a=s.n(i),n=s("vQrK"),o=s.n(n),r=s("pqUP"),c=s.n(r),d=s("iUF6"),l={components:{ThreadList:s("Cb9X").a,AgentSetting:d.a},methods:{toggleWeChatAccounts(){this.$root.$emit("show-nav-box")}}},h=(s("BhwK"),s("KHd+")),u=Object(h.a)(l,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"thread-section slds-border_right"},[e("div",{staticClass:"wechat-accounts-section"},[e("a",{staticClass:"down-btn",on:{click:this.toggleWeChatAccounts}},[e("icon",{attrs:{name:"menuIcon","class-name":"down-icon",width:"18px",height:"18px"}})],1)]),this._v(" "),e("agent-setting"),this._v(" "),e("thread-list")],1)}),[],!1,null,"d0fff55a",null).exports,v=s("x9kv"),p=s("w2Vt"),g=s("zAy/"),m=s("ag2C"),_=s("X4XD"),T=s("L2JU"),b=s("PXHh"),f=s("x/ns"),C={name:"live-chat",mixins:[b.a],components:{MessageSection:v.a,ThreadSection:u,LoadingSpinner:p.a,ActiveLiveChatPopup:m.a,FollowerAbout:g.a,ReloadLiveChatTip:_.a,LdSpinner:f.LdSpinner},data:()=>({buttonDisabled:!1,closingThread:null,showDropFilesTip:!1,isDragEventDisabled:!1,updateTimeTimer:null,IsReloadLiveChatTipVisible:!1}),watch:{$route(t){let e=t.params.followerId;if(e){const t="console-message"===this.$router.currentRoute.name;this.$store.dispatch("livechat/clearUnreadCount",{followerId:e,isConsoleEmitter:t})}}},async mounted(){this.$root.$on("current-user-agents-loaded",async()=>{this.mixinAgentNum<=0||0===this.recordTypes.length&&this.currentUser.Permissions&&this.currentUser.Permissions.Objects.CaseObj.IsInsertable&&await this.$store.dispatch("caseLayout/fetchRcordTypes")}),this.$_mixinGetWeChatAgents(),this.$root.$on("need-reload-live-chat",this.showReloadLiveChatTip),this.updateTimeTimer=c()(()=>{this.$root.$emit("update-livechat-time")},3e4)},computed:o()({},Object(T.c)({hasLoadedData:"livechat/hasLoadedData",currentThread:"livechat/currentThread",chattingThreads:"livechat/chattingThreads",waitingThreads:"livechat/waitingThreads",historyThreads:"livechat/historyThreads",currentAccount:"sidebar/currentAccount",recordTypes:"caseLayout/recordTypes",currentUser:"user/currentUser",livechatActive:"livechat/livechatActive"}),{isHistoryTab(){var t;return a()(t=this.$route.name).call(t,"history")>-1}}),methods:{showReloadLiveChatTip(){this.IsReloadLiveChatTipVisible=!0},hiddenReloadLiveChatTip(){this.IsReloadLiveChatTipVisible=!1},goToAgents(){this.$router.replace({path:"/"+this.currentAccount.Id+"/agents"})},home(){window.history.back()},dragFilesEnter(t){this.isDragEventDisabled||(this.showDropFilesTip=!0)},dragFilesLeave(){this.showDropFilesTip=!1},dropOnFiles(t){this.isDragEventDisabled||(this.showDropFilesTip=!1,this.$root.$emit("drop-on-files",t))},disabledDragEvent(){this.isDragEventDisabled=!0},enabledDragEvent(){this.isDragEventDisabled=!1}},beforeDestroy(){clearInterval(this.updateTimeTimer)}},A=(s("OASX"),s("vEiB"),s("R6fe")),w=Object(h.a)(C,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-grid live-chat-page",on:{dragstart:function(e){return t.disabledDragEvent()},dragend:function(e){return t.enabledDragEvent()},dragenter:function(e){return t.dragFilesEnter(e)},dragover:function(t){t.preventDefault()},drop:function(e){return e.preventDefault(),t.dropOnFiles(e)},paste:function(e){return t.dropOnFiles(e)}}},[s("active-live-chat-popup",{attrs:{"livechat-active":t.livechatActive}}),t._v(" "),t.IsReloadLiveChatTipVisible?s("reload-live-chat-tip",{on:{"click-reload":function(e){return t.hiddenReloadLiveChatTip()}}}):t._e(),t._v(" "),s("ld-spinner",{directives:[{name:"show",rawName:"v-show",value:!t.mixinIsWeChatAccountLoaded,expression:"!mixinIsWeChatAccountLoaded"}],staticClass:"loading-spinner",attrs:{container:"",color:"brand"}}),t._v(" "),0===t.mixinAgentNum?s("div",{staticClass:"no-agent-icon-div"},[s("div",{staticClass:"no-agent-div"},[s("icon",{attrs:{name:"noAgent","class-name":"no-agent-icon",width:"100px",height:"100px","charket-icon":""}}),t._v(" "),t.isHistoryTab?t._e():s("p",{staticClass:"no-agent-tip1"},[t._v(t._s(t.$t("noAgentAssigned")))]),t._v(" "),t.isHistoryTab?t._e():s("p",{staticClass:"no-agent-tip2"},[t._v(t._s(t.$t("askAdmin")))]),t._v(" "),s("div",{staticClass:"no-agent-btn-group"},[s("button",{staticClass:"slds-button slds-button_neutral no-agent-btn1",on:{click:t.home}},[t._v(t._s(t.$t("global.backBtn")))]),t._v(" "),this.currentAccount.Id?s("button",{staticClass:"slds-button slds-button_brand no-agent-btn2",on:{click:t.goToAgents}},[t._v(t._s(t.$t("goToAgents")))]):t._e()])],1)]):t._e(),t._v(" "),t.mixinAgentNum>0?s("div",{staticClass:"slds-grid page-content"},[s("div",{staticClass:"left-section slds-border_right"},[s("thread-section")],1),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical middle-section"},[!t.currentThread&&t.hasLoadedData?s("div",{staticClass:"no-msg-icon-div slds-size_5-of-6"},[s("div",{staticClass:"msg-section"},[s("icon",{attrs:{name:"NoMessage","class-name":"no-message-icon","charket-icon":""}})],1)]):t._e(),t._v(" "),s("loading-spinner",{attrs:{"is-loading":!t.hasLoadedData}}),t._v(" "),t.hasLoadedData&&t.currentThread?s("message-section"):t._e()],1),t._v(" "),t.currentThread?s("div",{staticClass:"right-section slds-border_left"},[s("follower-about",{attrs:{"current-thread":t.currentThread,"current-user":t.currentUser}})],1):t._e()]):t._e(),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showDropFilesTip,expression:"showDropFilesTip"}],staticClass:"drag-tip-area",on:{dragleave:function(e){return t.dragFilesLeave()}}},[s("div",{staticClass:"drag-tip-content"},[t._v("\n      "+t._s(t.$t("dropUploadTip"))+"\n    ")])]),t._v(" "),s("img",{staticClass:"charket-emotions",staticStyle:{display:"none"},attrs:{src:"#"}})],1)}),[],!1,null,"702c4592",null);"function"==typeof A.default&&Object(A.default)(w);e.default=w.exports},qOYv:function(t,e,s){},qaiJ:function(t,e,s){},vEiB:function(t,e,s){"use strict";var i=s("B4VV");s.n(i).a}}]);