(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"+JOJ":function(t,e,s){"use strict";var a=s("pED3"),n=s.n(a);e.default=n.a},"1vOb":function(t,e,s){"use strict";var a=s("Hi2j"),n=s.n(a);e.default=n.a},"3nmp":function(t,e,s){"use strict";var a=s("R9hF"),n=s.n(a),o=s("dUVM"),i=s.n(o),l=s("8Vev"),r=s.n(l),c=s("4LGG"),d=s.n(c),p=s("kZKX"),u=s.n(p),h=s("q1Z7"),m=s("QBew"),g=s("OZZp"),f=s("zEt/"),y=s.n(f),v=s("i+Lc"),b=s.n(v),_=s("20nU"),w=s("XIlo"),C=s("OB6B");var M={openRoute(t){let{wechatAccountId:e,path:s}=t;const a=["#",e,b()(s).call(s,"/")?s.substring(1):s].join("/");w.a.isInLightningConsole?C.a.openWindow(["/apex/",_.a.sfdc_namespace?"".concat(_.a.sfdc_namespace,"__"):"","CharketApp?isdtp=p1",a].join("")):window.open([window.location.origin,window.location.pathname,window.location.search,a].join(""))}},L=s("SLhn"),R=s.n(L),I=s("0G99"),$=s.n(I),S=s("cybb"),T=s("M9dV");const N=["Image","Skill","Pass","Video","Voice Message","Text Message","Coupon","Notification Template","Structured Message","Mini Program Page"],k=new u.a([["Image","global.imageLabel"],["Skill","global.skillLabel"],["Pass","global.passLabel"],["Video","global.videoLabel"],["Voice Message","global.voiceLabel"],["Text Message","global.textLabel"],["Coupon","global.couponLabel"],["Notification Template","global.notifyLabel"],["Structured Message","global.strucLabel"],["Mini Program Page","global.miniProgramLabel"]]),O=new u.a([["Image","global.popupHeader.selectImage"],["Skill","global.popupHeader.selectSkill"],["Pass","global.popupHeader.selectPass"],["Video","global.popupHeader.selectVideo"],["Voice Message","global.popupHeader.selectVoiceClip"],["Text Message","global.popupHeader.selectTextMessage"],["Coupon","global.popupHeader.selectCoupon"],["Notification Template","global.popupHeader.selectNotificationTemplateLabel"],["Structured Message","global.popupHeader.selectStructuredMessage"],["Mini Program Page","global.popupHeader.selectMiniProgram"]]);var x=class{constructor(t){this.componentInstance=t}static getAllChoosers(){return[...N]}getExclusivelyConfig(t){let e=null;switch(t){case"Skill":e={add:{title:this.componentInstance.$t("exclusive.skillAddTitle"),content:this.componentInstance.$t("exclusive.skillAddContent"),ok:this.componentInstance.$t("global.yesBtn"),cancel:this.componentInstance.$t("global.noBtn")},remove:{title:this.componentInstance.$t("exclusive.skillRemoveTitle"),content:this.componentInstance.$t("exclusive.skillRemoveContent"),ok:this.componentInstance.$t("global.yesBtn"),cancel:this.componentInstance.$t("global.noBtn")}}}return e}getReplyModeConfig(t){if("false"!==t&&!1!==t&&null!=t)return{label:this.componentInstance.$t("replyModeLabel"),modes:[{label:this.componentInstance.$t("replyModeAll"),value:"All"},{label:this.componentInstance.$t("replyModeRandom"),value:"Random"}]}}getChooserConfigs(t){return d()(t).call(t,t=>{const{type:e}=t,s={type:e,name:this.componentInstance.$t(k.get(e)),exclusive:this.getExclusivelyConfig(e),layout:this.createLayout(e,t.limitLabel),dataProvider:this.createDataProvider(e),limitOfItems:t.limit||null};if("Text Message"===e){s.showTabs=!0;const e=this.getSubConfigsOfTextMessageChooser(),{textConfig:a}=t;if(a){const t={};$()(a).call(a,s=>{t[s]=e.designer[s]}),s.configs={designer:t,editor:e.editor}}else s.configs=e}return s})}getSubConfigsOfTextMessageChooser(){return{designer:{link:{iconTitle:this.componentInstance.$t("designer.linkIcon"),title:this.componentInstance.$t("global.title"),linkURL:this.componentInstance.$t("designer.linkUrl"),invalidUrl:this.componentInstance.$t("designer.illegalUrl"),primaryButton:this.componentInstance.$t("global.confirmBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn"),change:this.componentInstance.$t("designer.changeBtn"),remove:this.componentInstance.$t("designer.removeBtn")},miniProgramPage:{iconTitle:this.componentInstance.$t("designer.miniProgramIcon"),title:this.componentInstance.$t("global.title"),linkUrl:this.componentInstance.$t("designer.linkUrl"),invalidUrl:this.componentInstance.$t("designer.illegalUrl"),appId:this.componentInstance.$t("designer.appId"),pagePath:this.componentInstance.$t("designer.pagePath"),primaryButton:this.componentInstance.$t("global.confirmBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn"),change:this.componentInstance.$t("designer.changeBtn"),remove:this.componentInstance.$t("designer.removeBtn"),dataProvider:this.createDataProvider("Mini Program Link")},action:{iconTitle:this.componentInstance.$t("designer.actionIcon"),name:this.componentInstance.$t("designer.name"),value:this.componentInstance.$t("designer.value"),primaryButton:this.componentInstance.$t("global.confirmBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn")},mergeField:{iconTitle:this.componentInstance.$t("designer.mergeFieldIcon"),title:this.componentInstance.$t("designer.selectAField"),placeholder:this.componentInstance.$t("designer.findObjectPlaceholder"),filterPlaceholder:this.componentInstance.$t("designer.labelFilterPlaceholder"),fieldTitle:this.componentInstance.$t("designer.fieldTitle"),type:this.componentInstance.$t("designer.type"),apiName:this.componentInstance.$t("designer.apiName"),primaryButton:this.componentInstance.$t("global.chooseBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn"),noMatches:this.componentInstance.$t("designer.noMatchesFound"),currentSelection:this.componentInstance.$t("designer.currentSelection"),dataProvider:this.createDataProvider("Merge Field")}},editor:{title:this.componentInstance.$t("global.popupHeader.editTextMessage"),cancelButton:this.componentInstance.$t("global.cancelBtn"),okButton:this.componentInstance.$t("global.saveBtn")}}}createLayout(t,e){const s={title:this.componentInstance.$t(O.get(t)),noRecords:this.componentInstance.$t("global.noRecords"),editButton:this.componentInstance.$t("global.editBtn"),searchPlaceholder:this.componentInstance.$t("global.searchPlaceholder"),primaryButton:this.componentInstance.$t("global.confirmBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn")},a={title:"Voice Message"===t?this.componentInstance.$t("uploader.voiceTitle"):this.componentInstance.$t("uploader.".concat(t.toLowerCase(),"Title")),label:this.componentInstance.$t("uploader.titleLabel"),descriptionLabel:this.componentInstance.$t("uploader.descriptionLabel"),secondaryButton:this.componentInstance.$t("uploader.cancelBtn"),sizeLimitError:this.componentInstance.$t("uploader.tooLarge"),upload:this.componentInstance.$t("uploader.uploadBtn"),uploading:this.componentInstance.$t("uploader.uploadingBtn")};switch(t){case"Text Message":s.tabs={new:{title:this.componentInstance.$t("global.popupHeader.createTextMessage"),tabLabel:this.componentInstance.$t("newTextMessage")},list:{title:this.componentInstance.$t("global.popupHeader.selectTextMessage"),tabLabel:this.componentInstance.$t("textMessages")}},s.iconLabel=this.componentInstance.$t("global.textLabel");break;case"Skill":s.headers=[{text:this.componentInstance.$t("nameLabel"),value:"name"},{text:this.componentInstance.$t("knowledgeSourceLabel"),value:"knowledgeSource"},{text:this.componentInstance.$t("relatedToLabel"),value:"relatedTo"},{text:this.componentInstance.$t("descriptionLabel"),value:"description"},{text:this.componentInstance.$t("validForLabel"),value:"validFor"},{text:this.componentInstance.$t("displayInLiveChatLabel"),value:"isDisplayInLiveChat"},{text:this.componentInstance.$t("internalLabel"),value:"isInternal"},{text:this.componentInstance.$t("lastModifiedByLabel"),value:"lastModifiedBy"}],s.iconLabel=this.componentInstance.$t("global.skillLabel");break;case"Pass":s.headers=[{text:this.componentInstance.$t("name"),value:"name"},{text:this.componentInstance.$t("startDate"),value:"localizedStartTime"},{text:this.componentInstance.$t("endDate"),value:"localizedEndTime"},{text:this.componentInstance.$t("quantity"),value:"quantity"},{text:this.componentInstance.$t("createdBy"),value:"compoundCreatedBy"}],s.iconLabel=e||this.componentInstance.$t("global.passLabel");break;case"Coupon":s.headers=[{text:this.componentInstance.$t("type"),value:"type"},{text:this.componentInstance.$t("name"),value:"name"},{text:this.componentInstance.$t("expirationDate"),value:"expirationDate"},{text:this.componentInstance.$t("quantity"),value:"quantity"},{text:this.componentInstance.$t("status"),value:"status"}],s.iconLabel=this.componentInstance.$t("global.couponLabel");break;case"Notification Template":s.headers=[{text:this.componentInstance.$t("titleLabel"),value:"title"},{text:this.componentInstance.$t("keywordLabel"),value:"keywordNames"},{text:this.componentInstance.$t("urlLabel"),value:"notificationURL"},{text:this.componentInstance.$t("noteLabel"),value:"note"},{text:this.componentInstance.$t("createdLabel"),value:"createdBy"}],s.iconLabel=this.componentInstance.$t("global.notifyLabel");break;case"Image":s.uploader=a,s.iconLabel=this.componentInstance.$t("global.imageLabel"),s.hasAction=!0;break;case"Voice Message":s.uploader=a,s.iconLabel=this.componentInstance.$t("global.voiceLabel"),s.hasAction=!0;break;case"Video":s.uploader=a,s.iconLabel=this.componentInstance.$t("global.videoLabel"),s.hasAction=!0;break;case"Mini Program Page":s.iconLabel=this.componentInstance.$t("global.miniProgramLabel");break;case"Structured Message":s.iconLabel=this.componentInstance.$t("global.strucLabel"),s.syncedTooltip=this.componentInstance.$t("global.syncedWithWeChatPlatform")}return s}createDataProvider(t){const e={wechatAccount:this.componentInstance.wechatAccount,pageName:this.componentInstance.pageName,structuredType:this.componentInstance.structuredType};switch(t){case"Text Message":e.success=()=>{this.componentInstance.$toast({content:this.componentInstance.$t("changeSavedNofity"),type:"success"})},e.error=t=>{this.componentInstance.$handleError(t)};break;case"Skill":e.formatter=t=>{var e;t.compoundRelatedTo={id:t.relatedTo?t.relatedTo.id:"",name:t.relatedTo?t.relatedTo.name:""},"Survey"===t.knowledgeSource&&t.relatedTo&&t.relatedTo.id?(t.compoundRelatedTo.href="javascript: void(0);",t.compoundRelatedTo.onClick=t=>{this.componentInstance.$router.push({name:"survey-editor",params:{surveyId:t.relatedTo.id}})}):t.relatedTo&&t.relatedTo.id&&(t.compoundRelatedTo.href="/".concat(t.relatedTo.id));const s=Object(S.e)(t.lastModifiedDate,this.componentInstance.$user.TimeZoneSidKey);return t.compoundLastModifiedBy=t.lastModifiedBy.name?R()(e="".concat(t.lastModifiedBy.name,", ")).call(e,s):s,t};break;case"Structured Message":e.formatter=t=>(t.localizedWeChatLastModifiedTime=Object(S.e)(t.weChatLastModifiedTime,this.componentInstance.$user.TimeZoneSidKey),t);break;case"Pass":e.formatter=t=>{var e;const s=Object(S.e)(t.createdDate,this.componentInstance.$user.TimeZoneSidKey);return t.compoundCreatedBy=R()(e="".concat(t.createdByUser,", ")).call(e,s),t.localizedStartTime=Object(S.e)(t.startTime,this.componentInstance.$user.TimeZoneSidKey),t.localizedEndTime=Object(S.e)(t.endTime,this.componentInstance.$user.TimeZoneSidKey),t};break;case"Coupon":const t=this.componentInstance.$t("to");e.formatter=e=>{var s,a;const n=Object(S.e)(e.beginDate,this.componentInstance.$user.TimeZoneSidKey),o=Object(S.e)(e.endDate,this.componentInstance.$user.TimeZoneSidKey);return e.expirationDate=R()(s=R()(a="".concat(n," ")).call(a,t," ")).call(s,o),e};break;case"Notification Template":e.formatter=t=>{var e;return t.localizedCreatedDate=Object(S.e)(t.createdDate,this.componentInstance.$user.TimeZoneSidKey),t.createdBy=R()(e="".concat(t.createdByUser,", ")).call(e,t.localizedCreatedDate),t};break;case"Voice Message":case"Video":e.formatter=t=>(t.localizedUpdateDateTime=Object(S.e)(t.updateDateTime,this.componentInstance.$user.TimeZoneSidKey),t)}return T.a.create(t,e)}},P=s("itEF"),D=s("wG3i"),A=s.n(D),j=s("FYrm"),E=s("w+Ta"),B=s("hOMy"),W={props:{accountId:{type:String,default:()=>""}},components:{CreateWeChatPass:j.a,LdModal:B.LdModal},data:()=>({isSavingPass:!1}),methods:{onClickActivator(){this.$refs.Modal.open()},closeModal(t){this.$emit("close",t),this.$refs.Modal.close()},async saveNewPass(){const t=this.accountId||this.$route.params.accountId,e=this.$refs.pass.getPass();if(t&&e)try{this.isSavingPass=!0;const s=await Object(E.f)(t,A()(e));if(s.ok){this.$router.app.$emit("open-toast-notification",{content:this.$t("passForApproval"),type:"success"});const t=s.data;this.$parent.$parent.$parent.$emit("new-pass-created"),this.closeModal(t)}else this.$refs.Modal.showError(s.error)}catch(t){const e=this.$parseErrorMessage(t);this.$refs.Modal.showError(e)}finally{this.isSavingPass=!1}}}},F=(s("nOmU"),s("KHd+")),V=s("Dk61"),U=Object(F.a)(W,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"new-pass-popup"},[s("span",{on:{click:t.onClickActivator}},[t._t("activator")],2),t._v(" "),s("ld-modal",{ref:"Modal",attrs:{title:t.$t("newPassTitle"),width:"auto","min-width":900,"max-width":"90%",persistent:t.isSavingPass}},[s("template",{slot:"content"},[s("create-we-chat-pass",{ref:"pass",attrs:{"acc-id":t.accountId,"is-popup":!0}})],1),t._v(" "),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSavingPass},on:{click:function(e){return t.closeModal()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isSavingPass},on:{click:function(e){return t.saveNewPass()}}},[t._v(t._s(t.$t("global.saveBtn")))])])],2)],1)}),[],!1,null,"dcb5ef76",null);"function"==typeof V.default&&Object(V.default)(U);var Q=U.exports,K=s("fb3H"),H=s("wbfU"),z={props:{accountId:String},components:{WechatNotification:K.a,NewNotificationPopup:H.a},data:()=>({isWeChatNotificationVisible:!1,isNewNotificationPopupVisible:!1,selectedWeChatNotification:null}),methods:{onClickActivator(){this.isWeChatNotificationVisible=!0},onWeChatNotificationClose(){this.isWeChatNotificationVisible=!1},onWeChatNotificationNext(t){this.selectedWeChatNotification=t,this.isWeChatNotificationVisible=!1,this.isNewNotificationPopupVisible=!0},onNewNotificationPopupClose(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")?this.$parent.$parent.$parent.$emit("new-notification-template-created"):this.isWeChatNotificationVisible=!0,this.isNewNotificationPopupVisible=!1}}},q=Object(F.a)(z,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isWeChatNotificationVisible?s("wechat-notification",{attrs:{"account-id":t.accountId},on:{close:t.onWeChatNotificationClose,next:t.onWeChatNotificationNext}}):t._e(),t._v(" "),t.isNewNotificationPopupVisible?s("new-notification-popup",{attrs:{"acc-id":t.accountId,notify:t.selectedWeChatNotification},on:{close:t.onNewNotificationPopupClose}}):t._e(),t._v(" "),s("div",{on:{click:t.onClickActivator}},[t._t("activator")],2)],1)}),[],!1,null,null,null).exports;const J=new u.a([["Mini Program",["Text Message","Image","Mini Program Page","Skill"]],["Subscription Account",["Text Message","Image","Structured Message","Voice Message","Video","Mini Program Page","Pass","Coupon","Skill"]],["Service Account",["Text Message","Image","Structured Message","Voice Message","Video","Mini Program Page","Notification Template","Pass","Coupon","Skill"]]]);var G={components:{WechatResponseDesigner:h.WechatResponseDesigner,LdButton:m.LdButton,LdIcon:g.LdIcon,NewPassPopup:Q,NotificationTemplateCreator:q},model:{prop:"value",event:"input"},props:{value:{type:Object,default:()=>({})},limitOfItems:{type:Number,default:999},wechatAccount:{type:Object,required:!0},choosers:{type:Array,required:!0},multiple:{type:Boolean,default:()=>!1},enableReplyMode:{type:[Boolean,String],default:()=>!1},pageName:{type:String,default:""},iconSize:{type:String,default:"small"},structuredType:{type:String,default:"news"}},data:()=>({helperInstance:null,wechatResponse:{},addSvg:y.a}),computed:{unifiedChoosers(){var t;return d()(t=this.choosers).call(t,t=>"string"==typeof t?{type:t}:t)},supportedChoosers(){var t;return this.wechatAccount.type?r()(t=this.unifiedChoosers).call(t,t=>{var e;let{type:s}=t;return i()(e=J.get(this.wechatAccount.type)).call(e,s)}):this.unifiedChoosers},chooserConfigs(){return this.helper.getChooserConfigs(this.supportedChoosers)},replyModeConfig(){return this.helper.getReplyModeConfig(this.enableReplyMode)},helper(){return this.helperInstance||(this.helperInstance=new x(this)),this.helperInstance},accountId(){return this.wechatAccount.id}},watch:{wechatResponse:{handler(t){if(t.isInternalChange&&this.value&&t.content===this.value.content)return;const e=this.multiple?P.a.from(t):P.a.createItem(t);this.$emit("input",e)},deep:!0},value:{deep:!0,immediate:!0,handler(t){this.wechatResponse=n()({isInternalChange:!0},t)}}},methods:{onClickNewStructuredMessage(){M.openRoute({wechatAccountId:this.$wechatAccount.id,path:"message/structured-messages/new"})}}},Z=(s("Ek5D"),s("xswR")),Y=s("ItEM"),X=s("fOvr"),tt=s("1vOb"),et=s("4bTK"),st=s("DR4q"),at=Object(F.a)(G,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("wechat-response-designer",{attrs:{choosers:t.chooserConfigs,multiple:t.multiple,"reply-mode-config":t.replyModeConfig,"limit-of-items":t.limitOfItems,"icon-size":t.iconSize},model:{value:t.wechatResponse,callback:function(e){t.wechatResponse=e},expression:"wechatResponse"}},[s("ld-button",{attrs:{slot:"structured-message-create-button",neutral:""},on:{click:t.onClickNewStructuredMessage},slot:"structured-message-create-button"},[s("ld-icon",{staticClass:"plus-icon",attrs:{size:"xx-small",color:"current",content:t.addSvg}})],1),t._v(" "),s("new-pass-popup",{attrs:{slot:"pass-create-button","account-id":t.accountId},slot:"pass-create-button"},[s("ld-button",{attrs:{slot:"activator",neutral:""},slot:"activator"},[t._v("\n      "+t._s(t.$t("global.newBtn"))+"\n    ")])],1),t._v(" "),s("notification-template-creator",{attrs:{slot:"notification-template-create-button","account-id":t.accountId},slot:"notification-template-create-button"},[s("ld-button",{attrs:{slot:"activator",neutral:""},slot:"activator"},[t._v("\n      "+t._s(t.$t("global.newBtn"))+"\n    ")])],1)],1)}),[],!1,null,"486a8157",null);"function"==typeof Z.default&&Object(Z.default)(at),"function"==typeof Y.default&&Object(Y.default)(at),"function"==typeof X.default&&Object(X.default)(at),"function"==typeof tt.default&&Object(tt.default)(at),"function"==typeof et.default&&Object(et.default)(at),"function"==typeof st.default&&Object(st.default)(at);var nt=at.exports;e.a=nt},"4bTK":function(t,e,s){"use strict";var a=s("t29s"),n=s.n(a);e.default=n.a},"6OJq":function(t,e,s){"use strict";var a=s("buAP");s.n(a).a},"7Nc+":function(t,e,s){},"7V0i":function(t,e,s){"use strict";var a=s("7Nc+");s.n(a).a},"8YXT":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"selectNotificationTemplateLabel":"选择微信模板","newTemplateLabel":"在微信中添加一个新模板"},"en":{"selectNotificationTemplateLabel":"Select WeChat Template","newTemplateLabel":"Choose a new template from WeChat."}}'),delete t.options._Ctor}},"94pc":function(t,e,s){},A3YL:function(t,e,s){"use strict";var a=s("F5n2"),n=s.n(a);e.default=n.a},AScg:function(t,e,s){},D7Q9:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"replyTabLabel":"自动回复","welMsgTabLabel":"欢迎消息","cluesContent":"自动向新的关注者发送欢迎信息","enabledLabel":"已启用","disabledLabel":"已禁用","searchLabel":"搜索自动回复","allStatusOptions":"全部","activeStatusOptions":"已启用","inactiveStatusOptions":"已禁用","lastDateOptions":"最近创建日期","oldestDateOptions":"最早创建日期","mostDateOptions":"最多响应次数","fewestDateOptions":"最少响应次数","autoReplyLabel":"自动回复","textMsgLabel":"文本","imageMsgLabel":"图片","strucMsgLabel":"图文消息","voiceMsgLabel":"语音","videoMsgLabel":"视频","miniProgramLabel":"小程序卡片","statusNotifyContent":"状态已保存。","welMsgNotifyContent":"欢迎消息已保存。","saveRelyNotifyContent":"自动回复已保存。","delReplyNotifyContent":"自动回复已删除。","activeReplyNotifyContent":"自动回复已启用。","deactivatedReplyNotifyContent":"自动回复已禁用。"},"en":{"replyTabLabel":"Smart Replies","welMsgTabLabel":"Welcome Message","cluesContent":"Automatically send a welcome message to new followers","enabledLabel":"Enabled","disabledLabel":"Disabled","searchLabel":"Search Smart Replies","allStatusOptions":"All","activeStatusOptions":"Active","inactiveStatusOptions":"Inactive","lastDateOptions":"Last Created Date","oldestDateOptions":"First Created Date","mostDateOptions":"Most Responded","fewestDateOptions":"Least Responded","autoReplyLabel":"Auto Reply","textMsgLabel":"Text","imageMsgLabel":"Image","strucMsgLabel":"Structured Message","voiceMsgLabel":"Voice Clip","videoMsgLabel":"Video","miniProgramLabel":"Mini Program Page","statusNotifyContent":"Status was saved.","welMsgNotifyContent":"The Welcome Message was saved.","saveRelyNotifyContent":"The smart reply was saved.","delReplyNotifyContent":"The smart reply was deleted.","activeReplyNotifyContent":"The smart reply was activated.","deactivatedReplyNotifyContent":"The smart reply was deactivated."}}'),delete t.options._Ctor}},DR4q:function(t,e,s){"use strict";var a=s("hG8I"),n=s.n(a);e.default=n.a},Dk61:function(t,e,s){"use strict";var a=s("I0LH"),n=s.n(a);e.default=n.a},Ek5D:function(t,e,s){"use strict";var a=s("94pc");s.n(a).a},F1eR:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"coupons":"卡券","syncHeader":"同步卡券","syncContent":"你确认想要从微信同步卡券?"},"en":{"coupons":"Coupons","syncHeader":"Sync Coupons","syncContent":"Are you sure you want to sync coupons from WeChat?"}}'),delete t.options._Ctor}},F5n2:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"weChatLabel":"微信","backLabel":"返回","detailsLabel":"详情","templateSettingLabel":"模板设置","urlLabel":"链接","informationLabel":"附加信息","noteLabel":"备注","placeholderLabel":"可选的"},"en":{"weChatLabel":"WeChat","backLabel":"Back","detailsLabel":"Details","templateSettingLabel":"Template Settings","urlLabel":"URL","informationLabel":"Additional Information","noteLabel":"NOTE","placeholderLabel":"Optional"}}'),delete t.options._Ctor}},F5n6:function(t,e,s){"use strict";var a={props:{paginations:{type:Array},pageNumber:{type:Number,default:1}},data:()=>({currentPageNumber:1}),created(){this.currentPageNumber=this.pageNumber},methods:{changePageNumber(t,e){this.currentPageNumber="pre"===e?this.currentPageNumber-1:"next"===e?this.currentPageNumber+1:t,this.$emit("target",this.currentPageNumber)}}},n=(s("hkfk"),s("KHd+")),o=s("k/9o"),i=Object(n.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.paginations.length>1?s("ul",{staticClass:"slds-grid slds-grid_align-center pagination"},[s("li",{staticClass:"page-turning-pre",attrs:{title:t.$t("preTitle")}},[t.currentPageNumber>1?s("a",{staticClass:"page-turning",attrs:{id:"previousPage"},on:{click:function(e){return t.changePageNumber("","pre")}}},[s("icon",{attrs:{name:"left","text-color":"default",size:"x-small","charket-icon":""}})],1):s("a",{staticClass:"disabled page-turning",attrs:{id:"previousPageDisabled",disabled:"true"}},[s("icon",{attrs:{name:"left","text-color":"default",size:"x-small","charket-icon":""}})],1)]),t._v(" "),t._l(t.paginations,(function(e){return s("li",{staticClass:"middle-page-number"},[0!==e.PageNumber?s("a",{class:{currentPage:e.PageNumber===t.currentPageNumber},on:{click:function(s){return t.changePageNumber(e.PageNumber)}}},[t._v(t._s(e.PageNumber))]):s("a",[t._v("...")])])})),t._v(" "),s("li",{staticClass:"page-turning-pre",attrs:{title:t.$t("nextTitle")}},[t.paginations[t.paginations.length-1].PageNumber!==t.currentPageNumber?s("a",{staticClass:"page-turning",attrs:{id:"nextPage"},on:{click:function(e){return t.changePageNumber("","next")}}},[s("icon",{attrs:{name:"right","text-color":"default",size:"x-small","charket-icon":""}})],1):s("a",{staticClass:"disabled page-turning",attrs:{id:"nextPageDisabled",disabled:"true"}},[s("icon",{attrs:{name:"right","text-color":"default",size:"x-small","charket-icon":""}})],1)])],2):t._e()}),[],!1,null,"430ba9bf",null);"function"==typeof o.default&&Object(o.default)(i);e.a=i.exports},Fblv:function(t,e,s){"use strict";var a=s("O2ea");s.n(a).a},GT4g:function(t,e,s){"use strict";var a=s("y1K5"),n=s.n(a);e.default=n.a},"HA+Y":function(t,e,s){},HaPu:function(t,e,s){"use strict";var a=s("8YXT"),n=s.n(a);e.default=n.a},HguZ:function(t,e,s){"use strict";var a=s("nt/d");s.n(a).a},Hi2j:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"type":"类型","name":"名称","expirationDate":"过期日期","quantity":"数量","status":"状态","to":"至"},"en":{"type":"Type","name":"Name","expirationDate":"Expiration Date","quantity":"Quantity","status":"Status","to":"to"}}'),delete t.options._Ctor}},I0LH:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"newPassTitle":"新建凭证","passForApproval":"凭证已提交审批！"},"en":{"newPassTitle":"New Pass","passForApproval":"The pass was submitted for approval."}}'),delete t.options._Ctor}},ItEM:function(t,e,s){"use strict";var a=s("tAMZ"),n=s.n(a);e.default=n.a},NvIn:function(t,e,s){"use strict";var a=s("Z62V");s.n(a).a},O2ea:function(t,e,s){},OWFR:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"name":"名称","startDate":"开始日期","endDate":"结束日期","quantity":"数量","createdBy":"最后修改信息"},"en":{"name":"Name","startDate":"Start Date","endDate":"End Date","quantity":"Quantity","createdBy":"Created By"}}'),delete t.options._Ctor}},XAGx:function(t,e,s){"use strict";var a=s("x61u");s.n(a).a},Xd9s:function(t,e,s){"use strict";var a=s("D7Q9"),n=s.n(a);e.default=n.a},Y9k4:function(t,e,s){"use strict";s.r(e);var a=s("vQrK"),n=s.n(a),o=s("wG3i"),i=s.n(o),l=s("Yvyk"),r=s.n(l),c=s("za7x"),d=s("692z"),p=s("F5n6"),u=s("w2Vt"),h=s("ngIk"),m=s("dcdS"),g=s("oWfJ"),f=s("00Ee");var y=s("4B+h"),v=s("cybb"),b=s("LQ5e"),_=s.n(b),w=s("L2JU"),C={mixins:[g.a],components:{Icon:c.a,NoRecord:d.a,Pagination:p.a,LoadingSpinner:u.a,InputSelect:h.a,Dropdown:m.a},created(){this.accountId=this.$route.params.accountId,r.a.all([this.getCurrentCouponList(),this.getStatus(),this.getType()])},computed:n()({},Object(w.c)({currentUser:"user/currentUser"}),{showNoRecord(){return!this.couponList||this.couponList.length<=0},adjustedQuantiyNum:{get:function(){if(""===this.newQuantityNum)return null;{const t=Number(this.editQuantityNum),e=Number(this.newQuantityNum);return!t&&0!==t||!e&&0!==e?null:e-t}},set:function(t){const e=Number(this.editQuantityNum);if(""===t)this.newQuantityNum="";else{const s=Number(t);!s&&0!==s||!e&&0!==e||(this.newQuantityNum=e+s>0?Math.round(e+s):0)}}},canSaveNewQuantity(){return/^[0-9]\d*$/.test(this.newQuantityNum)&&!this.isUpdatingQuantity}}),watch:{dropdownRefId:function(){"Status"===this.dropdownType?(this.dropdownOptionData.options=this.statusOptionData.options,this.dropdownOptionData.currents=this.statusOptionData.currentOptions,this.hasSortBy=!1,this.isChoosingType=!0):"Type"===this.dropdownType?(this.dropdownOptionData.options=this.typeOptionData.options,this.dropdownOptionData.currents=this.typeOptionData.currentOptions,this.hasSortBy=!1,this.isChoosingType=!0):"Order"===this.dropdownType&&(this.dropdownOptionData.options=this.orderOptionData.options,this.dropdownOptionData.currents=this.orderOptionData.currentOptions,this.hasSortBy=!0,this.isChoosingType=!1)}},data(){return{accountId:null,couponList:[],couponsTotal:0,hasMoreCoupons:!1,currentPageNum:1,pageCount:20,couponsPagination:[],isLoadingCoupons:!1,filterJson:{OrderBy:"Last Created Date",SearchKey:"",Status:"",Type:""},statusOptionData:{options:[],currentOptions:[]},typeOptionData:{options:[],currentOptions:[]},orderOptionData:{options:[{Name:this.$t("lastCreatedDate"),value:"Last Created Date"},{Name:this.$t("oldestCreatedDate"),value:"Oldest Created Date"},{Name:this.$t("lastStartTime"),value:"Last Start Time"},{Name:this.$t("oldestStartTime"),value:"Oldest Start Time"},{Name:this.$t("lastEndTime"),value:"Last End Time"},{Name:this.$t("oldestEndTime"),value:"Oldest End Time"},{Name:this.$t("mostQuantity"),value:"Most Quantity"},{Name:this.$t("leastQuantity"),value:"Least Quantity"}],currentOptions:[{Name:this.$t("lastCreatedDate"),value:"Last Created Date"}]},hasSortBy:!1,editQuantityNum:0,newQuantityNum:"",isUpdatingQuantity:!1,currentEditCoupon:null,isChoosingType:!1}},methods:{async getStatus(){try{const t=await Object(f.a)({method:"CouponRemoteActions.getCouponStatus",args:[]});if(t.ok){const e=JSON.parse(_.a.unescape(t.data));this.statusOptionData.options=e.CouponStatus}else Object(y.f)(t)}catch(t){Object(y.f)(t)}},async getType(){try{const t=await Object(f.a)({method:"CouponRemoteActions.getCouponType",args:[]});if(t.ok){const e=JSON.parse(_.a.unescape(t.data));this.typeOptionData.options=e.CouponType}else Object(y.f)(t)}catch(t){Object(y.f)(t)}},async getCurrentCouponList(){this.isLoadingCoupons=!0;const t=i()(this.filterJson);if(this.accountId)try{const e=await function(t,e,s,a){return Object(f.a)({method:"CouponRemoteActions.getCoupons",args:[t,e,s,a]})}(this.accountId,this.currentPageNum,this.pageCount,t);if(this.isLoadingCoupons=!1,e.ok){const t=JSON.parse(_.a.unescape(e.data));this.couponList=t.coupons,this.couponList;for(const t of this.couponList)t.beginDate=Object(v.c)(t.beginDate,this.currentUser.TimeZoneSidKey),t.endDate=Object(v.c)(t.endDate,this.currentUser.TimeZoneSidKey),t.createdDate=Object(v.e)(t.createdDate,this.currentUser.TimeZoneSidKey);this.couponsPagination=t.paging.pages,this.couponsTotal=t.paging.total.Count,this.hasMoreCoupons=t.paging.total.HasMore}else Object(y.f)(e)}catch(t){this.isLoadingCoupons=!1,Object(y.f)(t)}},clearSearchKey(){this.filterJson.SearchKey="",this.getCurrentCouponList()},selectPicklist(t){"Status"===this.dropdownType?(this.filterJson.Status=t[0]?t[0].Value:"",this.filterJson.Status,this.statusOptionData.currentOptions=t,this.getCurrentCouponList()):"Type"===this.dropdownType?(this.filterJson.Type=t[0]?t[0].Value:"",this.typeOptionData.currentOptions=t,this.getCurrentCouponList()):"Order"===this.dropdownType&&(this.filterJson.OrderBy=t[0].value,this.orderOptionData.currentOptions=t,this.getCurrentCouponList()),this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1},target(t){this.currentPageNum=t,this.getCurrentCouponList(),document.getElementsByClassName("scroll-content")[0].scrollTop=0},openEditQuantityModal(t){this.editQuantityNum=t.quantity,this.currentEditCoupon=t,this.$refs.quantityModal.open()},closeEditQuantityModal(){this.newQuantityNum="",this.$refs.quantityModal.close()},clearQuantityModalData(){this.newQuantityNum=""},onClickUpdateQuantityCancel(){this.closeEditQuantityModal()},async updateQuantity(){this.isUpdatingQuantity=!0;try{const a=await(t=this.accountId,e=this.currentEditCoupon.cardId,s=this.adjustedQuantiyNum,Object(f.a)({method:"CouponRemoteActions.updateStock",args:[t,e,s]}));a.ok?(this.closeEditQuantityModal(),this.getCurrentCouponList(),this.$router.app.$emit("open-toast-notification",{content:this.$t("changesAreSaved"),type:"success"})):this.$refs.quantityModal.showError(a.error)}catch(t){const e=this.$parseErrorMessage(t);this.$refs.quantityModal.showError(e)}finally{this.isUpdatingQuantity=!1}var t,e,s},openDeleteCouponModal(t){this.currentEditCoupon=t;const e=this.$confirm({title:this.$t("delModalHeader"),content:this.$t("delModalContent")});e.$on("ok",async()=>{e.close();try{const t=await function(t,e,s){return Object(f.a)({method:"CouponRemoteActions.deleteCoupon",args:[t,e,s]})}(this.accountId,this.currentEditCoupon.couponId,this.currentEditCoupon.cardId);t.ok?(this.getCurrentCouponList(),this.$router.app.$emit("open-toast-notification",{content:this.$t("delNotifyContent"),type:"success"})):Object(y.f)(t)}catch(t){Object(y.f)(t)}})},resetFilters(){this.filterJson.Status="",this.filterJson.Type="",this.statusOptionData.currentOptions=[],this.typeOptionData.currentOptions=[],this.getCurrentCouponList()}}},M=(s("HguZ"),s("KHd+")),L=s("+JOJ"),R=Object(M.a)(C,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-list-page"},[s("div",{staticClass:"slds-border_bottom slds-grid slds-grid_vertical-align-center coupon-list-filter"},[s("span",{staticClass:"coupon-count"},[t._v(t._s(t._f("addSeparators")(t.couponsTotal))),t.hasMoreCoupons?s("i",{staticClass:"show-plus-sign"},[t._v("+")]):t._e(),t._v("\n      "+t._s(t.couponsTotal>1?t.$t("item",["s"]):t.$t("item",[""]))+"\n    ")]),t._v(" "),s("div",{staticClass:"coupon-pick-list"},[s("input-select",{attrs:{"default-label":t.$t("status"),currents:t.statusOptionData.currentOptions,type:"Status"},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1),t._v(" "),s("div",{staticClass:"coupon-pick-list"},[s("input-select",{attrs:{"default-label":t.$t("type"),currents:t.typeOptionData.currentOptions,type:"Type"},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1),t._v(" "),s("div",{staticClass:"slds-col_bump-left coupon-search"},[s("search-input",{attrs:{placeholder:t.$t("searchCoupon")},on:{search:t.getCurrentCouponList,clear:t.clearSearchKey},model:{value:t.filterJson.SearchKey,callback:function(e){t.$set(t.filterJson,"SearchKey",e)},expression:"filterJson.SearchKey"}})],1),t._v(" "),s("div",{staticClass:"coupon-order"},[s("input-select",{attrs:{currents:t.orderOptionData.currentOptions,type:"Order"},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1)]),t._v(" "),t.filterJson.Status||t.filterJson.Type?s("section",{staticClass:"slds-box",attrs:{id:"filter-list-section"}},[s("span",{staticClass:"reset-filter-icon",on:{click:function(e){return t.resetFilters()}}},[s("icon",{attrs:{name:"close","text-color":"default",width:"13px",height:"13px"}})],1),t._v(" "),s("span",{staticClass:"reset-filter-title"},[t._v(t._s(t.$t("filterLabel"))+" ")]),t._v(" "),t.filterJson.Status?s("span",{staticClass:"reset-filter-value"},[t._v(t._s(t.$t("status"))+": "+t._s(t.statusOptionData.currentOptions[0].Name)+".")]):t._e(),t._v(" "),t.filterJson.Type?s("span",{staticClass:"reset-filter-value"},[t._v(t._s(t.$t("type"))+": "+t._s(t.typeOptionData.currentOptions[0].Name)+".")]):t._e()]):t._e(),t._v(" "),t.couponList.length>0?s("div",{staticClass:"slds-table--header-fixed_container coupon-list-content",class:{"coupon-filter-list":t.filterJson.Status||t.filterJson.Type}},[s("div",{staticClass:"slds-scrollable_y scroll-content"},[s("table",{staticClass:"slds-table slds-table_bordered slds-no-row-hover slds-table--header-fixed coupon-table",attrs:{role:"grid"}},[s("thead",[s("tr",{staticClass:"slds-line-height_reset"},[s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col",width:"13%"}},[s("div",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("type")}},[t._v(t._s(t.$t("type")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col",width:"17%"}},[s("div",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("name")}},[t._v(t._s(t.$t("name")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col",width:"18%"}},[s("div",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("expirationDate")}},[t._v(t._s(t.$t("expirationDate")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col",width:"10%"}},[s("div",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("status")}},[t._v(t._s(t.$t("status")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col",width:"12%"}},[s("div",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("quantity")}},[t._v(t._s(t.$t("quantity")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col",width:"20%"}},[s("div",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("createdBy")}},[t._v(t._s(t.$t("createdBy")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("div",{staticClass:"slds-truncate slds-cell-fixed action-col",attrs:{title:t.$t("action")}},[t._v(t._s(t.$t("action")))])])])]),t._v(" "),s("tbody",{staticClass:"select-coupon"},t._l(t.couponList,(function(e){return s("tr",{staticClass:"coupon-tr"},[s("td",{attrs:{"data-label":"Type"}},[s("div",{staticClass:"slds-truncate",attrs:{title:e.type}},[t._v(t._s(e.type))])]),t._v(" "),s("td",{attrs:{"data-label":"Name"}},[s("div",{staticClass:"slds-truncate"},[s("a",{attrs:{href:"/"+e.couponId,target:"_blank",title:e.name}},[t._v(t._s(e.name))]),t._v(" "),e.cardId?s("p",{staticClass:"coupon-card slds-truncate"},[t._v("(Card ID: "),s("span",{attrs:{title:e.cardId}},[t._v(t._s(e.cardId))]),t._v(")")]):t._e()])]),t._v(" "),s("td",{attrs:{"data-label":"Expiration Date"}},[s("div",{staticClass:"slds-truncate"},["Fixed Time Range"===e.dateType?s("div",{staticClass:"coupon-date",attrs:{title:e.beginDate+" "+(e.endDate?t.$t("to"):"")+" "+e.endDate}},[t._v(t._s(e.beginDate)+" "+t._s(e.endDate?t.$t("to"):"")+" "+t._s(e.endDate))]):s("div",[null!==e.fixedDaysValidAfter?s("p",{staticClass:"coupon-date",attrs:{title:t.$t("validInfo",[e.fixedDaysValidAfter,e.fixedDaysValidFor])},domProps:{innerHTML:t._s(t.$t("validInfo",["<span>"+e.fixedDaysValidAfter+"<span>","<span>"+e.fixedDaysValidFor+"<span>"]))}}):t._e(),t._v(" "),null!==e.fixedDaysValidFor&&null===e.fixedDaysValidAfter?s("p",{staticClass:"coupon-date",attrs:{title:t.$t("validInfo1",[e.fixedDaysValidFor])},domProps:{innerHTML:t._s(t.$t("validInfo1",["<span>"+e.fixedDaysValidFor+"<span>"]))}}):t._e()]),t._v(" "),e.expired?s("p",{staticClass:"coupon-date"},[t._v("("+t._s(t.$t("expired"))+")")]):t._e()])]),t._v(" "),s("td",{attrs:{"data-label":"Status"}},[s("div",{staticClass:"slds-truncate",attrs:{title:e.status.Label}},[t._v(t._s(e.status.Label))])]),t._v(" "),s("td",{attrs:{"data-label":"Quantity"}},[s("div",{staticClass:"slds-grid slds-grid_align-end coupon-quantity"},[s("div",{staticClass:"slds-truncate"},[s("a",{attrs:{href:"/"+e.couponId,target:"_blank",title:e.inventory+" / "+e.quantity}},[t._v(t._s(t._f("addSeparators")(e.inventory))+" / "+t._s(t._f("addSeparators")(e.quantity)))])]),t._v(" "),s("div",{staticClass:"quantity-edit-icon",on:{click:function(s){return t.openEditQuantityModal(e)}}},[s("span",{staticClass:"down-btn"},[s("icon",{attrs:{name:"editReplyIcon","class-name":"down-icon",height:"14px",width:"14px"}})],1)])])]),t._v(" "),s("td",{attrs:{"data-label":"Created By"}},[s("div",{staticClass:"slds-truncate"},[e.createdByUser?s("span",{attrs:{title:e.createdByUser+", "+e.createdDate}},[t._v(t._s(e.createdByUser)+", "+t._s(e.createdDate))]):s("span",{attrs:{title:e.createdDate}},[t._v(t._s(e.createdDate))])])]),t._v(" "),s("td",{attrs:{"data-label":"Action"}},["Delivered"!==e.status.Value?s("div",{staticClass:"slds-truncate action-btn"},[s("span",{staticClass:"del-btn",on:{click:function(s){return t.openDeleteCouponModal(e)}}},[t._v(t._s(t.$t("global.deleteBtn")))])]):t._e()])])})),0)]),t._v(" "),t.isLoadingCoupons?t._e():s("pagination",{attrs:{paginations:t.couponsPagination,"page-number":t.currentPageNum},on:{target:t.target}})],1)]):t._e(),t._v(" "),t.showNoRecord&&!t.isLoadingCoupons?s("no-record",{attrs:{"custom-style":"top: 120px;"}}):t._e(),t._v(" "),s("loading-spinner",{attrs:{"is-loading":t.isLoadingCoupons,"custom-style":"top: 40px;"}}),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.dropdownOptionData.options,currents:t.dropdownOptionData.currents,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth,"has-sort-by":t.hasSortBy,"default-label":t.isChoosingType},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e(),t._v(" "),s("ld-modal",{ref:"quantityModal",attrs:{title:t.$t("adjustQuantity")},on:{close:t.clearQuantityModalData},scopedSlots:t._u([{key:"content",fn:function(){return[s("div",{staticClass:"slds-p-around_medium"},[s("div",{staticClass:"slds-grid slds-grid_vertical adjust-quantity-form"},[s("div",{staticClass:"slds-grid slds-grid_align-spread adjust-quantity-item"},[s("label",{attrs:{for:"currentQuantity"}},[t._v(t._s(t.$t("currentQuantity")))]),t._v(" "),s("input",{staticClass:"slds-input",attrs:{type:"text",id:"currentQuantity",disabled:""},domProps:{value:t.editQuantityNum}})]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_align-spread adjust-quantity-item"},[s("label",{attrs:{for:"adjustQuantity"}},[t._v(t._s(t.$t("quantityAdjusted")))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.adjustedQuantiyNum,expression:"adjustedQuantiyNum"}],staticClass:"slds-input",attrs:{type:"number",id:"adjustQuantity"},domProps:{value:t.adjustedQuantiyNum},on:{input:function(e){e.target.composing||(t.adjustedQuantiyNum=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_align-spread adjust-quantity-item"},[s("label",{attrs:{for:"newQuantity"}},[t._v(t._s(t.$t("newQuantity")))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newQuantityNum,expression:"newQuantityNum"}],staticClass:"slds-input",attrs:{type:"number",id:"newQuantity"},domProps:{value:t.newQuantityNum},on:{input:function(e){e.target.composing||(t.newQuantityNum=e.target.value)}}})])])])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{neutral:"",disabled:t.isUpdatingQuantity},on:{click:function(e){return e.stopPropagation(),t.onClickUpdateQuantityCancel()}}},[t._v("\n        "+t._s(t.$t("global.cancelBtn"))+"\n      ")]),t._v(" "),s("ld-button",{attrs:{brand:"",disabled:!t.canSaveNewQuantity},on:{click:function(e){return e.stopPropagation(),t.updateQuantity()}}},[t._v("\n        "+t._s(t.$t("global.saveBtn"))+"\n      ")])]},proxy:!0}])})],1)}),[],!1,null,"d1489a58",null);"function"==typeof L.default&&Object(L.default)(R);var I={created(){this.$route.params.accountId&&(this.accountId=this.$route.params.accountId),this.switchAccount({wechatAccountId:this.$route.params.accountId,router:this.$router})},data(){return{tabs:[{name:"COUPONS",label:this.$t("coupons")}],accountId:""}},components:{WeChatCouponList:R.exports},methods:n()({},Object(w.b)("sidebar",["switchAccount"]),{refreshList(){this.$nextTick(()=>{this.$refs.couponList.getCurrentCouponList()})},syncCoupon(){const t=this.$confirm({title:this.$t("syncHeader"),content:this.$t("syncContent"),ok:this.$t("global.syncBtn")});t.$on("ok",async()=>{try{const e=await function(t){return Object(f.a)({method:"CouponRemoteActions.syncWeChatCoupons",args:[t]})}(this.accountId);e.ok?this.$refs.waitSyncConfirmMoal.open():Object(y.f)(e)}catch(t){Object(y.f)(t)}finally{t.close()}})},closeWaitConfirm(){this.$refs.waitSyncConfirmMoal.close()}})},$=(s("6OJq"),s("jO96")),S=Object(M.a)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-grid slds-grid_vertical wechat-coupon-page"},[s("scoped-tabs",{attrs:{tabs:t.tabs,"current-tab-name":"COUPONS"},on:{switch:t.refreshList}},[s("div",{attrs:{slot:"button-group"},slot:"button-group"},[s("button",{staticClass:"slds-button slds-button_brand",on:{click:function(e){return t.syncCoupon()}}},[t._v(t._s(t.$t("global.syncBtn")))])])]),t._v(" "),s("div",{staticClass:"coupon-page-content"},[s("we-chat-coupon-list",{ref:"couponList"})],1),t._v(" "),s("ld-modal",{ref:"waitSyncConfirmMoal",attrs:{title:t.$t("syncHeader")},scopedSlots:t._u([{key:"content",fn:function(){return[s("p",{staticClass:"slds-p-around_medium"},[t._v(t._s(t.$t("global.syncNotifyContent")))])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{brand:""},on:{click:function(e){return t.closeWaitConfirm()}}},[t._v("\n        "+t._s(t.$t("global.confirmBtn"))+"\n      ")])]},proxy:!0}])})],1)}),[],!1,null,"6e2f071a",null);"function"==typeof $.default&&Object($.default)(S);e.default=S.exports},Z62V:function(t,e,s){},buAP:function(t,e,s){},fGFX:function(t,e,s){},fOvr:function(t,e,s){"use strict";var a=s("OWFR"),n=s.n(a);e.default=n.a},fb3H:function(t,e,s){"use strict";var a=s("w2Vt"),n=s("zUtI"),o=s("4B+h"),i=s("LQ5e"),l=s.n(i),r={props:{accountId:String,default:()=>""},components:{LoadingSpinner:a.a},data:()=>({notifies:[],isNotifyLoading:!1,selectedNotify:{}}),created(){this.isNotifyLoading=!0,this.fetchNotifies()},methods:{async fetchNotifies(){try{const t=await Object(n.g)(this.accountId||this.$route.params.accountId);if(t.ok){this.isNotifyLoading=!1,this.notifies=JSON.parse(l.a.unescape(t.data));for(let t of this.notifies)this.$set(t,"type","example"),this.$set(t,"isSelectedShow",!1);this.$nextTick((function(){this.renderGrid()}))}else this.isNotifyLoading=!1,Object(o.f)(t)}catch(t){Object(o.f)(t)}},closeNotify(){this.$emit("close")},renderGrid(){const t=document.getElementsByClassName("template-item");let e,s,a=0;for(let n=0;n<t.length;n++)n>0&&(t[n-3]&&(e=t[n-3].offsetTop+t[n-3].offsetHeight+20,t[n].style.top=e+"px"),n%3>0&&(s=t[n-1].offsetLeft+t[n-1].offsetWidth+20,t[n].style.left=s+"px")),a=Math.max(a,t[n].offsetTop+t[n].offsetHeight+60);const n=document.getElementsByClassName("template-content")[0];n&&(n.style.height=a-35+"px");for(let e=0;e<t.length;e++)t[e].style.height=t[e].offsetHeight+10+"px"},selectNotify(t,e){e.isSelectedShow=!e.isSelectedShow;for(let t of this.notifies)t.TemplateId!==e.TemplateId&&(t.isSelectedShow=!1);this.selectedNotify=e.isSelectedShow?e:{}},switchTemplate(t,e){t.type=e},goToWeChatPlatform(){this.$emit("close"),window.open("https://mp.weixin.qq.com")},next(){this.$emit("next",this.selectedNotify)}}},c=(s("vyV3"),s("KHd+")),d=s("HaPu"),p=Object(c.a)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{attrs:{id:"wechat-notification-list"}},[s("div",{staticClass:"slds-modal slds-modal_large slds-fade-in-open",attrs:{"aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container container-width",attrs:{role:"document",tabindex:"0"}},[s("div",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close",on:{click:function(e){return t.closeNotify()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.$t("selectNotificationTemplateLabel")))])]),t._v(" "),t.isNotifyLoading?t._e():s("div",{staticClass:"slds-modal__content"},[s("div",{staticClass:"template-content"},[s("ul",{staticClass:"select-template-list"},[t._l(t.notifies,(function(e){return s("li",{staticClass:"slds-box template-item",on:{click:function(s){return s.stopPropagation(),t.selectNotify(s,e)}}},[s("div",{staticClass:"template-container"},[s("div",{staticClass:"slds-grid template-section"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"example"===e.type&&e.Example,expression:"notify.type === 'example' && notify.Example"}]},[s("span",{staticClass:"slds-text-heading_small title"},[t._v(t._s(e.Title))]),t._v(" "),s("pre",{staticClass:"slds-text-body_regular content"},[t._v(t._s(e.Example))])]),t._v(" "),s("div",[s("span",{staticClass:"slds-text-heading_small title"},[t._v(t._s(e.Title))]),t._v(" "),s("pre",{staticClass:"slds-text-body_regular content"},[t._v(t._s(e.Content))])])])]),t._v(" "),s("div",{staticClass:"switch-section"},[s("p",{directives:[{name:"show",rawName:"v-show",value:e.Example,expression:"notify.Example"}],staticClass:"left",class:{selected:"example"===e.type},on:{click:function(s){return s.stopPropagation(),t.switchTemplate(e,"example")}}}),t._v(" "),s("p",{class:{selected:"content"===e.type||!e.Example},on:{click:function(s){return s.stopPropagation(),t.switchTemplate(e,"content")}}})]),t._v(" "),e.isSelectedShow?s("div",{staticClass:"selected-notify"},[s("div",{staticClass:"selected-bg"}),t._v(" "),s("div",{staticClass:"selected-icon"},[s("icon",{attrs:{name:"check","fill-color":"white",width:"48px",height:"48px"}})],1)]):t._e()])})),t._v(" "),s("li",{staticClass:"slds-box template-item default"},[s("span",{staticClass:"default-icon down-btn",on:{click:function(e){return t.goToWeChatPlatform()}}},[s("icon",{attrs:{name:"add","class-name":"down-icon",width:"32px",height:"32px"}})],1),t._v(" "),s("p",{staticClass:"default-value"},[t._v(t._s(t.$t("newTemplateLabel")))])])],2)])]),t._v(" "),s("loading-spinner",{attrs:{"is-loading":t.isNotifyLoading,"custom-style":"position: relative;padding: 40px;background-color: white"}}),t._v(" "),s("div",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.closeNotify()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:!t.selectedNotify.TemplateId},on:{click:function(e){return t.next()}}},[t._v(t._s(t.$t("global.nextBtn")))])])],1)]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open"})])])}),[],!1,null,"1a576594",null);"function"==typeof d.default&&Object(d.default)(p);e.a=p.exports},h5Lq:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"createTitle":"创建自动回复","editTitle":"编辑自动回复","nameLabel":"名称","activeLabel":"启用","keywordLabel":"关键词","keywordPlaceholder":"按回车键或点击按钮进行添加","addBtnLabel":"添加","exactMatch":"精确匹配","phraseMatch":"模糊匹配","responsesLabel":"回复内容","noResponsesLabel":"没有回复内容","allLabel":"全部","randomLabel":"随机","replyModeLabel":"回复模式","wechatTagsLabel":"微信关注者标签","overwriteDescription":"覆盖微信关注者已有标签","statusLabel":"市场活动成员状态","textMsgLabel":"文本","imageMsgLabel":"图片","strucMsgLabel":"图文消息","voiceMsgLabel":"语音","videoMsgLabel":"视频","skillMsgLabel":"技能","miniProgramMsgLabel":"小程序卡片"},"en":{"createTitle":"Create Smart Reply","editTitle":"Edit Smart Reply","nameLabel":"Name","activeLabel":"Active","keywordLabel":"Keywords","keywordPlaceholder":"Press Enter or click the Add button to add a new keyword","addBtnLabel":"Add","exactMatch":"Exact Match","phraseMatch":"Phrase Match","responsesLabel":"Responses","noResponsesLabel":"No Responses","allLabel":"All","randomLabel":"Random","replyModeLabel":"Reply Mode","wechatTagsLabel":"WeChat Follower Tags","overwriteDescription":"Overwrite WeChat followers\' existing tag(s).","statusLabel":"Campaign Member Status","textMsgLabel":"text","imageMsgLabel":"image","strucMsgLabel":"structured message","voiceMsgLabel":"voice clip","videoMsgLabel":"video","skillMsgLabel":"skill","miniProgramMsgLabel":"mini program page"}}'),delete t.options._Ctor}},hG8I:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"newTextMessage":"新建文本消息","textMessages":"文本消息","designer":{"linkIcon":"添加链接","miniProgramIcon":"添加小程序链接","actionIcon":"添加动作","mergeFieldIcon":"插入合并字段","changeBtn":"更改","removeBtn":"删除","linkUrl":"链接网址","illegalUrl":"不合法的网址","appId":"App ID","pagePath":"页面路径","name":"名称","value":"值","selectAField":"选择一个字段","fieldTitle":"你已选择以下字段","findObjectPlaceholder":"查找对象...","labelFilterPlaceholder":"键入以过滤列表...","type":"类型","apiName":"API名","currentSelection":"当前选择","noMatchesFound":"没有发现匹配项"}},"en":{"newTextMessage":"New Text Message","textMessages":"Text Messages","designer":{"linkIcon":"Add link","miniProgramIcon":"Add mini program link","actionIcon":"Add action","mergeFieldIcon":"Insert merge field","changeBtn":"Change","removeBtn":"Remove","linkUrl":"Link URL","illegalUrl":"Invalid URL","appId":"App ID","pagePath":"Page Path","name":"Name","value":"Value","selectAField":"Select A Field","fieldTitle":"You have selected the following field","findObjectPlaceholder":"Find An Object...","labelFilterPlaceholder":"Type here to filter the list...","type":"Type","apiName":"API Name","currentSelection":"Current Selection","noMatchesFound":"No matches found"}}}'),delete t.options._Ctor}},hkfk:function(t,e,s){"use strict";var a=s("fGFX");s.n(a).a},jO96:function(t,e,s){"use strict";var a=s("F1eR"),n=s.n(a);e.default=n.a},"k/9o":function(t,e,s){"use strict";var a=s("qVZU"),n=s.n(a);e.default=n.a},lNHh:function(t,e,s){"use strict";var a=s("svHN"),n=s.n(a);e.default=n.a},mquc:function(t,e,s){"use strict";var a=s("h5Lq"),n=s.n(a);e.default=n.a},nOmU:function(t,e,s){"use strict";var a=s("yWOo");s.n(a).a},"nt/d":function(t,e,s){},o2Zb:function(t,e,s){"use strict";s.r(e);var a=s("wG3i"),n=s.n(a),o=s("4LGG"),i=s.n(o),l=s("Yvyk"),r=s.n(l),c=s("0G99"),d=s.n(c),p=s("SLhn"),u=s.n(p),h=s("8Vev"),m=s.n(h),g=s("+Bun"),f=s.n(g),y=s("vQrK"),v=s.n(y),b=s("692z"),_=s("F5n6"),w=s("Ip10"),C=s.n(w),M=s("dUVM"),L=s.n(M),R=s("ejTr"),I=s.n(R),$=s("3nmp"),S=s("ngIk"),T=s("dcdS"),N=s("V9RP"),k=s("oWfJ"),O=s("+SX9"),x=s("2AFw"),P=s("w2Vt"),D=s("00Ee");function A(t,e){return Object(D.a)({method:"ResponseRemoteActions.changeResponseStatus",args:[t,e]})}var j=s("4IgH"),E=s("4B+h"),B=s("LQ5e"),W=s.n(B),F=s("L2JU"),V=s("2mf0"),U=s("HAvB"),Q=s("cybb"),K={mixins:[k.a],props:{reply:{type:Object,default:()=>({})},currentOptions:{type:Array,default:()=>[]}},components:{WechatResponse:$.a,InputSelect:S.a,Dropdown:T.a,TagDropdown:N.a,ErrorToast:O.a,Lookup:x.a,LoadingSpinner:P.a},data(){return{isShowCreateSmartReply:!0,matchWordValue:"",campaignMetadata:{name:"Campaign",label:this.$tc("global.campaignName",1),labelPural:this.$tc("global.campaignName",2),icon:"campaign",linkField:{name:"Name",label:this.$tc("global.campaignName",1)},fields:[],newObjectLink:"/701/e"},currentItem:null,currentStatus:{name:""},smartReply:{WeChatTagIds:[],WeChatAccount:"",ResponseId:null,ReplyMode:"Random",Name:"",MessageIds:[],Keywords:[],IsOverwriteFollowerTag:!1,IsActive:!0,CampaignMemberStatus:"",CampaignId:""},isSave:!1,errorToastMsg:"",isReplyLoading:!0,accountId:"",statusOptionData:{options:[],currents:[]},tagOptions:[],response:{mode:"Random",items:[]}}},watch:{dropdownRefId:async function(){if(this.statusOptionData.options.length<=0)try{let t=await Object(j.b)(this.smartReply.CampaignId);if(t=JSON.parse(W.a.unescape(t.data)),t.campaignMemberStatus.length>0)for(const e of t.campaignMemberStatus)this.statusOptionData.options.push({Name:e,value:e})}catch(t){Object(E.f)(t)}},response(t,e){console.info("onResponseChange",t,e)}},computed:v()({},Object(F.c)({currentAccount:"sidebar/currentAccount"}),{isMiniProgramAcc(){return"Mini Program"===this.currentAccount.Type},canSave:function(){var t;const e=m()(t=this.smartReply.Keywords).call(t,t=>"Delete"!==t.Status);return this.smartReply.Name&&e.length>0&&this.response&&this.response.items.length>0},selectedMsgInfo(){if(this.response&&0!==this.response.items.length){const a={"Text Message":0,Image:0,StructureMessage:0,"Voice Message":0,Video:0,Skill:0,"Mini Program Page":0},n={"Text Message":this.$t("textMsgLabel"),Image:this.$t("imageMsgLabel"),StructureMessage:this.$t("strucMsgLabel"),"Voice Message":this.$t("voiceMsgLabel"),Video:this.$t("videoMsgLabel"),Skill:this.$t("skillMsgLabel"),"Mini Program Page":this.$t("miniProgramMsgLabel")};for(const t of this.response.items)"WeChat Structured Message"===t.type||"Link Structured Message"===t.type?a.StructureMessage++:a[t.type]++;let o="";for(const i of I()(a)){var t,e,s;if(i)if(this.isMiniProgramAcc){if(L()(t=["Text Message","Image","Mini Program Page"]).call(t,i))"Text Message"!==i&&a[i]>1&&"en"===this.$i18n.locale&&(n[i]=n[i]+"s"),o+=u()(e=" ".concat(a[i]," ")).call(e,n[i],",")}else"Text Message"!==i&&a[i]>1&&"en"===this.$i18n.locale&&(n[i]=n[i]+"s"),o+=u()(s=" ".concat(a[i]," ")).call(s,n[i],",")}return o=o.substring(0,o.length-1),"(".concat(o,")")}return""},wechatAccount(){return{id:this.currentAccount?this.currentAccount.Id:"",type:this.currentAccount?this.currentAccount.Type:""}}}),async created(){this.accountId=this.$route.params.accountId,this.tagOptions=this.currentOptions,this.reply.ResponseId?this.getReplyInfo():this.isReplyLoading=!1},methods:{closeReply(){this.isShowCreateSmartReply=!1,this.currentItem=null,this.$emit("close-smart-reply")},async getReplyInfo(){try{const e=await(t=this.reply.ResponseId,Object(D.a)({method:"ResponseRemoteActions.getSmartReplyById",args:[t]}));if(e.ok){const t=JSON.parse(W.a.unescape(e.data));this.smartReply=t,this.smartReply.CampaignMemberStatus&&(this.statusOptionData.currents=[{Name:this.smartReply.CampaignMemberStatus}]),this.smartReply.RelatedObjectName&&this.smartReply.CampaignId&&(this.currentItem={name:this.smartReply.RelatedObjectName,id:this.smartReply.CampaignId}),this.response.mode=this.smartReply.ReplyMode,this.smartReply.Skill.Id&&(this.smartReply.Skill.type="Skill",this.response.items=[new U.a(this.smartReply.Skill)]),t.MessageIds.length>0?await this.getResponseMessages(t.MessageIds):this.isReplyLoading=!1}}catch(t){Object(E.f)(t)}var t},async getResponseMessages(t){try{var e;const s=await V.a.getMessagesById(t);this.response.items=u()(e=this.response.items).call(e,i()(s).call(s,t=>(t.updateDateTime?t.localizedUpdateDateTime=Object(Q.e)(t.updateDateTime,this.$user.TimeZoneSidKey):t.weChatLastModifiedTime&&(t.localizedWeChatLastModifiedTime=Object(Q.e)(t.weChatLastModifiedTime,this.$user.TimeZoneSidKey)),t)))}catch(t){this.$handleError(t)}this.isReplyLoading=!1},addMatchWord(){if(this.matchWordValue){var t;const e=C()(t=this.smartReply.Keywords).call(t,t=>t.Word===this.matchWordValue);e?(e.MatchMode="Exact Match",e.KeywordId&&(e.Status="Edit")):this.smartReply.Keywords.push({Word:this.matchWordValue,MatchMode:"Exact Match",Status:"New",KeywordId:null})}this.matchWordValue=""},deleteMatchWord(t){var e;t.KeywordId?t.Status="Delete":this.smartReply.Keywords=m()(e=this.smartReply.Keywords).call(e,e=>e.Word!==t.Word)},editMatchWord(t){t.MatchMode="Exact Match"===t.MatchMode?"Phrase Match":"Exact Match",t.KeywordId&&(t.Status="Edit")},onSelect(t){this.smartReply.CampaignId=t?t.id:""},onRemove(t){this.smartReply.CampaignId="",this.smartReply.CampaignMemberStatus="",this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1,this.statusOptionData.options=[],this.statusOptionData.currents=[]},selectTags(t){this.tagOptions=t,this.smartReply.WeChatTagIds=[];for(let e of t)this.smartReply.WeChatTagIds.push(e.Id)},removeOption(t){this.smartReply.WeChatTagIds=[];for(let e of t)this.smartReply.WeChatTagIds.push(e.Id);this.tagOptions=t,this.showTagDropdown&&(this.$root.$emit("close-other-dropdown",null),this.showTagDropdown=!1)},selectPicklist(t){this.statusOptionData.currents=t,this.smartReply.CampaignMemberStatus=t[0]?t[0].value:"",this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1},async saveReply(){var t;this.isSave=!0,this.smartReply.WeChatAccount=this.$route.params.accountId,this.smartReply.MessageIds=[],this.smartReply.ReplyMode=this.response.mode;const e=C()(t=this.response.items).call(t,t=>"Skill"===t.type);if(e)this.smartReply.Skill={Id:e.id,IsInternal:e.isInternal,Name:e.name};else{this.smartReply.Skill={};for(const t of this.response.items)this.smartReply.MessageIds.push(t.id)}if(this.smartReply.ResponseId)try{const t=await(s=n()(this.smartReply),Object(D.a)({method:"ResponseRemoteActions.updateSmartReply",args:[s]}));this.isSave=!1,t.ok?(this.closeReply(),this.$emit("save-smart-reply","save")):(this.errorToastMsg=t.error,this.scrollToTop())}catch(t){this.isSave=!1,Object(E.f)(t)}else try{const t=await function(t){return Object(D.a)({method:"ResponseRemoteActions.saveSmartReply",args:[t]})}(n()(this.smartReply));this.isSave=!1,t.ok?(this.closeReply(),this.$emit("save-smart-reply","save")):(this.errorToastMsg=t.error,this.scrollToTop())}catch(t){this.isSave=!1,Object(E.f)(t)}var s},scrollToTop(){document.getElementById("modal-content").scrollTop=0}}},H=(s("XAGx"),s("KHd+")),z=s("mquc"),q=Object(H.a)(K,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",[s("div",{staticClass:"slds-modal slds-modal_large",class:{"slds-fade-in-open":t.isShowCreateSmartReply},attrs:{"aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container show-selected-container container-width",attrs:{role:"document",tabindex:"0"}},[s("div",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close",on:{click:function(e){return t.closeReply()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),t.reply.ResponseId?t._e():s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.$t("createTitle")))]),t._v(" "),t.reply.ResponseId?s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.$t("editTitle")))]):t._e()]),t._v(" "),t.isReplyLoading?t._e():s("div",{staticClass:"slds-modal__content",attrs:{id:"modal-content"}},[s("div",{staticClass:"new-reply-section"},[t.errorToastMsg?s("error-toast",{attrs:{content:t.errorToastMsg}}):t._e(),t._v(" "),s("div",{staticClass:"line-section two-line-left"},[s("div",{staticClass:"new-name-title"},[s("span",[t._v("*")]),t._v(" "+t._s(t.$t("nameLabel")))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.smartReply.Name,expression:"smartReply.Name"}],staticClass:"slds-input",attrs:{type:"text",maxlength:"80"},domProps:{value:t.smartReply.Name},on:{input:function(e){e.target.composing||t.$set(t.smartReply,"Name",e.target.value)}}})]),t._v(" "),t.smartReply.ResponseId?s("div",{staticClass:"line-section two-line-right"},[s("div",{staticClass:"new-name-title"},[t._v(t._s(t.$t("activeLabel")))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.smartReply.IsActive,expression:"smartReply.IsActive"}],staticClass:"active-checkbox",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.smartReply.IsActive)?t._i(t.smartReply.IsActive,null)>-1:t.smartReply.IsActive},on:{change:function(e){var s=t.smartReply.IsActive,a=e.target,n=!!a.checked;if(Array.isArray(s)){var o=t._i(s,null);a.checked?o<0&&t.$set(t.smartReply,"IsActive",s.concat([null])):o>-1&&t.$set(t.smartReply,"IsActive",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.smartReply,"IsActive",n)}}})]):t._e(),t._v(" "),s("div",{staticClass:"line-section"},[s("div",{staticClass:"new-name-title"},[s("span",[t._v("*")]),t._v(" "+t._s(t.$t("keywordLabel")))]),t._v(" "),s("div",{staticClass:"slds-grid keyword-input-area"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.matchWordValue,expression:"matchWordValue"}],staticClass:"slds-input slds-col keyword-input",attrs:{type:"text",placeholder:t.$t("keywordPlaceholder"),maxlength:"40"},domProps:{value:t.matchWordValue},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addMatchWord()},blur:function(e){return t.addMatchWord()},input:function(e){e.target.composing||(t.matchWordValue=e.target.value)}}}),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand keyword-add-btn",on:{click:function(e){return t.addMatchWord()}}},[t._v(t._s(t.$t("addBtnLabel")))])]),t._v(" "),t._l(t.smartReply.Keywords,(function(e){return t.smartReply.Keywords.length>0&&"Delete"!==e.Status?s("div",{staticClass:"word-rule-section"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.Word,expression:"word.Word"}],staticClass:"slds-box new-name-value rule-input",attrs:{type:"text",disabled:""},domProps:{value:e.Word},on:{input:function(s){s.target.composing||t.$set(e,"Word",s.target.value)}}}),t._v(" "),"Exact Match"===e.MatchMode?s("span",{on:{click:function(s){return t.editMatchWord(e)}}},[t._v(t._s(t.$t("exactMatch")))]):t._e(),t._v(" "),"Phrase Match"===e.MatchMode?s("span",{on:{click:function(s){return t.editMatchWord(e)}}},[t._v(t._s(t.$t("phraseMatch")))]):t._e(),t._v(" "),s("span",{staticClass:"rule-img down-btn",on:{click:function(s){return t.deleteMatchWord(e)}}},[s("icon",{attrs:{name:"deleteReplyIcon","class-name":"down-icon",width:"14px",height:"14px"}})],1)]):t._e()}))],2),t._v(" "),s("div",{staticClass:"line-section"},[s("div",{staticClass:"new-name-title"},[s("span",[t._v("*")]),t._v(" "+t._s(t.$t("responsesLabel"))+" "+t._s(t.selectedMsgInfo))]),t._v(" "),s("wechat-response",{attrs:{"limit-of-items":5,"page-name":"SMART REPLIES","wechat-account":t.wechatAccount,choosers:["Text Message","Image","Structured Message","Voice Message","Video","Mini Program Page","Skill"],multiple:"","enable-reply-mode":""},model:{value:t.response,callback:function(e){t.response=e},expression:"response"}})],1),t._v(" "),t.isMiniProgramAcc?t._e():s("div",{staticClass:"line-section two-line-left"},[s("div",{staticClass:"new-name-title"},[t._v(t._s(t.$tc("global.campaignName",1)))]),t._v(" "),s("lookup",{attrs:{"ld-selected-item":t.currentItem,"ld-metadatas":t.campaignMetadata},on:{select:function(e){return t.onSelect(e)},remove:function(e){return t.onRemove()}}})],1),t._v(" "),t.isMiniProgramAcc?t._e():s("div",{staticClass:"line-section two-line-right tag-section"},[s("div",{staticClass:"new-name-title"},[t._v(t._s(t.$t("wechatTagsLabel")))]),t._v(" "),s("input-select",{attrs:{currents:t.tagOptions,"limit-length":5},on:{"close-dropdown":t.closeDropdown,"open-dropdown":t.openTagDropdown,resize:t.resizeDropdown,"remove-option":t.removeOption}}),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.smartReply.IsOverwriteFollowerTag,expression:"smartReply.IsOverwriteFollowerTag"}],staticClass:"line-section-checkbox",attrs:{type:"checkbox",id:"checkbox-follower"},domProps:{checked:Array.isArray(t.smartReply.IsOverwriteFollowerTag)?t._i(t.smartReply.IsOverwriteFollowerTag,null)>-1:t.smartReply.IsOverwriteFollowerTag},on:{change:function(e){var s=t.smartReply.IsOverwriteFollowerTag,a=e.target,n=!!a.checked;if(Array.isArray(s)){var o=t._i(s,null);a.checked?o<0&&t.$set(t.smartReply,"IsOverwriteFollowerTag",s.concat([null])):o>-1&&t.$set(t.smartReply,"IsOverwriteFollowerTag",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(t.smartReply,"IsOverwriteFollowerTag",n)}}}),t._v(" "),s("label",{staticClass:"line-section-checkbox-title",attrs:{for:"checkbox-follower"}},[t._v(t._s(t.$t("overwriteDescription")))])],1),t._v(" "),t.isMiniProgramAcc?t._e():s("div",{staticClass:"line-section two-line-left"},[s("div",{staticClass:"new-name-title"},[t._v(t._s(t.$t("statusLabel")))]),t._v(" "),s("input-select",{attrs:{currents:t.statusOptionData.currents,"is-disabled":!t.smartReply.CampaignId},on:{"close-dropdown":t.closeDropdown,"open-dropdown":t.openDropdown,resize:t.resizeDropdown}})],1)],1)]),t._v(" "),s("loading-spinner",{attrs:{"is-loading":t.isReplyLoading,"custom-style":"position: relative; padding : 40px; background-color: white"}}),t._v(" "),s("div",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSave},on:{click:function(e){return t.closeReply()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:!t.canSave||t.isSave},on:{click:function(e){return t.saveReply()}}},[t._v(t._s(t.$t("global.saveBtn")))])])],1)]),t._v(" "),s("div",{staticClass:"slds-backdrop",class:{"slds-backdrop_open":t.isShowCreateSmartReply}})]),t._v(" "),t.showTagDropdown?s("tag-dropdown",{attrs:{"account-id":t.accountId,currents:t.tagOptions,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth,"is-single-selection":!1,"limit-length":5},on:{"select-option":t.selectTags,close:t.closeDropdown}}):t._e(),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.statusOptionData.options,currents:t.statusOptionData.currents,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e()],1)}),[],!1,null,"7aa5362b",null);"function"==typeof z.default&&Object(z.default)(q);var J=q.exports,G=s("3O4B"),Z=s.n(G),Y=s("kWsH"),X=s.n(Y),tt={props:{replies:{type:Array,default:()=>[]}},components:{NewSmartReply:J},computed:{smartReplies:function(){for(const e of this.replies){var t;let s=[];X()(t=e.Keywords).call(t,(function(t,e){return t.Word.localeCompare(e.Word)})),e.MessageNumber.NumberOfTexts>1?s.push({count:e.MessageNumber.NumberOfTexts,value:this.$tc("textMsgLabel",2)}):1===e.MessageNumber.NumberOfTexts&&s.push({count:1,value:this.$tc("textMsgLabel",1)}),e.MessageNumber.NumberOfStructuredMessages>1?s.push({count:e.MessageNumber.NumberOfStructuredMessages,value:this.$tc("strucMsgLabel",2)}):1===e.MessageNumber.NumberOfStructuredMessages&&s.push({count:1,value:this.$tc("strucMsgLabel",1)}),e.MessageNumber.NumberOfImages>1?s.push({count:e.MessageNumber.NumberOfImages,value:this.$tc("imageMsgLabel",2)}):1===e.MessageNumber.NumberOfImages&&s.push({count:1,value:this.$tc("imageMsgLabel",1)}),e.MessageNumber.NumberOfVoice>1?s.push({count:e.MessageNumber.NumberOfVoice,value:this.$tc("voiceMsgLabel",2)}):1===e.MessageNumber.NumberOfVoice&&s.push({count:1,value:this.$tc("voiceMsgLabel",1)}),e.MessageNumber.NumberOfVideos>1?s.push({count:e.MessageNumber.NumberOfVideos,value:this.$tc("videoMsgLabel",2)}):1===e.MessageNumber.NumberOfVideos&&s.push({count:1,value:this.$tc("videoMsgLabel",1)}),e.MessageNumber.NumberOfMiniProgramPages>1?s.push({count:e.MessageNumber.NumberOfMiniProgramPages,value:this.$tc("miniProgramMsgLabel",2)}):1===e.MessageNumber.NumberOfMiniProgramPages&&s.push({count:1,value:this.$tc("miniProgramMsgLabel",1)}),e.Skill.Id&&(s.push({count:1,value:this.$tc("skillMsgLabel")}),e.TotalMessageNumber=e.TotalMessageNumber+1),this.$set(e,"msgs",s)}return this.replies},tags:function(){let t=[];for(const e of this.editReply.WeChatTags)t.push({Name:e.TagName,value:e.TagName,Id:e.TagId,isSelected:!0});return t}},data:()=>({isSmartReplyShow:!1,editReply:{},modal:{mainContent:"",headerContent:""},tempReply:{}}),methods:{getMenuItems(t){const e=[{value:"edit",label:this.$t("global.editBtn"),target:t},{value:"delete",label:this.$t("global.deleteBtn"),target:t}];return t.IsActive?Z()(e).call(e,1,0,{value:"deactivate",label:this.$t("deactivateLabel"),target:t}):Z()(e).call(e,1,0,{value:"activate",label:this.$t("activateLabel"),target:t}),e},onClickMenuItem(t){const{value:e,target:s}=t;"edit"===e?this.editSmartReply(s):this.openModal(s,e)},editSmartReply(t){this.editReply=t,this.isSmartReplyShow=!0,this.$router.replace({path:"/".concat(this.$route.params.accountId,"/responses/replies/edit"),query:{id:t.ResponseId}})},openModal(t,e){let s="",a="";"delete"===e?(s=this.$tc("replyActionHeader",2),a=this.$tc("replyActionContent",2)):"deactivate"===e?(s=this.$tc("replyActionHeader",0),a=this.$tc("replyActionContent",0)):"activate"===e&&(s=this.$tc("replyActionHeader",1),a=this.$tc("replyActionContent",1)),this.tempReply=t,this.modal.headerContent=s,this.modal.mainContent=a;const n=this.$confirm({title:s,content:a});n.$on("ok",async()=>{n.close(),this.modal.headerContent===this.$tc("replyActionHeader",2)?this.deleteReply(this.tempReply):this.changeStatus(this.tempReply)})},async deleteReply(t){try{const s=await(e=t.ResponseId,Object(D.a)({method:"ResponseRemoteActions.deleteSmartReply",args:[e]}));s.ok?this.$emit("action-success","delete"):Object(E.f)(s)}catch(t){Object(E.f)(t)}var e},async changeStatus(t){try{const e=await A(t.ResponseId,!t.IsActive);if(e.ok){let e=t.IsActive?"inactive":"active";this.$emit("action-success",e)}else Object(E.f)(e)}catch(t){Object(E.f)(t)}},closeSmartReply(){this.isSmartReplyShow=!1,this.editReply={},this.$router.replace({path:"/".concat(this.$route.params.accountId,"/responses/replies")})},saveSmartReply(t){this.$emit("action-success",t)}}},et=(s("NvIn"),s("GT4g")),st=Object(H.a)(tt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("ul",t._l(t.smartReplies,(function(e){return s("li",{staticClass:"slds-border_bottom reply-list-item"},[s("div",{staticClass:"list-item-left"},[s("a",{staticClass:"type-value",attrs:{href:"/"+e.ResponseId,target:"_blank"}},[t._v(t._s(e.Name))]),t._v(" "),s("ul",t._l(e.Keywords,(function(e){return s("li",{staticClass:"label-list-item",class:{"phrase-item":"Phrase Match"===e.MatchMode}},[s("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:"Phrase Match"===e.MatchMode?t.$t("phraseMatch"):t.$t("exactMatch"),offset:5},expression:"{content: keyword.MatchMode === 'Phrase Match' ? $t('phraseMatch') : $t('exactMatch'), offset: 5}"}]},[t._v(t._s(e.Word))])])})),0),t._v(" "),e.TotalMessageNumber>0?s("div",{staticClass:"response-items"},[e.TotalMessageNumber>1?s("span",[t._v(t._s(e.TotalMessageNumber)+" "+t._s(t.$tc("responseNum",2)))]):t._e(),t._v(" "),1===e.TotalMessageNumber?s("span",[t._v("1 "+t._s(t.$tc("responseNum",1)))]):t._e(),t._v(" "),s("span",{staticClass:"response-items-msg"},[t._v("("),t._l(e.msgs,(function(e){return s("span",[t._v(t._s(e.count)+" "+t._s(e.value))])})),t._v(")")],2),t._v(" "),s("div",{staticClass:"mode-dot"}),"All"===e.ReplyMode?s("span",{staticClass:"mode-value"},[t._v(t._s(t.$t("allLabel")))]):t._e(),"Random"===e.ReplyMode?s("span",{staticClass:"mode-value"},[t._v(t._s(t.$t("randomLabel")))]):t._e(),t._v(" "),e.TagNumber>0?s("span",{staticClass:"tag-icon"},[s("icon",{attrs:{name:"tagGrey","fill-color":"#706e6b",width:"12px",height:"12px","charket-icon":""}})],1):t._e(),e.TagNumber>0?s("span",{staticClass:"tag-value"},[t._v(t._s(e.TagNumber))]):t._e(),e.RelatedObjectName?s("span",{staticClass:"campaign-icon"},[s("icon",{attrs:{name:"campaign","fill-color":"#706e6b",width:"22px",height:"22px","charket-icon":""}})],1):t._e(),e.RelatedObjectName?s("a",{staticClass:"campaign-value",attrs:{href:"/"+e.CampaignId,target:"_blank"}},[t._v(t._s(e.RelatedObjectName))]):t._e()]):t._e()]),t._v(" "),s("div",{staticClass:"list-item-center"},[s("span",{staticClass:"center-number"},[t._v(t._s(t._f("addSeparators")(e.TotalVolume)))]),t._v(" "),e.TotalVolume>1?s("span",{staticClass:"center-value"},[t._v(t._s(t.$tc("respondedLabel",2)))]):t._e(),t._v(" "),e.TotalVolume<=1?s("span",{staticClass:"center-value"},[t._v(t._s(t.$tc("respondedLabel",1)))]):t._e()]),t._v(" "),s("div",{staticClass:"list-item-right"},[s("ld-action-menu",{attrs:{items:t.getMenuItems(e)},on:{click:function(e){return t.onClickMenuItem(e)}}})],1)])})),0),t._v(" "),t.isSmartReplyShow?s("new-smart-reply",{attrs:{reply:t.editReply,"current-options":t.tags},on:{"close-smart-reply":function(e){return t.closeSmartReply()},"save-smart-reply":t.saveSmartReply}}):t._e()],1)}),[],!1,null,"9906e358",null);"function"==typeof et.default&&Object(et.default)(st);var at=st.exports,nt=s("jkSJ"),ot={mixins:[k.a],data(){return{accountId:"",tabs:[{name:"SMART REPLIES",label:this.$t("replyTabLabel")},{name:"WELCOME MESSAGE",label:this.$t("welMsgTabLabel")}],currentPopupType:"",editHeader:"",popupHeaderContent:"",isWelcomeEnabled:!1,isInitResponseLoading:!0,isNewSmartReplyShow:!1,editReply:{},responseId:null,isSave:!1,hasSortBy:!1,statusOptionData:{options:[{Name:this.$t("allStatusOptions"),value:"All"},{Name:this.$t("activeStatusOptions"),value:"Active"},{Name:this.$t("inactiveStatusOptions"),value:"Inactive"}],currentOptions:[{Name:this.$t("activeStatusOptions")}]},dateOptionData:{options:[{Name:this.$t("lastDateOptions"),value:"Last Created Date"},{Name:this.$t("oldestDateOptions"),value:"Oldest Created Date"},{Name:this.$t("mostDateOptions"),value:"Most Times Responded"},{Name:this.$t("fewestDateOptions"),value:"Fewest Times Responded"}],currentOptions:[{Name:this.$t("lastDateOptions")}]},Condition:{OrderBy:"Last Created Date",SearchKey:"",Active:"Active"},smartReplyMetadata:{replies:[],count:20,total:0,currentSmartReplyPagination:[]},hasMoreSmartReplies:!1,currentPageNumber:1,defaultVoiceIcon:s("iTeh"),wechatResponse:{mode:"All",items:[]}}},components:{NoRecord:b.a,Pagination:_.a,NewSmartReply:J,SmartReplyList:at,InputSelect:S.a,Dropdown:T.a,LoadingSpinner:P.a,WechatResponse:$.a},computed:v()({},Object(F.c)({currentAccount:"sidebar/currentAccount"}),{wechatAccount(){return{id:this.currentAccount?this.currentAccount.Id:"",type:this.currentAccount?this.currentAccount.Type:""}},currentTab:function(){var t;return f()(t=this.$route.name).call(t,"responses-replies")>=0?"SMART REPLIES":"responses-welcome"===this.$route.name?"WELCOME MESSAGE":""},isMiniProgramAcc(){return"Mini Program"===this.currentAccount.Type},filterTabs(){var t;return this.isMiniProgramAcc?m()(t=this.tabs).call(t,t=>"SMART REPLIES"===t.name):this.tabs},isSaveBtnDisabled(){return 0===this.wechatResponse.items.length||this.isSave||!this.isWelcomeEnabled},autoReplyLabel(){return this.wechatResponse.items.length<=0?"".concat(this.$t("autoReplyLabel")," (0/3)"):"Skill"===this.wechatResponse.items[0].type?"".concat(this.$t("autoReplyLabel")," (1/1)"):u()(t="".concat(this.$t("autoReplyLabel")," (")).call(t,this.wechatResponse.items.length,"/3)");var t}}),watch:{dropdownRefId:function(){"status"===this.dropdownType?(this.dropdownOptionData.options=this.statusOptionData.options,this.dropdownOptionData.currents=this.statusOptionData.currentOptions,this.hasSortBy=!1):"date"===this.dropdownType&&(this.dropdownOptionData.options=this.dateOptionData.options,this.dropdownOptionData.currents=this.dateOptionData.currentOptions,this.hasSortBy=!0)}},created(){this.accountId=this.$route.params.accountId,this.switchAccount({wechatAccountId:this.accountId,router:this.$router}),this.getResponseData(this.currentTab)},methods:v()({},Object(F.b)("sidebar",["switchAccount"]),{changeTab(t){"SMART REPLIES"===t?(this.$router.replace({path:"/".concat(this.accountId,"/responses/replies")}),this.currentPageNumber=1,this.resetFilterData()):"WELCOME MESSAGE"===t&&this.$router.replace({path:"/".concat(this.accountId,"/responses/welcome")}),this.getResponseData(t)},async toggleResponseState(){if(this.isWelcomeEnabled=!this.isWelcomeEnabled,this.responseId)if(this.isInitResponseLoading=!0,this.isWelcomeEnabled)try{await A(this.responseId,!0)}catch(t){Object(E.f)(t)}finally{this.isInitResponseLoading=!1}else try{await A(this.responseId,!1),this.$router.app.$emit("open-toast-notification",{content:this.$t("statusNotifyContent"),type:"success"})}catch(t){Object(E.f)(t)}finally{this.isInitResponseLoading=!1}},async getResponseData(t){if("SMART REPLIES"===t)this.isInitResponseLoading=!0,this.fetchSmartReply();else if("WELCOME MESSAGE"===t){this.isInitResponseLoading=!0,this.wechatResponse.items=[];try{const t=await(e=this.accountId,Object(D.a)({method:"ResponseRemoteActions.getWelcomeMessage",args:[e]}));if(t.ok){const e=JSON.parse(W.a.unescape(t.data));this.isWelcomeEnabled=e.Enabled,this.responseId=e.Id||null,this.wechatResponse.mode=e.ReplyMode||"All",e.Replies&&e.Replies.length>0&&await this.fetchWeChatMessage(e.Replies)}else Object(E.f)(t)}catch(t){Object(E.f)(t)}finally{this.isInitResponseLoading=!1}}var e},getWeChatMsgIdsAndSkillId(t){let e={wechatIds:[],skillId:null};return d()(t).call(t,t=>{"Message"===t.Type?e.wechatIds=t.RelatedIds:"Skill"===t.Type&&(e.skillId=t.RelatedIds.join(""))}),e},async fetchWeChatMessage(t){var e;const s=this.getWeChatMsgIdsAndSkillId(t),a=s.wechatIds.length>0,n=!!s.skillId;if(!a&&!n)return;let o=[],l={};await this.$try(async()=>{a&&!n?o=await nt.k.getMessagesByIds(s.wechatIds):a&&n?[o,l]=await r.a.all([nt.k.getMessagesByIds(s.wechatIds),nt.r.getSkill(s.skillId)]):!a&&n&&(l=await nt.r.getSkill(s.skillId))}),this.wechatResponse.items=u()(e=this.wechatResponse.items).call(e,i()(o).call(o,t=>(t.updateDateTime?t.localizedUpdateDateTime=Object(Q.e)(t.updateDateTime,this.$user.TimeZoneSidKey):t.weChatLastModifiedTime&&(t.localizedWeChatLastModifiedTime=Object(Q.e)(t.weChatLastModifiedTime,this.$user.TimeZoneSidKey)),t))),l.id&&this.wechatResponse.items.push(l)},async fetchSmartReply(){try{const o=await(t=this.accountId,e=this.smartReplyMetadata.count,s=this.currentPageNumber,a=n()(this.Condition),Object(D.a)({method:"ResponseRemoteActions.getSmartReplies",args:[t,e,s,a]}));if(o.ok){this.isInitResponseLoading=!1;const t=JSON.parse(W.a.unescape(o.data));this.smartReplyMetadata.replies=t.responses,this.smartReplyMetadata.total=t.total.Count,this.smartReplyMetadata.currentSmartReplyPagination=t.pages,this.hasMoreSmartReplies=t.total.HasMore}else this.isInitResponseLoading=!1,Object(E.f)(o)}catch(t){Object(E.f)(t)}var t,e,s,a},async saveResponseMsg(){this.isSave=!0,this.saveWelcomeMessageRest()},async saveWelcomeMessageRest(){try{const t={Id:this.responseId,ReplyMode:this.wechatResponse.mode,Enabled:this.isWelcomeEnabled,Replies:this.getSaveMsgReplies()},e=await function(t,e){return Object(D.a)({method:"ResponseRemoteActions.saveWelcomeMessage",args:[t,e]})}(this.accountId,n()(t));this.isSave=!1,e.ok?this.$router.app.$emit("open-toast-notification",{content:this.$t("welMsgNotifyContent"),type:"success"}):Object(E.f)(e)}catch(t){this.isSave=!1,Object(E.f)(t)}},getSaveMsgReplies(){var t;let e=[],s={Type:"Skill",RelatedIds:[]},a={Type:"Message",RelatedIds:[]};return d()(t=this.wechatResponse.items).call(t,t=>{"Skill"===t.type?s.RelatedIds.push(t.id):a.RelatedIds.push(t.id)}),s.RelatedIds.length>0&&e.push(s),a.RelatedIds.length>0&&e.push(a),e},newSmartReply(){this.isNewSmartReplyShow=!0,this.$router.replace({path:"/".concat(this.accountId,"/responses/replies/new")})},closeSmartReply(){this.isNewSmartReplyShow=!1,this.$router.replace({path:"/".concat(this.$route.params.accountId,"/responses/replies")})},selectPicklist(t){"status"===this.dropdownType?(this.Condition.Active=t[0].value,this.statusOptionData.currentOptions=t):"date"===this.dropdownType&&(this.Condition.OrderBy=t[0].value,this.dateOptionData.currentOptions=t),this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1,this.currentPageNumber=1,this.isInitResponseLoading=!0,this.fetchSmartReply()},searchSmartReply(){this.currentPageNumber=1,this.isInitResponseLoading=!0,this.fetchSmartReply()},clearSearchKey(){this.Condition.SearchKey="",this.currentPageNumber=1,this.isInitResponseLoading=!0,this.fetchSmartReply()},resetFilterData(){this.Condition.SearchKey="",this.Condition.OrderBy="Last Created Date",this.Condition.Active="Active",this.statusOptionData.currentOptions=[{Name:this.$t("activeStatusOptions")}],this.dateOptionData.currentOptions=[{Name:this.$t("lastDateOptions")}]},target(t){this.currentPageNumber=t,this.isInitResponseLoading=!0,this.fetchSmartReply(),document.getElementsByClassName("right-page-section")[0].scrollTop=0},saveSmartReplySucess(t){"save"===t?this.$router.app.$emit("open-toast-notification",{content:this.$t("saveRelyNotifyContent"),type:"success"}):"delete"===t?this.$router.app.$emit("open-toast-notification",{content:this.$t("delReplyNotifyContent"),type:"success"}):"active"===t?this.$router.app.$emit("open-toast-notification",{content:this.$t("activeReplyNotifyContent"),type:"success"}):"inactive"===t&&this.$router.app.$emit("open-toast-notification",{content:this.$t("deactivatedReplyNotifyContent"),type:"success"}),this.isNewSmartReplyShow=!1,this.currentPageNumber=1,this.isInitResponseLoading=!0,this.fetchSmartReply()}})},it=(s("7V0i"),s("Xd9s")),lt=Object(H.a)(ot,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"smart-reply-page"},[s("scoped-tabs",{attrs:{tabs:t.filterTabs,"current-tab-name":t.currentTab},on:{switch:t.changeTab}},[s("div",{attrs:{slot:"button-group"},slot:"button-group"},["WELCOME MESSAGE"===t.currentTab?s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isSaveBtnDisabled},on:{click:function(e){return t.saveResponseMsg()}}},[t._v(t._s(t.$t("global.saveBtn")))]):t._e(),t._v(" "),"SMART REPLIES"===t.currentTab?s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.newSmartReply()}}},[t._v(t._s(t.$t("global.newBtn")))]):t._e()])]),t._v(" "),"WELCOME MESSAGE"===t.currentTab?s("div",{staticClass:"slds-border_bottom slds-grid response-clues"},[s("div",{staticClass:"slds-col slds-col_bump-right"},[t._v("\n      "+t._s(t.$t("cluesContent"))+"\n    ")]),t._v(" "),s("div",{staticClass:"response-enabled"},[t._v("\n      "+t._s(t.isWelcomeEnabled?t.$t("enabledLabel"):t.$t("disabledLabel"))+"\n    ")]),t._v(" "),s("div",{staticClass:"response-enabled-button",class:{"response-disabled-btn":!t.isWelcomeEnabled},on:{click:function(e){return t.toggleResponseState()}}},[s("div",{class:[t.isWelcomeEnabled?"welcome-enabled":"welcome-disabled"]})])]):t._e(),t._v(" "),"SMART REPLIES"===t.currentTab?s("div",{staticClass:"slds-grid slds-grid_vertical-align-center reply-clues"},[t.smartReplyMetadata.total>1?s("span",[t._v(t._s(t._f("addSeparators")(t.smartReplyMetadata.total))),t.hasMoreSmartReplies?s("i",{staticClass:"show-plus-sign"},[t._v("+")]):t._e(),t._v(" "+t._s(t.$tc("global.itemLabel",2))+"\n    ")]):t._e(),t._v(" "),t.smartReplyMetadata.total<=1?s("span",[t._v(t._s(t.smartReplyMetadata.total)+" "+t._s(t.$tc("global.itemLabel",1)))]):t._e(),t._v(" "),s("div",{staticClass:"reply-statu"},[s("input-select",{attrs:{currents:t.statusOptionData.currentOptions,type:"status"},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1),t._v(" "),s("div",{staticClass:"slds-col_bump-left reply-search"},[s("search-input",{attrs:{placeholder:t.$t("searchLabel")},on:{search:t.searchSmartReply,clear:t.clearSearchKey},model:{value:t.Condition.SearchKey,callback:function(e){t.$set(t.Condition,"SearchKey",e)},expression:"Condition.SearchKey"}})],1),t._v(" "),s("div",{staticClass:"reply-date"},[s("input-select",{attrs:{currents:t.dateOptionData.currentOptions,type:"date"},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1)]):t._e(),t._v(" "),"SMART REPLIES"===t.currentTab?s("div",{staticClass:"reply-list-content slds-scrollable_y"},[t.isInitResponseLoading?t._e():s("smart-reply-list",{attrs:{replies:t.smartReplyMetadata.replies},on:{"action-success":t.saveSmartReplySucess}}),t._v(" "),t.isInitResponseLoading?t._e():s("pagination",{attrs:{paginations:t.smartReplyMetadata.currentSmartReplyPagination,"page-number":t.currentPageNumber},on:{target:t.target}})],1):t._e(),t._v(" "),s("loading-spinner",{attrs:{"is-loading":t.isInitResponseLoading,"custom-style":"top: 40px;"}}),t._v(" "),t.isInitResponseLoading||0!==t.smartReplyMetadata.total||"SMART REPLIES"!==t.currentTab?t._e():s("no-record",{attrs:{"custom-style":"top: 80px;"}}),t._v(" "),t.isWelcomeEnabled&&!t.isInitResponseLoading&&"WELCOME MESSAGE"===t.currentTab?s("div",{staticClass:"response-content slds-scrollable_y"},[s("div",{staticClass:"response-content-welcome"},[s("div",{staticClass:"welcome-title"},[t._v("\n        "+t._s(t.autoReplyLabel)+"\n      ")]),t._v(" "),s("wechat-response",{attrs:{"limit-of-items":3,"page-name":"WELCOME MESSAGE","wechat-account":t.wechatAccount,choosers:["Text Message","Image","Structured Message","Voice Message","Video","Mini Program Page","Skill"],multiple:"","enable-reply-mode":""},model:{value:t.wechatResponse,callback:function(e){t.wechatResponse=e},expression:"wechatResponse"}})],1)]):t._e(),t._v(" "),t.isNewSmartReplyShow?s("new-smart-reply",{attrs:{reply:t.editReply,"current-options":[]},on:{"save-smart-reply":t.saveSmartReplySucess,"close-smart-reply":function(e){return t.closeSmartReply()}}}):t._e(),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.dropdownOptionData.options,currents:t.dropdownOptionData.currents,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth,"has-sort-by":t.hasSortBy},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e()],1)}),[],!1,null,"282eef24",null);"function"==typeof it.default&&Object(it.default)(lt);e.default=lt.exports},pED3:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"item":"项目","searchCoupon":"查询卡券","type":"类型","name":"名称","expirationDate":"过期日期","quantity":"数量","status":"状态","createdBy":"最后修改信息","action":"操作","to":"至","expired":"已过期","lastCreatedDate":"最近创建日期","oldestCreatedDate":"最早创建日期","lastStartTime":"最近开始时间","oldestStartTime":"最早开始时间","lastEndTime":"最近结束日期","oldestEndTime":"最早结束日期","mostQuantity":"最多数量","leastQuantity":"最少数量","adjustQuantity":"调整数量","newQuantity":"新的数量","quantityAdjusted":"数量调整","currentQuantity":"当前数量","delModalHeader":"删除卡券","delModalContent":"你确定要删除这张卡券吗？","delNotifyContent":"卡券已删除。","changesAreSaved":"修改已保存。","validInfo":"领取后{0}天生效{1}天有效","validInfo1":"领取后当天生效{0}天有效","filterLabel":"过滤条件:"},"en":{"item":"item{0}","searchCoupon":"Search Coupons","type":"Type","name":"Name","expirationDate":"Expiration Date","quantity":"Quantity","status":"Status","createdBy":"Created By","action":"Action","to":"to","expired":"Expired","lastCreatedDate":"Last Created Date","oldestCreatedDate":"First Created Date","lastStartTime":"Last Start Time","oldestStartTime":"First Start Time","lastEndTime":"Last End Date","oldestEndTime":"First End Date","mostQuantity":"Most Quantity","leastQuantity":"Least Quantity","adjustQuantity":"Adjust Quantity","newQuantity":"New Quantity","quantityAdjusted":"Quantity Adjusted","currentQuantity":"Current Quantity","delModalHeader":"Delete Coupon","delModalContent":"Are you sure you want to delete this coupon?","delNotifyContent":"The coupon was deleted.","changesAreSaved":"Changes were saved.","validInfo":"Redeemable {0} day(s) after claimed and valid for {1} day(s)","validInfo1":"Redeemable immediately after claimed and valid for {0} day(s)","filterLabel":"Filtered By:"}}'),delete t.options._Ctor}},pUDi:function(t,e,s){"use strict";var a=s("SLhn"),n=s.n(a),o=s("3O4B"),i=s.n(o),l=s("WE60"),r=s.n(l),c=s("wG3i"),d=s.n(c),p=s("Ip10"),u=s.n(p),h=s("+Bun"),m=s.n(h),g=s("0G99"),f=s.n(g),y=s("vQrK"),v=s.n(y),b=s("mdEO"),_=s("TDue"),w=s("vkTm"),C=s("ngIk"),M=s("dcdS"),L=s("oWfJ"),R=s("L2JU"),I={components:{SelectField:_.a,ColorPicker:w.a,InputSelect:C.a,Dropdown:M.a,PhoneFrameCard:b.PhoneFrameCard},mixins:[L.a],props:{notify:{type:Object,default:()=>({contentTemplate:{keywords:[]}})},selectedMiniProgram:{type:Object,default:function(){return{}}},wechatAccountId:{type:String,default:()=>""}},data(){return{colorPickerPosition:"",newNotify:{},notifyColor:{first:"#000000",keywords:[],remark:"#000000"},colorType:"",mergeFieldType:"",keywords:[],notificationURL:"",note:"",showMergeField:!1,notifyFirst:"",notifyRemark:"",showFirst:"",showRemark:"",fieldObj:{},redirectOptionData:{options:[{Name:this.$t("urlLabel"),Value:"URL"},{Name:this.$t("global.miniProgramLabel"),Value:"Mini Program Page"}],currents:[{Name:this.$t("urlLabel"),Value:"URL"}]},selectedMiniProgramPage:{}}},computed:v()({},Object(R.c)({currentAccount:"sidebar/currentAccount"}),{isRedirectToURL(){return"URL"===this.redirectOptionData.currents[0].Value},isShowDetail(){return this.notificationURL||this.selectedMiniProgramPage.messageId}}),created(){this.newNotify=this.notify,this.notificationURL=this.newNotify.NotificationURL||"";let t=this.newNotify.Content.split(/{{.*?}}/gm),e=this.newNotify.Content.match(/{{.*?}}/gm),s=[];if(f()(t).call(t,(t,a)=>{s.push({name:t,value:e[a],key:e[a],color:"#000000"})}),this.$set(this.newNotify,"contentTemplate",s),this.notify.Id){var a,n;this.fieldObj=this.newNotify.mergeFieldObject;let t=u()(a=this.newNotify.contentTemplate).call(a,t=>{var e;return t.key&&0===m()(e=t.key).call(e,"{{first.")}),s=u()(n=this.newNotify.contentTemplate).call(n,t=>{var e;return t.key&&0===m()(e=t.key).call(e,"{{remark.")});t&&(t.color=this.newNotify.ContentMapping.first.color,t.value=this.newNotify.ContentMapping.first.value,this.notifyFirst=this.newNotify.ContentMapping.first.value,this.notifyColor.first=this.newNotify.ContentMapping.first.color),s&&(s.color=this.newNotify.ContentMapping.remark.color,s.value=this.newNotify.ContentMapping.remark.value,this.notifyRemark=this.newNotify.ContentMapping.remark.value,this.notifyColor.remark=this.newNotify.ContentMapping.remark.color),f()(e).call(e,(t,e)=>{if(0===m()(t).call(t,"{{first."))this.showFirst=t;else if(0===m()(t).call(t,"{{remark."))this.showRemark=t;else{var s;let e=t.match(/({{=?)(\S*)(?=.DATA)/g);const a=e[0].substr(2,e[0].length-1);this.keywords.push({label:a,value:this.newNotify.ContentMapping[a].value}),this.notifyColor.keywords.push(this.newNotify.ContentMapping[a].color);let n=u()(s=this.newNotify.contentTemplate).call(s,t=>t.key.replace(/{{/,"").replace(/.DATA}}/,"")===a);n.value=this.newNotify.ContentMapping[a].value,n.color=this.newNotify.ContentMapping[a].color}}),this.notificationURL=this.newNotify.ContentMapping.url||this.notificationURL}else f()(e).call(e,(t,e)=>{if(0===m()(t).call(t,"{{first."))this.showFirst=t;else if(0===m()(t).call(t,"{{remark."))this.showRemark=t;else{let e=t.match(/({{=?)(\S*)(?=.DATA)/g);this.keywords.push({label:e[0].substr(2,e[0].length-1),value:""}),this.notifyColor.keywords.push("#000000")}});this.note=this.newNotify.Note||"",this.selectedMiniProgram.messageId&&(this.redirectOptionData.currents=[{Name:this.$t("global.miniProgramLabel"),Value:"Mini Program Page"}],this.selectedMiniProgramPage=JSON.parse(d()(this.selectedMiniProgram)))},methods:{changeFirst(t){var e;u()(e=this.newNotify.contentTemplate).call(e,t=>{var e;return 0===m()(e=t.key).call(e,"{{first.")}).value=this.notifyFirst},changeRemark(){var t;u()(t=this.newNotify.contentTemplate).call(t,t=>{var e;return 0===m()(e=t.key).call(e,"{{remark.")}).value=this.notifyRemark},changeKey(t,e,s){var a;u()(a=this.newNotify.contentTemplate).call(a,t=>t.key.replace(/{{/,"").replace(/.DATA}}/,"")===s).value=t.target.value,this.keywords[e].value=t.target.value},onBgColor(t){if("first"===this.colorType){var e;this.notifyColor.first=t,u()(e=this.newNotify.contentTemplate).call(e,t=>{var e;return 0===m()(e=t.key).call(e,"{{first.")}).color=t}else if("remark"===this.colorType){var s;this.notifyColor.remark=t,u()(s=this.newNotify.contentTemplate).call(s,t=>{var e;return 0===m()(e=t.key).call(e,"{{remark.")}).color=t}else{var a,n,o;const e=r()(a=this.keywords).call(a,t=>t.label===this.colorType);i()(n=this.notifyColor.keywords).call(n,e,1,t),u()(o=this.newNotify.contentTemplate).call(o,t=>t.key.replace(/{{/,"").replace(/.DATA}}/,"")===this.colorType).color=t}},openColorPicker(t,e,s){var a;this.$refs.bgColorList.close(),this.colorType=s,this.colorPickerPosition=n()(a="position: absolute; left: ".concat(e,"px; top: ")).call(a,t,"px;"),this.$refs.bgColorList.open()},openSelectField(t){this.showMergeField=!0,this.mergeFieldType=t},closeSelectFiled(){this.showMergeField=!1},selectMergeField(t,e){if(this.fieldObj.label!==e.label&&(this.fieldObj=JSON.parse(d()(e))),"first"===this.mergeFieldType){var s;u()(s=this.newNotify.contentTemplate).call(s,t=>{var e;return 0===m()(e=t.key).call(e,"{{first.")}).value=this.notifyFirst+t,this.notifyFirst=this.notifyFirst+t}else if("remark"===this.mergeFieldType){var a;u()(a=this.newNotify.contentTemplate).call(a,t=>{var e;return 0===m()(e=t.key).call(e,"{{remark.")}).value=this.notifyRemark+t,this.notifyRemark=this.notifyRemark+t}else if("url"===this.mergeFieldType)this.notificationURL=t;else{var n,o;let e=u()(n=this.newNotify.contentTemplate).call(n,t=>{var e;return m()(e=t.key).call(e,this.mergeFieldType)>=0});const s=r()(o=this.keywords).call(o,t=>t.label===this.mergeFieldType);e.value=this.keywords[s].value,e.value=e.value+t,this.keywords[s].value=this.keywords[s].value+t}this.showMergeField=!1},prepareUpdatedData(){var t,e;let s={ContentMapping:{}};return s.Note=this.note,s.Title=this.newNotify.Title,this.showFirst&&(s.ContentMapping.first={value:this.notifyFirst,color:this.notifyColor.first}),f()(t=this.keywords).call(t,(t,e)=>{s.ContentMapping[t.label]={value:t.value,color:this.notifyColor.keywords[e]}}),this.showRemark&&(s.ContentMapping.remark={value:this.notifyRemark,color:this.notifyColor.remark}),this.isRedirectToURL?(s.NotificationURL=this.notificationURL,this.selectedMiniProgramPage={}):(this.notificationURL="",s.MiniProgramPageId=this.selectedMiniProgramPage.messageId||""),m()(e=this.notificationURL).call(e,"{!")>=0&&(s.NotificationURL="",s.ContentMapping.url=this.notificationURL),s},prepareCreatedData(){let t=this.prepareUpdatedData();return t.Content=this.newNotify.Content,this.newNotify.Industry&&(t.Industry=this.newNotify.Industry),this.newNotify.Sample&&(t.Sample=this.newNotify.Sample),t.TemplateId=this.newNotify.TemplateId,t},onChangeRedirectTo(t){this.redirectOptionData.currents=t,this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1},onMiniProgramChanged(t){this.selectedMiniProgramPage=t}}},$=(s("Fblv"),s("KHd+")),S=s("A3YL"),T=Object($.a)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-grid slds-grid_vertical-align-start new-notification-page"},[s("phone-frame-card",{staticClass:"phone-model-outer",attrs:{name:t.currentAccount.Name}},[s("div",{attrs:{slot:"app-name"},slot:"app-name"},[t._v(t._s(t.$t("global.wechatLabel")))]),t._v(" "),s("span",{attrs:{slot:"back-label"},slot:"back-label"},[t._v(t._s(t.$t("global.backBtn")))]),t._v(" "),s("div",{staticClass:"phone-model-body",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"slds-box template-container"},[s("div",{staticClass:"template-section",class:{"has-padding":!t.isShowDetail}},[s("span",{staticClass:"slds-text-heading_small title",class:{"key-title":!t.showFirst}},[t._v(t._s(t.newNotify.Title))]),t._v(" "),t._l(t.newNotify.contentTemplate,(function(e){return[e.name?s("pre",{staticClass:"keyword"},[t._v(t._s(e.name))]):t._e(),t._v(" "),e.value?s("pre",{staticClass:"keyword",style:{color:e.color}},[t._v(t._s(e.value))]):t._e()]})),t._v(" "),t.isShowDetail?s("div",{staticClass:"detail-section",class:{"mini-program-detail":!t.isRedirectToURL}},[t.isRedirectToURL?t._e():s("icon",{staticClass:"mini-program-icon",attrs:{name:"miniProIcon",width:"16px",height:"16px","fill-color":"#706e6b","charket-icon":""}}),t._v(" "),t.isRedirectToURL?s("span",{staticClass:"slds-text-body_regular detail-value"},[t._v("\n              "+t._s(t.$t("detailsLabel"))+"\n            ")]):t._e(),t._v(" "),s("span",{staticClass:"detail-icon"},[s("icon",{attrs:{name:"chevronright","fill-color":"#b0adab",width:"14px",height:"14px"}})],1)],1):t._e()],2)])]),t._v(" "),s("div",{staticClass:"slds-col phone-model-footer",attrs:{slot:"action"},slot:"action"},[s("icon",{attrs:{name:"add","fill-color":"slds-icon_container slds-icon-text-default",width:"20px",height:"20px"}})],1)]),t._v(" "),s("div",{staticClass:"right"},[s("div",{staticClass:"right-content"},[s("span",{staticClass:"slds-text-heading_small content-title"},[t._v(t._s(t.$t("templateSettingLabel")))]),t._v(" "),t.showFirst?s("div",{staticClass:"input-section"},[s("label",[t._v("First")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.notifyFirst,expression:"notifyFirst"}],staticClass:"slds-textarea value first",style:{color:t.notifyColor.first},domProps:{value:t.notifyFirst},on:{keyup:function(e){return t.changeFirst(e)},input:function(e){e.target.composing||(t.notifyFirst=e.target.value)}}}),t._v(" "),s("span",{staticClass:"insert-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openSelectField("first")}}},[s("icon",{attrs:{name:"insertTag","class-name":"down-icon",width:"15px",height:"15px"}})],1),t._v(" "),s("span",{staticClass:"color-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openColorPicker(100,755,"first")}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1)]):t._e(),t._v(" "),t._l(t.keywords,(function(e,a){return s("div",{staticClass:"input-section"},[s("label",[t._v(t._s(e.label))]),t._v(" "),s("input",{staticClass:"slds-input value",style:{color:t.notifyColor.keywords[a]},attrs:{type:"text"},domProps:{value:e.value},on:{keyup:function(s){return t.changeKey(s,a,e.label)}}}),t._v(" "),s("span",{staticClass:"insert-icon short-icon down-btn",on:{click:function(s){return s.stopPropagation(),t.openSelectField(e.label)}}},[s("icon",{attrs:{name:"insertTag","class-name":"down-icon",width:"15px",height:"15px"}})],1),t._v(" "),t.showFirst?s("span",{staticClass:"color-icon short-icon down-btn",on:{click:function(s){return s.stopPropagation(),t.openColorPicker(212+70*a,755,e.label)}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1):t._e(),t._v(" "),t.showFirst?t._e():s("span",{staticClass:"color-icon short-icon down-btn",on:{click:function(s){return s.stopPropagation(),t.openColorPicker(110+70*a,755,e.label)}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1)])})),t._v(" "),t.showRemark?s("div",{staticClass:"input-section"},[s("label",[t._v("Remark")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.notifyRemark,expression:"notifyRemark"}],staticClass:"slds-textarea value",style:{color:t.notifyColor.remark},domProps:{value:t.notifyRemark},on:{keyup:function(e){return t.changeRemark()},input:function(e){e.target.composing||(t.notifyRemark=e.target.value)}}}),t._v(" "),s("span",{staticClass:"insert-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openSelectField("remark")}}},[s("icon",{attrs:{name:"insertTag","class-name":"down-icon",width:"15px",height:"15px"}})],1),t._v(" "),t.showFirst?s("span",{staticClass:"color-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openColorPicker(204+70*t.keywords.length,755,"remark")}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1):t._e(),t._v(" "),t.showFirst?t._e():s("span",{staticClass:"color-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openColorPicker(102+70*t.keywords.length,755,"remark")}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1)]):t._e(),t._v(" "),s("div",{staticClass:"input-section"},[s("label",[t._v("Redirect To")]),t._v(" "),s("div",{staticClass:"redirect-section"},[s("input-select",{staticClass:"redirect-section__picklist",attrs:{currents:t.redirectOptionData.currents},on:{"close-dropdown":t.closeDropdown,"open-dropdown":t.openDropdown,resize:t.resizeDropdown}}),t._v(" "),t.isRedirectToURL?s("div",{staticClass:"redirect-section__content"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.notificationURL,expression:"notificationURL"}],staticClass:"slds-input",attrs:{type:"text",placeholder:t.$t("placeholderLabel")},domProps:{value:t.notificationURL},on:{input:function(e){e.target.composing||(t.notificationURL=e.target.value)}}}),t._v(" "),s("span",{staticClass:"insert-icon down-btn",on:{click:function(e){return t.openSelectField("url")}}},[s("icon",{attrs:{name:"insertTag","class-name":"down-icon",width:"15px",height:"15px"}})],1)]):s("div",{staticClass:"redirect-section__content"},[s("mini-program-selector",{attrs:{selected:t.selectedMiniProgramPage,"wechat-account-id":t.wechatAccountId},on:{changed:function(e){return t.onMiniProgramChanged(e)}}})],1)],1)]),t._v(" "),s("span",{staticClass:"slds-text-heading_small content-title"},[t._v(t._s(t.$t("informationLabel")))]),t._v(" "),s("div",{staticClass:"input-section"},[s("label",[t._v(t._s(t.$t("noteLabel")))]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.note,expression:"note"}],staticClass:"slds-textarea value note",attrs:{placeholder:t.$t("placeholderLabel")},domProps:{value:t.note},on:{input:function(e){e.target.composing||(t.note=e.target.value)}}})])],2)]),t._v(" "),s("div",{style:t.colorPickerPosition},[s("color-picker",{ref:"bgColorList",attrs:{value:""},on:{"get-color":t.onBgColor}})],1),t._v(" "),t.showMergeField?s("select-field",{attrs:{"title-name":"Campaigin Members","field-obj":t.fieldObj,"primary-disabled":!!t.notify.Id},on:{"close-merge-field":function(e){return t.closeSelectFiled()},"select-merge-field":t.selectMergeField}}):t._e(),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.redirectOptionData.options,currents:t.redirectOptionData.currents,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth},on:{"select-option":function(e){return t.onChangeRedirectTo(e)},close:function(e){return t.closeDropdown()}}}):t._e()],1)}),[],!1,null,"57709f2e",null);"function"==typeof S.default&&Object(S.default)(T);e.a=T.exports},qVZU:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"preTitle":"上一页","nextTitle":"下一页"},"en":{"preTitle":"Previous Page","nextTitle":"Next Page"}}'),delete t.options._Ctor}},rEsM:function(t,e,s){"use strict";var a=s("HA+Y");s.n(a).a},svHN:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"newNotifyLabel":"新建通知","saveNotifyLabel":"模板消息保存成功！"},"en":{"newNotifyLabel":"New Notification","saveNotifyLabel":"The notification was saved."}}'),delete t.options._Ctor}},t29s:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"urlLabel":"跳转链接","titleLabel":"标题","createdLabel":"创建人","keywordLabel":"关键字","noteLabel":"备注"},"en":{"urlLabel":"Notification URL","titleLabel":"Title","createdLabel":"Created By","keywordLabel":"Keywords","noteLabel":"Note"}}'),delete t.options._Ctor}},tAMZ:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"selectSkillLabel":"选择技能","nameLabel":"技能名称","knowledgeSourceLabel":"知识源","relatedToLabel":"相关项","descriptionLabel":"描述","validForLabel":"有效时间(分钟)","displayInLiveChatLabel":"在 Live Chat 中显示","internalLabel":"内部","lastModifiedByLabel":"上次修改人"},"en":{"selectSkillLabel":"Select Skill","nameLabel":"Name","knowledgeSourceLabel":"Knowledge Source","relatedToLabel":"Related To","descriptionLabel":"Description","validForLabel":"Valid For (mins)","displayInLiveChatLabel":"Display in Live Chat","internalLabel":"Internal","lastModifiedByLabel":"Last Modified By"}}'),delete t.options._Ctor}},vyV3:function(t,e,s){"use strict";var a=s("AScg");s.n(a).a},wbfU:function(t,e,s){"use strict";var a=s("wG3i"),n=s.n(a),o=s("pUDi"),i=s("zUtI"),l=s("4B+h"),r={props:{notify:{type:Object,default:()=>({contentTemplate:{keywords:[]}})},accId:{type:String,default:()=>""}},components:{NewNotification:o.a},data:()=>({isSaveNotify:!1}),methods:{closeModal(t){this.$emit("close",t)},async saveNotify(){const t=this.accId||this.$route.params.accountId,e=this.$refs.newNotifyPage.prepareCreatedData();if(t)try{this.isSaveNotify=!0;const s=await Object(i.a)(t,n()(e));s.ok?(this.$router.app.$emit("open-toast-notification",{content:this.$t("saveNotifyLabel"),type:"success"}),this.closeModal(s),this.isSaveNotify=!1):(Object(l.f)(s),this.isSaveNotify=!1)}catch(t){Object(l.f)(t),this.isSaveNotify=!1}}}},c=(s("rEsM"),s("KHd+")),d=s("lNHh"),p=Object(c.a)(r,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-notification-popup"},[s("section",{staticClass:"slds-modal slds-fade-in-open",attrs:{role:"dialog",tabindex:"-1","aria-labelledby":"modal-heading-01","aria-modal":"true","aria-describedby":"modal-content-id-1"}},[s("div",{staticClass:"slds-modal__container notify-width"},[s("header",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon slds-modal__close slds-button_icon-inverse",attrs:{disabled:t.isSaveNotify},on:{click:function(e){return t.closeModal()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium slds-hyphenate",attrs:{id:"modal-heading-01"}},[t._v(t._s(t.$t("newNotifyLabel")))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium modal-content-custom",attrs:{id:"modal-content-id-1"}},[s("new-notification",{ref:"newNotifyPage",attrs:{notify:t.notify,"wechat-account-id":t.accId}})],1),t._v(" "),s("footer",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSaveNotify},on:{click:function(e){return t.closeModal()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isSaveNotify},on:{click:function(e){return t.saveNotify()}}},[t._v(t._s(t.$t("global.saveBtn")))])])])]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open"})])}),[],!1,null,"5fadaa67",null);"function"==typeof d.default&&Object(d.default)(p);e.a=p.exports},x61u:function(t,e,s){},xncO:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"replyModeLabel":"回复模式","replyModeAll":"全部","replyModeRandom":"随机","nameLabel":"名称","changeSavedNofity":"修改已保存。","uploader":{"imageTitle":"上传图片","videoTitle":"上传视频","voiceTitle":"上传音频","titleLabel":"标题","descriptionLabel":"说明","cancelBtn":"取消","uploadBtn":"上传","uploadingBtn":"上传中","tooLarge":"最大文件大小为 2 MB。"},"exclusive":{"skillAddTitle":"移除已添加回复","skillAddContent":"技能无法和其他类型自动回复同时运行。添加当前技能会移除已添加回复。确定吗？","skillRemoveTitle":"移除已添加技能","skillRemoveContent":"技能无法和其他类型自动回复同时运行。添加当前回复会移除已添加技能。确定吗？"}},"en":{"replyModeLabel":"Reply Mode","replyModeAll":"All","replyModeRandom":"Random","nameLabel":"Name","changeSavedNofity":"Your changes are saved.","uploader":{"imageTitle":"Upload Image","videoTitle":"Upload Video","voiceTitle":"Upload Voice Clip","titleLabel":"Title","descriptionLabel":"Description","cancelBtn":"Cancel","uploadBtn":"Upload","uploadingBtn":"Uploading","tooLarge":"The maximum file size is 2 MB."},"exclusive":{"skillAddTitle":"Remove Added Responses","skillAddContent":"A skill cannot be executed along with any other auto responses. Adding this skill response removes all other auto responses. Are you sure?","skillRemoveTitle":"Remove Added Skill","skillRemoveContent":"A skill cannot be executed along with any other auto responses. Adding this auto response removes the previously added skill response. Are you sure?"}}}'),delete t.options._Ctor}},xswR:function(t,e,s){"use strict";var a=s("xncO"),n=s.n(a);e.default=n.a},y1K5:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"exactMatch":"精确匹配","phraseMatch":"模糊匹配","responseNum":"响应消息","respondedLabel":"响应次数","deactivateLabel":"禁用","activateLabel":"启用","replyActionHeader":"禁用自动回复 | 启用自动回复 | 删除自动回复","replyActionContent":"你确定要禁用这条自动回复吗？ | 你确定要启用这条自动回复吗？ | 你确定要删除这条自动回复吗？","textMsgLabel":"文本","imageMsgLabel":"图片","strucMsgLabel":"图文消息","voiceMsgLabel":"语音","videoMsgLabel":"视频","miniProgramMsgLabel":"小程序卡片","skillMsgLabel":"技能","allLabel":"全部","randomLabel":"随机回复一条"},"en":{"exactMatch":"Exact Match","phraseMatch":"Phrase Match","responseNum":"response | responses","respondedLabel":"Time responded | Times responded","deactivateLabel":"Deactivate","activateLabel":"Activate","replyActionHeader":"Deactivate Smart Reply | Activate Smart Reply | Delete Smart Reply","replyActionContent":"Are you sure you want to deactivate this Smart Reply? | Are you sure you want to activate this Smart Reply? | Are you sure you want to delete this Smart Reply?","textMsgLabel":"text | texts","imageMsgLabel":"image | images","strucMsgLabel":"structured message | structured messages","voiceMsgLabel":"voice | voices","videoMsgLabel":"video | videos","miniProgramMsgLabel":"mini program page | mini program pages","skillMsgLabel":"skill","allLabel":"All","randomLabel":"Random"}}'),delete t.options._Ctor}},yWOo:function(t,e,s){},zUtI:function(t,e,s){"use strict";s.d(e,"c",(function(){return n})),s.d(e,"e",(function(){return o})),s.d(e,"g",(function(){return i})),s.d(e,"d",(function(){return l})),s.d(e,"b",(function(){return r})),s.d(e,"h",(function(){return c})),s.d(e,"a",(function(){return d})),s.d(e,"f",(function(){return p}));var a=s("00Ee");function n(t,e,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return Object(a.a)({method:"NotificationTemplateRemoteActions.getNotificationTemplates",args:[t,e,s,n]})}function o(t,e,s,n){return Object(a.a)({method:"NotificationTemplateRemoteActions.getTemplates",args:[t,e,s,n]})}function i(t){return Object(a.a)({method:"NotificationTemplateRemoteActions.getWeChatPrivateTemplates",args:[t]})}function l(t){return Object(a.a)({method:"NotificationTemplateRemoteActions.getTemplate",args:[t]})}function r(t){return Object(a.a)({method:"NotificationTemplateRemoteActions.deleteTemplate",args:[t]})}function c(t,e){return Object(a.a)({method:"NotificationTemplateRemoteActions.updateTemplate",args:[t,e]})}function d(t,e){return Object(a.a)({method:"NotificationTemplateRemoteActions.createTemplate",args:[t,e]})}function p(t){return Object(a.a)({method:"NotificationTemplateRemoteActions.getWeChatNotifications",args:[t]})}}}]);