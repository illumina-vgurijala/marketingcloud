(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"/I/F":function(t,e,s){"use strict";s.d(e,"d",(function(){return i})),s.d(e,"a",(function(){return n})),s.d(e,"b",(function(){return o})),s.d(e,"c",(function(){return r}));var a=s("00Ee");function i(t,e,s){return Object(a.a)({method:"MassMessageRemoteActions.previewByWeChatId",args:[t,e,s]})}function n(t,e){return Object(a.a)({method:"MassMessageRemoteActions.cancelSchedulerMass",args:[t,e]})}function o(t,e){return Object(a.a)({method:"MassMessageRemoteActions.deleteMassMessage",args:[t,e]})}function r(){return Object(a.a)({method:"MassMessageRemoteActions.getMassStatus",args:[]})}},"01RO":function(t,e,s){},"3EyD":function(t,e,s){"use strict";var a=s("pgAJ"),i=s.n(a);e.default=i.a},"55zu":function(t,e,s){},"56Fa":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"badgeTitleLabel":"名牌模板","discardModalLabel":"你有未保存的更改。确定要放弃这些更改吗?","discardChangeLabel":"丢弃改变","stayPageLabel":"停留在当前页面","newBadgeNotify":"名牌模板已保存。","updateBadgeNotify":"名牌模板已修改。"},"en":{"badgeTitleLabel":"Name Badge Templates | Name Badge Template","discardModalLabel":"You have unsaved changes. Are you sure you want to discard these changes?","discardChangeLabel":"Discard Changes","stayPageLabel":"Stay on this Page","newBadgeNotify":"The name badge template was saved.","updateBadgeNotify":"The name badge template was updated."}}'),delete t.options._Ctor}},"5flY":function(t,e,s){"use strict";s.d(e,"d",(function(){return i})),s.d(e,"g",(function(){return n})),s.d(e,"b",(function(){return o})),s.d(e,"a",(function(){return r})),s.d(e,"h",(function(){return l})),s.d(e,"f",(function(){return d})),s.d(e,"e",(function(){return c})),s.d(e,"c",(function(){return u}));var a=s("00Ee");function i(t,e,s){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.getNameBadgeTemplates",args:[t,e,s]})}function n(t,e){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.setActive",args:[t,e]})}function o(t){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.deleteNameBadgeTemplate",args:[t]})}function r(t){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.createNameBadgeTemplate",args:[t]})}function l(t){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.updateNameBadgeTemplate",args:[t]})}function d(){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.getSizeOptions",args:[]})}function c(t,e,s){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.getNameBadges",args:[t,e,s]})}function u(t){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.getNameBadge",args:[t]})}},"6jru":function(t,e,s){"use strict";var a=s("xNsD");s.n(a).a},"89El":function(t,e,s){"use strict";s.r(e);var a=s("wG3i"),i=s.n(a),n=s("vQrK"),o=s.n(n),r=s("FYrm"),l=s("SLhn"),d=s.n(l),c=s("Yvyk"),u=s.n(c),p=s("692z"),h=s("F5n6"),g=s("w2Vt"),m=s("ngIk"),b=s("dcdS"),v=s("oWfJ"),f=s("+SX9"),_=s("w+Ta"),w=s("/I/F"),y=s("4B+h"),C=s("cybb"),P=s("LQ5e"),$=s.n(P),O=s("L2JU"),L={mixins:[v.a],components:{NoRecord:p.a,Pagination:h.a,LoadingSpinner:g.a,InputSelect:m.a,Dropdown:b.a,ErrorToast:f.a},created(){this.accountId=this.$route.params.accountId,u.a.all([this.getCurrentPassList(),this.getStatus()])},computed:o()({},Object(O.c)({currentUser:"user/currentUser"}),{showNoRecord(){return!this.passList||this.passList.length<=0},adjustedQuantiyNum:{get:function(){if(""===this.newQuantityNum)return null;{const t=Number(this.editQuantityNum),e=Number(this.newQuantityNum);return!t&&0!==t||!e&&0!==e?null:e-t}},set:function(t){const e=Number(this.editQuantityNum);if(""===t)this.newQuantityNum="";else{const s=Number(t);!s&&0!==s||!e&&0!==e||(this.newQuantityNum=e+s>0?Math.round(e+s):0)}}},canSaveNewQuantity(){return/^[0-9]\d*$/.test(this.newQuantityNum)&&!this.isUpdatingQuantity}}),watch:{dropdownRefId:function(){"Status"===this.dropdownType?(this.dropdownOptionData.options=this.statusOptionData.options,this.dropdownOptionData.currents=this.statusOptionData.currentOptions,this.hasSortBy=!1):"Order"===this.dropdownType&&(this.dropdownOptionData.options=this.orderOptionData.options,this.dropdownOptionData.currents=this.orderOptionData.currentOptions,this.hasSortBy=!0)}},data(){return{accountId:null,passList:[],passesTotal:0,hasMorePasses:!1,currentPageNum:1,pageCount:20,passesPagination:[],isLoadingPasses:!1,editQuantityNum:0,newQuantityNum:"",currentEditPass:null,isUpdatingQuantity:!1,showPreviewPopup:!1,isSubmittingPre:!1,showPreviewErrorTip:!1,previewErrorMsg:"",wechatId:"",filterJson:{OrderBy:"Last Created Date",SearchKey:"",Status:""},statusOptionData:{options:[],currentOptions:[{Name:this.$t("global.all"),Value:""}]},orderOptionData:{options:[{Name:this.$t("lastCreatedDate"),value:"Last Created Date"},{Name:this.$t("oldestCreatedDate"),value:"Oldest Created Date"},{Name:this.$t("lastStartTime"),value:"Last Start Time"},{Name:this.$t("oldestStartTime"),value:"Oldest Start Time"},{Name:this.$t("lastEndTime"),value:"Last End Time"},{Name:this.$t("oldestEndTime"),value:"Oldest End Time"}],currentOptions:[{Name:this.$t("lastCreatedDate"),value:"Last Created Date"}]},hasSortBy:!1}},methods:{async getStatus(){try{const t=await Object(_.c)();if(t.ok){const e=JSON.parse($.a.unescape(t.data));this.statusOptionData.options=e.PassStatus,this.statusOptionData.options.unshift({Name:this.$t("global.all"),Value:""})}else Object(y.f)(t)}catch(t){Object(y.f)(t)}},formatPassCreateInfo(t,e){var s;const a=Object(C.e)(e,this.currentUser.TimeZoneSidKey);return d()(s="".concat(t,",")).call(s,a)},async getCurrentPassList(){this.isLoadingPasses=!0;const t=i()(this.filterJson);if(this.accountId)try{const e=await Object(_.d)(this.accountId,this.currentPageNum,this.pageCount,t);if(this.isLoadingPasses=!1,e.ok){const t=JSON.parse($.a.unescape(e.data));this.passList=t.passes;for(const t of this.passList)t.startTime=Object(C.e)(t.startTime,this.currentUser.TimeZoneSidKey),t.endTime=Object(C.e)(t.endTime,this.currentUser.TimeZoneSidKey);this.passesPagination=t.paging.pages,this.passesTotal=t.paging.total.Count,this.hasMorePasses=t.paging.total.HasMore}else Object(y.f)(e)}catch(t){this.isLoadingPasses=!1,Object(y.f)(t)}},searchPasses(){this.getCurrentPassList()},clearSearchKey(){this.filterJson.SearchKey="",this.getCurrentPassList()},selectPicklist(t){"Status"===this.dropdownType?(this.filterJson.Status=t[0].Value,this.statusOptionData.currentOptions=t,this.getCurrentPassList()):"Order"===this.dropdownType&&(this.filterJson.OrderBy=t[0].value,this.orderOptionData.currentOptions=t,this.getCurrentPassList()),this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1},target(t){this.currentPageNum=t,this.getCurrentPassList(),document.getElementsByClassName("scroll-content")[0].scrollTop=0},openEditQuantityModal(t){this.editQuantityNum=t.quantity,this.currentEditPass=t,this.$refs.quantityModal.open()},closeEditQuantityModal(){this.newQuantityNum="",this.$refs.quantityModal.close()},clearQuantityModalData(){this.newQuantityNum=""},onClickUpdateQuantityCancel(){this.closeEditQuantityModal()},async updateQuantity(){this.isUpdatingQuantity=!0;try{const t=await Object(_.g)(this.accountId,this.currentEditPass.cardId,this.adjustedQuantiyNum);t.ok?(this.closeEditQuantityModal(),this.getCurrentPassList(),this.$router.app.$emit("open-toast-notification",{content:this.$t("changesAreSaved"),type:"success"})):this.$refs.quantityModal.showError(t.error)}catch(t){const e=this.$parseErrorMessage(t);this.$refs.quantityModal.showError(e)}finally{this.isUpdatingQuantity=!1}},closeModal(){this.showPreviewPopup=!1,this.wechatId=""},getMenuItems(t){const e=[{value:"Edit",label:this.$t("global.editBtn"),target:t},{value:"Delete",label:this.$t("global.deleteBtn"),target:t}];return"Delivered"!==t.status.Value&&e.unshift({value:"Preview",label:this.$t("global.previewBtn"),target:t}),e},onClickMenuItem(t){const{value:e,target:s}=t;if("Preview"===e)this.currentEditPass=s,this.showPreviewPopup=!0;else if("Edit"===e)this.$emit("editPass",s);else if("Delete"===e){this.currentEditPass=s;const t=this.$confirm({title:this.$t("delModalHeader"),content:this.$t("delModalContent")});t.$on("ok",async()=>{try{const e=await Object(_.a)(this.accountId,this.currentEditPass.passId,this.currentEditPass.cardId);e.ok?(t.close(),this.getCurrentPassList(),this.$router.app.$emit("open-toast-notification",{content:this.$t("passWasDeleted"),type:"success"})):(t.resume(),Object(y.f)(e))}catch(e){t.resume(),Object(y.f)(e)}})}},async preview(){this.isSubmittingPre=!0;const t=()=>{this.showPreviewErrorTip=!0;const t=this.$watch("wechatId",()=>{this.showPreviewErrorTip=!1,t()});this.isSubmittingPre=!1};try{const e=await Object(w.d)(this.accountId,this.currentEditPass.passId,this.wechatId);e.ok?(this.$router.app.$emit("open-toast-notification",{content:this.$t("canPreviewPass"),type:"success"}),this.showPreviewPopup=!1,this.isSubmittingPre=!1,this.wechatId=""):(this.previewErrorMsg=e.error.message||e.error,t())}catch(e){this.previewErrorMsg=e.Message,t()}}}},D=(s("riPu"),s("KHd+")),N=s("3EyD"),T=Object(D.a)(L,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pass-list-page"},[s("div",{staticClass:"slds-border_bottom slds-grid slds-grid_vertical-align-center pass-list-filter"},[s("span",{staticClass:"pass-count"},[t._v(t._s(t._f("addSeparators")(t.passesTotal))),t.hasMorePasses?s("i",{staticClass:"show-plus-sign"},[t._v("+")]):t._e(),t._v("\n      "+t._s(t.passesTotal>1?t.$t("item",["s"]):t.$t("item",[""]))+"\n    ")]),t._v(" "),s("div",{staticClass:"slds-col_bump-right pass-pick-list"},[s("input-select",{attrs:{currents:t.statusOptionData.currentOptions,type:"Status"},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1),t._v(" "),s("div",{staticClass:"pass-search"},[s("search-input",{attrs:{placeholder:t.$t("searchPass")},on:{search:t.searchPasses,clear:t.clearSearchKey},model:{value:t.filterJson.SearchKey,callback:function(e){t.$set(t.filterJson,"SearchKey",e)},expression:"filterJson.SearchKey"}})],1),t._v(" "),s("div",{staticClass:"pass-order"},[s("input-select",{attrs:{currents:t.orderOptionData.currentOptions,type:"Order"},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1)]),t._v(" "),t.passList.length>0?s("div",{staticClass:"slds-table--header-fixed_container pass-list-content"},[s("div",{staticClass:"slds-scrollable_y scroll-content"},[s("table",{staticClass:"slds-table slds-table_bordered slds-no-row-hover slds-table--header-fixed pass-table",attrs:{role:"grid"}},[s("thead",[s("tr",{staticClass:"slds-line-height_reset"},[s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("name")}},[t._v(t._s(t.$t("name")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("startDate")}},[t._v(t._s(t.$t("startDate")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("endDate")}},[t._v(t._s(t.$t("endDate")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable pass-tab-status",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("status")}},[t._v(t._s(t.$t("status")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable pass-tab-quantity",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("quantity")}},[t._v(t._s(t.$t("quantity")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("campaign")}},[t._v(t._s(t.$t("campaign")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("tags")}},[t._v(t._s(t.$t("tags")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("createdBy")}},[t._v(t._s(t.$t("createdBy")))])]),t._v(" "),s("th",{staticStyle:{width:"54px"},attrs:{scope:"col"}})])]),t._v(" "),s("tbody",{staticStyle:{transform:"none"}},t._l(t.passList,(function(e){return s("tr",{staticClass:"slds-hint-parent"},[s("th",{attrs:{scope:"row"}},[s("div",{staticClass:"slds-truncate other-color-item",attrs:{title:e.name}},[s("a",{attrs:{href:"/"+e.passId,target:"_blank"}},[t._v(t._s(e.name))])])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",attrs:{title:e.startTime}},[t._v("\n                "+t._s(e.startTime)+"\n              ")])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",attrs:{title:e.endTime}},[t._v("\n                "+t._s(e.endTime)+"\n              ")])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",attrs:{title:e.status.Label}},[t._v("\n                "+t._s(e.status.Label)+"\n              ")])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-grid slds-grid_align-end pass-quantity"},[s("div",{staticClass:"slds-truncate",attrs:{title:e.quantity}},[t._v("\n                  "+t._s(t._f("addSeparators")(e.quantity))+"\n                ")]),t._v(" "),s("div",{staticClass:"quantity-edit-icon",on:{click:function(s){return t.openEditQuantityModal(e)}}},[s("span",{staticClass:"down-btn"},[s("icon",{attrs:{name:"editReplyIcon","class-name":"down-icon",height:"14px",width:"14px"}})],1)])])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate other-color-item",attrs:{title:e.campaignName}},[s("a",{attrs:{href:"/"+e.campaignId,target:"_blank"}},[t._v(t._s(e.campaignName))])])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("ul",{staticClass:"slds-grid slds-wrap tags-list"},t._l(e.wechatTags,(function(e){return s("li",[s("div",{staticClass:"slds-truncate",attrs:{title:e.TagName}},[t._v("\n                  "+t._s(e.TagName)+"\n                  ")])])})),0)]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate"},[e.createdByUser?s("span",{attrs:{title:t.formatPassCreateInfo(e.createdByUser,e.createdDate)}},[t._v(t._s(e.createdByUser)+", "+t._s(t._f("formatDatetimeFilter")(e.createdDate,t.currentUser.TimeZoneSidKey)))]):s("span",{attrs:{title:t.formatDatetimeFilter()(e.createdDate,t.currentUser.TimeZoneSidKey)}},[t._v(t._s(t._f("formatDatetimeFilter")(e.createdDate,t.currentUser.TimeZoneSidKey)))])])]),t._v(" "),s("td",{staticClass:"td-position",staticStyle:{width:"3.25rem"},attrs:{role:"gridcell"}},[s("ld-action-menu",{attrs:{items:t.getMenuItems(e)},on:{click:function(e){return t.onClickMenuItem(e)}}})],1)])})),0)]),t._v(" "),t.isLoadingPasses?t._e():s("pagination",{attrs:{paginations:t.passesPagination,"page-number":t.currentPageNum},on:{target:t.target}})],1)]):t._e(),t._v(" "),t.showNoRecord&&!t.isLoadingPasses?s("no-record",{attrs:{"custom-style":"top: 40px;"}}):t._e(),t._v(" "),s("loading-spinner",{attrs:{"is-loading":t.isLoadingPasses,"custom-style":"top: 40px;"}}),t._v(" "),s("ld-modal",{ref:"quantityModal",attrs:{title:t.$t("adjustQuantity")},on:{close:t.clearQuantityModalData},scopedSlots:t._u([{key:"content",fn:function(){return[s("div",{staticClass:"slds-p-around_medium"},[s("div",{staticClass:"slds-grid slds-grid_vertical adjust-quantity-form"},[s("div",{staticClass:"slds-grid slds-grid_align-spread adjust-quantity-item"},[s("label",{attrs:{for:"currentQuantity"}},[t._v(t._s(t.$t("currentQuantity")))]),t._v(" "),s("input",{staticClass:"slds-input",attrs:{type:"text",id:"currentQuantity",disabled:""},domProps:{value:t.editQuantityNum}})]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_align-spread adjust-quantity-item"},[s("label",{attrs:{for:"adjustQuantity"}},[t._v(t._s(t.$t("quantityAdjusted")))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.adjustedQuantiyNum,expression:"adjustedQuantiyNum"}],staticClass:"slds-input",attrs:{type:"number",id:"adjustQuantity"},domProps:{value:t.adjustedQuantiyNum},on:{input:function(e){e.target.composing||(t.adjustedQuantiyNum=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_align-spread adjust-quantity-item"},[s("label",{attrs:{for:"newQuantity"}},[t._v(t._s(t.$t("newQuantity")))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newQuantityNum,expression:"newQuantityNum"}],staticClass:"slds-input",attrs:{type:"number",id:"newQuantity"},domProps:{value:t.newQuantityNum},on:{input:function(e){e.target.composing||(t.newQuantityNum=e.target.value)}}})])])])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{neutral:"",disabled:t.isUpdatingQuantity},on:{click:function(e){return e.stopPropagation(),t.onClickUpdateQuantityCancel()}}},[t._v("\n        "+t._s(t.$t("global.saveBtn"))+"\n      ")]),t._v(" "),s("ld-button",{attrs:{brand:"",disabled:!t.canSaveNewQuantity},on:{click:function(e){return e.stopPropagation(),t.updateQuantity()}}},[t._v("\n        "+t._s(t.$t("global.saveBtn"))+"\n      ")])]},proxy:!0}])}),t._v(" "),s("div",{staticClass:"slds-modal slds-modal_large",class:{"slds-fade-in-open":t.showPreviewPopup},attrs:{id:"ShowPreviewPopup","aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container show-selected-container preview-width",attrs:{role:"document",tabindex:"0"}},[s("div",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close preview-close-btn",attrs:{disabled:t.isSubmittingPre},on:{click:function(e){return t.closeModal()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v(t._s(t.$t("global.closeBtn")))])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.$t("previewPass")))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium preview-middle-height"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showPreviewErrorTip,expression:"showPreviewErrorTip"}],staticClass:"preview-error-tip"},[s("error-toast",{attrs:{content:t.previewErrorMsg}})],1),t._v(" "),s("div",{staticClass:"wechat-id"},[s("span",[t._v(t._s(t.$t("wechatId")))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.wechatId,expression:"wechatId"}],staticClass:"slds-input",attrs:{type:"text",name:""},domProps:{value:t.wechatId},on:{input:function(e){e.target.composing||(t.wechatId=e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSubmittingPre},on:{click:function(e){return t.closeModal()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isSubmittingPre||!t.wechatId},on:{click:function(e){return t.preview()}}},[t._v(t._s(t.$t("global.previewBtn")))])])])]),t._v(" "),s("div",{staticClass:"slds-backdrop",class:{"slds-backdrop_open":t.showPreviewPopup},attrs:{id:"ShowPreview"}}),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.dropdownOptionData.options,currents:t.dropdownOptionData.currents,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth,"has-sort-by":t.hasSortBy},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e()],1)}),[],!1,null,"22c6a65a",null);"function"==typeof N.default&&Object(N.default)(T);var B=T.exports,x={created(){this.$route.params.accountId&&(this.accountId=this.$route.params.accountId),"passes-new"===this.$route.name&&(this.showNewPassPage=!0),this.switchAccount({wechatAccountId:this.$route.params.accountId,router:this.$router})},data(){return{tabs:[{name:"PASSES",label:this.$t("passes")}],showNewPassPage:!1,accountId:"",isSavingPass:!1,passFormType:"new",editPassId:"",currentPass:"",submitTipContent:"This pass will be submitted to WeChat. You will not be able to use this pass until it has been approved by WeChat. You can check the approval status in the pass list. And once you submit this pass for approval, some fields will not be editable. Continue?"}},components:{CreateWeChatPass:r.a,WeChatPassList:B},methods:o()({},Object(O.b)("sidebar",["switchAccount"]),{throwError(t){const e=t.error.message||t.error;this.$router.app.$emit("open-toast-notification",{content:e,type:"error"})},openNewPassPage(t){this.passFormType=t,this.showNewPassPage=!0,"new"===t?this.$router.replace({path:"/".concat(this.accountId,"/passes/new")}):this.$router.replace({path:"/".concat(this.accountId,"/passes/edit")})},openSubmitModal(){if(this.currentPass=this.$refs.pass.getPass(),!this.currentPass)return;const t=this.$confirm({title:this.$t("submitForApproval"),content:this.$t("submitTip"),ok:this.$t("global.confirmBtn")});t.$on("ok",async()=>{try{this.isSavingPass=!0;const e="new"===this.passFormType?_.f:_.h,s=await e(this.accountId,i()(this.currentPass));this.currentPass="",s.ok?(this.$router.app.$emit("open-toast-notification",{content:this.$t("passForApproval"),type:"success"}),this.cancelCreatePass(),t.close()):(Object(y.f)(s),t.resume())}catch(e){Object(y.f)(e),t.resume()}finally{this.isSavingPass=!1}})},cancelCreatePass(){this.showNewPassPage=!1,this.$router.replace({path:"/".concat(this.accountId,"/passes")})},refreshList(){this.showNewPassPage=!1,this.$nextTick(()=>{this.$refs.passList.getCurrentPassList()})},getEditPass(t){this.editPassId=t.passId,this.openNewPassPage("edit")}})},S=(s("6jru"),s("Ksti")),E=Object(D.a)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-grid slds-grid_vertical wechat-pass-page"},[s("scoped-tabs",{attrs:{tabs:t.tabs,"current-tab-name":"PASSES"},on:{switch:t.refreshList}},[s("template",{slot:"button-group"},[s("button",{directives:[{name:"show",rawName:"v-show",value:!t.showNewPassPage,expression:"!showNewPassPage"}],staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.openNewPassPage("new")}}},[t._v(t._s(t.$t("global.newBtn")))]),t._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:t.showNewPassPage,expression:"showNewPassPage"}],staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.cancelCreatePass()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{directives:[{name:"show",rawName:"v-show",value:t.showNewPassPage,expression:"showNewPassPage"}],staticClass:"slds-button slds-button_brand",on:{click:function(e){return t.openSubmitModal()}}},[t._v(t._s(t.$t("global.submitBtn")))])])],2),t._v(" "),s("div",{staticClass:"pass-page-content"},[t.showNewPassPage?t._e():s("we-chat-pass-list",{ref:"passList",on:{editPass:t.getEditPass}}),t._v(" "),t.showNewPassPage?s("create-we-chat-pass",{ref:"pass",attrs:{"form-type":t.passFormType,"edit-pass-id":this.editPassId}}):t._e()],1)],1)}),[],!1,null,"4e141649",null);"function"==typeof S.default&&Object(S.default)(E);e.default=E.exports},D9Jf:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"activeLabel":"已启用","inactiveLabel":"已禁用","searchBadgeLabel":"搜索名牌模板","nameLabel":"名称","sizeLabel":"尺寸","lastDateLabel":"最近修改日期","deleteBadgeTitleLabel":"删除名牌模板","deleteBadgeContentLabel":"你确定要删除这个名牌模板吗?","oldestDateLabel":"最早修改时间","alphabeticallyLabel":"字母升序","reverseAlphabeticallyLabel":"字母降序","badgeActionContent":"你确定要禁用这个名牌模板吗？ | 你确定要启用这个名牌模板吗？","badgeActionHeader":"禁用名牌模板 | 启用名牌模板","deleteBadgeContent":"名牌模板被删除。","deactivateBadgeContent":"名牌模板被禁用。","activateBadgeContent":"名牌模板被启用。"},"en":{"activeLabel":"Active","inactiveLabel":"Inactive","searchBadgeLabel":"Search Name Badge Templates","nameLabel":"Name","sizeLabel":"Size","lastDateLabel":"Last Modified Date","deleteBadgeTitleLabel":"Delete Name Badge Template","deleteBadgeContentLabel":"Are you sure you want to delete this Name Badge Template?","oldestDateLabel":"First Modified Date","alphabeticallyLabel":"Alphabetically","reverseAlphabeticallyLabel":"Reverse Alphabetically","badgeActionContent":"Are you sure you want to deactivate this Name Badge Template? | Are you sure you want to activate this Name Badge Template ?","badgeActionHeader":"Deactivate Name Badge Template | Activate Name Badge Template","deleteBadgeContent":"The name badge template was deleted.","deactivateBadgeContent":"The name badge template was deactivated.","activateBadgeContent":"The name badge template was activated."}}'),delete t.options._Ctor}},F5n6:function(t,e,s){"use strict";var a={props:{paginations:{type:Array},pageNumber:{type:Number,default:1}},data:()=>({currentPageNumber:1}),created(){this.currentPageNumber=this.pageNumber},methods:{changePageNumber(t,e){this.currentPageNumber="pre"===e?this.currentPageNumber-1:"next"===e?this.currentPageNumber+1:t,this.$emit("target",this.currentPageNumber)}}},i=(s("hkfk"),s("KHd+")),n=s("k/9o"),o=Object(i.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.paginations.length>1?s("ul",{staticClass:"slds-grid slds-grid_align-center pagination"},[s("li",{staticClass:"page-turning-pre",attrs:{title:t.$t("preTitle")}},[t.currentPageNumber>1?s("a",{staticClass:"page-turning",attrs:{id:"previousPage"},on:{click:function(e){return t.changePageNumber("","pre")}}},[s("icon",{attrs:{name:"left","text-color":"default",size:"x-small","charket-icon":""}})],1):s("a",{staticClass:"disabled page-turning",attrs:{id:"previousPageDisabled",disabled:"true"}},[s("icon",{attrs:{name:"left","text-color":"default",size:"x-small","charket-icon":""}})],1)]),t._v(" "),t._l(t.paginations,(function(e){return s("li",{staticClass:"middle-page-number"},[0!==e.PageNumber?s("a",{class:{currentPage:e.PageNumber===t.currentPageNumber},on:{click:function(s){return t.changePageNumber(e.PageNumber)}}},[t._v(t._s(e.PageNumber))]):s("a",[t._v("...")])])})),t._v(" "),s("li",{staticClass:"page-turning-pre",attrs:{title:t.$t("nextTitle")}},[t.paginations[t.paginations.length-1].PageNumber!==t.currentPageNumber?s("a",{staticClass:"page-turning",attrs:{id:"nextPage"},on:{click:function(e){return t.changePageNumber("","next")}}},[s("icon",{attrs:{name:"right","text-color":"default",size:"x-small","charket-icon":""}})],1):s("a",{staticClass:"disabled page-turning",attrs:{id:"nextPageDisabled",disabled:"true"}},[s("icon",{attrs:{name:"right","text-color":"default",size:"x-small","charket-icon":""}})],1)])],2):t._e()}),[],!1,null,"430ba9bf",null);"function"==typeof n.default&&Object(n.default)(o);e.a=o.exports},FK88:function(t,e,s){"use strict";var a={props:{size:{type:String,default:"12mm x 12mm"},orientation:{type:String,default:"Landscape"},body:{type:String,default:""}},computed:{currentSize(){if(this.size){const t=this.size.split("x"),e=3.75*Number(t[0].replace(/[^0-9]/gi,""))+10,s=3.75*Number(t[1].replace(/[^0-9]/gi,""))+10;return"Portrait"===this.orientation?e>s?{width:s+"px",height:e+"px"}:{width:e+"px",height:s+"px"}:e>s?{width:e+"px",height:s+"px"}:{width:s+"px",height:e+"px"}}return{width:"55px",height:"55px"}}}},i=(s("bwDH"),s("KHd+")),n=Object(i.a)(a,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"badge-area",style:this.currentSize,domProps:{innerHTML:this._s(this.body)}})}),[],!1,null,"6186bcfe",null);e.a=n.exports},GyFa:function(t,e,s){"use strict";var a=s("56Fa"),i=s.n(a);e.default=i.a},KNmw:function(t,e,s){},Ksti:function(t,e,s){"use strict";var a=s("ul1B"),i=s.n(a);e.default=i.a},Mp6Y:function(t,e,s){},PXsE:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"previewLabel":"预览","previewErrorLabel":"检查此页面上的错误。","badgeTemplateLabel":"名牌模板信息","nameLabel":"名称","sizeLabel":"尺寸","completeLabel":"填写此字段","orientationLabel":"方向","activeLabel":"启用","descriptionLabel":"描述","bodyLabel":"模板","landscapeLabel":"横向","portrailLabel":"纵向"},"en":{"previewLabel":"Preview","previewErrorLabel":"Review the errors on this page.","badgeTemplateLabel":"Name Badge Template Information","nameLabel":"Name","sizeLabel":"Size","completeLabel":"Enter this field","orientationLabel":"Orientation","activeLabel":"Active","descriptionLabel":"Description","bodyLabel":"Body","landscapeLabel":"Landscape","portrailLabel":"Portrait"}}'),delete t.options._Ctor}},RN1l:function(t,e,s){"use strict";var a=s("55zu");s.n(a).a},Xih0:function(t,e,s){"use strict";var a=s("D9Jf"),i=s.n(a);e.default=i.a},Yv0A:function(t,e,s){"use strict";s.r(e);var a=s("wG3i"),i=s.n(a),n=s("5flY"),o=s("4B+h"),r=s("SLhn"),l=s.n(r),d=s("vQrK"),c=s.n(d),u=s("cybb"),p=s("L2JU"),h=s("oWfJ"),g=s("F5n6"),m=s("ngIk"),b=s("dcdS"),v=s("692z"),f=s("w2Vt"),_=s("FK88"),w=s("LQ5e"),y=s.n(w),C={mixins:[h.a],components:{Pagination:g.a,InputSelect:m.a,Dropdown:b.a,NoRecord:v.a,LoadingSpinner:f.a,BadgePreview:_.a},computed:c()({},Object(p.c)({currentUser:"user/currentUser"})),mounted(){this.getData()},data(){return{isLoading:!1,dataCondition:{OrderBy:"Last Modified Date",SearchKey:"",IsActive:!0},orderOption:{options:[{Name:this.$t("lastDateLabel"),value:"Last Modified Date"},{Name:this.$t("oldestDateLabel"),value:"Oldest Modified Date"},{Name:this.$t("alphabeticallyLabel"),value:"Alphabetically"},{Name:this.$t("reverseAlphabeticallyLabel"),value:"Reverse Alphabetically"}],currentOptions:[{Name:this.$t("lastDateLabel")}]},currentPage:1,itemCount:20,badgeTempListInfo:{nameBadgeTemplates:[],paging:{badgeCounts:{Active:0,InActive:0},pages:[]}},prevEditBadge:null,currentActiveBadge:{},actionBadge:null,actionModalHeader:"",actionModalContent:""}},methods:{sizeFilter(t){if(t){var e;const s=t.split("x");return l()(e="".concat(Number(s[0])," mm x ")).call(e,Number(s[1])," mm")}return t},formatDatetimeFilter:()=>u.e,async getData(){this.badgeTempListInfo.nameBadgeTemplates=[],this.isLoading=!0;try{const t=await Object(n.d)(this.currentPage,this.itemCount,i()(this.dataCondition));if(this.isLoading=!1,t.ok){if(t.data){this.badgeTempListInfo=JSON.parse(y.a.unescape(t.data)),this.badgeTempListInfo,this.badgeTempListInfo.nameBadgeTemplates.length>0?this.selectCurrentTemp(this.badgeTempListInfo.nameBadgeTemplates[0]):this.selectCurrentTemp({});for(const t of this.badgeTempListInfo.nameBadgeTemplates)this.$set(t,"showEditBox",!1)}}else Object(o.f)(t)}catch(t){this.isLoading=!1,Object(o.f)(t)}},switchList(t){this.dataCondition.IsActive="active"===t,this.getData()},showEditBox(t){t.showEditBox=!t.showEditBox,this.prevEditBadge&&this.prevEditBadge!==t&&this.prevEditBadge.showEditBox&&(this.prevEditBadge.showEditBox=!1),this.prevEditBadge=t;const e=()=>{t.showEditBox=!1,this.prevEditBadge=null,window.removeEventListener("click",e)};t.showEditBox&&window.addEventListener("click",e)},selectCurrentTemp(t){this.currentActiveBadge=t},changePage(t){this.currentPage=t,this.getData()},selectOrderOption(t){this.dataCondition.OrderBy=t[0].value,this.orderOption.currentOptions=t,this.currentPage=1,this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1,this.getData()},clearSearchKey(){this.dataCondition.SearchKey="",this.getData()},async changeActiveStatus(t,e){try{const s=await Object(n.g)(t.Id,!t.IsActive);if(s.ok){e.close();const s=t.IsActive?this.$t("deactivateBadgeContent"):this.$t("activateBadgeContent");this.$router.app.$emit("open-toast-notification",{content:s,type:"success"}),this.getData()}else e.resume(),Object(o.f)(s)}catch(t){e.resume(),Object(o.f)(t)}},openActionModal(t,e){"delete"===e?(this.actionModalHeader=this.$t("deleteBadgeTitleLabel"),this.actionModalContent=this.$t("deleteBadgeContentLabel")):"deactivate"===e?(this.actionModalHeader=this.$tc("badgeActionHeader",1),this.actionModalContent=this.$tc("badgeActionContent",1)):"activate"===e&&(this.actionModalHeader=this.$tc("badgeActionHeader",2),this.actionModalContent=this.$tc("badgeActionContent",2));const s=this.$confirm({title:this.actionModalHeader,content:this.actionModalContent});this.actionBadge=t;const a=this.actionBadge,i="delete"===e?this.deleteBadge:this.changeActiveStatus;s.$on("ok",async()=>{i(a,s)})},async deleteBadge(t,e){try{const s=await Object(n.b)(t.Id);s.ok?(e.close(),this.actionBadge=null,this.$router.app.$emit("open-toast-notification",{content:this.$t("deleteBadgeContent"),type:"success"}),this.getData()):(e.resume(),Object(o.f)(s))}catch(t){e.resume(),Object(o.f)(t)}},editCurrentTemp(t){const e=JSON.parse(i()(t));this.$emit("edit",e)},refreshList(t){this.currentPage=1,this.dataCondition.IsActive=t,this.getData()}}},P=(s("yTZ/"),s("KHd+")),$=s("Xih0"),O=Object(P.a)(C,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-grid badge-template-list"},[s("div",{staticClass:"templates-list-left"},[s("div",{staticClass:"slds-border_bottom slds-grid slds-grid_align-spread switch-active-bar"},[s("div",{staticClass:"slds-grid"},[s("span",{staticClass:"slds-tabs_default__item",class:{"slds-active":t.dataCondition.IsActive},on:{click:function(e){return t.switchList("active")}}},[s("a",{staticClass:"slds-tabs_default__link",attrs:{href:"javascript:void(0);"}},[t._v("\n            "+t._s(t.$t("activeLabel"))+"\n            "),s("span",{staticClass:"slds-badge"},[t._v(t._s(t.badgeTempListInfo.paging.badgeCounts.Active))])])]),t._v(" "),s("span",{staticClass:"slds-tabs_default__item",class:{"slds-active":!t.dataCondition.IsActive},on:{click:function(e){return t.switchList("inactive")}}},[s("a",{staticClass:"slds-tabs_default__link",attrs:{href:"javascript:void(0);"}},[t._v("\n            "+t._s(t.$t("inactiveLabel"))+"\n            "),s("span",{staticClass:"slds-badge"},[t._v(t._s(t.badgeTempListInfo.paging.badgeCounts.InActive))])])])]),t._v(" "),s("section",{staticClass:"search"},[s("search-input",{attrs:{placeholder:t.$t("searchBadgeLabel")},on:{search:t.getData,clear:t.clearSearchKey},model:{value:t.dataCondition.SearchKey,callback:function(e){t.$set(t.dataCondition,"SearchKey",e)},expression:"dataCondition.SearchKey"}})],1)]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_reverse slds-border_bottom templates-filter-bar"},[s("input-select",{attrs:{currents:t.orderOption.currentOptions},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1),t._v(" "),t.badgeTempListInfo.nameBadgeTemplates&&t.badgeTempListInfo.nameBadgeTemplates.length>0?s("div",{staticClass:"slds-table--header-fixed_container templates-list-banner"},[s("div",{staticClass:"slds-scrollable_y banner-scroll"},[s("table",{staticClass:"slds-table slds-table_bordered slds-no-row-hover slds-table--header-fixed badge-table",attrs:{role:"grid"}},[s("thead",[s("tr",{staticClass:"slds-line-height_reset"},[s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("nameLabel")}},[t._v(t._s(t.$t("nameLabel")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("sizeLabel")}},[t._v(t._s(t.$t("sizeLabel")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("span",{staticClass:"slds-truncate slds-cell-fixed",attrs:{title:t.$t("lastDateLabel")}},[t._v(t._s(t.$t("lastDateLabel")))])]),t._v(" "),s("th",{staticStyle:{width:"54px"},attrs:{scope:"col"}})])]),t._v(" "),s("tbody",t._l(t.badgeTempListInfo.nameBadgeTemplates,(function(e){return s("tr",{staticClass:"slds-hint-parent",class:{isActive:e.Id===t.currentActiveBadge.Id},on:{click:function(s){return t.selectCurrentTemp(e)}}},[s("th",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",attrs:{title:e.Name}},[s("a",{attrs:{href:"/"+e.Id,target:"_blank"}},[t._v(t._s(e.Name))])])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate"},[s("span",{attrs:{title:t.sizeFilter(e.Size)}},[t._v(t._s(t.sizeFilter(e.Size)))])])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate"},[s("span",{attrs:{title:""+t.formatDatetimeFilter()(e.LastModifiedDate,t.currentUser.TimeZoneSidKey)}},[t._v(t._s(t._f("formatDatetimeFilter")(e.LastModifiedDate,t.currentUser.TimeZoneSidKey)))])])]),t._v(" "),s("td",{staticClass:"td-position",attrs:{role:"gridcell"}},[s("button",{staticClass:"slds-button slds-button_icon-border-filled slds-button_icon-x-small down-btn",on:{click:function(s){return s.stopPropagation(),t.showEditBox(e)}}},[s("icon",{attrs:{name:"down","class-name":"down-icon",width:"0.75rem",height:"0.75rem"}})],1),t._v(" "),e.showEditBox?s("div",{staticClass:"slds-text-body_small slds-box edit"},[s("div",{on:{click:function(s){return t.editCurrentTemp(e)}}},[t._v(t._s(t.$t("global.editBtn")))]),t._v(" "),t.dataCondition.IsActive?s("div",{on:{click:function(s){return t.openActionModal(e,"deactivate")}}},[t._v(t._s(t.$t("global.deactivateBtn")))]):s("div",{on:{click:function(s){return t.openActionModal(e,"activate")}}},[t._v(t._s(t.$t("global.activateBtn")))]),t._v(" "),s("div",{on:{click:function(s){return t.openActionModal(e,"delete")}}},[t._v(t._s(t.$t("global.deleteBtn")))])]):t._e()])])})),0)]),t._v(" "),t.isLoading?t._e():s("pagination",{attrs:{paginations:t.badgeTempListInfo.paging.pages,"page-number":t.currentPage},on:{target:t.changePage}})],1)]):t._e(),t._v(" "),s("loading-spinner",{attrs:{"is-loading":t.isLoading,"custom-style":"top: 80px;"}}),t._v(" "),!t.isLoading&&t.badgeTempListInfo.paging&&0===t.badgeTempListInfo.paging.total?s("no-record",{attrs:{"custom-style":"top: 80px;"}}):t._e()],1),t._v(" "),s("div",{staticClass:"templates-show-right"},[s("badge-preview",{attrs:{size:t.currentActiveBadge.Size,orientation:t.currentActiveBadge.Orientation,body:t.currentActiveBadge.Body}}),t._v(" "),s("div",{staticClass:"slds-text-body_small current-temp-des"},[t._v("\n      "+t._s(t.currentActiveBadge.Description)+"\n    ")])],1),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.orderOption.options,currents:t.orderOption.currentOptions,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth,"has-sort-by":!0},on:{"select-option":t.selectOrderOption,close:t.closeDropdown}}):t._e()],1)}),[],!1,null,"3c80c147",null);"function"==typeof $.default&&Object($.default)(O);var L=O.exports,D=s("ejTr"),N=s.n(D),T=s("+dyS"),B=s.n(T),x={mixins:[h.a],components:{InputSelect:m.a,Dropdown:b.a,BadgePreview:_.a},created(){this.getSizeOptions(),this.$on("set-edit-size",t=>{this.sizeOption.currentOptions=[t],this.$off("set-edit-size")})},watch:{dropdownRefId:function(){"size"===this.dropdownType?(this.dropdownOptionData.options=this.sizeOption.options,this.dropdownOptionData.currentOptions=this.sizeOption.currentOptions):"orientation"===this.dropdownType&&(this.dropdownOptionData.options=this.orientationOption.options,this.dropdownOptionData.currentOptions=this.orientationOption.currentOptions)}},mounted(){this.sourceData||this.setSourceData(this.badgeData)},data(){return{sizeOption:{options:[{Name:"12 mm x 12 mm",value:"12x12"}],currentOptions:[{Name:"12 mm x 12 mm",value:"12x12"}]},orientationOption:{options:[{Name:this.$t("landscapeLabel"),value:"Landscape"},{Name:this.$t("portrailLabel"),value:"Portrait"}],currentOptions:[{Name:this.$t("landscapeLabel"),value:"Landscape"}]},badgeData:{Name:"",Size:"12x12",IsActive:!0,Description:"",Body:"",Orientation:"Landscape"},sourceData:null,showErrorTip:!1,errorObj:{nameEmpty:!1,bodyEmpty:!1}}},methods:{async getSizeOptions(){try{const e=await Object(n.f)();if(e.ok){var t;JSON.parse(y.a.unescape(e.data));const s=JSON.parse(y.a.unescape(e.data)),a=s.SizeOptions,i=[];for(const t of a)i.push({Name:t.Label,value:t.Value});const n=B()(i).call(i,t=>t.Name===this.sizeOption.options[0].Name);this.sizeOption.options=n?i:l()(t=this.sizeOption.options).call(t,i)}else Object(o.f)(e)}catch(t){Object(o.f)(t)}},selectOption(t){"size"===this.dropdownType?(this.sizeOption.currentOptions=t,this.badgeData.Size=t[0].value||"12x12"):(this.orientationOption.currentOptions=t,this.badgeData.Orientation=t[0].value||"Landscape"),this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1},getCreatedData(){return this.badgeData},setSourceData(t){this.sourceData=JSON.parse(i()(t))},setCreatedData(t){var e;this.badgeData=t;const s=t.Size.split("x"),a=l()(e="".concat(s[0],"mm x ")).call(e,s[1]," mm");this.sizeOption.options=[{Name:a,value:t.Size}],this.sizeOption.currentOptions=[{Name:a,value:t.Size}],this.setSourceData(t),t.Orientation&&("Landscape"===t.Orientation?this.orientationOption.currentOptions=[{Name:this.$t("landscapeLabel"),value:t.Orientation}]:this.orientationOption.currentOptions=[{Name:this.$t("portrailLabel"),value:t.Orientation}])},checkDiff(){for(const t of N()(this.sourceData))if("showEditBox"!==t&&this.sourceData[t]!==this.badgeData[t])return!0},checkEmpty(){if(this.errorObj.nameEmpty=""===this.badgeData.Name,this.errorObj.bodyEmpty=""===this.badgeData.Body,this.errorObj.nameEmpty||this.errorObj.bodyEmpty){if(this.showErrorTip=!0,this.errorObj.nameEmpty){const t=this.$watch("badgeData",e=>{this.errorObj.nameEmpty=""===e.Name,this.errorObj.bodyEmpty=""===e.Body,this.errorObj.nameEmpty||this.errorObj.bodyEmpty||(this.showErrorTip=!1,t())},{deep:!0})}return!0}return!1},closeErrorTip(){this.showErrorTip=!1}}},S=(s("RN1l"),s("tIu5")),E=Object(P.a)(x,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-grid create-badge-page"},[s("div",{staticClass:"slds-border_right create-badge-left"},[s("div",{staticClass:"slds-text-heading_small title"},[t._v(t._s(t.$t("previewLabel")))]),t._v(" "),s("badge-preview",{attrs:{size:t.sizeOption.currentOptions[0].value,orientation:t.orientationOption.currentOptions[0].value,body:t.badgeData.Body}})],1),t._v(" "),s("div",{staticClass:"slds-col create-badge-right"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showErrorTip,expression:"showErrorTip"}],staticClass:"badge-error-tip",on:{click:function(e){return t.closeErrorTip()}}},[t._v("\n      "+t._s(t.$t("previewErrorLabel"))+"\n    ")]),t._v(" "),s("div",{staticClass:"slds-text-heading_small title"},[t._v(t._s(t.$t("badgeTemplateLabel")))]),t._v(" "),s("div",{staticClass:"badge-created-item"},[s("label",{attrs:{for:""}},[s("i",[t._v("*")]),t._v("\n        "+t._s(t.$t("nameLabel"))+"\n      ")]),t._v(" "),s("div",{staticClass:"input-area",class:{"error-border":t.errorObj.bodyEmpty}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.badgeData.Name,expression:"badgeData.Name"}],staticClass:"slds-input",attrs:{type:"text"},domProps:{value:t.badgeData.Name},on:{input:function(e){e.target.composing||t.$set(t.badgeData,"Name",e.target.value)}}})]),t._v(" "),t.errorObj.nameEmpty?s("div",{staticClass:"slds-text-body_small error-info"},[t._v(t._s(t.$t("completeLabel")))]):t._e()]),t._v(" "),s("div",{staticClass:"badge-created-item"},[s("label",{staticClass:"no-padding",attrs:{for:""}},[t._v("\n        "+t._s(t.$t("sizeLabel"))+"\n      ")]),t._v(" "),s("div",{staticClass:"input-area"},[s("input-select",{attrs:{currents:t.sizeOption.currentOptions,type:"size"},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1)]),t._v(" "),s("div",{staticClass:"slds-grid badge-created-item"},[s("div",[s("label",{staticClass:"no-padding",attrs:{for:""}},[t._v(t._s(t.$t("orientationLabel")))]),t._v(" "),s("div",{staticClass:"Orientatio-area"},[s("input-select",{attrs:{currents:t.orientationOption.currentOptions,type:"orientation"},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1)]),t._v(" "),s("div",{staticClass:"just-for-active"},[s("label",{staticClass:"no-padding",attrs:{for:""}},[t._v("\n          "+t._s(t.$t("activeLabel"))+"\n        ")]),t._v(" "),s("div",{staticClass:"input-area"},[s("span",{staticClass:"slds-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.badgeData.IsActive,expression:"badgeData.IsActive"}],attrs:{type:"checkbox",name:"option",id:"checkbox-147"},domProps:{checked:Array.isArray(t.badgeData.IsActive)?t._i(t.badgeData.IsActive,null)>-1:t.badgeData.IsActive},on:{change:function(e){var s=t.badgeData.IsActive,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&t.$set(t.badgeData,"IsActive",s.concat([null])):n>-1&&t.$set(t.badgeData,"IsActive",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.badgeData,"IsActive",i)}}}),t._v(" "),t._m(0)])])])]),t._v(" "),s("div",{staticClass:"badge-created-item"},[s("label",{staticClass:"no-padding",attrs:{for:""}},[t._v("\n        "+t._s(t.$t("descriptionLabel"))+"\n      ")]),t._v(" "),s("div",{staticClass:"input-area descrition-area"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.badgeData.Description,expression:"badgeData.Description"}],staticClass:"slds-textarea",domProps:{value:t.badgeData.Description},on:{input:function(e){e.target.composing||t.$set(t.badgeData,"Description",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"badge-created-item"},[s("label",{attrs:{for:""}},[s("i",[t._v("*")]),t._v("\n        "+t._s(t.$t("bodyLabel"))+"\n      ")]),t._v(" "),s("div",{staticClass:"body-area",class:{"error-border":t.errorObj.bodyEmpty}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.badgeData.Body,expression:"badgeData.Body"}],staticClass:"slds-textarea",attrs:{rows:"10"},domProps:{value:t.badgeData.Body},on:{input:function(e){e.target.composing||t.$set(t.badgeData,"Body",e.target.value)}}})]),t._v(" "),t.errorObj.bodyEmpty?s("div",{staticClass:"slds-text-body_small error-info"},[t._v(t._s(t.$t("completeLabel")))]):t._e()])]),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.dropdownOptionData.options,currents:t.dropdownOptionData.currentOptions,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth},on:{"select-option":t.selectOption,close:t.closeDropdown}}):t._e()],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("label",{staticClass:"slds-checkbox__label no-padding",attrs:{for:"checkbox-147"}},[e("span",{staticClass:"slds-checkbox_faux pass-custom-checkbox"})])}],!1,null,"117b67a9",null);"function"==typeof S.default&&Object(S.default)(E);var I={components:{BadgeTempList:L,EditBadgeTemplate:E.exports},data:()=>({accountId:"",showCreatingPage:!1,currentType:"new",inableToSave:!1,currentEditBadge:null}),methods:{openEditPage(){this.showCreatingPage=!0,this.currentType="new"},toggleWeChatAccounts(){this.$root.$emit("show-nav-box")},cancelEdit(){this.$refs.createBadgeComp.checkDiff()?(this.$refs.discardConfirm.open(),this.$on("cancelSave",()=>{this.showCreatingPage=!1,this.$refs.discardConfirm.close(),this.$off("stayOnEdit"),this.$off("cancelSave")}),this.$on("stayOnEdit",()=>{this.$off("cancelSave"),this.$off("stayOnEdit")})):this.showCreatingPage=!1},editTemplate(t){this.showCreatingPage=!0,this.currentType="edit",this.currentEditBadge=t,this.$nextTick(()=>{this.$refs.createBadgeComp.setCreatedData(t)})},async saveBadge(){if(this.$refs.createBadgeComp.checkEmpty())return!1;if(this.$refs.createBadgeComp.checkDiff()){this.inableToSave=!0;const t=this.$refs.createBadgeComp.getCreatedData();if("new"===this.currentType)try{const e=await Object(n.a)(i()(t));e.ok?(this.showCreatingPage=!1,this.refreshList(t.IsActive),this.$root.$emit("open-toast-notification",{content:this.$t("newBadgeNotify"),type:"success"})):Object(o.f)(e),this.inableToSave=!1}catch(t){Object(o.f)(t),this.inableToSave=!1}else try{const e=await Object(n.h)(i()(t));e.ok?(this.showCreatingPage=!1,this.refreshList(t.IsActive),this.$router.app.$emit("open-toast-notification",{content:this.$t("updateBadgeNotify"),type:"success"})):Object(o.f)(e),this.inableToSave=!1}catch(t){Object(o.f)(t),this.inableToSave=!1}}else this.showCreatingPage=!1},stayOnEdit(){this.$refs.discardConfirm.close()},cancelToSave(){this.$emit("cancelSave")},closeLeaveConfirm(){this.$emit("stayOnEdit")},refreshList(t){this.showCreatingPage||this.$refs.badgeList.refreshList(t)}},beforeRouteLeave(t,e,s){let a=!1;this.showCreatingPage&&(a=this.$refs.createBadgeComp.checkDiff()),a?(this.$refs.discardConfirm.open(),this.$on("cancelSave",()=>{s(!0),this.$off("stayOnEdit"),this.$off("cancelSave")}),this.$on("stayOnEdit",()=>{s(!1),this.$off("cancelSave"),this.$off("stayOnEdit")})):s(!0)}},A=(s("f0na"),s("GyFa")),k=Object(P.a)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"badge-templates-page"},[s("header",{staticClass:"slds-border_bottom badge-templates-header"},[s("nav",[s("ul",[t.showCreatingPage?t._e():s("li",[s("a",{staticClass:"down-btn",on:{click:t.toggleWeChatAccounts}},[s("icon",{attrs:{name:"menuIcon","class-name":"down-icon",width:"18px",height:"18px"}})],1),t._v(" "),s("span",{staticClass:"header-line"}),t._v(" "),s("span",{staticClass:"slds-text-body_regular tab-value"},[t._v(t._s(t.$tc("badgeTitleLabel",1)))])]),t._v(" "),t.showCreatingPage?s("li",[s("a",{staticClass:"down-btn",on:{click:t.cancelEdit}},[s("icon",{attrs:{name:"back","class-name":"down-icon",width:"18px",height:"18px"}})],1),t._v(" "),s("span",{staticClass:"header-line"}),t._v(" "),s("label",{staticClass:"slds-text-body_regular tab-value",attrs:{for:""}},[t._v(t._s("edit"===t.currentType?t.currentEditBadge.Name:""))])]):t._e()]),t._v(" "),t.showCreatingPage?t._e():s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.openEditPage("new")}}},[t._v(t._s(t.$t("global.newBtn")))]),t._v(" "),t.showCreatingPage?s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.inableToSave},on:{click:function(e){return t.saveBadge()}}},[t._v(t._s(t.$t("global.saveBtn")))]):t._e(),t._v(" "),t.showCreatingPage?s("button",{staticClass:"slds-button slds-button_neutral button-marign",on:{click:function(e){return t.cancelEdit()}}},[t._v(t._s(t.$t("global.cancelBtn")))]):t._e()])]),t._v(" "),s("section",{staticClass:"badge-template-main"},[s("badge-temp-list",{directives:[{name:"show",rawName:"v-show",value:!t.showCreatingPage,expression:"!showCreatingPage"}],ref:"badgeList",on:{edit:function(e){return t.editTemplate(e)}}}),t._v(" "),t.showCreatingPage?s("edit-badge-template",{ref:"createBadgeComp"}):t._e()],1),t._v(" "),s("ld-modal",{ref:"discardConfirm",attrs:{title:t.$tc("badgeTitleLabel",2)},on:{close:t.closeLeaveConfirm},scopedSlots:t._u([{key:"content",fn:function(){return[s("p",{staticClass:"slds-p-around_medium text-align-center"},[t._v(t._s(t.$t("discardModalLabel")))])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{neutral:""},on:{click:function(e){return t.cancelToSave()}}},[t._v("\n        "+t._s(t.$t("discardChangeLabel"))+"\n      ")]),t._v(" "),s("ld-button",{attrs:{brand:""},on:{click:function(e){return t.stayOnEdit()}}},[t._v("\n        "+t._s(t.$t("stayPageLabel"))+"\n      ")])]},proxy:!0}])})],1)}),[],!1,null,"05301c03",null);"function"==typeof A.default&&Object(A.default)(k);e.default=k.exports},bwDH:function(t,e,s){"use strict";var a=s("naGm");s.n(a).a},f0na:function(t,e,s){"use strict";var a=s("01RO");s.n(a).a},fGFX:function(t,e,s){},hkfk:function(t,e,s){"use strict";var a=s("fGFX");s.n(a).a},"k/9o":function(t,e,s){"use strict";var a=s("qVZU"),i=s.n(a);e.default=i.a},naGm:function(t,e,s){},pgAJ:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"item":"项目","name":"名称","searchPass":"查询凭证","startDate":"开始日期","endDate":"结束日期","status":"状态","quantity":"数量","campaign":"市场活动","tags":"标签","createdBy":"最后修改信息","adjustQuantity":"调整数量","newQuantity":"新的数量","quantityAdjusted":"数量调整","currentQuantity":"当前数量","previewPass":"预览凭证","wechatId":"微信号","lastCreatedDate":"最近创建日期","oldestCreatedDate":"最早创建日期","lastStartTime":"最近开始时间","oldestStartTime":"最早开始时间","lastEndTime":"最近结束日期","oldestEndTime":"最早结束日期","changesAreSaved":"修改已保存。","passWasDeleted":"凭证已删除","canPreviewPass":"现在可以在微信上预览这张凭证。","delModalHeader":"删除凭证","delModalContent":"你确定要删除这张凭证吗？"},"en":{"item":"item{0}","name":"Name","searchPass":"Search Passes","startDate":"Start Date","endDate":"End Date","status":"Status","quantity":"Quantity","campaign":"Campaign","tags":"Tags","createdBy":"Created By","adjustQuantity":"Adjust Quantity","newQuantity":"New Quantity","quantityAdjusted":"Quantity Adjusted","currentQuantity":"Current Quantity","previewPass":"Preview Pass","wechatId":"WeChat Id","lastCreatedDate":"Last Created Date","oldestCreatedDate":"First Created Date","lastStartTime":"Last Start Time","oldestStartTime":"First Start Time","lastEndTime":"Last End Date","oldestEndTime":"First End Date","changesAreSaved":"Changes were saved.","passWasDeleted":"The pass was deleted.","canPreviewPass":"The pass is now available for preview in the WeChat app.","delModalHeader":"Delete Pass","delModalContent":"Are you sure you want to delete this pass?"}}'),delete t.options._Ctor}},qVZU:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"preTitle":"上一页","nextTitle":"下一页"},"en":{"preTitle":"Previous Page","nextTitle":"Next Page"}}'),delete t.options._Ctor}},riPu:function(t,e,s){"use strict";var a=s("Mp6Y");s.n(a).a},tIu5:function(t,e,s){"use strict";var a=s("PXsE"),i=s.n(a);e.default=i.a},ul1B:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"passes":"凭证","passForApproval":"凭证已提交审批","submitForApproval":"提交审批","submitTip":"此凭证将被提交至微信，在通过微信审批之前你还不能使用它。你可以在凭证列表中检查它的审批状态。一旦你将此凭证提交至审批，一些字段将不可被编辑。确认继续？"},"en":{"passes":"Passes","passForApproval":"Pass was submitted for approval.","submitForApproval":"Submit For Approval","submitTip":"This pass will be submitted to WeChat. You will not be able to use the pass until it is approved by WeChat. You can check the approval status in the pass list. Once the pass is submitted for approval, some fields will not be editable. Continue?"}}'),delete t.options._Ctor}},xNsD:function(t,e,s){},"yTZ/":function(t,e,s){"use strict";var a=s("KNmw");s.n(a).a}}]);