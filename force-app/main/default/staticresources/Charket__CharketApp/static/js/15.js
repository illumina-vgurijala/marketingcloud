(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"+1Cy":function(t,e,s){},"+Bxx":function(t,e,s){"use strict";var a=s("ZBZF");s.n(a).a},"+XWK":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"badgeTitle":"选择名牌模板","nameLabel":"名称","sizeLabel":"尺寸","lastDateLabel":"最近修改日期"},"en":{"badgeTitle":"Select Name Badge Template","nameLabel":"Name","sizeLabel":"Size","lastDateLabel":"Last Modified Date"}}'),delete t.options._Ctor}},"+qmn":function(t,e,s){"use strict";var a=s("ffUB"),i=s.n(a);e.default=i.a},"/B6M":function(t,e,s){"use strict";e.a={"北京市":["北京市"],"天津市":["天津市"],"上海市":["上海市"],"重庆市":["重庆市"],"河北省":["石家庄市","唐山市","秦皇岛市","邯郸市","邢台市","保定市","张家口市","承德市","沧州市","廊坊市","衡水市","定州市","辛集市"],"山西省":["太原市","大同市","阳泉市","长治市","晋城市","朔州市","晋中市","运城市","忻州市","临汾市","吕梁市"],"内蒙古":["呼和浩特市","包头市","乌海市","赤峰市","通辽市","鄂尔多斯市","呼伦贝尔市","巴彦淖尔市","乌兰察布市","兴安盟","锡林郭勒盟","阿拉善盟"],"辽宁省":["沈阳市","大连市","鞍山市","抚顺市","本溪市","丹东市","锦州市","营口市","阜新市","辽阳市","盘锦市","铁岭市","朝阳市","葫芦岛市"],"吉林省":["长春市","吉林市","四平市","辽源市","通化市","白山市","松原市","白城市","延边州"],"黑龙江省":["哈尔滨市","齐齐哈尔市","鸡西市","鹤岗市","双鸭山市","大庆市","伊春市","佳木斯市","七台河市","牡丹江市","黑河市","绥化市","大兴安岭地区"],"江苏省":["南京市","无锡市","徐州市","常州市","苏州市","南通市","连云港市","淮安市","盐城市","扬州市","镇江市","泰州市","宿迁市"],"浙江省":["杭州市","宁波市","温州市","嘉兴市","湖州市","绍兴市","金华市","衢州市","舟山市","台州市","丽水市"],"安徽省":["合肥市","芜湖市","蚌埠市","淮南市","马鞍山市","淮北市","铜陵市","安庆市","黄山市","滁州市","阜阳市","宿州市","六安市","亳州市","池州市","宣城市"],"福建省":["福州市","厦门市","莆田市","三明市","泉州市","漳州市","南平市","龙岩市","宁德市"],"江西省":["南昌市","景德镇市","萍乡市","九江市","新余市","鹰潭市","赣州市","吉安市","宜春市","抚州市","上饶市"],"山东省":["济南市","青岛市","淄博市","枣庄市","东营市","烟台市","潍坊市","济宁市","泰安市","威海市","日照市","莱芜市","临沂市","德州市","聊城市","滨州市","菏泽市"],"河南省":["郑州市","开封市","洛阳市","平顶山市","安阳市","鹤壁市","新乡市","焦作市","濮阳市","许昌市","漯河市","三门峡市","南阳市","商丘市","信阳市","周口市","驻马店市","济源市"],"湖北省":["武汉市","黄石市","十堰市","宜昌市","襄阳市","鄂州市","荆门市","孝感市","荆州市","黄冈市","咸宁市","随州市","恩施州","仙桃市","潜江市","天门市","神农架林区"],"湖南省":["长沙市","株洲市","湘潭市","衡阳市","邵阳市","岳阳市","常德市","张家界市","益阳市","郴州市","永州市","怀化市","娄底市","湘西州"],"广东省":["广州市","韶关市","深圳市","珠海市","汕头市","佛山市","江门市","湛江市","茂名市","肇庆市","惠州市","梅州市","汕尾市","河源市","阳江市","清远市","东莞市","中山市","潮州市","揭阳市","云浮市"],"广西":["南宁市","柳州市","桂林市","梧州市","北海市","防城港市","钦州市","贵港市","玉林市","百色市","贺州市","河池市","来宾市","崇左市"],"海南省":["海口市","三亚市","三沙市","琼海市","万宁市","东方市","文昌市","五指山市","临高县","澄迈县","定安县","屯昌县","昌江县","白沙县","琼中县","陵水县","保亭县","乐东县","儋州市"],"四川省":["成都市","自贡市","攀枝花市","泸州市","德阳市","绵阳市","广元市","遂宁市","内江市","乐山市","南充市","眉山市","宜宾市","广安市","达州市","雅安市","巴中市","资阳市","阿坝州","甘孜州","凉山州"],"贵州省":["贵阳市","六盘水市","遵义市","安顺市","毕节市","铜仁市","黔西南州","黔东南州","黔南州"],"云南省":["昆明市","曲靖市","玉溪市","保山市","昭通市","丽江市","普洱市","临沧市","楚雄州","红河州","文山州","西双版纳州","大理州","德宏州","怒江州","迪庆州"],"西藏自治区":["拉萨市","日喀则市","昌都市","山南地区","那曲地区","阿里地区","林芝地区"],"陕西省":["西安市","铜川市","宝鸡市","咸阳市","渭南市","延安市","汉中市","榆林市","安康市","商洛市"],"甘肃省":["兰州市","嘉峪关市","金昌市","白银市","天水市","武威市","张掖市","平凉市","酒泉市","庆阳市","定西市","陇南市","临夏州","甘南州"],"青海省":["西宁市","海东地区","海北州","黄南州","海南州","果洛州","玉树州","海西州"],"宁夏":["银川市","石嘴山市","吴忠市","固原市","中卫市"],"新疆":["乌鲁木齐市","克拉玛依市","吐鲁番地区","哈密地区","昌吉州","博尔塔拉州","巴音郭楞州","阿克苏地区","克孜勒苏柯尔克孜自治州","喀什地区","和田地区","伊犁州","五家渠市","阿拉尔市","图克舒克市","铁门关市","昆玉市","哈城地区","阿勒泰地区"],"台湾":["台湾"],"港澳":["香港特别行政区","澳门特别行政区"]}},"/FlB":function(t,e,s){},"/eHX":function(t,e,s){"use strict";var a=s("f/VK");s.n(a).a},"0JIZ":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"formLabel":"表单","urlLabel":"网页地址","tagLabel":"标签","responseLabel":"完成后发送","campaignStatusLabel":"市场活动成员状态","qrCodeLabel":"二维码","downloadLabel":"下载","previewLabel":"预览","badgeLabel":"打印名牌","expiredLabel":"已过期","expireInLabel":"有效时间","expireMinuteLabel":"分钟","expireHoursLabel":"小时","expireDayLabel":"天","copySuccess":"链接已被复制至你的粘贴板。","copyFailed":"复制失败。"},"en":{"formLabel":"Form","urlLabel":"Redirect URL","tagLabel":"Tags","responseLabel":"Completion Response(s)","campaignStatusLabel":"Campaign Member Status","qrCodeLabel":"QR Codes","downloadLabel":"Download","previewLabel":"Preview","badgeLabel":"Print Name Badge","expiredLabel":"Expired","expireInLabel":"Expires in","expireMinuteLabel":"minute | minutes","expireHoursLabel":"hour | hours","expireDayLabel":"day | days","copySuccess":"The link has been copied to your clipboard.","copyFailed":"Copy failed."}}'),delete t.options._Ctor}},"0zm+":function(t,e,s){t.exports=s("9EaA")},"1MG1":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"defaultContent":"<p id=\\"initContent\\">开始输入...</p>","descriptionEditor":"描述编辑"},"en":{"defaultContent":"<p id=\\"initContent\\">Start Typing...</p>","descriptionEditor":"Description Editor"}}'),delete t.options._Ctor}},"1vOb":function(t,e,s){"use strict";var a=s("Hi2j"),i=s.n(a);e.default=i.a},"2SXh":function(t,e,s){s("pevS")({target:"Object",stat:!0,sham:!s("wbIY")},{create:s("SJYm")})},"2n3x":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"defaultContent":"<p id=\\"initContent\\">开始输入...</p>"},"en":{"defaultContent":"<p id=\\"initContent\\">Start Typing...</p>"}}'),delete t.options._Ctor}},"3nmp":function(t,e,s){"use strict";var a=s("R9hF"),i=s.n(a),n=s("dUVM"),o=s.n(n),r=s("8Vev"),c=s.n(r),l=s("4LGG"),d=s.n(l),h=s("kZKX"),u=s.n(h),p=s("q1Z7"),m=s("QBew"),g=s("OZZp"),f=s("zEt/"),v=s.n(f),w=s("i+Lc"),b=s.n(w),C=s("20nU"),_=s("XIlo"),y=s("OB6B");var k={openRoute(t){let{wechatAccountId:e,path:s}=t;const a=["#",e,b()(s).call(s,"/")?s.substring(1):s].join("/");_.a.isInLightningConsole?y.a.openWindow(["/apex/",C.a.sfdc_namespace?"".concat(C.a.sfdc_namespace,"__"):"","CharketApp?isdtp=p1",a].join("")):window.open([window.location.origin,window.location.pathname,window.location.search,a].join(""))}},x=s("SLhn"),S=s.n(x),I=s("0G99"),L=s.n(I),N=s("cybb"),T=s("M9dV");const $=["Image","Skill","Pass","Video","Voice Message","Text Message","Coupon","Notification Template","Structured Message","Mini Program Page"],D=new u.a([["Image","global.imageLabel"],["Skill","global.skillLabel"],["Pass","global.passLabel"],["Video","global.videoLabel"],["Voice Message","global.voiceLabel"],["Text Message","global.textLabel"],["Coupon","global.couponLabel"],["Notification Template","global.notifyLabel"],["Structured Message","global.strucLabel"],["Mini Program Page","global.miniProgramLabel"]]),A=new u.a([["Image","global.popupHeader.selectImage"],["Skill","global.popupHeader.selectSkill"],["Pass","global.popupHeader.selectPass"],["Video","global.popupHeader.selectVideo"],["Voice Message","global.popupHeader.selectVoiceClip"],["Text Message","global.popupHeader.selectTextMessage"],["Coupon","global.popupHeader.selectCoupon"],["Notification Template","global.popupHeader.selectNotificationTemplateLabel"],["Structured Message","global.popupHeader.selectStructuredMessage"],["Mini Program Page","global.popupHeader.selectMiniProgram"]]);var O=class{constructor(t){this.componentInstance=t}static getAllChoosers(){return[...$]}getExclusivelyConfig(t){let e=null;switch(t){case"Skill":e={add:{title:this.componentInstance.$t("exclusive.skillAddTitle"),content:this.componentInstance.$t("exclusive.skillAddContent"),ok:this.componentInstance.$t("global.yesBtn"),cancel:this.componentInstance.$t("global.noBtn")},remove:{title:this.componentInstance.$t("exclusive.skillRemoveTitle"),content:this.componentInstance.$t("exclusive.skillRemoveContent"),ok:this.componentInstance.$t("global.yesBtn"),cancel:this.componentInstance.$t("global.noBtn")}}}return e}getReplyModeConfig(t){if("false"!==t&&!1!==t&&null!=t)return{label:this.componentInstance.$t("replyModeLabel"),modes:[{label:this.componentInstance.$t("replyModeAll"),value:"All"},{label:this.componentInstance.$t("replyModeRandom"),value:"Random"}]}}getChooserConfigs(t){return d()(t).call(t,t=>{const{type:e}=t,s={type:e,name:this.componentInstance.$t(D.get(e)),exclusive:this.getExclusivelyConfig(e),layout:this.createLayout(e,t.limitLabel),dataProvider:this.createDataProvider(e),limitOfItems:t.limit||null};if("Text Message"===e){s.showTabs=!0;const e=this.getSubConfigsOfTextMessageChooser(),{textConfig:a}=t;if(a){const t={};L()(a).call(a,s=>{t[s]=e.designer[s]}),s.configs={designer:t,editor:e.editor}}else s.configs=e}return s})}getSubConfigsOfTextMessageChooser(){return{designer:{link:{iconTitle:this.componentInstance.$t("designer.linkIcon"),title:this.componentInstance.$t("global.title"),linkURL:this.componentInstance.$t("designer.linkUrl"),invalidUrl:this.componentInstance.$t("designer.illegalUrl"),primaryButton:this.componentInstance.$t("global.confirmBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn"),change:this.componentInstance.$t("designer.changeBtn"),remove:this.componentInstance.$t("designer.removeBtn")},miniProgramPage:{iconTitle:this.componentInstance.$t("designer.miniProgramIcon"),title:this.componentInstance.$t("global.title"),linkUrl:this.componentInstance.$t("designer.linkUrl"),invalidUrl:this.componentInstance.$t("designer.illegalUrl"),appId:this.componentInstance.$t("designer.appId"),pagePath:this.componentInstance.$t("designer.pagePath"),primaryButton:this.componentInstance.$t("global.confirmBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn"),change:this.componentInstance.$t("designer.changeBtn"),remove:this.componentInstance.$t("designer.removeBtn"),dataProvider:this.createDataProvider("Mini Program Link")},action:{iconTitle:this.componentInstance.$t("designer.actionIcon"),name:this.componentInstance.$t("designer.name"),value:this.componentInstance.$t("designer.value"),primaryButton:this.componentInstance.$t("global.confirmBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn")},mergeField:{iconTitle:this.componentInstance.$t("designer.mergeFieldIcon"),title:this.componentInstance.$t("designer.selectAField"),placeholder:this.componentInstance.$t("designer.findObjectPlaceholder"),filterPlaceholder:this.componentInstance.$t("designer.labelFilterPlaceholder"),fieldTitle:this.componentInstance.$t("designer.fieldTitle"),type:this.componentInstance.$t("designer.type"),apiName:this.componentInstance.$t("designer.apiName"),primaryButton:this.componentInstance.$t("global.chooseBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn"),noMatches:this.componentInstance.$t("designer.noMatchesFound"),currentSelection:this.componentInstance.$t("designer.currentSelection"),dataProvider:this.createDataProvider("Merge Field")}},editor:{title:this.componentInstance.$t("global.popupHeader.editTextMessage"),cancelButton:this.componentInstance.$t("global.cancelBtn"),okButton:this.componentInstance.$t("global.saveBtn")}}}createLayout(t,e){const s={title:this.componentInstance.$t(A.get(t)),noRecords:this.componentInstance.$t("global.noRecords"),editButton:this.componentInstance.$t("global.editBtn"),searchPlaceholder:this.componentInstance.$t("global.searchPlaceholder"),primaryButton:this.componentInstance.$t("global.confirmBtn"),secondaryButton:this.componentInstance.$t("global.cancelBtn")},a={title:"Voice Message"===t?this.componentInstance.$t("uploader.voiceTitle"):this.componentInstance.$t("uploader.".concat(t.toLowerCase(),"Title")),label:this.componentInstance.$t("uploader.titleLabel"),descriptionLabel:this.componentInstance.$t("uploader.descriptionLabel"),secondaryButton:this.componentInstance.$t("uploader.cancelBtn"),sizeLimitError:this.componentInstance.$t("uploader.tooLarge"),upload:this.componentInstance.$t("uploader.uploadBtn"),uploading:this.componentInstance.$t("uploader.uploadingBtn")};switch(t){case"Text Message":s.tabs={new:{title:this.componentInstance.$t("global.popupHeader.createTextMessage"),tabLabel:this.componentInstance.$t("newTextMessage")},list:{title:this.componentInstance.$t("global.popupHeader.selectTextMessage"),tabLabel:this.componentInstance.$t("textMessages")}},s.iconLabel=this.componentInstance.$t("global.textLabel");break;case"Skill":s.headers=[{text:this.componentInstance.$t("nameLabel"),value:"name"},{text:this.componentInstance.$t("knowledgeSourceLabel"),value:"knowledgeSource"},{text:this.componentInstance.$t("relatedToLabel"),value:"relatedTo"},{text:this.componentInstance.$t("descriptionLabel"),value:"description"},{text:this.componentInstance.$t("validForLabel"),value:"validFor"},{text:this.componentInstance.$t("displayInLiveChatLabel"),value:"isDisplayInLiveChat"},{text:this.componentInstance.$t("internalLabel"),value:"isInternal"},{text:this.componentInstance.$t("lastModifiedByLabel"),value:"lastModifiedBy"}],s.iconLabel=this.componentInstance.$t("global.skillLabel");break;case"Pass":s.headers=[{text:this.componentInstance.$t("name"),value:"name"},{text:this.componentInstance.$t("startDate"),value:"localizedStartTime"},{text:this.componentInstance.$t("endDate"),value:"localizedEndTime"},{text:this.componentInstance.$t("quantity"),value:"quantity"},{text:this.componentInstance.$t("createdBy"),value:"compoundCreatedBy"}],s.iconLabel=e||this.componentInstance.$t("global.passLabel");break;case"Coupon":s.headers=[{text:this.componentInstance.$t("type"),value:"type"},{text:this.componentInstance.$t("name"),value:"name"},{text:this.componentInstance.$t("expirationDate"),value:"expirationDate"},{text:this.componentInstance.$t("quantity"),value:"quantity"},{text:this.componentInstance.$t("status"),value:"status"}],s.iconLabel=this.componentInstance.$t("global.couponLabel");break;case"Notification Template":s.headers=[{text:this.componentInstance.$t("titleLabel"),value:"title"},{text:this.componentInstance.$t("keywordLabel"),value:"keywordNames"},{text:this.componentInstance.$t("urlLabel"),value:"notificationURL"},{text:this.componentInstance.$t("noteLabel"),value:"note"},{text:this.componentInstance.$t("createdLabel"),value:"createdBy"}],s.iconLabel=this.componentInstance.$t("global.notifyLabel");break;case"Image":s.uploader=a,s.iconLabel=this.componentInstance.$t("global.imageLabel"),s.hasAction=!0;break;case"Voice Message":s.uploader=a,s.iconLabel=this.componentInstance.$t("global.voiceLabel"),s.hasAction=!0;break;case"Video":s.uploader=a,s.iconLabel=this.componentInstance.$t("global.videoLabel"),s.hasAction=!0;break;case"Mini Program Page":s.iconLabel=this.componentInstance.$t("global.miniProgramLabel");break;case"Structured Message":s.iconLabel=this.componentInstance.$t("global.strucLabel"),s.syncedTooltip=this.componentInstance.$t("global.syncedWithWeChatPlatform")}return s}createDataProvider(t){const e={wechatAccount:this.componentInstance.wechatAccount,pageName:this.componentInstance.pageName,structuredType:this.componentInstance.structuredType};switch(t){case"Text Message":e.success=()=>{this.componentInstance.$toast({content:this.componentInstance.$t("changeSavedNofity"),type:"success"})},e.error=t=>{this.componentInstance.$handleError(t)};break;case"Skill":e.formatter=t=>{var e;t.compoundRelatedTo={id:t.relatedTo?t.relatedTo.id:"",name:t.relatedTo?t.relatedTo.name:""},"Survey"===t.knowledgeSource&&t.relatedTo&&t.relatedTo.id?(t.compoundRelatedTo.href="javascript: void(0);",t.compoundRelatedTo.onClick=t=>{this.componentInstance.$router.push({name:"survey-editor",params:{surveyId:t.relatedTo.id}})}):t.relatedTo&&t.relatedTo.id&&(t.compoundRelatedTo.href="/".concat(t.relatedTo.id));const s=Object(N.e)(t.lastModifiedDate,this.componentInstance.$user.TimeZoneSidKey);return t.compoundLastModifiedBy=t.lastModifiedBy.name?S()(e="".concat(t.lastModifiedBy.name,", ")).call(e,s):s,t};break;case"Structured Message":e.formatter=t=>(t.localizedWeChatLastModifiedTime=Object(N.e)(t.weChatLastModifiedTime,this.componentInstance.$user.TimeZoneSidKey),t);break;case"Pass":e.formatter=t=>{var e;const s=Object(N.e)(t.createdDate,this.componentInstance.$user.TimeZoneSidKey);return t.compoundCreatedBy=S()(e="".concat(t.createdByUser,", ")).call(e,s),t.localizedStartTime=Object(N.e)(t.startTime,this.componentInstance.$user.TimeZoneSidKey),t.localizedEndTime=Object(N.e)(t.endTime,this.componentInstance.$user.TimeZoneSidKey),t};break;case"Coupon":const t=this.componentInstance.$t("to");e.formatter=e=>{var s,a;const i=Object(N.e)(e.beginDate,this.componentInstance.$user.TimeZoneSidKey),n=Object(N.e)(e.endDate,this.componentInstance.$user.TimeZoneSidKey);return e.expirationDate=S()(s=S()(a="".concat(i," ")).call(a,t," ")).call(s,n),e};break;case"Notification Template":e.formatter=t=>{var e;return t.localizedCreatedDate=Object(N.e)(t.createdDate,this.componentInstance.$user.TimeZoneSidKey),t.createdBy=S()(e="".concat(t.createdByUser,", ")).call(e,t.localizedCreatedDate),t};break;case"Voice Message":case"Video":e.formatter=t=>(t.localizedUpdateDateTime=Object(N.e)(t.updateDateTime,this.componentInstance.$user.TimeZoneSidKey),t)}return T.a.create(t,e)}},F=s("itEF"),M=s("wG3i"),P=s.n(M),R=s("FYrm"),E=s("w+Ta"),B=s("hOMy"),j={props:{accountId:{type:String,default:()=>""}},components:{CreateWeChatPass:R.a,LdModal:B.LdModal},data:()=>({isSavingPass:!1}),methods:{onClickActivator(){this.$refs.Modal.open()},closeModal(t){this.$emit("close",t),this.$refs.Modal.close()},async saveNewPass(){const t=this.accountId||this.$route.params.accountId,e=this.$refs.pass.getPass();if(t&&e)try{this.isSavingPass=!0;const s=await Object(E.f)(t,P()(e));if(s.ok){this.$router.app.$emit("open-toast-notification",{content:this.$t("passForApproval"),type:"success"});const t=s.data;this.$parent.$parent.$parent.$emit("new-pass-created"),this.closeModal(t)}else this.$refs.Modal.showError(s.error)}catch(t){const e=this.$parseErrorMessage(t);this.$refs.Modal.showError(e)}finally{this.isSavingPass=!1}}}},z=(s("nOmU"),s("KHd+")),U=s("Dk61"),q=Object(z.a)(j,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"new-pass-popup"},[s("span",{on:{click:t.onClickActivator}},[t._t("activator")],2),t._v(" "),s("ld-modal",{ref:"Modal",attrs:{title:t.$t("newPassTitle"),width:"auto","min-width":900,"max-width":"90%",persistent:t.isSavingPass}},[s("template",{slot:"content"},[s("create-we-chat-pass",{ref:"pass",attrs:{"acc-id":t.accountId,"is-popup":!0}})],1),t._v(" "),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSavingPass},on:{click:function(e){return t.closeModal()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isSavingPass},on:{click:function(e){return t.saveNewPass()}}},[t._v(t._s(t.$t("global.saveBtn")))])])],2)],1)}),[],!1,null,"dcb5ef76",null);"function"==typeof U.default&&Object(U.default)(q);var W=q.exports,Q=s("fb3H"),V=s("wbfU"),H={props:{accountId:String},components:{WechatNotification:Q.a,NewNotificationPopup:V.a},data:()=>({isWeChatNotificationVisible:!1,isNewNotificationPopupVisible:!1,selectedWeChatNotification:null}),methods:{onClickActivator(){this.isWeChatNotificationVisible=!0},onWeChatNotificationClose(){this.isWeChatNotificationVisible=!1},onWeChatNotificationNext(t){this.selectedWeChatNotification=t,this.isWeChatNotificationVisible=!1,this.isNewNotificationPopupVisible=!0},onNewNotificationPopupClose(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")?this.$parent.$parent.$parent.$emit("new-notification-template-created"):this.isWeChatNotificationVisible=!0,this.isNewNotificationPopupVisible=!1}}},K=Object(z.a)(H,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isWeChatNotificationVisible?s("wechat-notification",{attrs:{"account-id":t.accountId},on:{close:t.onWeChatNotificationClose,next:t.onWeChatNotificationNext}}):t._e(),t._v(" "),t.isNewNotificationPopupVisible?s("new-notification-popup",{attrs:{"acc-id":t.accountId,notify:t.selectedWeChatNotification},on:{close:t.onNewNotificationPopupClose}}):t._e(),t._v(" "),s("div",{on:{click:t.onClickActivator}},[t._t("activator")],2)],1)}),[],!1,null,null,null).exports;const J=new u.a([["Mini Program",["Text Message","Image","Mini Program Page","Skill"]],["Subscription Account",["Text Message","Image","Structured Message","Voice Message","Video","Mini Program Page","Pass","Coupon","Skill"]],["Service Account",["Text Message","Image","Structured Message","Voice Message","Video","Mini Program Page","Notification Template","Pass","Coupon","Skill"]]]);var Y={components:{WechatResponseDesigner:p.WechatResponseDesigner,LdButton:m.LdButton,LdIcon:g.LdIcon,NewPassPopup:W,NotificationTemplateCreator:K},model:{prop:"value",event:"input"},props:{value:{type:Object,default:()=>({})},limitOfItems:{type:Number,default:999},wechatAccount:{type:Object,required:!0},choosers:{type:Array,required:!0},multiple:{type:Boolean,default:()=>!1},enableReplyMode:{type:[Boolean,String],default:()=>!1},pageName:{type:String,default:""},iconSize:{type:String,default:"small"},structuredType:{type:String,default:"news"}},data:()=>({helperInstance:null,wechatResponse:{},addSvg:v.a}),computed:{unifiedChoosers(){var t;return d()(t=this.choosers).call(t,t=>"string"==typeof t?{type:t}:t)},supportedChoosers(){var t;return this.wechatAccount.type?c()(t=this.unifiedChoosers).call(t,t=>{var e;let{type:s}=t;return o()(e=J.get(this.wechatAccount.type)).call(e,s)}):this.unifiedChoosers},chooserConfigs(){return this.helper.getChooserConfigs(this.supportedChoosers)},replyModeConfig(){return this.helper.getReplyModeConfig(this.enableReplyMode)},helper(){return this.helperInstance||(this.helperInstance=new O(this)),this.helperInstance},accountId(){return this.wechatAccount.id}},watch:{wechatResponse:{handler(t){if(t.isInternalChange&&this.value&&t.content===this.value.content)return;const e=this.multiple?F.a.from(t):F.a.createItem(t);this.$emit("input",e)},deep:!0},value:{deep:!0,immediate:!0,handler(t){this.wechatResponse=i()({isInternalChange:!0},t)}}},methods:{onClickNewStructuredMessage(){k.openRoute({wechatAccountId:this.$wechatAccount.id,path:"message/structured-messages/new"})}}},G=(s("Ek5D"),s("xswR")),Z=s("ItEM"),X=s("fOvr"),tt=s("1vOb"),et=s("4bTK"),st=s("DR4q"),at=Object(z.a)(Y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("wechat-response-designer",{attrs:{choosers:t.chooserConfigs,multiple:t.multiple,"reply-mode-config":t.replyModeConfig,"limit-of-items":t.limitOfItems,"icon-size":t.iconSize},model:{value:t.wechatResponse,callback:function(e){t.wechatResponse=e},expression:"wechatResponse"}},[s("ld-button",{attrs:{slot:"structured-message-create-button",neutral:""},on:{click:t.onClickNewStructuredMessage},slot:"structured-message-create-button"},[s("ld-icon",{staticClass:"plus-icon",attrs:{size:"xx-small",color:"current",content:t.addSvg}})],1),t._v(" "),s("new-pass-popup",{attrs:{slot:"pass-create-button","account-id":t.accountId},slot:"pass-create-button"},[s("ld-button",{attrs:{slot:"activator",neutral:""},slot:"activator"},[t._v("\n      "+t._s(t.$t("global.newBtn"))+"\n    ")])],1),t._v(" "),s("notification-template-creator",{attrs:{slot:"notification-template-create-button","account-id":t.accountId},slot:"notification-template-create-button"},[s("ld-button",{attrs:{slot:"activator",neutral:""},slot:"activator"},[t._v("\n      "+t._s(t.$t("global.newBtn"))+"\n    ")])],1)],1)}),[],!1,null,"486a8157",null);"function"==typeof G.default&&Object(G.default)(at),"function"==typeof Z.default&&Object(Z.default)(at),"function"==typeof X.default&&Object(X.default)(at),"function"==typeof tt.default&&Object(tt.default)(at),"function"==typeof et.default&&Object(et.default)(at),"function"==typeof st.default&&Object(st.default)(at);var it=at.exports;e.a=it},"3q+l":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"addPrizesLabel":"添加奖品","addPrizesTitle":"添加奖品","addPrizesSubtitle":"为当前抽奖流程添加奖品。","settingsLabel":"设置","settingsTitle":"设置","settingsValue":"设置抽奖流程。"},"en":{"addPrizesLabel":"ADD PRIZES","addPrizesTitle":"Add Prizes","addPrizesSubtitle":"Add prizes for this lucky draw.","settingsLabel":"SETTINGS","settingsTitle":"Settings","settingsValue":"Set the lucky draw settings."}}'),delete t.options._Ctor}},"3zWd":function(t,e,s){},"4+HD":function(t,e,s){"use strict";var a=s("3q+l"),i=s.n(a);e.default=i.a},"46Re":function(t,e,s){},"4bTK":function(t,e,s){"use strict";var a=s("t29s"),i=s.n(a);e.default=i.a},"4lfF":function(t,e,s){"use strict";var a=s("TJfr"),i=s.n(a);e.default=i.a},"58Zw":function(t,e,s){"use strict";var a=s("UQyY");s.n(a).a},"5FD4":function(t,e,s){"use strict";var a=s("LgZB");s.n(a).a},"5Msn":function(t,e,s){"use strict";var a=s("s7xp"),i=s.n(a);e.default=i.a},"5flY":function(t,e,s){"use strict";s.d(e,"d",(function(){return i})),s.d(e,"g",(function(){return n})),s.d(e,"b",(function(){return o})),s.d(e,"a",(function(){return r})),s.d(e,"h",(function(){return c})),s.d(e,"f",(function(){return l})),s.d(e,"e",(function(){return d})),s.d(e,"c",(function(){return h}));var a=s("00Ee");function i(t,e,s){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.getNameBadgeTemplates",args:[t,e,s]})}function n(t,e){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.setActive",args:[t,e]})}function o(t){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.deleteNameBadgeTemplate",args:[t]})}function r(t){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.createNameBadgeTemplate",args:[t]})}function c(t){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.updateNameBadgeTemplate",args:[t]})}function l(){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.getSizeOptions",args:[]})}function d(t,e,s){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.getNameBadges",args:[t,e,s]})}function h(t){return Object(a.a)({method:"NameBadgeTemplateRemoteActions.getNameBadge",args:[t]})}},"6CHZ":function(t,e,s){},"6THU":function(t,e,s){},"6jXa":function(t,e,s){"use strict";var a=s("Igzh");s.n(a).a},"7XhL":function(t,e,s){"use strict";var a=s("tVRX"),i=s.n(a);e.default=i.a},"8YXT":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"selectNotificationTemplateLabel":"选择微信模板","newTemplateLabel":"在微信中添加一个新模板"},"en":{"selectNotificationTemplateLabel":"Select WeChat Template","newTemplateLabel":"Choose a new template from WeChat."}}'),delete t.options._Ctor}},9177:function(t,e,s){},"94pc":function(t,e,s){},"9EaA":function(t,e,s){s("2SXh");var a=s("dktu").Object;t.exports=function(t,e){return a.create(t,e)}},"9aMZ":function(t,e,s){"use strict";var a=s("jhb7"),i=s.n(a);e.default=i.a},"9duB":function(t,e,s){"use strict";var a=s("kmVQ");s.n(a).a},A3YL:function(t,e,s){"use strict";var a=s("F5n2"),i=s.n(a);e.default=i.a},AScg:function(t,e,s){},AsmZ:function(t,e,s){},"C94/":function(t,e,s){"use strict";var a=s("xPXm"),i=s.n(a);e.default=i.a},CGTS:function(t,e,s){"use strict";var a=s("enNt");s.n(a).a},CeEi:function(t,e,s){t.exports=s("0zm+")},D1u0:function(t,e,s){"use strict";var a=s("VK6O"),i=s.n(a);e.default=i.a},DR4q:function(t,e,s){"use strict";var a=s("hG8I"),i=s.n(a);e.default=i.a},Dk61:function(t,e,s){"use strict";var a=s("I0LH"),i=s.n(a);e.default=i.a},Dpxe:function(t,e,s){"use strict";var a=s("wOuw");s.n(a).a},EMO1:function(t,e,s){"use strict";var a=s("GfEe"),i=s.n(a),n=s("ip3M"),o=s.n(n),r=s("+dyS"),c=s.n(r),l=s("ejTr"),d=s.n(l),h=s("3O4B"),u=s.n(h),p=s("wG3i"),m=s.n(p),g=s("XmpP"),f={mixins:[s("dOfv").a]},v=(s("xecf"),s("KHd+")),w=s("pehn"),b=Object(v.a)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"rich-editor-page"},[s("div",{staticClass:"slds-grid slds-grid_vertical editor-toolbar"},[s("div",{staticClass:"slds-grid top-bar"},[s("div",{staticClass:"slds-grid re-undo"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onUndo()}}},[s("icon",{attrs:{name:"undo",width:"17px",height:"17px","fill-color":0!==t.toolStates.undo?"#d0d0d0":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onRedo()}}},[s("icon",{attrs:{name:"redo",width:"17px",height:"17px","fill-color":0!==t.toolStates.redo?"#d0d0d0":"#aaa","charket-icon":""}})],1)]),t._v(" "),s("a",{staticClass:"slds-grid font-size",attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openFontSizeList()}}},[s("div",{staticClass:"font-size-value"},[t._v("\n          "+t._s(t.toolValues.fontsize)+"\n        ")]),t._v(" "),s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showFontSizeList,expression:"showFontSizeList"}],staticClass:"font-size-list"},t._l(t.fontSizeList,(function(e){return s("li",{style:{fontSize:e},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.onFontsizeChange(e)}}},[t._v(t._s(e))])})),0)],1),t._v(" "),s("div",{staticClass:"slds-grid quot-dash"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onBlockquote()}}},[s("icon",{attrs:{name:"quot",width:"17px",height:"17px","fill-color":t.toolStates.blockquote?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onHorizontal()}}},[s("icon",{attrs:{name:"dash",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}})],1)]),t._v(" "),s("div",{staticClass:"slds-grid clear-or-brush"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onRemoveFormat()}}},[s("icon",{attrs:{name:"clearFormat",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onFormatmatch()}}},[s("icon",{attrs:{name:"brushFormat",width:"17px",height:"17px","fill-color":t.toolStates.formatmatch?"#5268ee":"#aaa","charket-icon":""}})],1)]),t._v(" "),s("div",{staticClass:"insert-image"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.getImages()}}},[s("icon",{attrs:{name:"image",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}})],1)])]),t._v(" "),s("div",{staticClass:"slds-grid bottom-bar"},[s("div",{staticClass:"slds-grid slds-wrap font-style"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onBold()}}},[s("icon",{attrs:{name:"bold",width:"19px",height:"19px","fill-color":t.toolStates.bold?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onItalic()}}},[s("icon",{attrs:{name:"italic",width:"19px",height:"19px","fill-color":t.toolStates.italic?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onUnderline()}}},[s("icon",{attrs:{name:"underline",width:"19px",height:"19px","fill-color":t.toolStates.underline?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),s("div",{staticClass:"slds-grid font-color"},[s("a",{staticClass:"slds-grid slds-grid_vertical",attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onFontColor(t.recentForeColor.hex)}}},[s("icon",{attrs:{name:"textColor",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("div",{staticClass:"color-bar",style:{backgroundColor:t.recentForeColor.hex}})],1),t._v(" "),s("button",{attrs:{name:"button",type:"button",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openFontColorList()}}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("color-picker",{ref:"colorList",attrs:{value:t.recentForeColor.hex?t.recentForeColor:t.defaultColor},on:{"get-color":t.onFontColor}})],1),t._v(" "),s("div",{staticClass:"slds-grid bg-color"},[s("a",{staticClass:"slds-grid slds-grid_vertical",attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onBgColor(t.recentBackColor.hex)}}},[s("icon",{attrs:{name:"text",width:"15px",height:"15px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("div",{staticClass:"color-bar",style:{backgroundColor:t.recentBackColor.hex}})],1),t._v(" "),s("button",{attrs:{name:"button",type:"button",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openBgColorList()}}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("color-picker",{ref:"bgColorList",attrs:{value:t.recentBackColor.hex?t.recentBackColor:t.defaultColor},on:{"get-color":t.onBgColor}})],1)]),t._v(" "),s("div",{staticClass:"slds-grid style-paragraph"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onParagraphStyle("indent")}}},[s("icon",{attrs:{name:"textIndent",width:"17px",height:"17px","fill-color":t.toolStates.indent?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),t._l(t.paragraphStyle,(function(e){return s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(s){return s.preventDefault(),t.onParagraphStyle(e.value)}}},[s("icon",{attrs:{name:e.label,width:"17px",height:"17px","fill-color":t.toolValues.justify===e.value?"#5268ee":"#aaa","charket-icon":""}})],1)}))],2),t._v(" "),s("div",{staticClass:"slds-grid style-list"},[s("div",{staticClass:"ol-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openOlList()}}},[s("icon",{attrs:{name:"olList",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showOlList,expression:"showOlList"}]},t._l(t.toolOptions.orderedlist,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.setListStyle("ol",e.value)}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.insertunorderedlist===e.value,expression:"toolValues.insertunorderedlist === style.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)]),t._v(" "),s("div",{staticClass:"ul-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openUlList()}}},[s("icon",{attrs:{name:"ulList",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showUlList,expression:"showUlList"}]},t._l(t.toolOptions.unorderedlist,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.setListStyle("ul",e.value)}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.insertunorderedlist===e.value,expression:"toolValues.insertunorderedlist === style.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)])]),t._v(" "),s("div",{staticClass:"slds-grid paragraph-line-space"},[s("div",{staticClass:"line-height-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openLineHeightList()}}},[s("icon",{attrs:{name:"lineHeight",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showLineHeightList,expression:"showLineHeightList"}]},t._l(t.toolOptions.lineheight,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.onLineHeight(e.value)}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.lineheight===e.value,expression:"toolValues.lineheight === val.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)]),t._v(" "),s("div",{staticClass:"spacing-top-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openSpacingTopList()}}},[s("icon",{attrs:{name:"pMarginTop",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showSpacingTopList,expression:"showSpacingTopList"}]},t._l(t.toolOptions.rowspacing,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.onRowSpacing(e.value,"top")}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.rowspacingtop===e.value,expression:"toolValues.rowspacingtop === val.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)]),t._v(" "),s("div",{staticClass:"spacing-bottom-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openSpacingBottomList()}}},[s("icon",{attrs:{name:"pMarginBottom",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showSpacingBottomList,expression:"showSpacingBottomList"}]},t._l(t.toolOptions.rowspacing,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.onRowSpacing(e.value,"bottom")}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.rowspacingbottom===e.value,expression:"toolValues.rowspacingbottom === val.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)])]),t._v(" "),s("div",{staticClass:"slds-grid image-float"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onImageFloat("none")}}},[s("icon",{attrs:{name:"imageFloatNone",width:"17px",height:"17px","fill-color":t.imagefloatvisible?"#aaa":"#d0d0d0","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onImageFloat("left")}}},[s("icon",{attrs:{name:"imageFloatLeft",width:"17px",height:"17px","fill-color":t.imagefloatvisible?"#aaa":"#d0d0d0","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onImageFloat("center")}}},[s("icon",{attrs:{name:"imageFloatCenter",width:"17px",height:"17px","fill-color":t.imagefloatvisible?"#aaa":"#d0d0d0","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onImageFloat("right")}}},[s("icon",{attrs:{name:"imageFloatRight",width:"17px",height:"17px","fill-color":t.imagefloatvisible?"#aaa":"#d0d0d0","charket-icon":""}})],1)])])]),t._v(" "),s("div",{staticClass:"editor-container"},[s("div",{ref:"editor"})])])}),[],!1,null,"12dd7cd2",null);"function"==typeof w.default&&Object(w.default)(b);var C=b.exports,_=s("+BhS"),y=s("w2Vt"),k=s("Ktw+"),x=s("xEMq"),S=s("4B+h"),I=s("LQ5e"),L=s.n(I),N={components:{ImagePopup:_.a,Ueditor:C,LoadingSpinner:y.a,MessageUploader:k.a},props:{accountId:{type:String,default:()=>""},newsType:{type:String,defaut:"mpnews"},createdInfo:{type:Object,defaut:()=>({type:"new",id:null})},changeDocTitle:{type:Boolean,default:!0}},mixins:[g.a],inject:["showErrorImg"],async mounted(){if("edit"===this.createdInfo.type){this.isLoading=!0;try{const t=await Object(x.c)(this.createdInfo.id);t.ok?(this.dealWithEditstru(JSON.parse(L.a.unescape(t.data))),this.isLoading=!1):(this.isLoading=!1,Object(S.f)(t))}catch(t){this.isLoading=!1,Object(S.f)(t)}}else"new"===this.createdInfo.type&&(this.originalNews="mpnews"===this.newsType?JSON.parse(m()(this.mpNewsDetails)):JSON.parse(m()(this.newsDetails)),this.changeDocTitle&&("mpnews"===this.newsType?document.title="New WeChat Article":document.title="New Link Message"))},computed:{authorLength(){const t=this.mpNewsDetails.wechatAttachment[this.currentEditIndex].author;return this.getAuthorLength(t)},errorTop(){return("mpnews"===this.newsType?this.mpnewsErrorTop:12)+"px"},titlePadding(){return 8*("mpnews"===this.newsType?this.mpNewsDetails.wechatAttachment[this.currentEditIndex]:this.newsDetails.wechatAttachment[this.currentEditIndex]).title.length.toString().length+22+"px"},authorPadding(){const t=this.mpNewsDetails.wechatAttachment[this.currentEditIndex].author;return 7*this.getAuthorLength(t).toString().length+14+"px"},wechatAccountId(){return this.accountId||this.$route.params.accountId}},data:()=>({mpNewsDetails:{wechatAttachment:[{title:"",thumbnailId:"",author:"",description:"",showCoverPic:0,content:"",contentSourceUrl:"",viewedSourceUrl:!1,coverImgStyle:"full-width"}]},newsDetails:{wechatAttachment:[{title:"",description:"",url:"",structureMsgUrl:"",coverImgStyle:"full-width",thumbnailId:"",wechatImageUrl:""}]},originalNews:null,content:"",coverPictures:{},currentImageType:"",currentEditIndex:0,articlesTotal:1,errorObj:{titleEmpty:!1,titleOverLength:!1,authorOverLength:!1,contentEmpty:!1,contentSourceUrlEmpty:!1,coverImgEmpty:!1,summaryOverLength:!1,structuredMessageUrlEmpty:!1},isCoveredToolbar:!1,showErrorTip:!1,isLoading:!1,mpnewsErrorTop:88}),methods:{onUeditorChange(t){if(this.showErrorTip=!1,this.content=t,this.content){document.querySelector(".editor-container").classList.remove("container-empty")}},openImagePopup(t){this.showErrorTip=!1,this.currentImageType=t,this.$refs.imagepopupmodel.openModal("","image","")},dealWithEditstru(t){if("Link"===t.structuredMessageType){for(const e of t.wechatAttachment)e.coverImgStyle="full-width";t.attachmentIdsToDelete=[],this.newsDetails=t,this.originalNews=JSON.parse(m()(this.newsDetails))}else if("WeChat"===t.structuredMessageType){for(const e of t.wechatAttachment)this.coverPictures[e.thumbnailId]=e.url,e.viewedSourceUrl=!!e.contentSourceUrl,e.coverImgStyle="full-width";if(this.mpNewsDetails=t,this.content)this.mpNewsDetails.wechatAttachment[this.currentEditIndex].content=this.content,this.originalNews=JSON.parse(m()(this.mpNewsDetails));else{const t=this.$watch("content",()=>{this.mpNewsDetails.wechatAttachment[0].content=this.content,this.originalNews=JSON.parse(m()(this.mpNewsDetails)),t()});this.mpNewsDetails.wechatAttachment[0].content&&this.$refs.ueditor.updateContent(this.mpNewsDetails.wechatAttachment[0].content)}}this.articlesTotal=t.wechatAttachment.length},getSelectedMessage(t){"mpnews"===this.newsType?"coverPic"===this.currentImageType?(this.coverPictures[t[0].mediaId]=t[0].url,this.mpNewsDetails.wechatAttachment[this.currentEditIndex].thumbnailId=t[0].mediaId,this.mpNewsDetails.wechatAttachment[this.currentEditIndex].url=t[0].url):"contentPic"===this.currentImageType&&this.$refs.ueditor.inputImage(t[0].wechatImageUrl):(this.newsDetails.wechatAttachment[this.currentEditIndex].wechatImageUrl=t[0].wechatImageUrl,this.newsDetails.wechatAttachment[this.currentEditIndex].thumbnailId=t[0].mediaId,this.newsDetails.wechatAttachment[this.currentEditIndex].url=t[0].url)},changeCurrentEdit(t){if("mpnews"===this.newsType){if(this.mpNewsDetails.wechatAttachment[this.currentEditIndex].content=this.content,this.originalNews.wechatAttachment[t]&&this.mpNewsDetails.wechatAttachment[t].content===this.originalNews.wechatAttachment[t].content){const e=this.$watch("content",()=>{this.originalNews.wechatAttachment[t].content=this.content,e()})}this.$refs.ueditor.updateContent(this.mpNewsDetails.wechatAttachment[t].content)}this.currentEditIndex=t},addNewArticle(){"mpnews"===this.newsType?this.mpNewsDetails.wechatAttachment.push({title:"",thumbnailId:"",author:"",description:"",showCoverPic:0,content:null,contentSourceUrl:"",viewedSourceUrl:!1,coverImgStyle:"full-width"}):"news"===this.newsType&&this.newsDetails.wechatAttachment.push({title:"",description:"",url:"",structureMsgUrl:"",order:this.articlesTotal,coverImgStyle:"full-width",wechatImageUrl:""}),this.articlesTotal++,this.changeCurrentEdit(this.articlesTotal-1)},sortArticle(t,e){"mpnews"===this.newsType&&(this.mpNewsDetails.wechatAttachment[this.currentEditIndex].content=this.content);const s="mpnews"===this.newsType?this.mpNewsDetails:this.newsDetails;if("up"===e){var a,i;const e=u()(a=s.wechatAttachment).call(a,t-1,1);u()(i=s.wechatAttachment).call(i,t,0,e[0]),this.currentEditIndex===t?(this.currentEditIndex=t-1,this.changeCurrentEdit(this.currentEditIndex)):this.currentEditIndex===t-1&&(this.currentEditIndex=t,this.changeCurrentEdit(this.currentEditIndex))}else{var n,o;const e=u()(n=s.wechatAttachment).call(n,t+1,1);u()(o=s.wechatAttachment).call(o,t,0,e[0]),this.currentEditIndex===t?(this.currentEditIndex=t+1,this.changeCurrentEdit(this.currentEditIndex)):this.currentEditIndex===t+1&&(this.currentEditIndex=t,this.changeCurrentEdit(this.currentEditIndex))}},deleteArticle(t){if(this.changeCurrentEdit(t),this.articlesTotal--,"edit"===this.createdInfo.type&&"news"===this.newsType&&this.newsDetails.wechatAttachment[t].wechatAttachmentId&&(this.newsDetails.attachmentIdsToDelete.push(this.newsDetails.wechatAttachment[t].wechatAttachmentId),this.newsDetails.wechatAttachment[t].order<this.newsDetails.wechatAttachment.length-1))for(const e of this.newsDetails.wechatAttachment)e.order>this.newsDetails.wechatAttachment[t].order&&e.order--;var e,s;"mpnews"===this.newsType?u()(e=this.mpNewsDetails.wechatAttachment).call(e,t,1):u()(s=this.newsDetails.wechatAttachment).call(s,t,1);this.currentEditIndex===t&&(this.currentEditIndex=t-1,"mpnews"===this.newsType&&this.$refs.ueditor.updateContent(this.mpNewsDetails.wechatAttachment[t-1].content))},deleteCoverImage(){"mpnews"===this.newsType?this.mpNewsDetails.wechatAttachment[this.currentEditIndex].thumbnailId="":(this.newsDetails.wechatAttachment[this.currentEditIndex].url="",this.newsDetails.wechatAttachment[this.currentEditIndex].wechatImageUrl="")},getAuthorLength(t){let e=0;if(t){for(let s=0;s<t.length;s++)t.charCodeAt(s)>127||94===t.charCodeAt(s)?e+=2:e+=1;return Math.ceil(e/2)}return 0},imgLoad(t){const e=t.target.offsetHeight,s=t.target.offsetWidth,a="mpnews"===this.newsType?this.mpNewsDetails:this.newsDetails;0===this.currentEditIndex?a.wechatAttachment[this.currentEditIndex].coverImgStyle=e/s>=5/9?"full-width":"full-height":a.wechatAttachment[this.currentEditIndex].coverImgStyle=e>=s?"full-width":"full-height"},checkDifferent(){"mpnews"===this.newsType&&(this.mpNewsDetails.wechatAttachment[this.currentEditIndex].content=this.content);const t="mpnews"===this.newsType?this.mpNewsDetails:this.newsDetails;if(this.originalNews&&this.originalNews.wechatAttachment.length!==t.wechatAttachment.length)return!0;{var e;const s=(e,s)=>{for(let a of d()(e))if("coverImgStyle"!==a&&e[a]!==t.wechatAttachment[s][a])return!0};return c()(e=this.originalNews.wechatAttachment).call(e,s)}},getEditorContent(){var t=this;let e=!1;const s=()=>{for(const t of o()(this.errorObj))if(t)return t},a=function(e,s){let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=()=>{t.showErrorTip=!1,e.classList.remove(s),e.removeEventListener("keydown",i),e.removeEventListener("blur",i)};t.showErrorTip=a,e.classList.add(s),e.addEventListener("keydown",i),e.addEventListener("blur",i)};if("mpnews"===this.newsType){this.mpNewsDetails.wechatAttachment[this.currentEditIndex].content=this.content;for(let[t,o]of i()(n=this.mpNewsDetails.wechatAttachment).call(n)){var n;if(this.errorObj.titleEmpty=""===o.title,this.errorObj.titleOverLength=o.title.length>64,this.errorObj.authorOverLength=this.getAuthorLength(o.author)>8,this.errorObj.contentEmpty=0===o.content.length,o.viewedSourceUrl?this.errorObj.contentSourceUrlEmpty=!o.contentSourceUrl||0===o.contentSourceUrl.length:(this.errorObj.contentSourceUrlEmpty=!1,o.contentSourceUrl=null),this.errorObj.coverImgEmpty=""===o.thumbnailId,this.errorObj.summaryOverLength=o.description&&o.description.length>120,e=!!s(),e){if(this.changeCurrentEdit(t),this.errorObj.titleEmpty)this.$refs.mpnewsTitle.focus(),a(this.$refs.mpnewsTitle,"input-empty");else if(this.errorObj.contentEmpty){document.querySelector(".editor-container").classList.add("container-empty"),this.showErrorTip=!0,this.$refs.mpnewsTitle.scrollIntoView()}else if(this.errorObj.contentSourceUrlEmpty)this.$nextTick(()=>{this.$refs.mpnewsContentSource.focus(),a(this.$refs.mpnewsContentSource,"input-empty")});else if(this.errorObj.coverImgEmpty)this.showErrorTip=!0,this.$refs.mpnewsCoverImg.scrollIntoView();else if(this.errorObj.titleOverLength){const t=this.mpNewsDetails.wechatAttachment[this.currentEditIndex].title;this.mpNewsDetails.wechatAttachment[this.currentEditIndex].title="",this.$nextTick(()=>{this.$refs.mpnewsTitle.focus(),a(this.$refs.mpnewsTitle,"input-empty"),this.mpNewsDetails.wechatAttachment[this.currentEditIndex].title=t})}else if(this.errorObj.authorOverLength){const t=this.mpNewsDetails.wechatAttachment[this.currentEditIndex].author;this.mpNewsDetails.wechatAttachment[this.currentEditIndex].author="",this.$nextTick(()=>{this.$refs.mpnewsAuthor.focus(),a(this.$refs.mpnewsAuthor,"input-overlength"),this.mpNewsDetails.wechatAttachment[this.currentEditIndex].author=t})}else if(this.errorObj.summaryOverLength){const t=this.mpNewsDetails.wechatAttachment[this.currentEditIndex].description;this.mpNewsDetails.wechatAttachment[this.currentEditIndex].description="",this.$nextTick(()=>{this.$refs.mpnewsSummary.focus(),a(this.$refs.mpnewsSummary,"textarea-overlength"),this.mpNewsDetails.wechatAttachment[this.currentEditIndex].description=t})}this.errorObj;break}}if(!e){for(const t of this.mpNewsDetails.wechatAttachment)if(!t.description){const e=document.createElement("div");e.innerHTML=t.content;let s=null;e.textContent?s=e.textContent:e.text&&(s=e.text),s&&s.length>54&&(s=s.substring(0,54)),t.description=s}return this.mpNewsDetails}}else if("news"===this.newsType){for(let[t,n]of i()(r=this.newsDetails.wechatAttachment).call(r)){var r;if(this.errorObj.titleEmpty=""===n.title,this.errorObj.titleOverLength=n.title.length>64,this.errorObj.coverImgEmpty=""===n.url,this.errorObj.structuredMessageUrlEmpty=""===n.structureMsgUrl,this.errorObj.summaryOverLength=n.description&&n.description.length>120,e=!!s(),e){if(this.changeCurrentEdit(t),this.errorObj.titleEmpty)this.$refs.newsTitle.focus(),a(this.$refs.newsTitle,"input-empty");else if(this.errorObj.structuredMessageUrlEmpty)this.$refs.newsSource.focus(),a(this.$refs.newsSource,"input-empty");else if(this.errorObj.coverImgEmpty)this.showErrorTip=!0,this.$refs.mpnewsCoverImg.scrollIntoView();else if(this.errorObj.titleOverLength){const t=this.newsDetails.wechatAttachment[this.currentEditIndex].title;this.newsDetails.wechatAttachment[this.currentEditIndex].title="",this.$nextTick(()=>{this.$refs.newsTitle.focus(),this.newsDetails.wechatAttachment[this.currentEditIndex].title=t,a(this.$refs.newsTitle,"input-empty")})}else if(this.errorObj.summaryOverLength){const t=this.newsDetails.wechatAttachment[this.currentEditIndex].description;this.newsDetails.wechatAttachment[this.currentEditIndex].description="",this.$nextTick(()=>{this.$refs.newsSummary.focus(),this.newsDetails.wechatAttachment[this.currentEditIndex].description=t,a(this.$refs.newsSummary,"textarea-overlength")})}this.errorObj;break}}if(!e)return this.newsDetails}},ueditorReady(){const t=this.mpNewsDetails.wechatAttachment[this.currentEditIndex].content;t&&this.$refs.ueditor.updateContent(t)},showToolbarCover(){this.isCoveredToolbar=!0},hideToolBarCover(){this.isCoveredToolbar=!1},closeErrorTip(){this.showErrorTip=!1},selectMergeField(t){this.newsDetails.wechatAttachment[this.currentEditIndex].structureMsgUrl+=t,this.closeMergeField()},setLinkUrl(t){this.newsDetails.wechatAttachment[0].structureMsgUrl=t},onUploadCompleted(t){this.$root.$emit("upload-file-success"),"mpnews"===this.newsType?(this.mpNewsDetails.wechatAttachment[this.currentEditIndex].thumbnailId=t.mediaId,this.mpNewsDetails.wechatAttachment[this.currentEditIndex].url=t.url,this.coverPictures[t.mediaId]=t.url):(this.newsDetails.wechatAttachment[this.currentEditIndex].wechatImageUrl=t.wechatImageUrl,this.newsDetails.wechatAttachment[this.currentEditIndex].thumbnailId=t.mediaId,this.newsDetails.wechatAttachment[this.currentEditIndex].url=t.url)}},beforeDestroy(){"MessageLibrary"===this.$route.meta.permission&&(document.title="Message Library | charket")}},T=(s("tJr4"),s("YdbM"),s("Xn/o")),$=Object(v.a)(N,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-stru-box",attrs:{id:"newStructure"}},[s("div",{staticClass:"new-stru-list slds-scrollable_y"},[s("loading-spinner",{attrs:{"is-loading":t.isLoading,"custom-style":"position: relative;top: 50%;height:50px;"}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"stru-list-title"},[t._v("\n      "+t._s(t.$t("global.strucLabel"))+"\n    ")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"new-stru-first",class:{"selected-article":0===t.currentEditIndex},on:{click:function(e){return t.changeCurrentEdit(0)}}},["mpnews"===t.newsType?s("div",{staticClass:"first-stru-image"},[t.coverPictures[t.mpNewsDetails.wechatAttachment[0].thumbnailId]?t._e():s("div",{staticClass:"default-image"},[s("icon",{attrs:{name:"image",width:"48px",height:"48px","fill-color":"#ffffff","charket-icon":""}})],1),t._v(" "),t.coverPictures[t.mpNewsDetails.wechatAttachment[0].thumbnailId]?s("div",{staticClass:"cover-image"},[s("img",{class:["full-width"===t.mpNewsDetails.wechatAttachment[0].coverImgStyle?"w-cover-img":"h-cover-img"],attrs:{src:t._f("imgFilter")(t.coverPictures[t.mpNewsDetails.wechatAttachment[0].thumbnailId]),alt:""},on:{error:function(e){return t.showErrorImg(e)}}})]):t._e(),t._v(" "),s("div",{staticClass:"first-stru-title"},[t._v("\n          "+t._s(t.mpNewsDetails.wechatAttachment[0].title?t.mpNewsDetails.wechatAttachment[0].title:t.$t("title"))+"\n        ")])]):t._e(),t._v(" "),"news"===t.newsType?s("div",{staticClass:"first-stru-image"},[t.newsDetails.wechatAttachment[0].url?t._e():s("div",{staticClass:"default-image"},[s("icon",{attrs:{name:"image",width:"48px",height:"48px","fill-color":"#ffffff","charket-icon":""}})],1),t._v(" "),t.newsDetails.wechatAttachment[0].url?s("div",{staticClass:"cover-image"},[s("img",{class:["full-width"===t.newsDetails.wechatAttachment[0].coverImgStyle?"w-cover-img":"h-cover-img"],attrs:{src:t._f("imgFilter")(t.newsDetails.wechatAttachment[0].url),alt:""},on:{error:function(e){return t.showErrorImg(e)}}})]):t._e(),t._v(" "),s("div",{staticClass:"first-stru-title"},[t._v("\n          "+t._s(t.newsDetails.wechatAttachment[0].title?t.newsDetails.wechatAttachment[0].title:t.$t("title"))+"\n        ")])]):t._e(),t._v(" "),"news"===t.newsType&&t.newsDetails.wechatAttachment.length>1||"mpnews"===t.newsType&&t.mpNewsDetails.wechatAttachment.length>1?s("div",{staticClass:"stru-toolbar"},[s("div",{staticClass:"button-down",on:{click:function(e){return e.stopPropagation(),t.sortArticle(0,"down")}}},[s("icon",{attrs:{name:"arrowdown",width:"18px",height:"18px","fill-color":"#ffffff","charket-icon":""}})],1)]):t._e()]),t._v(" "),t._l(t.articlesTotal-1,(function(e){return s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"new-stru-others",class:{"selected-article":t.currentEditIndex===e},on:{click:function(s){return t.changeCurrentEdit(e)}}},["mpnews"===t.newsType?s("div",{staticClass:"other-stru-title"},[t._v("\n        "+t._s(t.mpNewsDetails.wechatAttachment[e].title?t.mpNewsDetails.wechatAttachment[e].title:t.$t("title"))+"\n      ")]):t._e(),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"other-stru-image"},[t.coverPictures[t.mpNewsDetails.wechatAttachment[e].thumbnailId]?t._e():s("div",{staticClass:"default-image"},[s("icon",{attrs:{name:"image",width:"30px",height:"30px","fill-color":"#ffffff","charket-icon":""}})],1),t._v(" "),s("img",{directives:[{name:"show",rawName:"v-show",value:t.coverPictures[t.mpNewsDetails.wechatAttachment[e].thumbnailId],expression:"coverPictures[mpNewsDetails.wechatAttachment[i].thumbnailId]"}],class:["full-width"===t.mpNewsDetails.wechatAttachment[e].coverImgStyle?"w-cover-img":"h-cover-img"],attrs:{src:t._f("imgFilter")(t.coverPictures[t.mpNewsDetails.wechatAttachment[e].thumbnailId]),alt:""},on:{error:function(e){return t.showErrorImg(e)}}})]):t._e(),t._v(" "),"news"===t.newsType?s("div",{staticClass:"other-stru-title"},[t._v("\n        "+t._s(t.newsDetails.wechatAttachment[e].title?t.newsDetails.wechatAttachment[e].title:t.$t("title"))+"\n      ")]):t._e(),t._v(" "),"news"===t.newsType?s("div",{staticClass:"other-stru-image"},[t.newsDetails.wechatAttachment[e].url?t._e():s("div",{staticClass:"default-image"},[s("icon",{attrs:{name:"image",width:"30px",height:"30px","fill-color":"#ffffff","charket-icon":""}})],1),t._v(" "),s("img",{directives:[{name:"show",rawName:"v-show",value:t.newsDetails.wechatAttachment[e].url,expression:"newsDetails.wechatAttachment[i].url"}],class:["full-width"===t.newsDetails.wechatAttachment[e].coverImgStyle?"w-cover-img":"h-cover-img"],attrs:{src:t._f("imgFilter")(t.newsDetails.wechatAttachment[e].url),alt:""},on:{error:function(e){return t.showErrorImg(e)}}})]):t._e(),t._v(" "),s("div",{staticClass:"stru-toolbar"},[s("div",{staticClass:"button-up",on:{click:function(s){return s.stopPropagation(),t.sortArticle(e,"up")}}},[s("icon",{attrs:{name:"arrowup",width:"18px",height:"18px","fill-color":"#ffffff","charket-icon":""}})],1),t._v(" "),e<t.articlesTotal-1?s("div",{staticClass:"button-down",on:{click:function(s){return s.stopPropagation(),t.sortArticle(e,"down")}}},[s("icon",{attrs:{name:"arrowdown",width:"18px",height:"18px","fill-color":"#ffffff","charket-icon":""}})],1):t._e(),t._v(" "),"mpnews"!==t.newsType||"edit"!==t.createdInfo.type?s("div",{staticClass:"button-delete",on:{click:function(s){return s.stopPropagation(),t.deleteArticle(e)}}},[s("icon",{attrs:{name:"deleteIcon",width:"18px",height:"18px","fill-color":"#ffffff","charket-icon":""}})],1):t._e()])])})),t._v(" "),t.articlesTotal<8&&("mpnews"!==t.newsType||"edit"!==t.createdInfo.type)&&!t.isLoading?s("div",{staticClass:"new-stru-others add-new-article",on:{click:function(e){return t.addNewArticle()}}},[s("div",{staticClass:"add-article-button"},[s("span",{staticClass:"slds-icon_container slds-icon-text-default"},[s("icon",{attrs:{name:"add",width:"20px",height:"20px","charket-icon":"","class-name":"add-icon"}})],1)])]):t._e()],2),t._v(" "),s("div",{staticClass:"slds-border_left new-stru-wrapper"},[s("div",{staticClass:"slds-grid new-stru-content"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showErrorTip,expression:"showErrorTip"}],staticClass:"slds-text-heading_small error-tip",style:{top:t.errorTop},on:{click:function(e){return t.closeErrorTip()}}},[t._v("\n        "+t._s(t.$t("reviewError"))+"\n      ")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isCoveredToolbar,expression:"isCoveredToolbar"}],staticClass:"toolbar-cover"}),t._v(" "),s("div",{staticClass:"slds-col slds-scrollable_y",class:{"slds-border_top mpnews-wrapper":"mpnews"===t.newsType,"slds-grid slds-grid_vertical only-news-wrapper":"news"===t.newsType,"error-head-mpnews":"mpnews"===t.newsType&&t.showErrorTip}},[s("div",{staticClass:"slds-grid slds-grid_vertical new-stru-head",class:{"error-head-news":t.showErrorTip&&"news"===t.newsType,"only-news-head":"news"===t.newsType}},["mpnews"===t.newsType?s("div",{staticClass:"slds-grid new-stru-title"},[s("i",[t._v("*")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].title,expression:"mpNewsDetails.wechatAttachment[currentEditIndex].title"}],ref:"mpnewsTitle",staticClass:"slds-col",style:{paddingRight:t.titlePadding},attrs:{type:"text",placeholder:t.$t("title")},domProps:{value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].title},on:{focus:function(e){return t.showToolbarCover()},input:function(e){e.target.composing||t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"title",e.target.value)}}}),t._v(" "),s("span",{staticClass:"slds-text-body_small",class:{overLength:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].title.length>64}},[t._v("\n              "+t._s(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].title.length)+"/64\n            ")])]):t._e(),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"slds-grid slds-grid_align-end new-stru-author"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].author,expression:"mpNewsDetails.wechatAttachment[currentEditIndex].author"}],ref:"mpnewsAuthor",style:{paddingRight:t.authorPadding},attrs:{type:"text",placeholder:t.$t("author")},domProps:{value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].author},on:{focus:function(e){return t.showToolbarCover()},input:function(e){e.target.composing||t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"author",e.target.value)}}}),t._v(" "),s("span",{staticClass:"slds-text-body_small",class:{overLength:t.authorLength>8}},[t._v(t._s(t.authorLength)+"/8")])]):t._e(),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"content-star"},[t._v("\n            *\n          ")]):t._e(),t._v(" "),"news"===t.newsType?s("div",{staticClass:"slds-grid slds-grid_align-end new-stru-title slds-border_bottom only-news-title"},[s("i",[t._v("*")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newsDetails.wechatAttachment[t.currentEditIndex].title,expression:"newsDetails.wechatAttachment[currentEditIndex].title"}],ref:"newsTitle",staticClass:"slds-col",style:{paddingRight:t.titlePadding},attrs:{type:"text",placeholder:t.$t("title")},domProps:{value:t.newsDetails.wechatAttachment[t.currentEditIndex].title},on:{input:function(e){e.target.composing||t.$set(t.newsDetails.wechatAttachment[t.currentEditIndex],"title",e.target.value)}}}),t._v(" "),s("span",{staticClass:"slds-text-body_small",class:{overLength:t.newsDetails.wechatAttachment[t.currentEditIndex].title.length>64}},[t._v("\n              "+t._s(t.newsDetails.wechatAttachment[t.currentEditIndex].title.length)+"/64\n            ")])]):t._e(),t._v(" "),"news"===t.newsType?s("div",{staticClass:"slds-grid slds-grid_vertical news-stru-url"},[s("div",{staticClass:"stru-url-title"},[s("i",[t._v("*")]),t._v("\n              "+t._s(t.$t("url"))+"\n            ")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newsDetails.wechatAttachment[t.currentEditIndex].structureMsgUrl,expression:"newsDetails.wechatAttachment[currentEditIndex].structureMsgUrl"}],ref:"newsSource",staticClass:"slds-input",attrs:{type:"text",name:""},domProps:{value:t.newsDetails.wechatAttachment[t.currentEditIndex].structureMsgUrl},on:{input:function(e){e.target.composing||t.$set(t.newsDetails.wechatAttachment[t.currentEditIndex],"structureMsgUrl",e.target.value)}}}),t._v(" "),s("div",{staticClass:"merge-field-icon down-btn",attrs:{title:t.$t("insertFieldLabel")},on:{click:function(e){return t.openMergeField()}}},[s("icon",{staticClass:"link-icon down-icon",attrs:{name:"insertTag",width:"16px",height:"16px","charket-icon":""}})],1)]):t._e()]),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"new-stru-section"},[s("ueditor",{ref:"ueditor",on:{getImages:function(e){return t.openImagePopup("contentPic")},onchange:t.onUeditorChange,ready:t.ueditorReady,editorFocus:function(e){return t.hideToolBarCover()}}}),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"slds-grid slds-grid_vertical new-stru-source"},[s("div",{staticClass:"slds-form-element__control"},[s("label",{staticClass:"slds-checkbox",attrs:{for:"stru-source-url"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].viewedSourceUrl,expression:"mpNewsDetails.wechatAttachment[currentEditIndex].viewedSourceUrl"}],staticClass:"slds-col",attrs:{type:"checkbox",name:"default",id:"stru-source-url"},domProps:{checked:Array.isArray(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].viewedSourceUrl)?t._i(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].viewedSourceUrl,null)>-1:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].viewedSourceUrl},on:{change:function(e){var s=t.mpNewsDetails.wechatAttachment[t.currentEditIndex].viewedSourceUrl,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"viewedSourceUrl",s.concat([null])):n>-1&&t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"viewedSourceUrl",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"viewedSourceUrl",i)}}}),t._v(" "),s("span",{staticClass:"slds-checkbox_faux"}),t._v(" "),s("span",{staticClass:"slds-form-element__label stru-source-label"},[t._v(t._s(t.$t("sourceUrl")))])])]),t._v(" "),t.mpNewsDetails.wechatAttachment[t.currentEditIndex].viewedSourceUrl?s("input",{directives:[{name:"model",rawName:"v-model",value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].contentSourceUrl,expression:"mpNewsDetails.wechatAttachment[currentEditIndex].contentSourceUrl"}],ref:"mpnewsContentSource",staticClass:"slds-input slds-col",attrs:{type:"text"},domProps:{value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].contentSourceUrl},on:{input:function(e){e.target.composing||t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"contentSourceUrl",e.target.value)}}}):t._e()]):t._e()],1):t._e(),t._v(" "),s("div",{staticClass:"slds-col slds-border_top new-stru-footer"},[s("div",{staticClass:"new-stru-publish-style",class:{"only-mpnews-publish":"mpnews"===t.newsType,"only-news-publish":"news"===t.newsType}},[s("div",{ref:"mpnewsCoverImg",staticClass:"slds-grid slds-grid_vertical stru-cover-image"},[s("div",{staticClass:"slds-text-body_small select-title"},[s("i",[t._v("*")]),t._v("\n                "+t._s(t.$t("coverImage"))+"\n                "),s("span",[t._v(t._s(0===t.currentEditIndex?t.$t("recommendedSize",[900,500]):t.$t("recommendedSize",[200,200])))])]),t._v(" "),s("div",{staticClass:"select-button"},[s("message-uploader",{staticClass:"slds-button slds-button_neutral upload-file-btn",attrs:{type:"image","wechat-account-id":t.wechatAccountId},on:{completed:t.onUploadCompleted}},[s("span",{staticClass:"upload-file-btn__label"},[t._v(t._s(t.$t("global.uploadBtn")))])]),t._v(" "),s("button",{staticClass:"slds-button slds-button_neutral image-popup-btn",on:{click:function(e){return t.openImagePopup("coverPic")}}},[t._v(t._s(t.$t("chooseFromLibrary")))])],1),t._v(" "),t.mpNewsDetails.wechatAttachment[t.currentEditIndex]&&t.mpNewsDetails.wechatAttachment[t.currentEditIndex].thumbnailId||t.newsDetails.wechatAttachment[t.currentEditIndex]&&t.newsDetails.wechatAttachment[t.currentEditIndex].url?s("div",{class:[0===t.currentEditIndex?"cover-image-first":"cover-image-others"]},["mpnews"===t.newsType?s("img",{staticClass:"vt-cover-img",attrs:{src:t.coverPictures[t.mpNewsDetails.wechatAttachment[t.currentEditIndex].thumbnailId],alt:""},on:{load:function(e){return t.imgLoad(e)}}}):t._e(),t._v(" "),"news"===t.newsType?s("img",{staticClass:"vt-cover-img",attrs:{src:t.newsDetails.wechatAttachment[t.currentEditIndex].url,alt:""},on:{load:function(e){return t.imgLoad(e)}}}):t._e(),t._v(" "),"mpnews"===t.newsType?s("img",{class:["full-width"===t.mpNewsDetails.wechatAttachment[t.currentEditIndex].coverImgStyle?"w-cover-img":"h-cover-img"],attrs:{src:t._f("imgFilter")(t.coverPictures[t.mpNewsDetails.wechatAttachment[t.currentEditIndex].thumbnailId]),alt:""},on:{error:function(e){return t.showErrorImg(e)}}}):t._e(),t._v(" "),"news"===t.newsType?s("img",{class:["full-width"===t.newsDetails.wechatAttachment[t.currentEditIndex].coverImgStyle?"w-cover-img":"h-cover-img"],attrs:{src:t._f("imgFilter")(t.newsDetails.wechatAttachment[t.currentEditIndex].url),alt:""},on:{error:function(e){return t.showErrorImg(e)}}}):t._e(),t._v(" "),s("div",{staticClass:"cover-image-toolbar"},[s("div",{staticClass:"button-delete",on:{click:function(e){return e.stopPropagation(),t.deleteCoverImage()}}},[s("icon",{attrs:{name:"deleteIcon",width:"18px",height:"18px","fill-color":"#ffffff","charket-icon":""}})],1)])]):t._e(),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"slds-form-element__control"},[s("label",{staticClass:"slds-checkbox",attrs:{for:"stru-cover-pic"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].showCoverPic,expression:"mpNewsDetails.wechatAttachment[currentEditIndex].showCoverPic"}],attrs:{type:"checkbox",name:"default",id:"stru-cover-pic","true-value":1,"false-value":0},domProps:{checked:Array.isArray(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].showCoverPic)?t._i(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].showCoverPic,null)>-1:t._q(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].showCoverPic,1)},on:{change:function(e){var s=t.mpNewsDetails.wechatAttachment[t.currentEditIndex].showCoverPic,a=e.target,i=a.checked?1:0;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"showCoverPic",s.concat([null])):n>-1&&t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"showCoverPic",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"showCoverPic",i)}}}),t._v(" "),s("span",{staticClass:"slds-checkbox_faux"}),t._v(" "),s("span",{staticClass:"slds-form-element__label stru-cover-label"},[t._v(t._s(t.$t("showImageInContent")))])])]):t._e()]),t._v(" "),"mpnews"===t.newsType?s("div",{staticClass:"stru-digest"},[s("div",{staticClass:"slds-text-body_small digest-title"},[t._v("\n                "+t._s(t.$t("summary"))+"\n              ")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].description,expression:"mpNewsDetails.wechatAttachment[currentEditIndex].description"}],ref:"mpnewsSummary",staticClass:"slds-textarea resize-vertical",attrs:{name:"name",rows:"8",cols:"80"},domProps:{value:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].description},on:{input:function(e){e.target.composing||t.$set(t.mpNewsDetails.wechatAttachment[t.currentEditIndex],"description",e.target.value)}}}),t._v(" "),s("div",{staticClass:"word-rest-number",class:{overLength:t.mpNewsDetails.wechatAttachment[t.currentEditIndex].description&&t.mpNewsDetails.wechatAttachment[t.currentEditIndex].description.length>120}},[t._v("\n                "+t._s(120-(t.mpNewsDetails.wechatAttachment[t.currentEditIndex].description?t.mpNewsDetails.wechatAttachment[t.currentEditIndex].description.length:0))+"\n              ")])]):t._e(),t._v(" "),"news"===t.newsType?s("div",{staticClass:"slds-grid slds-grid_vertical stru-digest"},[s("div",{staticClass:"slds-text-body_small digest-title"},[t._v("\n                "+t._s(t.$t("summary"))+"\n              ")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newsDetails.wechatAttachment[t.currentEditIndex].description,expression:"newsDetails.wechatAttachment[currentEditIndex].description"}],ref:"newsSummary",staticClass:"slds-textarea resize-vertical",attrs:{name:"name",rows:"8",cols:"80"},domProps:{value:t.newsDetails.wechatAttachment[t.currentEditIndex].description},on:{input:function(e){e.target.composing||t.$set(t.newsDetails.wechatAttachment[t.currentEditIndex],"description",e.target.value)}}}),t._v(" "),s("div",{staticClass:"word-rest-number",class:{overLength:t.newsDetails.wechatAttachment[t.currentEditIndex].description&&t.newsDetails.wechatAttachment[t.currentEditIndex].description.length>120}},[t._v("\n                "+t._s(120-(t.newsDetails.wechatAttachment[t.currentEditIndex].description?t.newsDetails.wechatAttachment[t.currentEditIndex].description.length:0))+"\n              ")])]):t._e()])])])])]),t._v(" "),s("image-popup",{ref:"imagepopupmodel",attrs:{"acc-id":t.wechatAccountId,"header-content":t.$t("global.popupHeader.selectImage"),"popup-type":"image","is-multi-select":!1},on:{getSelectedMessage:t.getSelectedMessage}}),t._v(" "),t.showMergeField?s("select-field",{attrs:{"page-name":"STRUCTURED MESSAGES"},on:{"close-merge-field":function(e){return t.closeMergeField()},"select-merge-field":t.selectMergeField}}):t._e()],1)}),[],!1,null,"228b38a8",null);"function"==typeof T.default&&Object(T.default)($);e.a=$.exports},EaUY:function(t,e,s){"use strict";var a=s("+1Cy");s.n(a).a},EcAN:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"formLabel":"表单","formNameLabel":"表单名称","nameLabel":"名称","sfObjectLabel":"关联对象","recordLabel":"记录类型","noteLabel":"备注","titleLabel":"标题","bannerLabel":"横幅","formPreviewLabel":"表单预览","editableLabel":"参会者可以在提交后修改信息"},"en":{"formLabel":"Form | Forms","formNameLabel":"Form Name","nameLabel":"Name","sfObjectLabel":"Salesforce Object","recordLabel":"Record Type","noteLabel":"Note","titleLabel":"Title","bannerLabel":"Banner","formPreviewLabel":"Form Preview","editableLabel":"Attendees can edit response after submit"}}'),delete t.options._Ctor}},Ek5D:function(t,e,s){"use strict";var a=s("94pc");s.n(a).a},F5n2:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"weChatLabel":"微信","backLabel":"返回","detailsLabel":"详情","templateSettingLabel":"模板设置","urlLabel":"链接","informationLabel":"附加信息","noteLabel":"备注","placeholderLabel":"可选的"},"en":{"weChatLabel":"WeChat","backLabel":"Back","detailsLabel":"Details","templateSettingLabel":"Template Settings","urlLabel":"URL","informationLabel":"Additional Information","noteLabel":"NOTE","placeholderLabel":"Optional"}}'),delete t.options._Ctor}},F5n6:function(t,e,s){"use strict";var a={props:{paginations:{type:Array},pageNumber:{type:Number,default:1}},data:()=>({currentPageNumber:1}),created(){this.currentPageNumber=this.pageNumber},methods:{changePageNumber(t,e){this.currentPageNumber="pre"===e?this.currentPageNumber-1:"next"===e?this.currentPageNumber+1:t,this.$emit("target",this.currentPageNumber)}}},i=(s("hkfk"),s("KHd+")),n=s("k/9o"),o=Object(i.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.paginations.length>1?s("ul",{staticClass:"slds-grid slds-grid_align-center pagination"},[s("li",{staticClass:"page-turning-pre",attrs:{title:t.$t("preTitle")}},[t.currentPageNumber>1?s("a",{staticClass:"page-turning",attrs:{id:"previousPage"},on:{click:function(e){return t.changePageNumber("","pre")}}},[s("icon",{attrs:{name:"left","text-color":"default",size:"x-small","charket-icon":""}})],1):s("a",{staticClass:"disabled page-turning",attrs:{id:"previousPageDisabled",disabled:"true"}},[s("icon",{attrs:{name:"left","text-color":"default",size:"x-small","charket-icon":""}})],1)]),t._v(" "),t._l(t.paginations,(function(e){return s("li",{staticClass:"middle-page-number"},[0!==e.PageNumber?s("a",{class:{currentPage:e.PageNumber===t.currentPageNumber},on:{click:function(s){return t.changePageNumber(e.PageNumber)}}},[t._v(t._s(e.PageNumber))]):s("a",[t._v("...")])])})),t._v(" "),s("li",{staticClass:"page-turning-pre",attrs:{title:t.$t("nextTitle")}},[t.paginations[t.paginations.length-1].PageNumber!==t.currentPageNumber?s("a",{staticClass:"page-turning",attrs:{id:"nextPage"},on:{click:function(e){return t.changePageNumber("","next")}}},[s("icon",{attrs:{name:"right","text-color":"default",size:"x-small","charket-icon":""}})],1):s("a",{staticClass:"disabled page-turning",attrs:{id:"nextPageDisabled",disabled:"true"}},[s("icon",{attrs:{name:"right","text-color":"default",size:"x-small","charket-icon":""}})],1)])],2):t._e()}),[],!1,null,"430ba9bf",null);"function"==typeof n.default&&Object(n.default)(o);e.a=o.exports},FEoC:function(t,e,s){},FK88:function(t,e,s){"use strict";var a={props:{size:{type:String,default:"12mm x 12mm"},orientation:{type:String,default:"Landscape"},body:{type:String,default:""}},computed:{currentSize(){if(this.size){const t=this.size.split("x"),e=3.75*Number(t[0].replace(/[^0-9]/gi,""))+10,s=3.75*Number(t[1].replace(/[^0-9]/gi,""))+10;return"Portrait"===this.orientation?e>s?{width:s+"px",height:e+"px"}:{width:e+"px",height:s+"px"}:e>s?{width:e+"px",height:s+"px"}:{width:s+"px",height:e+"px"}}return{width:"55px",height:"55px"}}}},i=(s("bwDH"),s("KHd+")),n=Object(i.a)(a,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"badge-area",style:this.currentSize,domProps:{innerHTML:this._s(this.body)}})}),[],!1,null,"6186bcfe",null);e.a=n.exports},Fblv:function(t,e,s){"use strict";var a=s("O2ea");s.n(a).a},Fip8:function(t,e,s){"use strict";var a=s("q6or");s.n(a).a},"HA+Y":function(t,e,s){},HaPu:function(t,e,s){"use strict";var a=s("8YXT"),i=s.n(a);e.default=i.a},Hi2j:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"type":"类型","name":"名称","expirationDate":"过期日期","quantity":"数量","status":"状态","to":"至"},"en":{"type":"Type","name":"Name","expirationDate":"Expiration Date","quantity":"Quantity","status":"Status","to":"to"}}'),delete t.options._Ctor}},I0LH:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"newPassTitle":"新建凭证","passForApproval":"凭证已提交审批！"},"en":{"newPassTitle":"New Pass","passForApproval":"The pass was submitted for approval."}}'),delete t.options._Ctor}},Igzh:function(t,e,s){},ItEM:function(t,e,s){"use strict";var a=s("tAMZ"),i=s.n(a);e.default=i.a},IzIm:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"title":"标题","author":"作者","reviewError":"检查此页面上的错误。","url":"链接","coverImage":"封面图","chooseFromLibrary":"从图片库选择","summary":"摘要","showImageInContent":"在内容中展示图片","sourceUrl":"原文链接","recommendedSize":"推荐尺寸为{0}像素 * {1}像素","insertFieldLabel":"插入合并字段"},"en":{"title":"Title","author":"Author","reviewError":"Review the errors on this page.","url":"URL","coverImage":"Cover Image","chooseFromLibrary":"Choose From Library","summary":"Summary","showImageInContent":"Show image in content","sourceUrl":"Source URL","recommendedSize":"The recommended image resolution is {0}px by {1}px.","insertFieldLabel":"Insert merge field"}}'),delete t.options._Ctor}},Jz0g:function(t,e,s){"use strict";var a=s("f9CC"),i=s.n(a);e.default=i.a},L5tX:function(t,e,s){"use strict";var a=s("0JIZ"),i=s.n(a);e.default=i.a},LgZB:function(t,e,s){},LsMU:function(t,e,s){!function(t,e){"use strict";var s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])})(t,e)};function a(t,e,s,a){var i,n=arguments.length,o=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,s):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,s,a);else for(var r=t.length-1;0<=r;r--)(i=t[r])&&(o=(n<3?i(o):3<n?i(e,s,o):i(e,s))||o);return 3<n&&o&&Object.defineProperty(e,s,o),o}function i(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}var n,o=(function(t,e){function a(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}(r,n=e.Vue),a([e.Prop({type:String}),i("design:type",String)],r.prototype,"name",void 0),a([e.Prop({type:Boolean,default:!1}),i("design:type",Boolean)],r.prototype,"outlined",void 0),a([e.Prop({type:Boolean,default:!1}),i("design:type",Boolean)],r.prototype,"internal",void 0),r=a([e.Component({})],r));function r(){return null!==n&&n.apply(this,arguments)||this}var c,l="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase()),d={};function h(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-grid slds-grid_vertical wrapper",class:{"slds-box":t.outlined}},[s("div",{staticClass:"slds-truncate slds-text-heading_small name",attrs:{title:t.name}},[t._v(t._s(t.name))]),t._v(" "),s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("span",{staticClass:"slds-checkbox"},[s("input",{attrs:{type:"checkbox",name:"options",disabled:""},domProps:{checked:t.internal}}),t._v(" "),t._m(0)])])])])}var u=o;h._withStripped=!0;var p=function(t,e,s,a,i,n,o,r,c,l){"boolean"!=typeof o&&(c=r,r=o,o=!1);var d,h="function"==typeof s?s.options:s;if(t&&t.render&&(h.render=t.render,h.staticRenderFns=t.staticRenderFns,h._compiled=!0,i&&(h.functional=!0)),a&&(h._scopeId=a),n?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,c(t)),t&&t._registeredComponents&&t._registeredComponents.add(n)},h._ssrRegister=d):e&&(d=o?function(t){e.call(this,l(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,r(t))}),d)if(h.functional){var u=h.render;h.render=function(t,e){return d.call(e),u(t,e)}}else{var p=h.beforeCreate;h.beforeCreate=p?[].concat(p,d):[d]}return s}({render:h,staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("label",{staticClass:"slds-checkbox__label"},[e("span",{staticClass:"slds-checkbox_faux"}),this._v(" "),e("span",{staticClass:"slds-form-element__label"},[this._v("Internal")])])}]},(function(t){t&&t("data-v-06ef5832_0",{source:".wrapper[data-v-06ef5832] {\n  width: 239px;\n  height: 83px;\n  margin-top: 13px;\n  padding: 16px;\n}\n.name[data-v-06ef5832] {\n  color: #080707;\n  line-height: 28px;\n}",map:void 0,media:void 0})}),u,"data-v-06ef5832",!1,void 0,!1,(function(t){return function(t,e){return function(t,e){var s=l?e.media||"default":t,a=d[s]||(d[s]={ids:new Set,styles:[]});if(!a.ids.has(t)){a.ids.add(t);var i=e.source;if(e.map&&(i+="\n/*# sourceURL="+e.map.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e.map))))+" */"),a.element||(a.element=document.createElement("style"),a.element.type="text/css",e.media&&a.element.setAttribute("media",e.media),void 0===c&&(c=document.head||document.getElementsByTagName("head")[0]),c.appendChild(a.element)),"styleSheet"in a.element)a.styles.push(i),a.element.styleSheet.cssText=a.styles.filter(Boolean).join("\n");else{var n=a.ids.size-1,o=document.createTextNode(i),r=a.element.childNodes;r[n]&&a.element.removeChild(r[n]),r.length?a.element.insertBefore(o,r[n]):a.element.appendChild(o)}}}(t,e)}}),void 0,void 0);t.SkillDetailCard=p,t.default=function(t){t.component("SkillDetailCard",p)},Object.defineProperty(t,"__esModule",{value:!0})}(e,s("YKMj"))},N3N8:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"qrCodeRegisterNumberTitle":"你想要创建多少注册二维码?","qrCodeCheckInNumberTitle":"你想要创建多少签到二维码?","qrCodeNumberLimitLabel":"最多五个","qrCodeDayTitle":"二维码的有效期","qrCodeDayLimitLabel":"最多三十天","expireLabel":"不过期","registerMessageLabel":"自动返回给用户提示其注册活动的消息是？","checkInMessageLabel":"自动返回给未注册用户提示其现场注册消息是？","newMsgLabel":"新建消息","selectMsgLabel":"选择消息","noQRCodeLabel":"无二维码","downloadLabel":"下载","submitLabel":"提交","submittingLabel":"提交中","textLabel":"文本","strucLabel":"图文","hourLabel":"小时","dayLabel":"天","expiredLabel":"已过期","expireInLabel":"有效时间","expireMinuteLabel":"分钟","expireHoursLabel":"小时","expireDayLabel":"天","defaultMsgLabel":"例如，请点击这里报名活动。","deactivateModalTitleLabel":"禁用二维码","deactivateModalContentLabel":"你确定要禁用这个二维码吗?","deactivateSuccessLabel":"二维码已被禁用。","qrResponseHeader":"检查响应消息","qrResponseContent":"当前二维码回复中包含的表单和{0}表单不一致，可能会导致{0}失败。","confirmSave":"继续使用","reselect":"重新选择"},"en":{"qrCodeRegisterNumberTitle":"How many registration QR codes do you want to create?","qrCodeCheckInNumberTitle":"How many check-in QR codes do you want to create?","qrCodeNumberLimitLabel":"Up to 5 per request","qrCodeDayTitle":"How long will QR codes be valid?","qrCodeDayLimitLabel":"Up to 30 days","expireLabel":"Do not expire","registerMessageLabel":"What’s the auto response message after scanning the QR code?","checkInMessageLabel":"What’s the auto response message for the onsite registration?","newMsgLabel":"New Message","selectMsgLabel":"Select Message","noQRCodeLabel":"No QR Codes","downloadLabel":"Download","submitLabel":"Submit","submittingLabel":"Submitting","textLabel":"Text","strucLabel":"Structured Message","hourLabel":"Hour(s)","dayLabel":"Day(s)","expiredLabel":"Expired","expireInLabel":"Expires in","expireMinuteLabel":"minute | minutes","expireHoursLabel":"hour | hours","expireDayLabel":"day | days","defaultMsgLabel":"E.g. Please click here to sign up the event.","deactivateModalTitleLabel":"Deactivate QR Code","deactivateModalContentLabel":"Are you sure you want to deactivate this QR code?","deactivateSuccessLabel":"The QR code was deactivated.","qrResponseHeader":"Check Response Message","qrResponseContent":"The form selected for the QR code auto response is different from the form selected for the event {0}. This will cause issues with the event {0}.","confirmSave":"Continue","reselect":"Reselect"}}'),delete t.options._Ctor}},NCd6:function(t,e,s){},NIFb:function(t,e,s){"use strict";var a=s("PUsS"),i=s.n(a);e.default=i.a},NJYw:function(t,e,s){"use strict";var a=s("6THU");s.n(a).a},NflP:function(t,e,s){"use strict";var a=s("w/3m"),i=s.n(a);e.default=i.a},NlwA:function(t,e,s){"use strict";var a=s("nCab");s.n(a).a},O2ea:function(t,e,s){},OBMq:function(t,e,s){"use strict";var a=s("FEoC");s.n(a).a},OH8b:function(t,e,s){"use strict";var a=s("o86H"),i=s.n(a);e.default=i.a},OMe9:function(t,e,s){"use strict";var a=s("szQD");s.n(a).a},OWFR:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"name":"名称","startDate":"开始日期","endDate":"结束日期","quantity":"数量","createdBy":"最后修改信息"},"en":{"name":"Name","startDate":"Start Date","endDate":"End Date","quantity":"Quantity","createdBy":"Created By"}}'),delete t.options._Ctor}},PI8L:function(t,e,s){"use strict";var a=s("AsmZ");s.n(a).a},PUsS:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"newTitle":"新建微信市场活动","editTitle":"编辑微信市场活动","accountLabel":"微信公众号","tagsLabel":"微信关注者标签","overwriteLabel":"覆盖存在的关注者标签"},"en":{"newTitle":"New WeChat Campaign","editTitle":"Edit WeChat Campaign","accountLabel":"WeChat Account","tagsLabel":"WeChat Follower Tags","overwriteLabel":"Overwrite existing followers’ tag(s)"}}'),delete t.options._Ctor}},Pjfr:function(t,e,s){!function(t,e){"use strict";var s=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t){var e=function(t){var e,s=Object.prototype,a=s.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",r=i.toStringTag||"@@toStringTag";function c(t,e,s,a){var i=e&&e.prototype instanceof g?e:g,n=Object.create(i.prototype),o=new L(a||[]);return n._invoke=function(t,e,s){var a=d;return function(i,n){if(a===u)throw new Error("Generator is already running");if(a===p){if("throw"===i)throw n;return T()}for(s.method=i,s.arg=n;;){var o=s.delegate;if(o){var r=x(o,s);if(r){if(r===m)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(a===d)throw a=p,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);a=u;var c=l(t,e,s);if("normal"===c.type){if(a=s.done?p:h,c.arg===m)continue;return{value:c.arg,done:s.done}}"throw"===c.type&&(a=p,s.method="throw",s.arg=c.arg)}}}(t,s,o),n}function l(t,e,s){try{return{type:"normal",arg:t.call(e,s)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var d="suspendedStart",h="suspendedYield",u="executing",p="completed",m={};function g(){}function f(){}function v(){}var w={};w[n]=function(){return this};var b=Object.getPrototypeOf,C=b&&b(b(N([])));C&&C!==s&&a.call(C,n)&&(w=C);var _=v.prototype=g.prototype=Object.create(w);function y(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function k(t,e){var s;this._invoke=function(i,n){function o(){return new e((function(s,o){!function s(i,n,o,r){var c=l(t[i],t,n);if("throw"!==c.type){var d=c.arg,h=d.value;return h&&"object"==typeof h&&a.call(h,"__await")?e.resolve(h.__await).then((function(t){s("next",t,o,r)}),(function(t){s("throw",t,o,r)})):e.resolve(h).then((function(t){d.value=t,o(d)}),(function(t){return s("throw",t,o,r)}))}r(c.arg)}(i,n,s,o)}))}return s=s?s.then(o,o):o()}}function x(t,s){var a=t.iterator[s.method];if(a===e){if(s.delegate=null,"throw"===s.method){if(t.iterator.return&&(s.method="return",s.arg=e,x(t,s),"throw"===s.method))return m;s.method="throw",s.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=l(a,t.iterator,s.arg);if("throw"===i.type)return s.method="throw",s.arg=i.arg,s.delegate=null,m;var n=i.arg;return n?n.done?(s[t.resultName]=n.value,s.next=t.nextLoc,"return"!==s.method&&(s.method="next",s.arg=e),s.delegate=null,m):n:(s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,m)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function N(t){if(t){var s=t[n];if(s)return s.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function s(){for(;++i<t.length;)if(a.call(t,i))return s.value=t[i],s.done=!1,s;return s.value=e,s.done=!0,s};return o.next=o}}return{next:T}}function T(){return{value:e,done:!0}}return f.prototype=_.constructor=v,v.constructor=f,v[r]=f.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,r in t||(t[r]="GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},y(k.prototype),k.prototype[o]=function(){return this},t.AsyncIterator=k,t.async=function(e,s,a,i,n){void 0===n&&(n=Promise);var o=new k(c(e,s,a,i),n);return t.isGeneratorFunction(s)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},y(_),_[r]="Generator",_[n]=function(){return this},_.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var s in t)e.push(s);return e.reverse(),function s(){for(;e.length;){var a=e.pop();if(a in t)return s.value=a,s.done=!1,s}return s.done=!0,s}},t.values=N,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var s in this)"t"===s.charAt(0)&&a.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var s=this;function i(a,i){return r.type="throw",r.arg=t,s.next=a,i&&(s.method="next",s.arg=e),!!i}for(var n=this.tryEntries.length-1;0<=n;--n){var o=this.tryEntries[n],r=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var s=this.tryEntries.length-1;0<=s;--s){var i=this.tryEntries[s];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var n=i;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var o=n?n.completion:{};return o.type=t,o.arg=e,n?(this.method="next",this.next=n.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var s=this.tryEntries[e];if(s.finallyLoc===t)return this.complete(s.completion,s.afterLoc),I(s),m}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var s=this.tryEntries[e];if(s.tryLoc===t){var a=s.completion;if("throw"===a.type){var i=a.arg;I(s)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,s,a){return this.delegate={iterator:N(t),resultName:s,nextLoc:a},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}));function a(t,e,s,a,i,n,o){try{var r=t[n](o),c=r.value}catch(t){return void s(t)}r.done?e(c):Promise.resolve(c).then(a,i)}var i,n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])})(t,e)};function o(t,e){function s(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}function r(t,e,s,a){var i,n=arguments.length,o=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,s):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,s,a);else for(var r=t.length-1;0<=r;r--)(i=t[r])&&(o=(n<3?i(o):3<n?i(e,s,o):i(e,s))||o);return 3<n&&o&&Object.defineProperty(e,s,o),o}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(){var t=null!==i&&i.apply(this,arguments)||this;return t.functional=!0,t}function d(t,e,s,a,i,n,o,r,c,l){"boolean"!=typeof o&&(c=r,r=o,o=!1);var d,h="function"==typeof s?s.options:s;if(t&&t.render&&(h.render=t.render,h.staticRenderFns=t.staticRenderFns,h._compiled=!0,i&&(h.functional=!0)),a&&(h._scopeId=a),n?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,c(t)),t&&t._registeredComponents&&t._registeredComponents.add(n)},h._ssrRegister=d):e&&(d=o?function(t){e.call(this,l(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,r(t))}),d)if(h.functional){var u=h.render;h.render=function(t,e){return d.call(e),u(t,e)}}else{var p=h.beforeCreate;h.beforeCreate=p?[].concat(p,d):[d]}return s}var h,u=d({},void 0,(o(l,i=e.Vue),Object.defineProperty(l.prototype,"html",{get:function(){return this.content||"<svg></svg>"},enumerable:!0,configurable:!0}),l.prototype.render=function(t){var e;return null!==(e=this.content)&&void 0!==e&&e.startsWith("#")?this.renderSvgLink(t,this.content):this.renderSvgElement(t,this.html)},l.prototype.renderSvgLink=function(t,e){var s='\n      <svg xmlns:xlink="http://www.w3.org/1999/xlink">\n        <use xlink:href="'+e+'" />\n      </svg>\n    ';return this.renderSvgElement(t,s)},l.prototype.renderSvgElement=function(t,e){var s=this.parseSvgElement(e),a={"aria-hidden":"true"};return Array.from(s.attributes).forEach((function(t){"id"!==t.name&&(a[t.name]=t.value)})),t("svg",{attrs:a,domProps:{innerHTML:s.innerHTML}})},l.prototype.parseSvgElement=function(t){return(new DOMParser).parseFromString(t,"image/svg+xml").children[0]},r([e.Prop({type:String,required:!0}),c("design:type",String)],l.prototype,"content",void 0),l=r([e.Component({})],l)),void 0,void 0,void 0,!1,void 0,void 0,void 0),p=["xx-small","x-small","small","medium","large"],m=(o(g,h=e.Vue),Object.defineProperty(g.prototype,"classes",{get:function(){var t=[];this.color&&t.push("slds-spinner_"+this.color);var e=Object.keys(this.$attrs).filter((function(t){return p.includes(t)})).pop()||"medium";return t.push("slds-spinner_"+e),t},enumerable:!0,configurable:!0}),g.prototype.render=function(t){var e=this.renderSpinner(t);return this.container&&"false"!==this.container.toString()?t("div",{staticClass:"slds-spinner_container"},[e]):e},g.prototype.renderSpinner=function(t){var e=[t("span",{class:"slds-assistive-text"},"Loading"),t("div",{class:"slds-spinner__dot-a"}),t("div",{class:"slds-spinner__dot-b"})];return t("div",{attrs:{role:"status"},staticClass:"slds-spinner ld-spinner",class:this.classes},e)},r([e.Prop({type:[Boolean,String]}),c("design:type",Object)],g.prototype,"container",void 0),r([e.Prop({type:String}),c("design:type",String)],g.prototype,"color",void 0),g=r([e.Component({})],g));function g(){var t=null!==h&&h.apply(this,arguments)||this;return t.functional=!0,t}var f,v="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function w(t){return function(t,e){return function(t,e){var s=v?e.media||"default":t,a=b[s]||(b[s]={ids:new Set,styles:[]});if(!a.ids.has(t)){a.ids.add(t);var i=e.source;if(e.map&&(i+="\n/*# sourceURL="+e.map.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e.map))))+" */"),a.element||(a.element=document.createElement("style"),a.element.type="text/css",e.media&&a.element.setAttribute("media",e.media),void 0===f&&(f=document.head||document.getElementsByTagName("head")[0]),f.appendChild(a.element)),"styleSheet"in a.element)a.styles.push(i),a.element.styleSheet.cssText=a.styles.filter(Boolean).join("\n");else{var n=a.ids.size-1,o=document.createTextNode(i),r=a.element.childNodes;r[n]&&a.element.removeChild(r[n]),r.length?a.element.insertBefore(o,r[n]):a.element.appendChild(o)}}}(t,e)}}var b={};function C(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-combobox_container ld-picklist"},[s("div",{staticClass:"slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click",class:{"slds-is-open":t.showDropdown},attrs:{"aria-expanded":"true","aria-haspopup":"listbox",role:"combobox"}},[s("div",{staticClass:"slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right",attrs:{role:"none"}},[s("input",{ref:"ComboboxInput",staticClass:"slds-input slds-combobox__input slds-combobox__input-value ld-picklist__input",class:{disabled:t.disabled},attrs:{placeholder:t.placeholder,disabled:t.disabled,type:"text",autocomplete:"off",role:"textbox",readonly:""},domProps:{value:t.text},on:{click:function(e){return t.onClickCombobox()}}}),t._v(" "),s("span",{staticClass:"slds-icon_container slds-icon-utility-down slds-input__icon slds-input__icon_right"},[t._t("default",[s("ld-svg",{staticClass:"slds-icon slds-icon_xx-small slds-icon-text-default",attrs:{content:t.downSvg}})])],2)]),t._v(" "),s("div",{ref:"DropdownMenu",staticClass:"slds-dropdown slds-dropdown_fluid",class:[t.menuRowsClass],style:t.menuPositionStyle,attrs:{role:"listbox"}},[s("ul",{staticClass:"slds-listbox slds-listbox_vertical",attrs:{role:"group"}},[t.optionHeader?s("li",{staticClass:"slds-listbox__item",attrs:{role:"presentation"}},[s("div",{staticClass:"slds-media slds-listbox__option slds-listbox__option_plain",attrs:{role:"presentation"}},[s("h3",{staticClass:"slds-listbox__option-header",attrs:{role:"presentation"}},[t._v("\n              "+t._s(t.optionHeader)+"\n            ")])])]):t._e(),t._v(" "),t.noRecordVisible?s("li",{staticClass:"slds-listbox__item",attrs:{role:"presentation"}},[s("div",{staticClass:"slds-listbox__option slds-listbox__option_plain",attrs:{role:"presentation"}},[s("div",{staticClass:"ld-picklist__no-record",attrs:{role:"presentation"}},[t._v("\n              "+t._s(t.noRecordsLabel)+"\n            ")])])]):t._e(),t._v(" "),t._l(t.items,(function(e,a){return s("li",{key:a,staticClass:"slds-listbox__item",attrs:{role:"presentation"},on:{click:function(e){return t.onClickOption(a)}}},[s("div",{staticClass:"slds-media slds-listbox__option slds-listbox__option_plain slds-media_small slds-media_center",class:{"slds-is-selected":t.isOptionSelected(a)},attrs:{role:"option"}},[s("span",{staticClass:"slds-media__figure"},[s("ld-svg",{staticClass:"slds-icon slds-icon_x-small slds-listbox__icon-selected",attrs:{content:t.checkSvg}})],1),t._v(" "),s("span",{staticClass:"slds-media__body"},[s("span",{staticClass:"slds-truncate",attrs:{title:e.label}},[t._v("\n                "+t._s(e.label)+"\n              ")])])])])}))],2),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isLoadingItems,expression:"isLoadingItems"}],staticClass:"ld-picklist__loading-container"},[s("ld-spinner",{attrs:{small:"",color:"brand"}})],1)])])])}var _=d({},(function(t){t&&t("data-v-faededbc_0",{source:".ld-spinner[data-v-faededbc] {\n  position: relative !important;\n  z-index: 9000 !important;\n}",map:void 0,media:void 0})}),m,"data-v-faededbc",void 0,void 0,!1,w,void 0,void 0),y={components:{LdSvg:u,LdSpinner:_},props:{options:{type:[Array,Function],required:!0},placeholder:{type:String,default:function(){return""}},optionHeader:{type:String,default:function(){return""}},value:{type:[String,Boolean],default:function(){return""}},disabled:{type:Boolean,default:!1},invertSelect:{type:Boolean,default:!1},menuRows:{type:Number,default:5},menuPosition:{type:String,default:"left"},width:{type:Number,default:0},noRecordsLabel:{type:String,default:"No Records"}},data:function(){return{items:[],isItemsLoaded:!1,isLoadingItems:!1,selectedIndex:this.getSelectedIndex(),showDropdown:!1,onClickDocument:null,downSvg:'<?xml version="1.0"?><svg xmlns="http://www.w3.org/2000/svg" width="52" height="52" viewBox="0 0 52 52"><path d="m8.3 14h35.4c1 0 1.7 1.3 0.9 2.2l-17.3 21.2c-0.6 0.8-1.9 0.8-2.5 0l-17.5-21.2c-0.7-0.9-0.1-2.2 1-2.2z"></path></svg>',checkSvg:'<?xml version="1.0"?><svg xmlns="http://www.w3.org/2000/svg" width="52" height="52" viewBox="0 0 52 52"><path d="m19.1 42.5l-16.5-16.6c-0.6-0.6-0.6-1.6 0-2.2l2.2-2.2c0.6-0.6 1.6-0.6 2.2 0l12.4 12.5c0.4 0.4 1.1 0.4 1.5 0l24.3-24.5c0.6-0.6 1.6-0.6 2.2 0l2.2 2.2c0.6 0.6 0.6 1.6 0 2.2l-28.3 28.6c-0.6 0.7-1.6 0.7-2.2 0z"></path></svg>',menuPositionStyle:""}},computed:{text:function(){return-1!==this.selectedIndex&&this.items[this.selectedIndex]?this.items[this.selectedIndex].label:""},menuRowsClass:function(){if(![5,7,10].includes(Number(this.menuRows)))throw new Error("The menu-rows option is only supported for these values: 5, 7, 10");return"slds-dropdown_length-".concat(this.menuRows)},noRecordVisible:function(){return 0===this.items.length&&this.isItemsLoaded}},mounted:function(){var t=this;this.attachEventListeners(),Array.isArray(this.options)&&(this.items=this.options,this.isItemsLoaded=!0),this.$nextTick((function(){window.addEventListener("resize",t.resizePage),window.addEventListener("mousewheel",t.resizePage),window.addEventListener("DOMMouseScroll",t.resizePage)}))},beforeDestroy:function(){document.removeEventListener("click",this.onClickDocument),window.removeEventListener("resize",this.resizePage),window.removeEventListener("mousewheel",this.resizePage),window.removeEventListener("DOMMouseScroll",this.resizePage)},methods:{getSelectedIndex:function(){var t=this;return Array.isArray(this.items)&&this.value?this.items.findIndex((function(e){return e.value===t.value})):-1},isOptionSelected:function(t){return this.selectedIndex===t},onClickCombobox:function(){this.showDropdown=!this.showDropdown},onClickOption:function(t){this.invertSelect&&this.selectedIndex===t?this.selectedIndex=-1:this.selectedIndex=t;var e=this.items[this.selectedIndex];this.$emit("change",e),this.showDropdown=!1},attachEventListeners:function(){var t=this;this.onClickDocument=function(e){var s=e.target===t.$refs.ComboboxInput;t.isClickEventInDropdownMenu(e)||s||(t.showDropdown=!1)},document.addEventListener("click",this.onClickDocument)},isClickEventInDropdownMenu:function(t){var e=this;return function t(s){return s===e.$refs.DropdownMenu||!!s.parentElement&&t(s.parentElement)}(t.srcElement)},reset:function(t){0<arguments.length&&void 0!==t&&t?this.selectedIndex=this.getSelectedIndex():(this.isItemsLoaded=!1,this.isLoadingItems=!1,this.items=[],this.selectedIndex=-1,this.showDropdown=!1)},resizePage:function(){this.showDropdown&&this.setMenuPositionStyle()},setMenuPositionStyle:function(){var t=this.$refs.ComboboxInput;if(t){var e=t.getBoundingClientRect();this.menuPositionStyle=this.calculateMenuPositionStyle(e)}},calculateMenuPositionStyle:function(t){var e=this.calculateMenuHeight(),s=this.calculateMenuWidth(t),a=this.calculateMenuHorizontalValue(t);return window.innerHeight-t.bottom>=e?"position: fixed; top: ".concat(t.bottom,"px; ").concat(a,"; width: ").concat(s,"px;"):t.top>=e?"position: fixed; top: ".concat(t.top-e,"px; ").concat(a,"; width: ").concat(s,"px;"):"position: fixed; top: ".concat(t.top-e/2,"px; ").concat(a,"; width: ").concat(s,"px;")},calculateMenuHorizontalValue:function(t){return"left"===this.menuPosition?"right: ".concat(window.innerWidth-t.right,"px; left: auto"):"left: ".concat(t.left,"px; right: auto")},calculateMenuHeight:function(){var t=Math.min(this.menuRows,this.items.length);return this.optionHeader?35*t+37+14:35*t+14},calculateMenuWidth:function(t){return this.width?this.width:t.width}},watch:{options:function(t){Array.isArray(t)&&(this.items=t)},value:function(){this.selectedIndex=this.getSelectedIndex()},items:function(t,e){0===e.length&&Array.isArray(this.options)&&(this.selectedIndex=this.getSelectedIndex())},showDropdown:function(t){var e=this;return function(t){return function(){var e=this,s=arguments;return new Promise((function(i,n){var o=t.apply(e,s);function r(t){a(o,i,n,r,c,"next",t)}function c(t){a(o,i,n,r,c,"throw",t)}r(void 0)}))}}(s.mark((function a(){return s.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(e.setMenuPositionStyle(),!t||e.isItemsLoaded||Array.isArray(e.options))return s.abrupt("return");s.next=3;break;case 3:return e.isLoadingItems=!0,s.next=6,e.options();case 6:e.items=s.sent,e.setMenuPositionStyle(),e.selectedIndex=e.getSelectedIndex(),e.isLoadingItems=!1,e.isItemsLoaded=!0;case 11:case"end":return s.stop()}}),a)})))()}}};C._withStripped=!0;var k=d({render:C,staticRenderFns:[]},(function(t){t&&t("data-v-a57e9d0e_0",{source:".ld-picklist__input[data-v-a57e9d0e] {\n  cursor: pointer;\n}\n.ld-picklist__input.disabled[data-v-a57e9d0e] {\n  cursor: not-allowed;\n  background-color: #ecebea;\n  border-color: #c9c7c5;\n}\n.ld-picklist__input[data-v-a57e9d0e]::-webkit-input-placeholder {\n  color: #080707;\n}\n.ld-picklist__input[data-v-a57e9d0e]:-moz-placeholder {\n  color: #080707;\n}\n.ld-picklist__input[data-v-a57e9d0e]:-ms-input-placeholder {\n  color: #080707;\n}\n.ld-picklist__loading-container[data-v-a57e9d0e] {\n  height: 35px;\n}\n.ld-picklist__no-record[data-v-a57e9d0e] {\n  text-align: center;\n}\n.ld-picklist .slds-dropdown[data-v-a57e9d0e] {\n  transform: none;\n}",map:void 0,media:void 0})}),y,"data-v-a57e9d0e",!1,void 0,!1,w,void 0,void 0);t.LdPicklist=k,t.default=function(t){t.component("LdPicklist",k)},Object.defineProperty(t,"__esModule",{value:!0})}(e,s("YKMj"))},Poeg:function(t,e,s){"use strict";var a=s("TCjm");s.n(a).a},QvEr:function(t,e,s){},S26R:function(t,e,s){"use strict";s.r(e);var a=s("autp"),i=s.n(a),n=s("vQrK"),o=s.n(n),r=s("kWsH"),c=s.n(r),l=s("Yvyk"),d=s.n(l),h=s("Ip10"),u=s.n(h),p=s("wG3i"),m=s.n(p),g=s("ejTr"),f=s.n(g),v=s("w2Vt"),w=s("692z"),b=s("F5n6"),C=s("ngIk"),_=s("dcdS"),y=s("oWfJ"),k=s("00Ee");function x(t,e,s){return Object(k.a)({method:"CampaignFlowRemoteActions.createCampaignFlowStep",args:[t,e,s]})}function S(t,e,s){return Object(k.a)({method:"CampaignFlowRemoteActions.updateCampaignFlowStep",args:[t,e,s]})}function I(t,e){return Object(k.a)({method:"CampaignFlowRemoteActions.getCampaignFlowStepRules",args:[t,e]})}function L(t){return Object(k.a)({method:"QRCodeRemoteActions.getQRCodesByCampaignFlowStepId",args:[t]})}function N(t){return Object(k.a)({method:"CampaignFlowRemoteActions.getCampaignFlow",args:[t]})}function T(t){return Object(k.a)({method:"FormRemoteActions.getFormName",args:[t]})}function $(t){return Object(k.a)({method:"CampaignFlowRemoteActions.getCampaignMemberStatus",args:[t]})}function D(t,e){return Object(k.a)({method:"CampaignFlowRemoteActions.addPrize",args:[t,e]})}function A(t,e){return Object(k.a)({method:"CampaignFlowRemoteActions.updatePrize",args:[t,e]})}function O(t,e,s,a){return Object(k.a)({method:"CampaignFlowRemoteActions.updateFlowStepPage",args:[t,e,s,a]})}function F(t,e){return Object(k.a)({method:"CampaignFlowRemoteActions.updateQRCodeResponsesWithNewFormLink",args:[t,e]})}var M=s("4B+h"),P=s("L2JU"),R=s("cybb"),E=s("LQ5e"),B=s.n(E),j={mixins:[y.a],components:{LoadingSpinner:v.a,NoRecord:w.a,Pagination:b.a,InputSelect:C.a,Dropdown:_.a},computed:o()({},Object(P.c)({accountList:"sidebar/wechatAccounts",currentUser:"user/currentUser"}),{hasSortBy(){return"order"===this.dropdownType},hasDefaultLabel(){return"order"!==this.dropdownType},noRecordStyle(){return this.campaignFilter.WeChatAccountId||this.campaignFilter.Status?"top: 132px;":"top: 90px;"}}),watch:{dropdownRefId(){"status"===this.dropdownType?(this.dropdownOptionData.options=this.statusOptionData.options,this.dropdownOptionData.currents=this.statusOptionData.currentOptions):"order"===this.dropdownType?(this.dropdownOptionData.options=this.orderOptionData.options,this.dropdownOptionData.currents=this.orderOptionData.currentOptions):"accounts"===this.dropdownType&&(this.dropdownOptionData.options=this.accounts.options,this.dropdownOptionData.currents=this.accounts.currents)}},data(){return{currentPageNumber:1,pageSize:20,campaignFilter:{OrderBy:"Last Created Date",SearchKey:"",Status:"",WeChatAccountId:""},loadingCampaigns:!1,campaignTotal:26,accounts:{options:[],currents:[]},statusOptionData:{options:[],currentOptions:[]},orderOptionData:{options:[{Name:this.$t("orderFirstLabel"),value:"Last Created Date"},{Name:this.$t("orderSecondLabel"),value:"Oldest Created Date"}],currentOptions:[{Name:this.$t("orderFirstLabel"),value:"Last Created Date"}]},campaignListInfo:{campaignFlows:[],pages:[],total:{Count:0,HasMore:!1}},currentCampaignListPagination:[],currentCampaign:null,selectedCampaign:{},selectedType:""}},async created(){var t;for(const t of f()(this.accountList)){const e=this.accountList[t];"Service Account"===e.Type&&this.accounts.options.push(JSON.parse(m()(e)))}const e=this.$route.query.accountId,s=u()(t=this.accounts.options).call(t,t=>t.Id===e);s?(this.campaignFilter.WeChatAccountId=e,this.accounts.currents.push(s)):(this.campaignFilter.WeChatAccountId="",this.accounts.currents=[]),e&&this.$router.replace({path:"/wechat-campaign"}),"/wechat-campaign"===this.$route.path&&this.$route.query.campaignId?await d.a.all([this.getCampaignStatusData(),this.getCampaignListData()]):(this.loadingCampaigns=!0,await d.a.all([this.getCampaignStatusData(),this.getCampaignListData()]),this.loadingCampaigns=!1)},methods:o()({},Object(P.b)("wechatCampaign",["storeRegisterStepId","storeCampaign","storeCheckInStepId","storeLuckyDrawStepId","storeFlowSteps"]),{formatDatetimeFilter:()=>R.e,async refreshCampaignList(){this.campaignFilter={OrderBy:"Last Created Date",SearchKey:"",Status:"",WeChatAccountId:""},this.orderOptionData.currentOptions=[{Name:this.$t("orderFirstLabel"),value:"Last Created Date"}],this.accounts.currents=[],this.statusOptionData.currentOptions=[],this.currentPageNumber=1,this.loadingCampaigns=!0,await this.getCampaignListData(),this.loadingCampaigns=!1},async getCampaignStatusData(){try{const t=await Object(k.a)({method:"CampaignFlowRemoteActions.getCampaignStatus",args:[]});if(t.ok){const e=JSON.parse(B.a.unescape(t.data));if(this.statusOptionData.options=[],this.statusOptionData.currentOptions=[],e.campaignStatus)for(const t of e.campaignStatus)this.statusOptionData.options.push({Name:t,value:t})}else Object(M.f)(t)}catch(t){Object(M.f)(t)}},async getCampaignListData(){try{const i=await(e=this.pageSize,s=this.currentPageNumber,a=m()(this.campaignFilter),Object(k.a)({method:"CampaignFlowRemoteActions.getCampaignFlows",args:[e,s,a]}));if(i.ok){const e=JSON.parse(B.a.unescape(i.data));this.campaignListInfo=e,this.campaignListInfo;for(const s of e.campaignFlows){var t;this.$set(s,"showActions",!1),c()(t=s.CampaignFlowSteps).call(t,(function(t,e){return e.Type.Value>t.Type.Value}))}this.currentCampaignListPagination=e.pages}else Object(M.f)(i)}catch(t){Object(M.f)(t)}var e,s,a},async selectPicklist(t){"status"===this.dropdownType?(this.statusOptionData.currentOptions=t,this.campaignFilter.Status=t[0]?t[0].value:""):"order"===this.dropdownType?(this.campaignFilter.OrderBy=t[0].value,this.orderOptionData.currentOptions=t):"accounts"===this.dropdownType&&(this.accounts.currents=t,this.campaignFilter.WeChatAccountId=t[0]?t[0].Id:""),this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1,this.currentPageNumber=1,this.loadingCampaigns=!0,await this.getCampaignListData(),this.loadingCampaigns=!1},async searchCampaigns(){this.currentPageNumber=1,this.loadingCampaigns=!0,await this.getCampaignListData(),this.loadingCampaigns=!1},clearSearchKey(){this.campaignFilter.SearchKey="",this.searchCampaigns()},async resetFilters(){this.accounts.currents=[],this.statusOptionData.currentOptions=[],this.campaignFilter.Status="",this.campaignFilter.WeChatAccountId="",this.currentPageNumber=1,this.loadingCampaigns=!0,await this.getCampaignListData(),this.loadingCampaigns=!1},async target(t){this.currentPageNumber=t,this.loadingCampaigns=!0,await this.getCampaignListData(),this.loadingCampaigns=!1,this.$nextTick((function(){document.getElementsByClassName("campaign-page-list")[0].scrollTop=0}))},showEditBox(t){this.currentCampaign&&this.currentCampaign!==t&&(this.currentCampaign.showActions=!1),t.showActions=!t.showActions,this.currentCampaign=t,this.$root.$el.addEventListener("click",this.hideEditBox)},hideEditBox(){const t=this.$root.$el;this.currentCampaign.showActions=!1,t.removeEventListener("click",this.hideEditBox)},openModal(t,e,s,a){this.selectedCampaign=a,this.selectedType=s;const i=this.$confirm({title:t,content:e});i.$on("ok",async()=>{"delete"===this.selectedType?this.deleteCampaign(this.selectedCampaign,i):this.actionCampaign(this.selectedCampaign,this.selectedType,i)})},async actionCampaign(t,e,s){var a;const i=u()(a=t.CampaignFlowSteps).call(a,t=>t.Type.Value===e),n=i.IsActive?this.$t("deactivateSuccessLabel",[i.Type.Label]):this.$t("activateSuccessLabel",[i.Type.Label]);if(i)try{const t=await(o=i.Id,r=!i.IsActive,Object(k.a)({method:"CampaignFlowRemoteActions.setCampaignFlowStepStatus",args:[o,r]}));t.ok?(s.close(),this.$root.$emit("open-toast-notification",{content:n,type:"success"}),this.loadingCampaigns=!0,await this.getCampaignListData(),this.loadingCampaigns=!1):(s.resume(),this.loadingCampaigns=!1,Object(M.f)(t))}catch(t){s.resume(),this.loadingCampaigns=!1,Object(M.f)(t)}var o,r},async deleteCampaign(t,e){try{const a=await(s=t.Id,Object(k.a)({method:"CampaignFlowRemoteActions.deleteCampaignFlow",args:[s]}));a.ok?(e.close(),this.$root.$emit("open-toast-notification",{content:this.$t("deleteSuccessLabel"),type:"success"}),this.loadingCampaigns=!0,this.currentPageNumber=1,await this.getCampaignListData(),this.loadingCampaigns=!1,this.$nextTick((function(){document.getElementsByClassName("campaign-page-list")[0].scrollTop=0}))):(e.resume(),this.loadingCampaigns=!1,Object(M.f)(a))}catch(t){e.resume(),this.loadingCampaigns=!1,Object(M.f)(t)}var s},editCampaign(t){this.$emit("edit-campaign",t)},editCampaignFlow(t){let e;this.storeRegisterStepId(""),this.storeCheckInStepId(""),this.storeLuckyDrawStepId("");for(const s of t.CampaignFlowSteps)"Registration"===s.Type.Value?(this.storeRegisterStepId(s.Id),e=s.Id):"Check-in"===s.Type.Value?this.storeCheckInStepId(s.Id):"LuckyDraw"===s.Type.Value&&this.storeLuckyDrawStepId(s.Id);const s={id:t.CampaignId,flowId:t.Id,tags:t.WeChatTags,isOverwriteFollowerTag:t.IsOverwriteFollowerTag,name:t.Name,account:{id:t.WeChatAccountId,name:t.WeChatAccountName,type:t.WeChatAccountType},type:"edit"};this.$router.replace({path:"/wechat-campaign/register",query:{flowId:t.Id,flowStepId:e}}),this.storeCampaign(s),this.storeFlowSteps(t.CampaignFlowSteps),this.$emit("edit-campaign-name",!0)}})},z=(s("PI8L"),s("KHd+")),U=s("OH8b"),q=Object(z.a)(j,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"campaign-list-page"},[s("div",{staticClass:"slds-border_bottom slds-grid slds-grid_align-spread campaign-list-filter"},[s("div",{staticClass:"slds-grid"},[s("div",{staticClass:"campaign-number"},[t.campaignListInfo.total.Count<=1?s("span",[t._v(t._s(t.campaignListInfo.total.Count)+" "+t._s(t.$tc("itemLabel",1)))]):t._e(),t._v(" "),t.campaignListInfo.total.Count>1?s("span",[t._v(t._s(t._f("addSeparators")(t.campaignListInfo.total.Count))),t.campaignListInfo.total.HasMore?s("i",{staticClass:"show-plus-sign"},[t._v("+")]):t._e(),t._v(" "+t._s(t.$tc("itemLabel",2)))]):t._e()]),t._v(" "),s("div",{staticClass:"campaign-status"},[s("input-select",{attrs:{currents:t.statusOptionData.currentOptions,type:"status","default-label":t.$t("statusDefaultValue")},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1),t._v(" "),s("div",{staticClass:"campaign-account"},[s("input-select",{attrs:{currents:t.accounts.currents,type:"accounts","default-label":t.$t("accountDefaultValue")},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1)]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_align-end"},[s("div",{staticClass:"campaign-search"},[s("search-input",{attrs:{placeholder:t.$t("searchLabel")},on:{search:t.searchCampaigns,clear:t.clearSearchKey},model:{value:t.campaignFilter.SearchKey,callback:function(e){t.$set(t.campaignFilter,"SearchKey",e)},expression:"campaignFilter.SearchKey"}})],1),t._v(" "),s("div",{staticClass:"campaign-order"},[s("input-select",{attrs:{currents:t.orderOptionData.currentOptions,type:"order"},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1)])]),t._v(" "),t.campaignFilter.WeChatAccountId||t.campaignFilter.Status?s("section",{staticClass:"slds-box filter-list-section"},[s("span",{staticClass:"reset-filter-icon",on:{click:function(e){return t.resetFilters()}}},[s("icon",{attrs:{name:"close","fill-color":"#706e6b",width:"13px",height:"13px"}})],1),t._v(" "),s("span",{staticClass:"reset-filter-title"},[t._v(t._s(t.$t("filteredByLabel"))+": ")]),t._v(" "),t.campaignFilter.Status?s("span",{staticClass:"reset-filter-value"},[t._v(t._s(t.$t("statusDefaultValue"))+": "+t._s(t.campaignFilter.Status)+".")]):t._e(),t._v(" "),t.campaignFilter.WeChatAccountId?s("span",{staticClass:"reset-filter-value"},[t._v(t._s(t.$t("weChatAccLabel"))+": "+t._s(t.accounts.currents[0].Name))]):t._e()]):t._e(),t._v(" "),t.loadingCampaigns?t._e():s("div",{staticClass:"campaign-page-list slds-scrollable_y",class:{"has-filter-list":t.campaignFilter.WeChatAccountId||t.campaignFilter.Status}},[s("ul",t._l(t.campaignListInfo.campaignFlows,(function(e,a){return s("li",{staticClass:"slds-border_bottom slds-grid slds-grid_align-spread slds-grid_vertical-align-center campaign-list-item",class:{"slds-border_top":0===a&&(t.campaignFilter.WeChatAccountId||t.campaignFilter.Status)}},[s("div",{staticClass:"slds-grid slds-grid_vertical slds-grid_vertical-align-start slds-size_5-of-12 campaign-info-left"},[s("a",{staticClass:"slds-truncate",attrs:{href:"javascript:void(0);",title:e.Name},on:{click:function(s){return t.editCampaignFlow(e)}}},[s("span",[t._v(t._s(e.Name))])]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical-align-center slds-truncate info-detail"},[e.CampaignStartDate?s("span",{staticClass:"detail-clock"},[s("icon",{attrs:{name:"clock",width:"14px",height:"14px","fill-color":"#706e6b"}})],1):t._e(),t._v(" "),e.CampaignStartDate?s("span",{staticClass:"detail-clock-value"},[t._v(t._s(t._f("formatNoTimeZoneDateTime")(e.CampaignStartDate,"date")))]):t._e(),t._v(" "),s("span",{staticClass:"detail-campaign"},["Service Account"===e.WeChatAccountType?s("icon",{attrs:{name:"wechatAccountService",width:"14px",height:"14px","fill-color":"#706e6b"}}):t._e(),t._v(" "),"Subscription Account"===e.WeChatAccountType?s("icon",{attrs:{name:"wechatAccountSubscription",width:"14px",height:"14px","fill-color":"#706e6b"}}):t._e()],1),t._v(" "),s("span",{staticClass:"slds-truncate detail-name"},[t._v(t._s(e.WeChatAccountName))])]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical-align-center slds-truncate info-modify"},[e.LastModifiedUserName?s("span",{staticClass:"slds-truncate"},[t._v(t._s(t.$t("modifiedLabel")+" "+e.LastModifiedUserName+", "+t.formatDatetimeFilter()(e.LastModifiedDate,t.currentUser.TimeZoneSidKey)))]):s("span",{staticClass:"slds-truncate"},[t._v(t._s(t.$t("modifiedLabel")+" "+t.formatDatetimeFilter()(e.LastModifiedDate,t.currentUser.TimeZoneSidKey)))])])]),t._v(" "),s("div",{staticClass:"slds-size_4-of-12 campaign-info-middle"},[s("span",{staticClass:"slds-badge"},[t._v(t._s(e.Status))])]),t._v(" "),s("div",{staticClass:"slds-size_1-of-12 campaign-info-right"},[s("div",{staticClass:"slds-grid slds-grid_vertical campaign-members"},[s("a",{attrs:{href:"/"+e.CampaignId,target:"_blank"}},[s("span",{staticClass:"member-total"},[t._v(t._s(e.CampaignMemberCount))])]),t._v(" "),e.CampaignMemberCount>1?s("span",[t._v(t._s(t.$tc("memberLabel",2)))]):s("span",[t._v(t._s(t.$tc("memberLabel",1)))])])]),t._v(" "),s("div",{staticClass:"action-section"},[s("button",{staticClass:"slds-button slds-button_icon-border-filled slds-button_icon-x-small down-btn",on:{click:function(s){return s.stopPropagation(),t.showEditBox(e)}}},[s("icon",{attrs:{name:"down","class-name":"down-icon",width:"0.75rem",height:"0.75rem"}})],1),t._v(" "),e.showActions?s("div",{staticClass:"slds-box action-list"},[s("div",{on:{click:function(s){return t.editCampaign(e)}}},[t._v(t._s(t.$t("actionEdit")))]),t._v(" "),t._l(e.CampaignFlowSteps,(function(a){return[s("div",{directives:[{name:"show",rawName:"v-show",value:a.IsActive&&"LuckyDraw"!==a.Type.Value,expression:"flowStep.IsActive && flowStep.Type.Value !== 'LuckyDraw'"}],on:{click:function(s){t.openModal(""+t.$t("actionDeactivate")+a.Type.Label,""+t.$t("actionDeactivateContent")+a.Type.Label+t.$t("actionStep")+"?",a.Type.Value,e)}}},[t._v(t._s(t.$t("actionDeactivate"))+t._s(a.Type.Label))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!a.IsActive&&"LuckyDraw"!==a.Type.Value,expression:"!flowStep.IsActive && flowStep.Type.Value !== 'LuckyDraw'"}],on:{click:function(s){t.openModal(""+t.$t("actionActivate")+a.Type.Label,""+t.$t("actionActivateContent")+a.Type.Label+t.$t("actionStep")+"?",a.Type.Value,e)}}},[t._v(t._s(t.$t("actionActivate"))+t._s(a.Type.Label))])]})),t._v(" "),s("div",{on:{click:function(s){t.openModal(t.$t("actionDeleteTitle"),t.$t("actionDeleteContent"),"delete",e)}}},[t._v(t._s(t.$t("actionDelete")))])],2):t._e()])])})),0),t._v(" "),t.loadingCampaigns?t._e():s("pagination",{attrs:{paginations:t.currentCampaignListPagination,"page-number":t.currentPageNumber},on:{target:t.target}})],1),t._v(" "),s("loading-spinner",{attrs:{"is-loading":t.loadingCampaigns}}),t._v(" "),!t.loadingCampaigns&&t.campaignListInfo.campaignFlows.length<=0?s("no-record",{attrs:{"custom-style":this.noRecordStyle}}):t._e(),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.dropdownOptionData.options,currents:t.dropdownOptionData.currents,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth,"has-sort-by":t.hasSortBy,"default-label":t.hasDefaultLabel},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e()],1)}),[],!1,null,"1b1198f9",null);"function"==typeof U.default&&Object(U.default)(q);var W=q.exports,Q=s("za7x"),V=s("SLhn"),H=s.n(V),K=s("4LGG"),J=s.n(K),Y={name:"wizard",props:{steps:{type:Array,default:()=>[]},stepIndex:{type:Number,default:()=>0},selectIndex:{type:Number,default:()=>0}},watch:{stepIndex(t){this.currentStepIndex=t}},data:()=>({currentStepIndex:0}),created(){this.currentStepIndex=this.stepIndex,this.selectIndex},methods:{selectStep(t){t<=this.currentStepIndex&&this.$emit("select-step",t)}}},G=(s("6jXa"),Object(z.a)(Y,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"wizard"},[s("ul",{staticClass:"slds-grid wizard-steps"},t._l(t.steps,(function(e,a){return s("li",{staticClass:"slds-grid slds-grid_vertical slds-grid_vertical-reverse wizard-step",class:{active:t.currentStepIndex>=a},style:{width:100/t.steps.length+"%"}},[s("span",{staticClass:"wizard-step-line"}),t._v(" "),s("span",{staticClass:"wizard-step-indicator",class:{"select-indicator":t.selectIndex===a},on:{click:function(e){return t.selectStep(a)}}}),t._v(" "),s("span",{staticClass:"wizard-step-label"},[t._v(t._s(e.label))])])})),0)])}),[],!1,null,"091fa926",null).exports),Z=s("+Bun"),X=s.n(Z),tt=s("CeEi"),et=s.n(tt),st=s("oG9Y"),at=s.n(st),it=s("miio"),nt=s("2GRW");const ot=s("/B6M").a;var rt={computed:{defaultPreviewBg(){return this.currentForm.Id?"":"#fff"}},watch:{"currentForm.Id":async function(t){t?(await this.getFormInfo(),this.$refs.previewContent.innerHTML||this.initRenderDom()):this.$refs.previewContent.innerHTML=""},"currentForm.Banner":function(t){this.changedFormField("Banner",t)},"currentForm.Title":function(t){this.changedFormField("Title",t)}},data:()=>({advancedStyle:""}),methods:{async getFormInfo(){try{const t=await Object(it.d)(this.currentForm.Id);if(t.ok){const e=JSON.parse(B.a.unescape(t.data)),s=JSON.parse(m()(e.FormInfo));this.currentForm.Description=s.Description,this.currentForm.ButtonSettings=s.ButtonSettings,this.currentForm.FormFields=s.FormFields,this.currentForm.Styles=s.Styles,this.currentForm.AdvancedStyles=s.AdvancedStyles}else Object(M.f)(t)}catch(t){Object(M.f)(t)}},initRenderDom(){this.advancedStyle=null,this.removeStyles(),this.currentForm.AdvancedStyles&&(this.advancedStyle=this.currentForm.AdvancedStyles.replace(/#app/g,"#".concat(this.previewFormId)));const t=JSON.parse(m()(this.currentForm));Object(nt.a)(this.$refs.previewContent,t,{},"OutBuilderPreview",this.advancedStyle,ot,"",this.previewFormId)},changedFormField(t,e){this.currentForm.FormFields&&this.currentForm.FormFields.length>0&&(this.currentForm[t]=e,this.$refs.previewContent.innerHTML="",this.initRenderDom())},removeStyles(){const t=at()(document.querySelectorAll("style"));for(const e of t){const t=e.innerText;t&&X()(t).call(t,"#".concat(this.previewFormId))>-1&&document.head.removeChild(e)}}}},ct=s("2AFw"),lt=s("4IgH"),dt=s("4MOm");const ht=["MasterObject__c","RecordTypeId__c","Note__c","Banner__c","Title__c","LongURL__c","ButtonSettings__c"],ut=J()(ht).call(ht,t=>dt.a.getQualifiedName(t)),pt=dt.a.getQualifiedName("Form__c"),mt=dt.a.getQualifiedName("WeChatFollower__c");var gt={methods:{searchSelectForm(t){var e,s,a,i;const n=H()(e=H()(s=H()(a=H()(i="select Id, Name, ".concat(ut.join(",")," from ")).call(i,pt," where ")).call(a,ut[0]," != '")).call(s,mt,"' and Id = '")).call(e,t,"'");return Object(lt.c)(n)}}},ft={mixins:[gt,rt],computed:{canNext(){return!!this.currentForm.Name}},components:{Lookup:ct.a},mounted(){this.$root.$on("fetch-register-data",async(t,e)=>{await this.fetchFlowName(t.Form.Id),e.formName=this.currentForm.Name,this.currentForm.Id?this.currentItem={id:this.currentForm.Id,name:this.currentForm.Name}:this.currentItem=null,this.currentForm.Title=t.Form.Title,this.currentForm.Banner=t.Form.Banner,this.currentForm.URL=t.Form.FormURL,this.currentForm.Editable=t.Form.Editable})},beforeDestroy(){this.$root.$off("fetch-register-data")},data(){return{formMetadata:{name:"Form__c",label:this.$tc("formLabel",1),labelPural:this.$tc("formLabel",2),icon:"custom.forms",linkField:{name:"Name",label:this.$tc("formLabel",1)},fields:[],newObjectLink:"Self Link"},currentItem:null,currentForm:{Id:"",Name:"",Title:"",Banner:"",MasterObject:"",URL:"",RecordType:"",Note:"",Link:"",LongURL:"",Editable:!0},previewFormId:"campaign-preview-form"}},methods:o()({},Object(P.b)("wechatCampaign",["storeForm"]),{async fetchFlowName(t){try{const e=await T(t),s=JSON.parse(B.a.unescape(e.data));this.currentForm.Name=s.formName,this.currentForm.Id=t}catch(t){Object(M.f)(t)}},async selectForm(t){if(this.currentForm.Id=t?t.id:"",this.currentForm.Id)try{const t=await this.searchSelectForm(this.currentForm.Id),e=JSON.parse(B.a.unescape(t.data))[0];if(t.ok){this.currentForm.Name=e.Name,this.currentForm.Title=e.Title__c,this.currentForm.Banner=e.Banner__c,this.currentForm.MasterObject=e.MasterObject__c,this.currentForm.URL=e.LongUrl__c||"",this.currentForm.RecordType=e.RecordTypeId__c,this.currentForm.Note=e.Note__c,this.currentForm.LongURL=e.LongUrl__c;let t=et()(this.currentForm);this.storeForm(t),this.$root.$emit("flow-select-form",this.currentForm)}else Object(M.f)(t)}catch(t){Object(M.f)(t)}},removeForm(t){this.currentForm={Id:"",Name:"",Title:"",Banner:"",MasterObject:"",URL:"",RecordType:"",Note:"",Link:"",Editable:this.currentForm.Editable};let e=et()(this.currentForm);this.storeForm(e),this.$root.$emit("flow-select-form",this.currentForm)},cancel(){this.$emit("cancel-form")},next(){this.$emit("select-form",this.currentForm)},goToFormList(){const t=window.location.href,e=X()(t).call(t,"#");if(e>-1){const s=t.substring(0,e+1);window.open("".concat(s,"/forms"),"","",!1)}}})},vt=(s("CGTS"),s("ZXNS")),wt=Object(z.a)(ft,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"charket-select-form"},[s("section",{staticClass:"slds-box slds-grid main"},[s("section",{staticClass:"slds-col field"},[s("div",{staticClass:"slds-form-element field-item"},[s("label",{staticClass:"slds-form-element__label"},[s("abbr",{staticClass:"slds-required"},[t._v("*")]),t._v(t._s(t.$tc("formLabel",1)))]),t._v(" "),s("div",{staticClass:"slds-form-element__control form-input"},[s("lookup",{attrs:{"ld-selected-item":t.currentItem,"ld-metadatas":t.formMetadata},on:{select:function(e){return t.selectForm(e)},remove:function(e){return t.removeForm(e)},"self-link":t.goToFormList}})],1)]),t._v(" "),s("div",{staticClass:"slds-form-element field-item"},[s("label",{staticClass:"slds-form-element__label",attrs:{for:"form-title"}},[t._v(t._s(t.$t("titleLabel")))]),t._v(" "),s("div",{staticClass:"slds-form-element__control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currentForm.Title,expression:"currentForm.Title"}],staticClass:"slds-input",attrs:{type:"text",id:"form-title"},domProps:{value:t.currentForm.Title},on:{input:function(e){e.target.composing||t.$set(t.currentForm,"Title",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"slds-form-element field-item"},[s("label",{staticClass:"slds-form-element__label",attrs:{for:"form-banner"}},[t._v(t._s(t.$t("bannerLabel")))]),t._v(" "),s("div",{staticClass:"slds-form-element__control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currentForm.Banner,expression:"currentForm.Banner"}],staticClass:"slds-input",attrs:{type:"text",id:"form-banner"},domProps:{value:t.currentForm.Banner},on:{input:function(e){e.target.composing||t.$set(t.currentForm,"Banner",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("span",{staticClass:"slds-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currentForm.Editable,expression:"currentForm.Editable"}],attrs:{type:"checkbox",name:"options",id:"form-update-editable"},domProps:{checked:Array.isArray(t.currentForm.Editable)?t._i(t.currentForm.Editable,null)>-1:t.currentForm.Editable},on:{change:function(e){var s=t.currentForm.Editable,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&t.$set(t.currentForm,"Editable",s.concat([null])):n>-1&&t.$set(t.currentForm,"Editable",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.currentForm,"Editable",i)}}}),t._v(" "),s("label",{staticClass:"slds-checkbox__label checkbox-label",attrs:{for:"form-update-editable"}},[s("span",{staticClass:"slds-checkbox_faux checkbox-span"}),t._v(" "),s("span",{staticClass:"slds-form-element__label checkbox-value"},[t._v(t._s(t.$t("editableLabel")))])])])])])]),t._v(" "),s("section",{staticClass:"slds-box preview",class:{"slds-grid slds-grid_vertical-align-center slds-grid_align-center preview-default":!t.currentForm.Id},style:{backgroundColor:t.defaultPreviewBg}},[t.currentForm.Id?t._e():s("span",{staticClass:"preview-value"},[t._v(t._s(t.$t("formPreviewLabel")))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.currentForm.Id,expression:"currentForm.Id"}],ref:"previewContent",staticClass:"preview-container preview-form slds-scrollable_y",attrs:{id:t.previewFormId}})])]),t._v(" "),s("section",{staticClass:"slds-border_top footer"},[s("button",{staticClass:"slds-button slds-button_neutral btn-left",on:{click:function(e){return t.cancel()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand btn-right",attrs:{disabled:!t.canNext},on:{click:function(e){return t.next()}}},[t._v(t._s(t.$t("global.nextBtn")))])])])}),[],!1,null,"60f2f214",null);"function"==typeof vt.default&&Object(vt.default)(wt);var bt=wt.exports,Ct=s("dUVM"),_t=s.n(Ct),yt=s("8Vev"),kt=s.n(yt),xt=s("+SX9"),St=s("V9RP"),It=s("3nmp"),Lt=s("rVwK"),Nt={mixins:[y.a],props:{code:{type:Object,default:()=>({})},messages:{type:Array,default:()=>[]}},data:()=>({isSubmitSave:!1,errorToastMsg:"",tagOptions:[],selectMessage:{tempMessage:{},messageType:"",messageTitle:"",messageEditTitle:""},showTagDropdown:!1,newCode:{Name:"",IsOverwriteFollowerTag:"",WeChatTagIds:[],WeChatMessage:{FileMapping:{},Id:"",TextBody:""}},accountId:"",tempCode:{},response:null}),computed:o()({},Object(P.c)({wechatCampaign:"wechatCampaign/campaign"})),components:{ErrorToast:xt.a,InputSelect:C.a,TagDropdown:St.a,WechatResponse:It.a},created(){if(this.code.QRCodeId){this.newCode=this.code,this.tempCode=JSON.parse(m()(this.newCode));for(const t of this.newCode.WeChatTags)this.tagOptions.push({Id:t.TagId,Name:t.TagName,value:t.TagName});if(this.newCode.WeChatMessage){const t=new Lt.e(this.newCode.WeChatMessage.FileMapping);t.weChatLastModifiedTime&&(t.localizedWeChatLastModifiedTime=Object(R.e)(t.weChatLastModifiedTime,this.$user.TimeZoneSidKey)),this.response=t}}this.accountId=this.wechatCampaign.account.id},methods:{closeNewQrCodePopup(){this.$emit("close",this.tempCode)},async save(){try{this.isSubmitSave=!0;let t={QRCodeId:this.newCode.QRCodeId,Name:this.newCode.Name,WhatId:this.newCode.WhatId,Type:this.newCode.Type,ExpirationSeconds:this.newCode.ExpirationSeconds,WeChatAccount:this.accountId,WeChatMessage:{Id:"",TextBody:""},CampaignMemberStatus:null,WeChatTagIds:this.newCode.WeChatTagIds,WeChatTags:this.newCode.WeChatTags,IsOverwriteFollowerTag:this.newCode.IsOverwriteFollowerTag,IsActive:!0};t.WeChatMessage.Id=this.response.id,t.WeChatMessage.TextBody=this.response.content,this.newCode.WeChatMessage?this.newCode.WeChatMessage.FileMapping=this.response:(this.newCode.WeChatMessage={},this.newCode.WeChatMessage.FileMapping=this.response,this.newCode.WeChatMessage.Id=this.response.id);const e=await Object(lt.g)(m()(t));this.isSubmitSave=!1,e.ok?(this.$emit("close",""),this.$router.app.$emit("open-toast-notification",{content:this.$t("saveQrcodeLabel"),type:"success"})):(this.errorToastMsg=e.error,this.scrollToTop())}catch(t){this.isSubmitSave=!1,Object(M.f)(t)}},selectTags(t){this.newCode.WeChatTagIds=[],this.newCode.WeChatTags=[];let e=[];for(let e of t)this.newCode.WeChatTagIds.push(e.Id);for(let s of t)e.push(s.Name),this.newCode.WeChatTags.push({TagId:s.Id,TagName:s.Name});this.newCode.tagTooltip=e.toString(),this.tagOptions=t},removeOption(t){this.selectTags(t),this.showTagDropdown&&(this.$root.$emit("close-other-dropdown",null),this.showTagDropdown=!1)},scrollToTop(){document.getElementById("modal-content").scrollTop=0}}},Tt=(s("nWn+"),s("+qmn")),$t=Object(z.a)(Nt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"charket-new-qrcode-flow"}},[s("div",{staticClass:"slds-modal slds-modal_large slds-fade-in-open",attrs:{"aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container show-selected-container new-width",attrs:{role:"document",tabindex:"0"}},[s("div",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close",on:{click:function(e){return t.closeNewQrCodePopup()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.$t("titleLabel")))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium new-height",attrs:{id:"modal-content"}},[t.errorToastMsg?s("error-toast",{attrs:{content:t.errorToastMsg}}):t._e(),t._v(" "),s("div",{staticClass:"new-line"},[s("div",{staticClass:"new-title"},[s("span",[t._v("*")]),t._v(" "+t._s(t.$t("nameLabel")))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newCode.Name,expression:"newCode.Name"}],staticClass:"slds-input new-input",attrs:{type:"text",name:""},domProps:{value:t.newCode.Name},on:{input:function(e){e.target.composing||t.$set(t.newCode,"Name",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"new-line"},[s("div",{staticClass:"new-title"},[t._v(t._s(t.$t("tagLabel")))]),t._v(" "),s("div",{staticClass:"new-line-picklist"},[s("input-select",{attrs:{currents:t.tagOptions,"limit-length":5},on:{"close-dropdown":t.closeDropdown,"open-dropdown":t.openTagDropdown,resize:t.resizeDropdown,"remove-option":t.removeOption}})],1)]),t._v(" "),s("div",{staticClass:"new-line"},[s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("span",{staticClass:"slds-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.newCode.IsOverwriteFollowerTag,expression:"newCode.IsOverwriteFollowerTag"}],attrs:{type:"checkbox",name:"options",id:"follower-tag-campaign"},domProps:{checked:Array.isArray(t.newCode.IsOverwriteFollowerTag)?t._i(t.newCode.IsOverwriteFollowerTag,null)>-1:t.newCode.IsOverwriteFollowerTag},on:{change:function(e){var s=t.newCode.IsOverwriteFollowerTag,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&t.$set(t.newCode,"IsOverwriteFollowerTag",s.concat([null])):n>-1&&t.$set(t.newCode,"IsOverwriteFollowerTag",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.newCode,"IsOverwriteFollowerTag",i)}}}),t._v(" "),s("label",{staticClass:"slds-checkbox__label checkbox-label",attrs:{for:"follower-tag-campaign"}},[s("span",{staticClass:"slds-checkbox_faux checkbox-span"}),t._v(" "),s("span",{staticClass:"slds-form-element__label checkbox-value"},[t._v(t._s(t.$t("overwriteTagLabel")))])])])])])]),t._v(" "),s("div",{staticClass:"new-line"},[s("div",{staticClass:"new-title"},[t._v(t._s(t.$t("scanLabel")))]),t._v(" "),s("wechat-response",{attrs:{"page-name":"QR Codes of WeChat Campaign","wechat-account":t.wechatCampaign.account,choosers:["Text Message","Structured Message"]},model:{value:t.response,callback:function(e){t.response=e},expression:"response"}})],1)],1),t._v(" "),s("div",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSubmitSave},on:{click:function(e){return t.closeNewQrCodePopup()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isSubmitSave||!t.newCode.Name},on:{click:function(e){return t.save()}}},[t._v(t._s(t.$t("global.saveBtn")))])])])]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open"}),t._v(" "),t.showTagDropdown?s("tag-dropdown",{attrs:{"account-id":t.accountId,currents:t.tagOptions,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth,"is-single-selection":!1,"limit-length":5},on:{"select-option":t.selectTags,close:t.closeDropdown}}):t._e()],1)}),[],!1,null,"ecfc6c6a",null);"function"==typeof Tt.default&&Object(Tt.default)($t);var Dt=$t.exports,At=s("EMO1"),Ot=s("xEMq"),Ft=s("jkSJ"),Mt={props:{accountId:{type:String,default:()=>""}},components:{NewStruMessage:At.a},mounted(){this.isModalOpen=!0},data:()=>({isModalOpen:!1,isSavingStru:!1}),methods:{async saveLinkStructure(){this.isSavingStru=!0;const t=this.accountId||this.$route.params.accountId,e=this.$refs.newStruEditor.getEditorContent();if(e&&t){for(let t of e.wechatAttachment){var s;t.url&&X()(s=t.url).call(s,"/servlet/servlet.FileDownload?file=")>-1?t.attachmentId=t.url.match(/file=(\S*)/)[1]:t.attachmentId="","mpnews"===this.newsType&&delete t.url}try{const s=await Object(Ot.f)(t,m()(e),"news");if(this.isSavingStru=!1,s.ok){const t=JSON.parse(B.a.unescape(s.data));try{const e=await Ft.k.getById(t.Id);this.$emit("get-data",e),this.$router.app.$emit("open-toast-notification",{content:this.$t("notifyContent"),type:"success"})}catch(t){this.isSavingStru=!1,this.$handleError(t)}}else Object(M.f)(s)}catch(t){this.isSavingStru=!1,Object(M.f)(t)}}else this.isSavingStru=!1},closeModal(){this.$emit("close")},setLinkUrl(t){this.$refs.newStruEditor.setLinkUrl(t)}},beforeDestroy(){this.isModalOpen=!1}},Pt=(s("eAJ0"),s("jGbS")),Rt=Object(z.a)(Mt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-stru-popup"},[s("div",{staticClass:"slds-modal slds-modal_large",class:{"slds-fade-in-open":t.isModalOpen},attrs:{id:"messagePopup","aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container"},[s("header",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon slds-modal__close slds-button_icon-inverse",on:{click:function(e){return t.closeModal()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium slds-hyphenate",attrs:{id:"modal-heading-01"}},[t._v(t._s(t.$t("newStrucTitle")))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium modal-content-custom",attrs:{id:"modal-content-id-1"}},[s("new-stru-message",{ref:"newStruEditor",attrs:{"account-id":t.accountId,"created-info":{type:"new"},"news-type":"news","change-doc-title":!1}})],1),t._v(" "),s("footer",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSavingStru},on:{click:function(e){return t.closeModal()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isSavingStru},on:{click:function(e){return t.saveLinkStructure()}}},[t._v(t._s(t.$t("global.saveBtn")))])])])]),t._v(" "),s("div",{staticClass:"slds-backdrop",class:{"slds-backdrop_open":t.isModalOpen},attrs:{id:"Modal"}})])}),[],!1,null,"2e0fd53e",null);"function"==typeof Pt.default&&Object(Pt.default)(Rt);var Et=Rt.exports,Bt=s("+BhS"),jt=s("g6H1"),zt=s("xt0/"),Ut={mixins:[y.a],props:{registerFlow:{type:Object,default:()=>({})},isRegister:{type:Boolean,default:()=>!0},hasForm:{type:String,default:()=>""},checkInFormLink:{type:String,default:()=>""}},inject:["showErrorImg"],computed:o()({},Object(P.c)({wechatCampaign:"wechatCampaign/campaign",registerStepId:"wechatCampaign/registerStepId",checkInStepId:"wechatCampaign/checkInStepId",campaignFlowSteps:"wechatCampaign/campaignFlowSteps"}),{canNext(){return this.currentCode.count&&this.currentCode.validTime&&!this.showError&&!this.showTimeError},timeMaxValue(){return"Day"===this.expireOptionData.currents[0].value?30:720},canSubmit(){return!this.isShowResponse&&!this.isRegister||this.isShowResponse&&!this.hasForm?this.isSubmit||this.showError||this.showTimeError||!this.currentCode.validTime||!this.currentCode.count:this.isSubmit||this.showError||this.showTimeError||!this.currentCode.validTime||!this.currentCode.count||0===this.selectMessages.length}}),components:{NewQrcode:Dt,InputSelect:C.a,Dropdown:_.a,NewStruPopup:Et,MessagePopup:Bt.a,MessageDetail:jt.a,ImagePreview:zt.ImagePreview},watch:{registerFlow:{handler(t){this.registration=t,this.isRegister?this.defaultRegisterUrl=this.registration.Form.FormURL:this.defaultCheckInUrl=this.registration.Form.FormURL},deep:!0}},mounted(){this.$root.$on("fetch-register-data",(t,e)=>{this.isRegister&&this.fetchQrCodes(this.registerStepId,e)}),this.$root.$on("fetch-check-in-data",(t,e)=>{this.isRegister||this.fetchQrCodes(this.checkInStepId,e)}),this.$root.$on("check-in-response",t=>{this.isRegister?this.isShowResponse=!0:this.isShowResponse=t}),this.$root.$on("select-long-url",t=>{this.showError||this.showTimeError||(this.defaultCheckInUrl=t)})},beforeDestroy(){let t=this.$root;t.$off("fetch-register-data"),t.$off("select-long-url"),t.$off("fetch-check-in-data"),t.$off("check-in-response")},data(){return{accountId:"",currentCode:{count:1,validTime:30,isExpire:!1,qrcodes:[]},expireOptionData:{options:[{Name:this.$t("dayLabel"),value:"Day"},{Name:this.$t("hourLabel"),value:"Hour"}],currents:[{Name:this.$t("dayLabel"),value:"Day"}]},showNewStruPopup:!1,showTextSection:!0,showStrucSection:!1,showQrcode:!1,popupHeaderContent:"",editMsgId:"",currentPopupType:"",selectMessages:[],showError:!1,showTimeError:!1,msgCount:0,isSubmit:!1,editCode:{},registration:{Step:"",Form:{Id:"",Title:"",Banner:"",ThankYouMessage:"",RedirectURL:"",FormURL:""},QRCodes:[],CompletionActions:{CouponIds:[],TemplateIds:[],MessageIds:[],PassId:"",SubmittedAction:""}},currentQrCode:{},campaignStepId:"",isShowResponse:!1,defaultRegisterUrl:"",defaultCheckInUrl:"",qrMaxCounts:5,selectedMsg:{},modal:{headerContent:"",mainContent:""},actionCode:null,qrResponseContent:""}},created(){this.accountId=this.wechatCampaign.account.id,this.registration=this.registerFlow},methods:o()({},Object(P.b)("wechatCampaign",["storeFlowSteps"]),{responseMsgFilter(t){const e=t.type||t.Type;return"Text Message"===e?"1 ".concat(this.$t("global.textMsgLabel")):"WeChat Structured Message"===e||"Link Structured Message"===e?"1 ".concat(this.$t("global.strucMsgLabel")):void 0},async fetchQrCodes(t,e){try{const s=await L(t);if(s.ok){const t=JSON.parse(B.a.unescape(s.data));e.qrcodes=t.qrCodes,this.currentCode.qrcodes=t.qrCodes;for(const t of this.currentCode.qrcodes){this.$set(t,"showActions",!1);let e=[];for(const s of t.WeChatTags)e.push(s.TagName);this.$set(t,"tagTooltip",e.toString())}}}catch(t){Object(M.f)(t)}},onlyNum(t,e){let s;s=e===this.qrMaxCounts?/^[1-5]$/:/\d/,s.test(t.key)||8===t.keyCode?t.returnValue=!0:t.returnValue=!1},checkNumLimit(t,e){e===this.qrMaxCounts?this.showError=!!(t&&t>e):this.showTimeError=!!(t&&t>e)},selectPicklist(t){this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1,this.expireOptionData.currents=t,this.checkNumLimit(this.currentCode.validTime,this.timeMaxValue)},openNewStruPopup(t){this.currentPopupType="structureMessage",this.showNewStruPopup=!0,t&&this.$nextTick(()=>{let t;t=this.isRegister?this.defaultRegisterUrl:this.defaultCheckInUrl,this.$refs.newStruPopup.setLinkUrl(t)})},closeNewStruPopup(){this.showNewStruPopup=!1},getNewStruData(t){this.msgCount++,this.selectMessages=[],this.selectMessages.unshift({type:this.currentPopupType,messages:[t],id:this.msgCount}),this.closeNewStruPopup(),this.getMsgContentLink([t])},openTextSection(){this.showTextSection||(this.showTextSection=!0,this.showStrucSection=!1,this.selectMessages=[])},openStrucSection(){this.showStrucSection||(this.showStrucSection=!0,this.showTextSection=!1,this.selectMessages=[])},showPopup(t,e,s,a){if(this.popupHeaderContent=t,this.currentPopupType=s,"text"===s)if("Edit"===a)this.$refs.msgpopupmodel.openModal(a,s,[{id:"temp",content:"",type:"Text Message"}]);else{let t;var i;if(t=this.isRegister?B.a.escape(this.defaultRegisterUrl):B.a.escape(this.defaultCheckInUrl),t)this.$refs.msgpopupmodel.openModal(a,s,[{id:"",content:H()(i='<a href="'.concat(t,'" target="_blank">')).call(i,this.$t("defaultMsgLabel"),"</a>"),type:"Text Message"}]);else this.$refs.msgpopupmodel.openModal(a,s)}else this.$refs.msgpopupmodel.openModal(a,s);this.editMsgId=""},getSelectedMessage(t){if(this.editMsgId){var e,s;const a=u()(e=this.selectMessages).call(e,t=>t.id===this.editMsgId),i=kt()(s=this.selectMessages).call(s,t=>t.id!==this.editMsgId);let n="";n="Text Message"===t[0].type?u()(i).call(i,e=>e.messages[0].id===t[0].id||e.messages[0].messageId===t[0].id):u()(i).call(i,e=>e.messages[0].Id===t[0].Id),n||(a.messages=t)}else this.msgCount++,this.selectMessages=[],this.selectMessages.unshift({type:this.currentPopupType,messages:t,id:this.msgCount});this.editMsgId="",this.getMsgContentLink(t)},getMsgContentLink(t){let e="",s=t[0].type||t[0].Type;if("WeChat Structured Message"===s||"Link Structured Message"===s){for(let s of t[0].attachments)if(e=s.url,e&&this.checkFormLink(e))break}else if("Text Message"===s){if(e=t[0].content,/<a.*?>.*?<\/a>/.test(e)){const t=(new window.DOMParser).parseFromString(e,"text/html").getElementsByTagName("a");for(let e of t)if(this.checkFormLink(e.href))break}}},checkFormLink(t){let e=this.isRegister?this.registration.Form.FormURL:this.checkInFormLink;if(e){let s=e.split("?")[0],a=new RegExp(s);const i=[e,"".concat(e,"&")];if(a.test(t)&&!_t()(i).call(i,t)){let t=this.isRegister?this.$tc("global.registerLabel",1):this.$tc("global.checkInLabel",1);return this.qrResponseContent=this.$t("qrResponseContent",[t]),this.$refs.qrResponseModal.open(),!0}return!1}return!1},confirmSave(t){t&&(this.selectMessages=[]),this.$refs.qrResponseModal.close()},editSelectMsg(t){this.selectedMsg=t,this.$refs.msgDetail[0].editText()},updateTextMsg(t){this.selectedMsg.messages[0].content=t},deleteSelectMsg(t){var e;this.selectMessages=kt()(e=this.selectMessages).call(e,e=>e.id!==t.id)},toggleCodeActions(t){this.editCode&&this.editCode!==t&&(this.editCode.showActions=!1),t.showActions=!t.showActions,this.editCode=t,this.$root.$el.addEventListener("click",this.hideCodeActions)},hideCodeActions(){const t=this.$root.$el;this.editCode.showActions=!1,t.removeEventListener("click",this.hideCodeActions)},openActionModal(t,e,s){this.actionCode=t,this.modal.headerContent=e,this.modal.mainContent=s,this.$refs.codeModalPopup.open()},async closeActionModal(){this.$refs.codeModalPopup.close();try{var t;if((await Object(lt.a)(this.actionCode.QRCodeId,!this.actionCode.IsActive)).ok)this.currentCode.qrcodes=kt()(t=this.currentCode.qrcodes).call(t,t=>t.QRCodeId!==this.actionCode.QRCodeId),this.campaignStepId=this.isRegister?this.registerStepId:this.checkInStepId,await this.updateFlowStep(!0),this.$router.app.$emit("open-toast-notification",{content:this.$t("deactivateSuccessLabel"),type:"success"})}catch(t){Object(M.f)(t)}},onClickCancel(){this.$refs.codeModalPopup.close()},editQrcode(t){this.editCode=t,this.showQrcode=!0},closeEditQrcode(t){if(t){var e;let s=u()(e=this.currentCode.qrcodes).call(e,e=>e.QRCodeId===t.QRCodeId);s.Name=t.Name,s.WeChatTagIds=t.WeChatTagIds,s.WeChatMessage=t.WeChatMessage,s.IsOverwriteFollowerTag=t.IsOverwriteFollowerTag,s.tagTooltip=t.tagTooltip}else this.editCode={};this.showQrcode=!1},viewQrCodeImage(t){this.currentQrCode=t,this.$refs.ImagePreview.open()},async createQRCodesStep(){let t={QRCodeId:"",Name:"",WhatId:this.campaignStepId,Type:"",ExpirationSeconds:0,WeChatAccount:this.accountId,WeChatMessage:{Id:"",TextBody:""},CampaignMemberStatus:null,WeChatTagIds:[],IsOverwriteFollowerTag:this.wechatCampaign.isOverwriteFollowerTag,IsActive:!0};if(t.Name=this.isRegister?"".concat(this.wechatCampaign.name," - Registration"):"".concat(this.wechatCampaign.name," - Check-in"),"Day"===this.expireOptionData.currents[0].value?t.ExpirationSeconds=24*this.currentCode.validTime*3600:t.ExpirationSeconds=3600*this.currentCode.validTime,this.currentCode.isExpire?(t.Type="Permanent",t.ExpirationSeconds=""):t.Type="Temporary",this.selectMessages.length>0&&this.selectMessages[0].messages.length>0){const e=this.selectMessages[0].messages[0];t.WeChatMessage.Id=e.id||e.Id}for(const e of this.wechatCampaign.tags)t.WeChatTagIds.push(e.Id);const e=await(s=m()(t),a=this.currentCode.count,i=this.campaignStepId,Object(k.a)({method:"QRCodeRemoteActions.createQRCodes",args:[s,a,i]}));var s,a,i;if(e.ok)return JSON.parse(B.a.unescape(e.data)).qrcodeIds;this.isSubmit=!1,Object(M.f)(e)},async generateQRCodesStep(t){const e=await(s=t,Object(k.a)({method:"QRCodeRemoteActions.generateQRCodes",args:[s]}));var s;e.ok||(this.isSubmit=!1,Object(M.f)(e))},async getQRCodesStep(){const t=await L(this.campaignStepId);if(t.ok){const e=JSON.parse(B.a.unescape(t.data));this.currentCode.qrcodes=e.qrCodes,this.currentCode.qrcodes;for(const t of this.currentCode.qrcodes){this.$set(t,"showActions",!1);let e=[];for(const s of t.WeChatTags)e.push(s.TagName);this.$set(t,"tagTooltip",e.toString())}}else this.isSubmit=!1,Object(M.f)(t)},async updateFlowStep(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.registration.QRCodes=[];for(const t of this.currentCode.qrcodes)this.registration.QRCodes.push({Id:t.QRCodeId});let e=await N(this.$route.query.flowId);e=JSON.parse(B.a.unescape(e.data)),e=e.campaignFlow,this.storeFlowSteps(e.CampaignFlowSteps);let s="";for(const t of this.campaignFlowSteps)"Check-in"!==t.Type.Value||this.isRegister?"Registration"===t.Type.Value&&this.isRegister&&(s=t.CampaignMemberStatus):s=t.CampaignMemberStatus;const a=await S(this.campaignStepId,m()(this.registration),s);if(a.ok){if(t)return null;this.isSubmit=!1,this.currentCode.count=1,this.currentCode.validTime=30,this.currentCode.isExpire=!1,this.selectMessages=[],this.expireOptionData.currents=[{Name:this.$t("dayLabel"),value:"Day"}]}else this.isSubmit=!1,Object(M.f)(a)},async submit(){if(this.isShowResponse&&!this.hasForm)this.$emit("confirm-submit");else{this.isSubmit=!0,this.campaignStepId=this.isRegister?this.registerStepId:this.checkInStepId;try{const t=await this.createQRCodesStep();await this.generateQRCodesStep(t),await this.getQRCodesStep(),await this.updateFlowStep()}catch(t){this.isSubmit=!1,Object(M.f)(t)}}},back(){this.$emit("back")},next(){this.currentCode.message=this.selectMessages,this.currentCode.validType=this.expireOptionData.currents,this.$emit("select-qrcode",this.currentCode)},expireDateFilter(t){if(t<=0)return"".concat(this.$t("expiredLabel"));var e,s;if(t/60>0&&t/60<1.5)return H()(e="".concat(this.$tc("expireInLabel",2)," 1 ")).call(e,this.$tc("expireMinuteLabel",1));if(t/60>=1.5&&t/3600<=1.5){var a,i;const e=(t/60).toFixed(0);return H()(a=H()(i="".concat(this.$tc("expireInLabel",2)," ")).call(i,e," ")).call(a,this.$tc("expireMinuteLabel",2))}if(t/3600>1.5&&t/3600<24){var n,o;const e=(t/3600).toFixed(0);return H()(n=H()(o="".concat(this.$tc("expireInLabel",2)," ")).call(o,e," ")).call(n,this.$tc("expireHoursLabel",2))}if(t/3600>=24&&t/3600<36)return H()(s="".concat(this.$tc("expireInLabel",2)," 1 ")).call(s,this.$tc("expireDayLabel",1));{var r,c;const e=(t/86400).toFixed(0);return H()(r=H()(c="".concat(this.$tc("expireInLabel",2)," ")).call(c,e," ")).call(r,this.$tc("expireDayLabel",2))}}})},qt=(s("rU8W"),s("frfo")),Wt=Object(z.a)(Ut,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"charket-create-qrcode"},[s("section",{staticClass:"slds-box slds-grid main",class:{"check-in-qrcode":!t.isRegister}},[s("section",{staticClass:"field",class:{"check-in-field":!t.isRegister}},[s("div",{staticClass:"slds-form-element field-item"},[s("label",{staticClass:"slds-form-element__label",attrs:{for:"qrcode-count"}},[s("abbr",{staticClass:"slds-required"},[t._v("*")]),t._v(t._s(t.isRegister?t.$t("qrCodeRegisterNumberTitle"):t.$t("qrCodeCheckInNumberTitle")))]),t._v(" "),s("div",{staticClass:"slds-form-element__control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currentCode.count,expression:"currentCode.count"}],staticClass:"slds-input",class:{"qrcode-count-error":t.showError},attrs:{type:"text",id:"qrcode-count"},domProps:{value:t.currentCode.count},on:{keydown:function(e){return t.onlyNum(e,t.qrMaxCounts)},keyup:function(e){return t.checkNumLimit(t.currentCode.count,t.qrMaxCounts)},input:function(e){e.target.composing||t.$set(t.currentCode,"count",e.target.value)}}}),t._v(" "),t.showError?s("div",{staticClass:"qrcode-count-error-message"},[t._v(t._s(t.$t("qrCodeNumberLimitLabel")))]):t._e()])]),t._v(" "),s("div",{staticClass:"slds-form-element field-item"},[s("label",{staticClass:"slds-form-element__label"},[s("abbr",{staticClass:"slds-required"},[t._v("*")]),t._v(t._s(t.$t("qrCodeDayTitle")))]),t._v(" "),s("div",{staticClass:"slds-form-element__control slds-grid slds-grid_align-spread"},[s("div",{staticClass:"time-left-section"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currentCode.validTime,expression:"currentCode.validTime"}],staticClass:"slds-input expire-number",class:{"qrcode-count-error":t.showTimeError},attrs:{type:"text",disabled:t.currentCode.isExpire},domProps:{value:t.currentCode.validTime},on:{keydown:function(e){return t.onlyNum(e,t.timeMaxValue)},keyup:function(e){return t.checkNumLimit(t.currentCode.validTime,t.timeMaxValue)},input:function(e){e.target.composing||t.$set(t.currentCode,"validTime",e.target.value)}}}),t._v(" "),s("div",{staticClass:"lookup"},[s("input-select",{attrs:{currents:t.expireOptionData.currents,"is-disabled":t.currentCode.isExpire},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1),t._v(" "),t.showTimeError?s("div",{staticClass:"qrcode-count-error-message"},[t._v(t._s(t.$t("qrCodeDayLimitLabel")))]):t._e()]),t._v(" "),s("div",{staticClass:"time-right-section"},[s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("span",{staticClass:"slds-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currentCode.isExpire,expression:"currentCode.isExpire"}],attrs:{type:"checkbox",name:"options",id:"checkbox-isExpire-"+t.isRegister},domProps:{checked:Array.isArray(t.currentCode.isExpire)?t._i(t.currentCode.isExpire,null)>-1:t.currentCode.isExpire},on:{change:function(e){var s=t.currentCode.isExpire,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&t.$set(t.currentCode,"isExpire",s.concat([null])):n>-1&&t.$set(t.currentCode,"isExpire",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.currentCode,"isExpire",i)}}}),t._v(" "),s("label",{staticClass:"slds-checkbox__label checkbox-label",attrs:{for:"checkbox-isExpire-"+t.isRegister}},[s("span",{staticClass:"slds-checkbox_faux checkbox-span"}),t._v(" "),s("span",{staticClass:"slds-form-element__label checkbox-value"},[t._v(t._s(t.$t("expireLabel")))])])])])])])])]),t._v(" "),t.isRegister||!t.isRegister&&t.isShowResponse?s("div",{staticClass:"slds-form-element"},[s("label",{staticClass:"slds-form-element__label"},[s("abbr",{staticClass:"slds-required"},[t._v("*")]),t._v(t._s(t.isRegister?t.$t("registerMessageLabel"):t.$t("checkInMessageLabel"))+"\n        ")]),t._v(" "),s("div",{staticClass:"slds-box scan-section"},[s("div",{staticClass:"slds-border_bottom label-icon",class:{"border-bottom-none":0===t.selectMessages.length}},[s("span",{staticClass:"down-btn text-icon",on:{click:t.openTextSection}},[t.showTextSection?s("icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.$t("textLabel"),offset:5},expression:"{content: $t('textLabel'), offset: 5}"}],attrs:{name:"textActive",width:"20px",height:"20px"}}):s("icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.$t("textLabel"),offset:5},expression:"{content: $t('textLabel'), offset: 5}"}],attrs:{name:"text","class-name":"down-icon",width:"20px",height:"20px"}})],1),t._v(" "),s("span",{staticClass:"down-btn msg-icon",on:{click:t.openStrucSection}},[t.showStrucSection?s("icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.$t("strucLabel"),offset:5},expression:"{content: $t('strucLabel'), offset: 5}"}],attrs:{name:"strucActive",width:"20px",height:"20px"}}):s("icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.$t("strucLabel"),offset:5},expression:"{content: $t('strucLabel'), offset: 5}"}],attrs:{name:"StructuredMessage","class-name":"down-icon",width:"20px",height:"20px"}})],1)]),t._v(" "),0===t.selectMessages.length&&t.showTextSection?s("div",{staticClass:"slds-border_top slds-grid label-section"},[s("div",{staticClass:"slds-grid slds-grid_vertical slds-grid_vertical-align-center slds-col action-section",on:{click:function(e){t.showPopup(t.$t("global.popupHeader.createTextMessage"),"Text","text","")}}},[s("span",{staticClass:"down-btn action-icon"},[s("icon",{attrs:{name:"add","class-name":"down-icon",width:"20px",height:"20px"}})],1),t._v(" "),s("span",{staticClass:"action-value"},[t._v(t._s(t.$t("newMsgLabel")))])]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical slds-grid_vertical-align-center slds-col action-section",on:{click:function(e){t.showPopup(t.$t("global.popupHeader.selectTextMessage"),"Text","text","Edit")}}},[s("span",{staticClass:"down-btn action-icon"},[s("icon",{attrs:{name:"search","class-name":"down-icon",width:"20px",height:"20px"}})],1),t._v(" "),s("span",{staticClass:"action-value"},[t._v(t._s(t.$t("selectMsgLabel")))])])]):t._e(),t._v(" "),0===t.selectMessages.length&&t.showStrucSection?s("div",{staticClass:"slds-border_top slds-grid label-section"},[s("div",{staticClass:"slds-grid slds-grid_vertical slds-grid_vertical-align-center slds-col action-section",on:{click:t.openNewStruPopup}},[s("span",{staticClass:"down-btn action-icon"},[s("icon",{attrs:{name:"add","class-name":"down-icon",width:"20px",height:"20px"}})],1),t._v(" "),s("span",{staticClass:"action-value"},[t._v(t._s(t.$t("newMsgLabel")))])]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical slds-grid_vertical-align-center slds-col action-section",on:{click:function(e){t.showPopup(t.$t("global.popupHeader.selectStructuredMessage"),"Structured Message","structureMessage","")}}},[s("span",{staticClass:"down-btn action-icon"},[s("icon",{attrs:{name:"search","class-name":"down-icon",width:"20px",height:"20px"}})],1),t._v(" "),s("span",{staticClass:"action-value"},[t._v(t._s(t.$t("selectMsgLabel")))])])]):t._e(),t._v(" "),s("ul",{staticClass:"msg-list-section"},t._l(t.selectMessages,(function(e){return s("li",{staticClass:"slds-border_bottom",class:{stru:"structureMessage"===e.type}},[s("message-detail",{ref:"msgDetail",refInFor:!0,attrs:{"current-type":e.type,messages:e.messages,"hide-text-border":!0},on:{update:t.updateTextMsg}}),t._v(" "),s("div",{staticClass:"msg-action-section",class:{"stru-msg":"structureMessage"===e.type}},["structureMessage"!==e.type?s("span",{staticClass:"down-btn",on:{click:function(s){return t.editSelectMsg(e)}}},[s("icon",{attrs:{name:"editReplyIcon","class-name":"down-icon",width:"16px",height:"16px"}})],1):t._e(),t._v(" "),s("span",{staticClass:"down-btn",on:{click:function(s){return t.deleteSelectMsg(e)}}},[s("icon",{attrs:{name:"deleteReplyIcon","class-name":"down-icon",width:"16px",height:"16px"}})],1)])],1)})),0)])]):t._e(),t._v(" "),s("div",{staticClass:"footer-btn"},[s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.canSubmit},on:{click:t.submit}},[t._v(t._s(t.isSubmit?t.$t("submittingLabel"):t.$t("submitLabel")))])])]),t._v(" "),s("section",{staticClass:"slds-box slds-col list slds-scrollable_y",class:{"check-in-list":!t.isRegister}},[t.isSubmit?s("div",{staticClass:"slds-spinner_container"},[t._m(0)]):t._e(),t._v(" "),t.currentCode.qrcodes.length>0?s("ul",{staticClass:"list-items"},t._l(t.currentCode.qrcodes,(function(e){return s("li",{staticClass:"slds-grid slds-grid_vertical-align-center qr-li"},[s("div",{staticClass:"qr-pic",on:{click:function(s){return t.viewQrCodeImage(e)}}},[s("img",{attrs:{src:t._f("imgFilter")(e.WeChatQrCodeUrl)},on:{error:function(e){return t.showErrorImg(e)}}})]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical slds-grid_vertical-align-start qr-center-part"},[s("div",{staticClass:"qr-edit-part"},[s("a",{staticClass:"slds-truncate qr-name",attrs:{href:"/"+e.QRCodeId,target:"_blank"}},[t._v(t._s(e.Name))]),t._v(" "),s("div",{staticClass:"qr-right-btn"},[s("button",{staticClass:"slds-button slds-button_icon-border-filled slds-button_icon-x-small down-btn",on:{click:function(s){return s.stopPropagation(),t.toggleCodeActions(e)}}},[s("icon",{attrs:{name:"down","class-name":"down-icon",width:"0.75rem",height:"0.75rem"}})],1),t._v(" "),e.showActions?s("div",{staticClass:"slds-box action-list"},[s("div",{on:{click:function(s){return s.stopPropagation(),t.editQrcode(e)}}},[t._v(t._s(t.$t("global.editBtn")))]),t._v(" "),e.IsActive?s("div",{on:{click:function(s){s.stopPropagation(),t.openActionModal(e,t.$t("deactivateModalTitleLabel"),t.$t("deactivateModalContentLabel"))}}},[t._v(t._s(t.$t("global.deactivateBtn")))]):t._e()]):t._e()])]),t._v(" "),s("div",{staticClass:"qr-related"},[s("span",{staticClass:"tag-icon"},[s("icon",{attrs:{name:"tagGrey","fill-color":"#706e6b",width:"11px",height:"11px","charket-icon":""}})],1),t._v(" "),s("span",{staticClass:"tag-value"},[t._v(t._s(e.WeChatTagIds.length))]),t._v(" "),e.WeChatMessage?s("span",{staticClass:"expire-value"},[t._v(" • "),s("span",{staticClass:"response-icon"},[s("icon",{attrs:{name:"reply","fill-color":"#706e6b",width:"13px",height:"13px","charket-icon":""}})],1),t._v(t._s(t.responseMsgFilter(e.WeChatMessage.FileMapping)))]):t._e(),t._v(" "),"Temporary"===e.Type?s("span",{staticClass:"expire-value",class:{"qr-right-red":(e.ExpirationSeconds/86400).toFixed(0)<=7}},[t._v(" • "+t._s(t.expireDateFilter(e.ExpirationSeconds)))]):t._e()]),t._v(" "),s("div",{staticClass:"download-created"},[s("a",{staticClass:"slds-grid qr-download",attrs:{href:e.WeChatQrCodeUrl,target:"_blank"}},[s("span",{staticClass:"qr-download-icon down-btn"},[s("icon",{attrs:{name:"download","class-name":"down-icon",width:"12px",height:"12px"}})],1),t._v(" "),s("span",{staticClass:"download-span"},[t._v(t._s(t.$t("downloadLabel")))])])])])])})),0):t._e(),t._v(" "),0!==t.currentCode.qrcodes.length||t.isSubmit?t._e():s("section",{staticClass:"slds-grid slds-grid_align-center slds-grid_vertical-align-center list-no-record"},[s("span",[t._v(t._s(t.$t("noQRCodeLabel")))])])])]),t._v(" "),t.isRegister?s("section",{staticClass:"slds-border_top footer"},[s("button",{staticClass:"slds-button slds-button_neutral btn-left",on:{click:function(e){return t.back()}}},[t._v(t._s(t.$t("global.backBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand btn-right",attrs:{disabled:!t.canNext},on:{click:function(e){return t.next()}}},[t._v(t._s(t.$t("global.nextBtn")))])]):t._e(),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.expireOptionData.options,currents:t.expireOptionData.currents,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e(),t._v(" "),t.showNewStruPopup?s("new-stru-popup",{ref:"newStruPopup",attrs:{"account-id":t.accountId},on:{close:function(e){return t.closeNewStruPopup()},"get-data":function(e){return t.getNewStruData(e)}}}):t._e(),t._v(" "),t.showQrcode?s("new-qrcode",{attrs:{messages:t.selectMessages,code:t.editCode},on:{close:t.closeEditQrcode}}):t._e(),t._v(" "),s("message-popup",{ref:"msgpopupmodel",attrs:{"acc-id":t.accountId,"header-content":t.popupHeaderContent,"page-name":"QR Codes of WeChat Campaign","popup-type":t.currentPopupType,"is-multi-select":!1,"stru-msg-type":"news"},on:{getSelectedMessage:t.getSelectedMessage}}),t._v(" "),s("image-preview",{ref:"ImagePreview",attrs:{url:t._f("imgFilter")(t.currentQrCode.WeChatQrCodeUrl),name:t.currentQrCode.Name}}),t._v(" "),s("ld-modal",{ref:"codeModalPopup",attrs:{title:t.modal.headerContent},scopedSlots:t._u([{key:"content",fn:function(){return[s("p",{staticClass:"slds-p-around_medium slds-align_absolute-center"},[t._v(t._s(t.modal.mainContent))])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{neutral:""},on:{click:function(e){return t.onClickCancel()}}},[t._v("\n        "+t._s(t.$t("global.cancelBtn"))+"\n      ")]),t._v(" "),s("ld-button",{attrs:{brand:""},on:{click:function(e){return t.closeActionModal()}}},[t._v("\n        "+t._s(t.$t("global.confirmBtn"))+"\n      ")])]},proxy:!0}])}),t._v(" "),s("ld-modal",{ref:"qrResponseModal",attrs:{title:t.$t("qrResponseHeader")},scopedSlots:t._u([{key:"content",fn:function(){return[s("p",{staticClass:"slds-p-around_medium slds-align_absolute-center"},[t._v(t._s(t.qrResponseContent))])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{neutral:""},on:{click:function(e){return t.confirmSave(!1)}}},[t._v("\n        "+t._s(t.$t("confirmSave"))+"\n      ")]),t._v(" "),s("ld-button",{attrs:{brand:""},on:{click:function(e){return t.confirmSave(!0)}}},[t._v("\n        "+t._s(t.$t("reselect"))+"\n      ")])]},proxy:!0}])})],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"slds-spinner_brand slds-spinner slds-spinner_small",attrs:{role:"alert"}},[e("span",{staticClass:"slds-assistive-text"},[this._v("Loading")]),this._v(" "),e("div",{staticClass:"slds-spinner__dot-a"}),this._v(" "),e("div",{staticClass:"slds-spinner__dot-b"})])}],!1,null,"7b78cee0",null);"function"==typeof qt.default&&Object(qt.default)(Wt);var Qt=Wt.exports,Vt=s("iP86"),Ht=s.n(Vt),Kt=s("aF8D"),Jt=s("Pjfr"),Yt={props:{showFooter:{type:Boolean,default:()=>!0},getSubmitMsg:{type:Boolean,default:()=>!1}},computed:o()({},Object(P.c)({wechatCampaign:"wechatCampaign/campaign",campaignFlowSteps:"wechatCampaign/campaignFlowSteps"}),{campaignMemberStatusOptions(){var t;return this.statusOptions.length>0?this.statusOptions:Ht()(t=this.getCampaignMemberStatusOptions).call(t,this)},campaignMemberStatusValue(){return this.statusOptions.length>0?this.config.campaignMemberStatus:""}}),components:{UeditorPopup:Kt.a,LdPicklist:Jt.LdPicklist,WechatResponse:It.a},mounted(){this.$root.$on("fetch-register-data",async(t,e)=>{this.showFooter&&(await this.initPageData(t,e),this.addAction(),e.messageLabel=this.config.messageLabel)}),this.$root.$on("fetch-check-in-data",async(t,e)=>{this.showFooter||(await this.initPageData(t,e),this.addAction(),e.messageLabel=this.config.messageLabel)})},beforeDestroy(){let t=this.$root;t.$off("fetch-register-data"),t.$off("fetch-check-in-data")},data(){return{picklistUrlLabel:this.$t("urlLabel"),picklistThanksMsgLabel:this.$t("showThanksMsgLabel"),submittedActionOptions:[{label:this.$t("urlLabel"),value:"Redirect To"},{label:this.$t("showThanksMsgLabel"),value:"Show Thank You Message"}],campaignMemberStatusPlaceholder:this.$t("noneLabel"),notifyMsgLabel:this.$t("notifyMsgLabel"),textMsgLabel:this.$t("textMsgLabel"),imageMsgLabel:this.$t("imageMsgLabel"),videoMsgLabel:this.$t("videoMsgLabel"),voiceMsgLabel:this.$t("voiceMsgLabel"),strucMsgLabel:this.$t("strucMsgLabel"),passMsgLabel:this.$t("passMsgLabel"),couponMsgLabel:this.$t("couponMsgLabel"),miniProgramMsgLabel:this.$t("miniProgramLabel"),skillMsgLabel:this.$t("skillLabel"),statusOptions:[],showUeditorPopup:!1,ueditorPopupGetReady:!1,config:{submittedAction:"Show Thank You Message",thanksMsg:"",redirectUrl:"",campaignMemberStatus:"",messageLabel:[],TemplateIds:[],MessageIds:[],PassId:"",CouponIds:[],SkillId:""},response:{items:[]}}},methods:{getPassTooltip(){var t;return kt()(t=this.response.items).call(t,t=>"Pass"===t.type).length>=1?this.$t("passLimitLabel"):this.$t("global.passLabel")},onSubmittedActionChange(t){this.config.submittedAction=t.value},async getCampaignMemberStatusOptions(){try{const t=await Ft.c.getCampaignMemberStatusOptions(this.wechatCampaign.id),e=J()(t).call(t,t=>({label:t,value:t}));if(this.showFooter){u()(e).call(e,t=>"Accepted"===t.label||"已接受"===t.label)||e.push({label:this.$t("acceptedLabel"),value:this.$t("acceptedLabel")})}else{u()(e).call(e,t=>"Attended"===t.label||"已签到"===t.label)||e.push({label:this.$t("attendedLabel"),value:this.$t("attendedLabel")})}return this.statusOptions=e,this.statusOptions}catch(t){this.$handleError(t)}},onCampaignMemberStatusChange(t){this.config.campaignMemberStatus=t.value},async initPageData(t,e){let s="";for(const t of this.campaignFlowSteps)"Check-in"!==t.Type.Value||this.showFooter?"Registration"===t.Type.Value&&this.showFooter&&(s=t.CampaignMemberStatus):s=t.CampaignMemberStatus;s&&(this.config.campaignMemberStatus=s,e.campaignMemberStatus=s,0===this.statusOptions.length&&(this.campaignMemberStatusPlaceholder=s)),this.config.thanksMsg=t.Form.ThankYouMessage,this.config.redirectUrl=t.Form.RedirectURL,t.CompletionActions.SubmittedAction&&(this.config.submittedAction=t.CompletionActions.SubmittedAction);const a=t.CompletionActions.TemplateIds,i=t.CompletionActions.MessageIds,n=t.CompletionActions.PassId,o=t.CompletionActions.CouponIds,r=t.CompletionActions.SkillId;await this.fetchResponseItems({messageIds:i,notificationIds:a,passId:n,couponIds:o,skillId:r})},fetchResponseItems(t){let{messageIds:e,notificationIds:s,passId:a,couponIds:i,skillId:n}=t;return this.$try(async()=>{const[t,o,r,c,l]=await d.a.all([this.getCoupons(i),this.getWeChatPass(a),this.getNotificationTemplates(s),this.getWeChatMessages(e),this.getSkill(n)]);this.response.items.push(...t,...o,...r,...c,...l)})},async getWeChatMessages(t){if(!t||0===t.length)return[];const e=await Ft.k.getMessagesById(t);return J()(e).call(e,t=>(t.updateDateTime?t.localizedUpdateDateTime=Object(R.e)(t.updateDateTime,this.$user.TimeZoneSidKey):t.weChatLastModifiedTime&&(t.localizedWeChatLastModifiedTime=Object(R.e)(t.weChatLastModifiedTime,this.$user.TimeZoneSidKey)),t))},async getNotificationTemplates(t){if(!t||0===t.length)return[];const e=await Ft.m.getByIds(t);return J()(e).call(e,t=>(t.localizedCreatedDate=Object(R.e)(t.createdDate,this.$user.TimeZoneSidKey),t))},async getWeChatPass(t){if(!t)return[];return[await Ft.n.getById(t)]},async getCoupons(t){if(!t||0===t.length)return[];return await Ft.e.getByIds(t)},async getSkill(t){if(!t)return[];return[await Ft.r.getSkill(t)]},openUeditorPopup(){this.showUeditorPopup=!0,this.ueditorPopupGetReady?(this.$off("ueditorReady"),this.$refs.ueditorPopup.editor.setContent(this.config.thanksMsg)):this.$on("ueditorReady",()=>{this.$refs.ueditorPopup.editor.setContent(this.config.thanksMsg)})},closeUeditorPopup(){this.showUeditorPopup=!1},setThanksMsg(t){this.config.thanksMsg=t,this.closeUeditorPopup()},ueditorPopupReady(){this.ueditorPopupGetReady=!0,this.$emit("ueditorReady")},back(){this.$emit("back")},addAction(){this.getAction(this.config)},getAction(t){let e=0,s=0,a=0,i=0,n=0,o=0,r=0,c=0,l=0,d=0;this.config.messageLabel=[],this.config.MessageIds=[],this.config.TemplateIds=[],this.config.CouponIds=[],this.config.PassId="",this.config.SkillId="";for(const t of this.response.items){const h=t.id;switch(t.type){case"Text Message":s++,this.config.MessageIds.push(h);break;case"Image":a++,this.config.MessageIds.push(h);break;case"Voice Message":n++,this.config.MessageIds.push(h);break;case"Video":i++,this.config.MessageIds.push(h);break;case"Mini Program Page":l++,this.config.MessageIds.push(h);break;case"WeChat Structured Message":case"Link Structured Message":o++,this.config.MessageIds.push(h);break;case"Pass":r++,this.config.PassId=h;break;case"Cash":case"Discount":case"General Coupon":case"Gift":case"Groupon":c++,this.config.CouponIds.push(h);break;case"Notification Template":e++,this.config.TemplateIds.push(h);break;case"Skill":d++,this.config.SkillId=h}}e>0&&this.config.messageLabel.push({count:e,label:this.notifyMsgLabel}),s>0&&this.config.messageLabel.push({count:s,label:this.textMsgLabel}),a>0&&this.config.messageLabel.push({count:a,label:this.imageMsgLabel}),i>0&&this.config.messageLabel.push({count:i,label:this.videoMsgLabel}),n>0&&this.config.messageLabel.push({count:n,label:this.voiceMsgLabel}),o>0&&this.config.messageLabel.push({count:o,label:this.strucMsgLabel}),r>0&&this.config.messageLabel.push({count:r,label:this.passMsgLabel}),c>0&&this.config.messageLabel.push({count:c,label:this.couponMsgLabel}),l>0&&this.config.messageLabel.push({count:l,label:this.miniProgramMsgLabel}),d>0&&this.config.messageLabel.push({count:d,label:this.skillMsgLabel})},next(){this.addAction(),this.$emit("select-action",this.config)}}},Gt=(s("EaUY"),s("ngDp")),Zt=Object(z.a)(Yt,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"charket-completion-actions"},[s("section",{staticClass:"slds-box main",class:{"check-in-actions":!t.showFooter}},[s("div",{staticClass:"slds-grid completion-action-section"},[s("label",{staticClass:"form-label"},[t._v(t._s(t.$t("formActionLabel")))]),t._v(" "),s("div",{staticClass:"completion-action-input-wrapper"},[s("ld-picklist",{attrs:{options:t.submittedActionOptions,value:t.config.submittedAction},on:{change:t.onSubmittedActionChange}})],1)]),t._v(" "),s("div",["Redirect To"===t.config.submittedAction?s("div",{staticClass:"slds-grid completion-action-section"},[s("label",[t._v(t._s(t.$t("redirectUrlLabel")))]),t._v(" "),s("div",{staticClass:"completion-action-textarea-wrapper"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.config.redirectUrl,expression:"config.redirectUrl"}],staticClass:"slds-input",attrs:{type:"text"},domProps:{value:t.config.redirectUrl},on:{input:function(e){e.target.composing||t.$set(t.config,"redirectUrl",e.target.value)}}})])]):s("div",{staticClass:"slds-grid completion-action-section"},[s("label",[t._v(t._s(t.$t("thanksMsgLabel")))]),t._v(" "),s("div",{staticClass:"completion-action-textarea-wrapper"},[s("div",{staticClass:"slds-box thankyou-message-area charket-edui edui-init-style",domProps:{innerHTML:t._s(t.config.thanksMsg)},on:{click:function(e){return t.openUeditorPopup()}}})])])]),t._v(" "),s("div",{staticClass:"slds-grid completion-action-section"},[s("label",{staticClass:"form-label"},[t._v(t._s(t.$t("responseLabel")))]),t._v(" "),s("wechat-response",{attrs:{"page-name":"SMART REPLIES","wechat-account":t.wechatCampaign.account,choosers:["Notification Template",{type:"Pass",limit:1,limitLabel:t.getPassTooltip()},"Text Message","Image","Structured Message","Voice Message","Video","Mini Program Page","Coupon","Skill"],multiple:""},model:{value:t.response,callback:function(e){t.response=e},expression:"response"}})],1),t._v(" "),s("div",{staticClass:"slds-grid completion-action-section"},[s("label",{staticClass:"form-label"},[t._v(t._s(t.$t("campaignStatusLabel")))]),t._v(" "),s("div",{staticClass:"completion-action-input-wrapper"},[s("ld-picklist",{attrs:{options:t.campaignMemberStatusOptions,placeholder:t.campaignMemberStatusPlaceholder,value:t.campaignMemberStatusValue},on:{change:t.onCampaignMemberStatusChange}})],1)])]),t._v(" "),t.showFooter?s("section",{staticClass:"slds-border_top footer"},[s("button",{staticClass:"slds-button slds-button_neutral btn-left",on:{click:function(e){return t.back()}}},[t._v(t._s(t.$t("global.backBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand btn-right",on:{click:function(e){return t.next()}}},[t._v(t._s(t.$t("global.nextBtn")))])]):t._e(),t._v(" "),s("ueditor-popup",{directives:[{name:"show",rawName:"v-show",value:t.showUeditorPopup,expression:"showUeditorPopup"}],ref:"ueditorPopup",attrs:{"ueditor-title":t.$t("editThankYouMessage")},on:{ready:t.ueditorPopupReady,"update-description":t.setThanksMsg,"close-editor":t.closeUeditorPopup}})],1)}),[],!1,null,"aaf58b20",null);"function"==typeof Gt.default&&Object(Gt.default)(Zt);var Xt=Zt.exports,te={props:{form:{type:Object,default:()=>({})},confirmData:{type:Object,default:()=>({})},hasBadge:{type:Boolean,default:()=>!1},stepType:{type:String,required:!0}},inject:["showErrorImg"],watch:{confirmData:{handler(t){this.currentData=t},deep:!0},"form.Form.Id":async function(t){try{var e;const s=await Object(it.f)(t),a="Register"===this.stepType?this.registerStepId:this.checkInStepId;this.formLink=B.a.unescape(s.data)?H()(e="".concat(B.a.unescape(s.data),"&spid=")).call(e,a):""}catch(t){Object(M.f)(t)}}},data:()=>({currentQrCode:{},isShowQrCodeImg:!1,currentData:{qrcodes:[],messageLabel:[],formName:"",isPrint:"",campaignMemberStatus:""},formLink:""}),computed:o()({},Object(P.c)({wechatCampaign:"wechatCampaign/campaign",registerStepId:"wechatCampaign/registerStepId",checkInStepId:"wechatCampaign/checkInStepId"}),{selectedMsgInfo(){let t="";for(const s of this.currentData.messageLabel){var e;s.count>1&&"en"===this.$i18n.locale&&(s.label+="s"),t+=H()(e=" ".concat(s.count," ")).call(e,s.label,",")}return t=t.substring(0,t.length-1),t},isFormDetailVisible(){return!this.hasBadge&&this.currentData.formName||this.hasBadge&&this.form.IsAcceptOnSiteRegistration&&this.currentData.formName}}),components:{ImagePreview:zt.ImagePreview},methods:{responseMsgFilter(t){const e=t.type||t.Type;return"Text Message"===e?"1 ".concat(this.$t("global.textMsgLabel")):"WeChat Structured Message"===e||"Link Structured Message"===e?"1 ".concat(this.$t("global.strucMsgLabel")):void 0},viewQrCodeImage(t){this.currentQrCode=t,this.$refs.ImagePreview.open()},back(){this.$emit("back")},save(){this.$emit("save")},saveAndDownload(){for(const t of this.currentData.qrcodes)this.downloadFile(t.Name,t.WeChatQrCodeUrl);this.$emit("save")},downloadFile(t,e){let s=document.createElement("a"),a=document.createEvent("HTMLEvents");a.initEvent("click"),s.href=e,s.download=t,s.dispatchEvent(a)},previewForm(){this.formLink&&window.open("".concat(this.formLink,"&preview=1"))},expireDateFilter(t){if(t<=0)return"".concat(this.$t("expiredLabel"));var e,s;if(t/60>0&&t/60<1.5)return H()(e="".concat(this.$tc("expireInLabel",2)," 1 ")).call(e,this.$tc("expireMinuteLabel",1));if(t/60>=1.5&&t/3600<=1.5){var a,i;const e=(t/60).toFixed(0);return H()(a=H()(i="".concat(this.$tc("expireInLabel",2)," ")).call(i,e," ")).call(a,this.$tc("expireMinuteLabel",2))}if(t/3600>1.5&&t/3600<24){var n,o;const e=(t/3600).toFixed(0);return H()(n=H()(o="".concat(this.$tc("expireInLabel",2)," ")).call(o,e," ")).call(n,this.$tc("expireHoursLabel",2))}if(t/3600>=24&&t/3600<36)return H()(s="".concat(this.$tc("expireInLabel",2)," 1 ")).call(s,this.$tc("expireDayLabel",1));{var r,c;const e=(t/86400).toFixed(0);return H()(r=H()(c="".concat(this.$tc("expireInLabel",2)," ")).call(c,e," ")).call(r,this.$tc("expireDayLabel",2))}}}},ee=(s("utAx"),s("L5tX")),se=Object(z.a)(te,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"confirm-section"},[s("section",{staticClass:"slds-box slds-grid main"},[s("section",{staticClass:"slds-col"},[s("div",{staticClass:"slds-grid confirm-info"},[s("label",[t._v(t._s(t.$t("formLabel")))]),t._v(" "),t.isFormDetailVisible?s("div",{staticClass:"slds-grid slds-grid_vertical confirm-info-container"},[s("div",{staticClass:"slds-grid slds-col confirm-info-content"},[s("div",{staticClass:"confirm-form-name"},[t._v("\n               "+t._s(t.currentData.formName)+"\n               "),s("span",{staticClass:"preview-icon",on:{click:t.previewForm}},[s("icon",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.$t("previewLabel")},expression:"{content: $t('previewLabel')}"}],attrs:{name:"newWindow","fill-color":"#706e6b",width:"14px",height:"14px","charket-icon":""}})],1)])]),t._v(" "),s("div",{staticClass:"slds-grid confirm-form-link"},[s("div",{staticClass:"slds-form-element__control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.formLink,expression:"formLink"}],staticClass:"slds-input form-url",attrs:{type:"text",disabled:!0},domProps:{value:t.formLink},on:{input:function(e){e.target.composing||(t.formLink=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"copy-btn down-btn",on:{click:function(e){t.$_charket_copyText(t.formLink,t.$t("copySuccess"),t.$t("copyFailed"))}}},[s("icon",{attrs:{name:"copy","class-name":"down-icon",width:"14px",height:"14px"}})],1)])]):t._e()]),t._v(" "),s("div",{staticClass:"slds-grid confirm-info"},[s("label",[t._v(t._s(t.$t("urlLabel")))]),t._v(" "),s("div",{staticClass:"slds-col confirm-info-content"},[s("a",{attrs:{href:t.form.Form.RedirectURL,target:"_blank"}},[t._v(t._s(t.form.Form.RedirectURL))])])]),t._v(" "),s("div",{staticClass:"slds-grid confirm-info"},[s("label",[t._v(t._s(t.$t("tagLabel")))]),t._v(" "),s("div",{staticClass:"slds-col confirm-info-content"},[s("ul",t._l(t.wechatCampaign.tags,(function(e){return s("li",{staticClass:"label-list-item"},[s("span",[t._v(t._s(e.Name))])])})),0)])]),s("div",{staticClass:"slds-grid confirm-info"},[s("label",[t._v(t._s(t.$t("responseLabel")))]),t._v(" "),s("div",{staticClass:"slds-col confirm-info-content"},[s("span",[t._v(t._s(t.selectedMsgInfo))])])]),s("div",{staticClass:"slds-grid confirm-info"},[s("label",[t._v(t._s(t.$t("campaignStatusLabel")))]),t._v(" "),s("div",{staticClass:"slds-col confirm-info-content"},[t._v("\n           "+t._s(t.currentData.campaignMemberStatus)+"\n         ")])]),s("div",{staticClass:"slds-grid confirm-info"},[t.hasBadge?s("div",{staticClass:"confirm-badge-content"},[s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("span",{staticClass:"slds-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currentData.isPrint,expression:"currentData.isPrint"}],attrs:{type:"checkbox",name:"options",id:"confirm-print-badge",disabled:""},domProps:{checked:Array.isArray(t.currentData.isPrint)?t._i(t.currentData.isPrint,null)>-1:t.currentData.isPrint},on:{change:function(e){var s=t.currentData.isPrint,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&t.$set(t.currentData,"isPrint",s.concat([null])):n>-1&&t.$set(t.currentData,"isPrint",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.currentData,"isPrint",i)}}}),t._v(" "),s("label",{staticClass:"slds-checkbox__label checkbox-label",attrs:{for:"confirm-print-badge"}},[s("span",{staticClass:"slds-checkbox_faux checkbox-span"}),t._v(" "),s("span",{staticClass:"slds-form-element__label checkbox-value"},[t._v(t._s(t.$t("badgeLabel")))])])])])])]):t._e()])]),t._v(" "),0!==t.currentData.qrcodes.length?s("section",{staticClass:"slds-col confirm-right list slds-scrollable_y"},[s("label",[t._v(t._s(t.$t("qrCodeLabel")))]),t._v(" "),s("ul",{staticClass:"list-items"},t._l(t.currentData.qrcodes,(function(e){return s("li",{staticClass:"slds-grid qr-li"},[s("div",{staticClass:"qr-pic",on:{click:function(s){return t.viewQrCodeImage(e)}}},[s("img",{attrs:{src:t._f("imgFilter")(e.WeChatQrCodeUrl)},on:{error:function(e){return t.showErrorImg(e)}}})]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical slds-grid_vertical-align-start qr-center-part"},[s("div",{staticClass:"qr-edit-part"},[s("a",{staticClass:"slds-truncate qr-name",attrs:{href:"/"+e.QRCodeId,target:"_blank"}},[t._v(t._s(e.Name))])]),t._v(" "),s("div",{staticClass:"qr-related"},[s("span",{staticClass:"tag-icon"},[s("icon",{attrs:{name:"tagGrey","fill-color":"#706e6b",width:"11px",height:"11px","charket-icon":""}})],1),t._v(" "),s("span",{staticClass:"tag-value"},[t._v(t._s(e.WeChatTagIds.length))]),t._v(" "),e.WeChatMessage?s("span",{staticClass:"expire-value"},[t._v(" • "),s("span",{staticClass:"response-icon"},[s("icon",{attrs:{name:"reply","fill-color":"#706e6b",width:"13px",height:"13px","charket-icon":""}})],1),t._v(t._s(t.responseMsgFilter(e.WeChatMessage.FileMapping)))]):t._e(),t._v(" "),"Temporary"===e.Type?s("span",{staticClass:"expire-value",class:{"qr-right-red":(e.ExpirationSeconds/86400).toFixed(0)<=7}},[t._v(" • "+t._s(t.expireDateFilter(e.ExpirationSeconds)))]):t._e()]),t._v(" "),s("div",{staticClass:"download-created"},[s("a",{staticClass:"slds-grid qr-download",attrs:{href:e.WeChatQrCodeUrl,target:"_blank"}},[s("span",{staticClass:"qr-download-icon down-btn"},[s("icon",{attrs:{name:"download","class-name":"down-icon",width:"12px",height:"12px"}})],1),t._v(" "),s("span",{staticClass:"download-span"},[t._v(t._s(t.$t("downloadLabel")))])])])])])})),0)]):t._e()]),t._v(" "),s("section",{staticClass:"slds-border_top footer"},[s("button",{staticClass:"slds-button slds-button_neutral btn-left",on:{click:function(e){return t.back()}}},[t._v(t._s(t.$t("global.backBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand btn-right",on:{click:function(e){return t.save()}}},[t._v(t._s(t.$t("global.saveBtn")))])]),t._v(" "),s("image-preview",{ref:"ImagePreview",attrs:{url:t._f("imgFilter")(t.currentQrCode.WeChatQrCodeUrl),name:t.currentQrCode.Name}})],1)}),[],!1,null,"330e032e",null);"function"==typeof ee.default&&Object(ee.default)(se);var ae=se.exports,ie={computed:o()({},Object(P.c)({wechatCampaign:"wechatCampaign/campaign",registerStepId:"wechatCampaign/registerStepId"})),components:{Wizard:G,SelectForm:bt,CreateQrcode:Qt,CompletionActions:Xt,Confirmation:ae},data(){return{steps:[{label:this.$t("formStepLabel"),title:this.$t("formStepTitle"),value:this.$t("formStepValue"),stepApi:"Select Form",page:0},{label:this.$t("qrCodeStepLabel"),title:this.$t("qrCodeStepTitle"),value:this.$t("qrCodeStepValue"),stepApi:"Create QR Codes",page:1},{label:this.$t("actionStepLabel"),title:this.$t("actionStepTitle"),value:this.$t("actionStepValue"),stepApi:"Completion Actions",page:2},{label:this.$t("confirmStepLabel"),title:this.$t("confirmStepTitle"),value:this.$t("confirmStepValue"),stepApi:"Confirm & Save",page:3}],stepIndex:0,selectedIndex:0,currentStep:{},registration:{Step:"Select Form",Form:{Editable:!0,Id:"",Title:"",Banner:"",ThankYouMessage:"",RedirectURL:"",FormURL:""},QRCodes:[],CompletionActions:{TemplateIds:[],MessageIds:[],PassId:"",CouponIds:[],SkillId:"",SubmittedAction:""},flowStepPage:0},confirmData:{formName:"",messageLabel:[],qrcodes:[],campaignMemberStatus:""},currentFlow:{},qrModalContent:"",confirmCodes:[]}},async created(){"edit"===this.wechatCampaign.type?(await this.fetchCampaignFlowStepRules(),this.currentStep=this.steps[this.registration.flowStepPage],this.stepIndex=this.registration.flowStepPage,this.selectedIndex=this.registration.flowStepPage):(this.currentStep=this.steps[0],this.fetchCampaignStepId())},methods:o()({},Object(P.b)("wechatCampaign",["storeRegisterStepId"]),{async fetchCampaignFlowStepRules(){try{const t=await I(this.wechatCampaign.flowId,"Registration"),e=JSON.parse(B.a.unescape(t.data));this.registration=e,this.registration.Step=this.registration.Step||"Select Form",this.registration,this.$root.$emit("fetch-register-data",this.registration,this.confirmData)}catch(t){Object(M.f)(t)}},async fetchCampaignStepId(){try{const t=await x(this.wechatCampaign.flowId,"Registration",m()(this.registration)),e=JSON.parse(B.a.unescape(t.data));this.$router.replace({path:"/wechat-campaign/register",query:{flowId:this.wechatCampaign.flowId,flowStepId:e.wechatCampaignFlowStepId}}),this.storeRegisterStepId(e.wechatCampaignFlowStepId)}catch(t){Object(M.f)(t)}},cancel(){this.$emit("cancel-flow")},back(){document.querySelector(".flow-tab-right").scrollTop=0,this.selectedIndex=this.selectedIndex-1,this.currentStep=this.steps[this.selectedIndex]},next(){document.querySelector(".flow-tab-right").scrollTop=0,this.selectedIndex<this.stepIndex?this.selectedIndex=this.selectedIndex+1:(this.stepIndex=this.stepIndex+1,this.selectedIndex=this.stepIndex),this.currentStep=this.steps[this.selectedIndex],this.registration.Step=this.currentStep.stepApi,this.registration.flowStepPage<this.currentStep.page&&(this.registration.flowStepPage=this.currentStep.page),S(this.registerStepId,m()(this.registration),this.confirmData.campaignMemberStatus)},selectStep(t){if(this.selectedIndex=t,this.currentStep=this.steps[t],t===this.steps.length-1){const t=this.$refs.completionActions,e=this.$refs.selectForm,s=this.$refs.createQRCode;t.addAction(),this.currentFlow={form:e.currentForm,actions:t.config,qrCodes:s.currentCode.qrcodes},"Show Thank You Message"===this.currentFlow.actions.submittedAction?this.currentFlow.actions.redirectUrl="":this.currentFlow.actions.thanksMsg="",this.registration.Form.Id=e.currentForm.Id,this.registration.Form.RedirectURL=this.currentFlow.actions.redirectUrl,this.confirmData={qrcodes:this.currentFlow.qrCodes,messageLabel:this.currentFlow.actions.messageLabel,formName:this.currentFlow.form.Name,campaignMemberStatus:this.currentFlow.actions.campaignMemberStatus||""}}},getForm(t){this.confirmData.formName=t.Name,this.registration.Form.Id=t.Id,this.registration.Form.Title=t.Title,this.registration.Form.Banner=t.Banner,this.registration.Form.Title=t.Title,this.registration.Form.FormURL=t.URL,this.registration.Form.Editable=t.Editable,this.next()},getQrcode(t){this.registration.QRCodes=[];for(const e of t.qrcodes)this.registration.QRCodes.push({Id:e.QRCodeId});this.confirmData.qrcodes=t.qrcodes,this.next()},getAction(t){this.registration.CompletionActions.SubmittedAction=t.submittedAction||"","Show Thank You Message"===this.registration.CompletionActions.SubmittedAction?(this.registration.Form.ThankYouMessage=t.thanksMsg,this.registration.Form.RedirectURL=""):(this.registration.Form.RedirectURL=t.redirectUrl,this.registration.Form.ThankYouMessage=""),this.confirmData.messageLabel=t.messageLabel,this.confirmData.campaignMemberStatus=t.campaignMemberStatus||"",this.registration.CompletionActions.MessageIds=t.MessageIds,this.registration.CompletionActions.TemplateIds=t.TemplateIds,this.registration.CompletionActions.PassId=t.PassId,this.registration.CompletionActions.CouponIds=t.CouponIds,this.registration.CompletionActions.SkillId=t.SkillId,this.next()},async updateQRCodeResponses(t){try{const e=await F(this.registerStepId,m()(this.registration));if(e.ok){const s=JSON.parse(B.a.unescape(e.data));if(s.QRCodeIdsToManualUpdate.length>0){this.confirmCodes=[];for(const e of s.QRCodeIdsToManualUpdate){let s=u()(t).call(t,t=>t.QRCodeId===e)||{};this.confirmCodes.push(s.Name)}this.confirmCodes,this.qrModalContent=this.$t("global.qrCodeConfirmContent",[this.$tc("global.registerLabel",1)]),this.$refs.qrModal.open()}else await this.confirmSave(!0)}else Object(M.f)(e)}catch(t){Object(M.f)(t)}},async confirmSave(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.$refs.qrModal.close();try{var t;this.registration.QRCodes=J()(t=this.confirmData.qrcodes).call(t,t=>({Id:t.QRCodeId}));const e=await S(this.registerStepId,m()(this.registration),this.confirmData.campaignMemberStatus);e.ok?this.$emit("flow-done"):Object(M.f)(e)}catch(t){Object(M.f)(t)}},saveFlow(){if(f()(this.currentFlow).length>0){var t;const e=this.currentFlow.form,s=this.currentFlow.actions,a=J()(t=this.currentFlow.qrCodes).call(t,t=>({Id:t.QRCodeId}));this.registration={Step:this.registration.Step,Form:{Editable:e.Editable,Id:e.Id,Title:e.Title,Banner:e.Banner,ThankYouMessage:s.thanksMsg,RedirectURL:s.redirectUrl,FormURL:e.URL},QRCodes:a,CompletionActions:{TemplateIds:s.TemplateIds,MessageIds:s.MessageIds,PassId:s.PassId,CouponIds:s.CouponIds,SkillId:s.SkillId,SubmittedAction:s.submittedAction||""},flowStepPage:this.registration.flowStepPage}}this.updateQRCodeResponses(this.$refs.createQRCode.currentCode.qrcodes)},onClickCancel(){this.$refs.qrModal.close()}})},ne=(s("OBMq"),s("7XhL")),oe=Object(z.a)(ie,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"wechat-register-flow"},[s("section",{staticClass:"wizard-section"},[s("wizard",{attrs:{steps:t.steps,"step-index":t.stepIndex,"select-index":t.selectedIndex},on:{"select-step":t.selectStep}})],1),t._v(" "),s("p",{staticClass:"step-title"},[t._v(t._s(t.currentStep.title))]),t._v(" "),s("p",{staticClass:"step-value"},[t._v(t._s(t.currentStep.value))]),t._v(" "),s("section",{staticClass:"content"},[s("select-form",{directives:[{name:"show",rawName:"v-show",value:0===t.currentStep.page,expression:"currentStep.page === 0"}],ref:"selectForm",on:{"select-form":t.getForm,"cancel-form":t.cancel}}),t._v(" "),s("create-qrcode",{directives:[{name:"show",rawName:"v-show",value:1===t.currentStep.page,expression:"currentStep.page === 1"}],ref:"createQRCode",attrs:{"has-form":t.registration.Form.Id,"register-flow":t.registration},on:{back:t.back,"select-qrcode":t.getQrcode}}),t._v(" "),s("completion-actions",{directives:[{name:"show",rawName:"v-show",value:2===t.currentStep.page,expression:"currentStep.page === 2"}],ref:"completionActions",on:{"select-action":t.getAction,back:t.back}}),t._v(" "),s("confirmation",{directives:[{name:"show",rawName:"v-show",value:3===t.currentStep.page,expression:"currentStep.page === 3"}],attrs:{"confirm-data":t.confirmData,form:t.registration,stepType:"Register"},on:{back:t.back,save:t.saveFlow}})],1),t._v(" "),s("ld-modal",{ref:"qrModal",attrs:{title:t.$t("global.qrCodeConfirmHeader",[t.$tc("global.registerLabel",2)])},scopedSlots:t._u([{key:"content",fn:function(){return[s("div",{staticClass:"slds-p-around_medium modal-content"},[s("p",{staticClass:"main-content"},[t._v(t._s(t.qrModalContent))]),t._v(" "),s("ul",t._l(t.confirmCodes,(function(e,a){return s("li",{key:a},[t._v("- "+t._s(e))])})),0)])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{neutral:""},on:{click:function(e){return t.onClickCancel()}}},[t._v("\n        "+t._s(t.$t("global.cancelBtn"))+"\n      ")]),t._v(" "),s("ld-button",{attrs:{brand:""},on:{click:function(e){return t.confirmSave()}}},[t._v("\n        "+t._s(t.$t("global.confirmSaveBtn"))+"\n      ")])]},proxy:!0}])})],1)}),[],!1,null,"e0014b74",null);"function"==typeof ne.default&&Object(ne.default)(oe);var re=oe.exports,ce=s("WE60"),le=s.n(ce),de=s("3O4B"),he=s.n(de),ue=s("UX+f"),pe={props:{checkInStaff:{type:Array,default:function(){return[]}},methodBtn:{type:String,default:""}},data(){return{followers:[],currentFollower:{},selectedFollower:{},addCheckInStaffModal:{header:this.$t("addCheckInStaffLabel"),isSaving:!1},lookup:{currentItem:null,metadata:[{name:"WeChatFollower__c",label:this.$tc("weChatFollowerLabel",1),labelPural:this.$tc("weChatFollowerLabel",2),icon:"custom.followers",linkField:{name:"Name",label:this.$t("followerNameLabel")},fields:[]}]},ns:""}},computed:o()({},Object(P.c)({wechatCampaign:"wechatCampaign/campaign"}),{condition(){var t,e;const s=H()(t="".concat(dt.a.getQualifiedName("WeChatAccount__c")," = '")).call(t,this.wechatCampaign.account.id,"'");return this.checkInStaff.length>0?H()(e="".concat(s," and Id not in ('")).call(e,this.checkInStaff.join("','"),"')"):s}}),components:{Lookup:ct.a,CktLink:ue.a},watch:{checkInStaff:async function(){await this.getStaff();for(let t of this.followers)this.$set(t,"displayActionBox",!1)}},methods:{showActionBox(t){t.Id!==this.currentFollower.Id&&(this.currentFollower.displayActionBox=!1),this.currentFollower=t,t.displayActionBox=!t.displayActionBox,this.$root.$el.addEventListener("click",this.hideActionBox)},hideActionBox(){const t=this.$root.$el;this.currentFollower.displayActionBox=!1,t.removeEventListener("click",this.hideActionBox)},OpenStaffModal(){this.$refs.addCheckInStaffModal.open()},closeStaffModal(){this.$refs.addCheckInStaffModal.close()},closeStaffModalCb(){this.$refs.staffLookup.$refs.typeahead.remove(),this.clearSelectedFollower()},onSelect(t){this.selectedFollower=t},clearSelectedFollower(){this.selectedFollower={}},async saveStaff(){var t,e,s,a,i;let n=H()(t=H()(e=H()(s=H()(a=H()(i="select Id, Name, ".concat(this.ns,"DisplayName__c, ")).call(i,this.ns,"Lead__r.Name, ")).call(a,this.ns,"Contact__r.Name, ")).call(s,this.ns,"ProfilePhotoUrl__c from ")).call(e,this.ns,"WeChatFollower__c where Id = '")).call(t,this.selectedFollower.id,"'");this.addCheckInStaffModal.isSaving=!0;try{const t=await Object(lt.c)(n);if(t.ok){var o;const e=JSON.parse(B.a.unescape(t.data))[0];this.$set(e,"displayActionBox",!1),_t()(o=this.checkInStaff).call(o,e.Id)||this.followers.push(e),this.$refs.addCheckInStaffModal.close(),this.$emit("add-staff",e.Id),this.$router.app.$emit("open-toast-notification",{content:this.$t("saveStaffLabel"),type:"success"})}else this.$refs.addCheckInStaffModal.showError(t.error)}catch(t){const e=this.$parseErrorMessage(t);this.$refs.addCheckInStaffModal.showError(e)}this.addCheckInStaffModal.isSaving=!1},openDeleteFollowerPopup(t){const e=this.$confirm({content:this.$t("deleteStaffContentLabel"),title:this.$t("deleteStaffHeaderLabel"),ok:this.$t("global.deleteBtn")});e.$on("ok",async()=>{var t,s;let a=le()(t=this.followers).call(t,t=>t.Id===this.currentFollower.Id);this.$emit("remove-staff",this.followers[a].Id),he()(s=this.followers).call(s,a,1),e.close()})},async getStaff(){if(this.checkInStaff.length>0){var t,e,s,a,i;let n=H()(t=H()(e=H()(s=H()(a=H()(i="select Id, Name, ".concat(this.ns,"DisplayName__c, ")).call(i,this.ns,"Lead__r.Name, ")).call(a,this.ns,"Contact__r.Name, ")).call(s,this.ns,"ProfilePhotoUrl__c from ")).call(e,this.ns,"WeChatFollower__c where Id in ('")).call(t,this.checkInStaff.join("','"),"')");try{let t=await Object(lt.c)(n);if(t.ok){let e=JSON.parse(B.a.unescape(t.data));this.followers=e}else Object(M.f)(t)}catch(t){Object(M.f)(t)}}}}},me=(s("9duB"),s("cMbL"),s("5Msn")),ge=Object(z.a)(pe,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"pass-section"},[s("section",{staticClass:"staff-list"},[s("section",{staticClass:"slds-grid slds-grid_vertical-align-center slds-grid_align-spread table-caption"},[s("label",{staticClass:"slds-text-heading_small"},[t._v(t._s(t.$t("checkInStaffLabel")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_neutral add-follower-btn",on:{click:t.OpenStaffModal}},[t._v(t._s(t.$t("addLabel")))])]),t._v(" "),s("table",{staticClass:"slds-table slds-table_bordered slds-no-row-hover",attrs:{role:"grid"}},[s("thead",[s("tr",{staticClass:"slds-line-height_reset",staticStyle:{height:"2rem"}},[s("th",[s("label",{},[t._v(t._s(t.$tc("nameLabel",1)))])]),t._v(" "),s("th",[s("label",[t._v(t._s(t.$t("relatedObjLabel")))])]),t._v(" "),s("th",{staticClass:"action-th"})])]),t._v(" "),s("tbody",t._l(t.followers,(function(e){return s("tr",[s("td",[s("img",{staticClass:"avator",attrs:{src:e.ProfilePhotoUrl__c}}),t._v(" "),s("ckt-link",{staticClass:"follower-name",attrs:{href:"/"+e.Id,label:e.Name,"is-console-tab-active":!0,"console-primary-tab-name":e.Name}})],1),t._v(" "),s("td",[e.Lead__r?s("ckt-link",{attrs:{href:"/"+e.Lead__r.Id,label:e.Lead__r.Name,"is-console-tab-active":!0,"console-primary-tab-name":e.Lead__r.Name}}):e.Contact__r?s("ckt-link",{attrs:{href:"/"+e.Contact__r.Id,label:e.Contact__r.Name,"is-console-tab-active":!0,"console-primary-tab-name":e.Contact__r.Name}}):t._e()],1),t._v(" "),s("td",{staticClass:"action"},[s("div",{staticClass:"btn-position"},[s("button",{staticClass:"slds-button slds-button_icon-border-filled slds-button_icon-x-small down-btn",on:{click:function(s){return s.stopPropagation(),t.showActionBox(e)}}},[s("icon",{attrs:{name:"down","class-name":"down-icon",width:"0.75rem",height:"0.75rem"}})],1),t._v(" "),e.displayActionBox?s("div",{staticClass:"slds-box action-dropdown"},[s("div",{staticClass:"action-item",on:{click:function(s){return t.openDeleteFollowerPopup(e.Id)}}},[t._v(t._s(t.$t("global.deleteBtn")))])]):t._e()])])])})),0)]),t._v(" "),0===t.followers.length?s("section",{staticClass:"no-records"},[s("label",[t._v(t._s(t.$t("noRecordLabel")))])]):t._e()]),t._v(" "),s("ld-modal",{ref:"addCheckInStaffModal",staticClass:"add-staff-modal",attrs:{title:t.addCheckInStaffModal.header,width:"50%","min-width":"490px"},on:{close:function(e){return t.closeStaffModalCb()}},scopedSlots:t._u([{key:"content",fn:function(){return[s("div",{staticClass:"slds-p-around_medium"},[s("div",{staticClass:"slds-form-element staff-lookup-container"},[s("label",{staticClass:"slds-form-element__label follower-label"},[t._v(t._s(t.$t("followerNameLabel")))]),t._v(" "),s("div",{staticClass:"slds-form-element__control follower-input"},[t.lookup.metadata.length>0?s("lookup",{ref:"staffLookup",attrs:{"ld-selected-item":t.lookup.currentItem,"ld-metadatas":t.lookup.metadata,condition:t.condition},on:{select:t.onSelect,remove:function(e){return t.clearSelectedFollower()}}}):t._e()],1)])])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{disabled:t.addCheckInStaffModal.isSaving,neutral:""},on:{click:t.closeStaffModal}},[t._v("\n        "+t._s(t.$t("global.cancelBtn"))+"\n      ")]),t._v(" "),s("ld-button",{attrs:{disabled:t.addCheckInStaffModal.isSaving||!t.selectedFollower.id,brand:""},on:{click:function(e){return t.saveStaff()}}},[t._v("\n        "+t._s(t.$t("global.saveBtn"))+"\n      ")])]},proxy:!0}])})],1)}),[],!1,null,"ef0ae9b0",null);"function"==typeof me.default&&Object(me.default)(ge);var fe=ge.exports,ve={mixins:[y.a,gt,rt],props:{checkInStaff:{type:Array,default:function(){return[]}},checkInData:{type:Object,default:function(){return{}}}},data(){return{methodBtn:"QRCode",formMetadata:{name:"Form__c",label:this.$tc("formLabel",1),labelPural:this.$tc("formLabel",2),icon:"custom.forms",linkField:{name:"Name",label:this.$tc("formLabel",1)},fields:[],newObjectLink:"Self Link"},currentItem:null,currentForm:{Id:"",Name:"",Title:"",Banner:"",MasterObject:"",URL:"",RecordType:"",Note:"",Link:"",LongURL:""},statusOptionData:{options:[],currentOptions:[]},qrCodeAbout:{isAcceptOnSiteRegistration:!1,isOnlyRegisteredCanCheckin:!1,isAcceptOtherChannel:!1,campaignMemberStatus:[],otherChannelPrompt:"",type:""},checkIn:{Step:"",QRCodes:[],Form:{Id:"",Title:"",Banner:"",ThankYouMessage:"",RedirectURL:"",FormURL:""},Type:"",CheckinStaff:[],IsAcceptOnSiteRegistration:!1,IsOnlyRegisteredCanCheckin:!1,AcceptedMemberStatus:[],IsAcceptOtherChannel:!1,OtherChannelPrompt:"",CompletionActions:{TemplateIds:[],MessageIds:[],CampaignMemberStatus:"",IsPrint:!1,SubmittedAction:"",FailedResponse:""},BadgeTemplates:[],flowStepPage:0},previewFormId:"check-in-preview-form",showConfirm:!1}},computed:o()({},Object(P.c)({wechatCampaign:"wechatCampaign/campaign",checkInStepId:"wechatCampaign/checkInStepId",form:"wechatCampaign/form"}),{canNextForm(){return(!this.qrCodeAbout.isAcceptOnSiteRegistration||this.qrCodeAbout.isAcceptOnSiteRegistration&&this.currentForm.Name)&&(!this.qrCodeAbout.isAcceptOtherChannel||this.qrCodeAbout.isAcceptOtherChannel&&this.qrCodeAbout.otherChannelPrompt)}}),components:{Lookup:ct.a,InputSelect:C.a,Dropdown:_.a,CreateQrcode:Qt,PassCheckInMethod:fe},mounted(){this.$root.$on("fetch-check-in-data",async(t,e)=>{await this.fetchFlowName(t.Form.Id),e.formName=this.currentForm.Name,this.currentForm.Id?this.currentItem={id:this.currentForm.Id,name:this.currentForm.Name}:this.currentItem="",this.checkIn=t,this.currentForm.Title=t.Form.Title,this.currentForm.Banner=t.Form.Banner,this.currentForm.URL=t.Form.FormURL,this.qrCodeAbout.isAcceptOnSiteRegistration=t.IsAcceptOnSiteRegistration,this.qrCodeAbout.isOnlyRegisteredCanCheckin=t.IsOnlyRegisteredCanCheckin,this.qrCodeAbout.isAcceptOtherChannel=t.IsAcceptOtherChannel,this.qrCodeAbout.otherChannelPrompt=t.OtherChannelPrompt,this.qrCodeAbout.type=t.Type,this.methodBtn=t.Type;for(const e of t.AcceptedMemberStatus)this.qrCodeAbout.campaignMemberStatus.push(e),this.statusOptionData.currentOptions.push({Name:e,Value:e})}),this.$root.$on("flow-select-form",t=>{this.checkIn.flowStepPage<1&&(t.Id?(this.currentForm=t,this.currentItem={name:this.currentForm.Name,id:this.currentForm.Id}):(this.currentForm=t,this.currentItem=null));const e=this.currentForm.LongURL||"";this.currentForm.URL=e,this.$root.$emit("select-long-url",e)})},watch:{dropdownRefId:async function(){if(this.statusOptionData.options.length<=0)try{let t=await Object(lt.b)(this.wechatCampaign.id);if(t=JSON.parse(B.a.unescape(t.data)),t.campaignMemberStatus.length>0)for(const e of t.campaignMemberStatus)this.statusOptionData.options.push({Name:e,Value:e})}catch(t){Object(M.f)(t)}},"qrCodeAbout.isAcceptOnSiteRegistration":async function(){this.qrCodeAbout.isAcceptOnSiteRegistration?(this.qrCodeAbout.isOnlyRegisteredCanCheckin=!1,this.$root.$emit("check-in-response",!0)):this.$root.$emit("check-in-response",!1)},"qrCodeAbout.isOnlyRegisteredCanCheckin":function(){this.qrCodeAbout.isOnlyRegisteredCanCheckin&&(this.qrCodeAbout.isAcceptOnSiteRegistration=!1)},checkInData:{handler(t){this.checkIn=t},deep:!0}},methods:{confirmSubmit(){this.showConfirm=!0,document.querySelector(".flow-tab-right").scrollTop=0},async fetchFlowName(t){try{const e=await T(t),s=JSON.parse(B.a.unescape(e.data));this.currentForm.Name=s.formName,this.currentForm.Id=t}catch(t){Object(M.f)(t)}},async selectForm(t){if(this.currentForm.Id=t?t.id:"",this.currentForm.Id){this.showConfirm=!1;try{const t=await this.searchSelectForm(this.currentForm.Id),e=JSON.parse(B.a.unescape(t.data))[0];t.ok?(this.currentForm.Name=e.Name,this.currentForm.Title=e.Title__c,this.currentForm.Banner=e.Banner__c,this.currentForm.MasterObject=e.MasterObject__c,this.currentForm.URL=e.LongUrl__c||"",this.$root.$emit("select-long-url",this.currentForm.URL),this.currentForm.RecordType=e.RecordTypeId__c,this.currentForm.Note=e.Note__c):Object(M.f)(t)}catch(t){Object(M.f)(t)}}},removeForm(t){this.currentForm={Id:"",Name:"",Title:"",Banner:"",MasterObject:"",URL:"",RecordType:"",Note:"",Link:""},this.currentItem=null,this.$root.$emit("select-long-url","")},goToFormList(){const t=window.location.href,e=X()(t).call(t,"#");if(e>-1){const s=t.substring(0,e+1);window.open("".concat(s,"/forms"),"","",!1)}},selectPicklist(t){this.statusOptionData.currentOptions=t,this.qrCodeAbout.campaignMemberStatus=[];for(let e of t)this.qrCodeAbout.campaignMemberStatus.push(e.Value)},removeStaff(t){this.$emit("remove-staff",t)},addStaff(t){this.$emit("add-staff",t)},cancel(){this.$emit("cancel-check-in")},next(){this.qrCodeAbout.type=this.methodBtn,this.qrCodeAbout.isOnlyRegisteredCanCheckin||(this.qrCodeAbout.campaignMemberStatus=[],this.statusOptionData.currentOptions=[]),this.qrCodeAbout.isAcceptOtherChannel||(this.qrCodeAbout.otherChannelPrompt=""),this.$emit("get-method",this.currentForm,this.$refs.createQRCode.currentCode,this.qrCodeAbout)}}},we=(s("OMe9"),s("miT4")),be=Object(z.a)(ve,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"charket-select-check-in-method"},[s("section",{staticClass:"slds-box main"},[s("section",{staticClass:"slds-grid check-in-method-section"},[s("label",{staticClass:"select-label"},[t._v(t._s(t.$t("methodLabel")))]),t._v(" "),s("div",{staticClass:"slds-button-group btn-group",attrs:{role:"group"}},[s("button",{staticClass:"slds-button select-btn",class:{"slds-button_brand":"QRCode"===t.methodBtn,"slds-button_neutral":"Pass"===t.methodBtn},on:{click:function(e){t.methodBtn="QRCode"}}},[t._v(t._s(t.$t("qrCodeMethodBtnLabel")))]),t._v(" "),s("button",{staticClass:"slds-button select-btn",class:{"slds-button_neutral":"QRCode"===t.methodBtn,"slds-button_brand":"Pass"===t.methodBtn},on:{click:function(e){t.methodBtn="Pass"}}},[t._v(t._s(t.$t("passMethodBtnLabel")))])])]),t._v(" "),s("section",{directives:[{name:"show",rawName:"v-show",value:"QRCode"===t.methodBtn,expression:"methodBtn === 'QRCode'"}],staticClass:"qr-code-section"},[s("section",{staticClass:"check-in-setting-section"},[s("p",{staticClass:"check-in-title"},[t._v(t._s(t.$t("settingLabel")))]),t._v(" "),s("div",{staticClass:"slds-grid section-content"},[s("div",{staticClass:"slds-col section-content-left"},[s("div",{staticClass:"checkbox-section"},[s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("span",{staticClass:"slds-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.qrCodeAbout.isAcceptOnSiteRegistration,expression:"qrCodeAbout.isAcceptOnSiteRegistration"}],attrs:{type:"checkbox",name:"options",id:"accept-register"},domProps:{checked:Array.isArray(t.qrCodeAbout.isAcceptOnSiteRegistration)?t._i(t.qrCodeAbout.isAcceptOnSiteRegistration,null)>-1:t.qrCodeAbout.isAcceptOnSiteRegistration},on:{change:function(e){var s=t.qrCodeAbout.isAcceptOnSiteRegistration,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&t.$set(t.qrCodeAbout,"isAcceptOnSiteRegistration",s.concat([null])):n>-1&&t.$set(t.qrCodeAbout,"isAcceptOnSiteRegistration",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.qrCodeAbout,"isAcceptOnSiteRegistration",i)}}}),t._v(" "),s("label",{staticClass:"slds-checkbox__label checkbox-label",attrs:{for:"accept-register"}},[s("span",{staticClass:"slds-checkbox_faux checkbox-span"}),t._v(" "),s("span",{staticClass:"slds-form-element__label checkbox-value"},[t._v(t._s(t.$t("onsiteLabel")))])])])])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.qrCodeAbout.isAcceptOnSiteRegistration,expression:"qrCodeAbout.isAcceptOnSiteRegistration"}],staticClass:"form-section"},[s("div",{staticClass:"slds-form-element field-item"},[s("label",{staticClass:"slds-form-element__label"},[s("abbr",{staticClass:"slds-required"},[t._v("*")]),t._v(t._s(t.$tc("formLabel",1)))]),t._v(" "),s("div",{staticClass:"slds-form-element__control form-input"},[s("lookup",{attrs:{"is-danger":t.showConfirm,"ld-selected-item":t.currentItem,"ld-metadatas":t.formMetadata},on:{select:function(e){return t.selectForm(e)},remove:function(e){return t.removeForm(e)},"self-link":t.goToFormList}}),t._v(" "),t.showConfirm?s("p",{staticClass:"confirm-info"},[t._v(t._s(t.$t("confirmInfo")))]):t._e()],1)]),t._v(" "),s("div",{staticClass:"slds-form-element field-item"},[s("label",{staticClass:"slds-form-element__label"},[t._v(t._s(t.$t("titleLabel")))]),t._v(" "),s("div",{staticClass:"slds-form-element__control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currentForm.Title,expression:"currentForm.Title"}],staticClass:"slds-input",attrs:{type:"text"},domProps:{value:t.currentForm.Title},on:{input:function(e){e.target.composing||t.$set(t.currentForm,"Title",e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"slds-form-element field-item"},[s("label",{staticClass:"slds-form-element__label"},[t._v(t._s(t.$t("bannerLabel")))]),t._v(" "),s("div",{staticClass:"slds-form-element__control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.currentForm.Banner,expression:"currentForm.Banner"}],staticClass:"slds-input",attrs:{type:"text"},domProps:{value:t.currentForm.Banner},on:{input:function(e){e.target.composing||t.$set(t.currentForm,"Banner",e.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"checkbox-section"},[s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("span",{staticClass:"slds-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.qrCodeAbout.isOnlyRegisteredCanCheckin,expression:"qrCodeAbout.isOnlyRegisteredCanCheckin"}],attrs:{type:"checkbox",name:"options",id:"can-check-in"},domProps:{checked:Array.isArray(t.qrCodeAbout.isOnlyRegisteredCanCheckin)?t._i(t.qrCodeAbout.isOnlyRegisteredCanCheckin,null)>-1:t.qrCodeAbout.isOnlyRegisteredCanCheckin},on:{change:function(e){var s=t.qrCodeAbout.isOnlyRegisteredCanCheckin,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&t.$set(t.qrCodeAbout,"isOnlyRegisteredCanCheckin",s.concat([null])):n>-1&&t.$set(t.qrCodeAbout,"isOnlyRegisteredCanCheckin",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.qrCodeAbout,"isOnlyRegisteredCanCheckin",i)}}}),t._v(" "),s("label",{staticClass:"slds-checkbox__label checkbox-label",attrs:{for:"can-check-in"}},[s("span",{staticClass:"slds-checkbox_faux checkbox-span"}),t._v(" "),s("span",{staticClass:"slds-form-element__label checkbox-value"},[t._v(t._s(t.$t("attendLabel")))])])])])])]),t._v(" "),t.qrCodeAbout.isOnlyRegisteredCanCheckin?s("div",{staticClass:"form-section"},[s("div",{staticClass:"slds-form-element field-item"},[s("label",{staticClass:"slds-form-element__label"},[t._v(t._s(t.$t("acceptStatusLabel")))]),t._v(" "),s("div",{staticClass:"status-section"},[s("input-select",{attrs:{"default-label":t.$t("memberStatusLabel"),currents:t.statusOptionData.currentOptions,"is-single-selection":!1},on:{"close-dropdown":t.closeDropdown,"open-dropdown":t.openDropdown,resize:t.resizeDropdown,"remove-option":t.selectPicklist}})],1)])]):t._e(),t._v(" "),s("div",{staticClass:"checkbox-section"},[s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("span",{staticClass:"slds-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.qrCodeAbout.isAcceptOtherChannel,expression:"qrCodeAbout.isAcceptOtherChannel"}],attrs:{type:"checkbox",name:"options",id:"accept-other-channel"},domProps:{checked:Array.isArray(t.qrCodeAbout.isAcceptOtherChannel)?t._i(t.qrCodeAbout.isAcceptOtherChannel,null)>-1:t.qrCodeAbout.isAcceptOtherChannel},on:{change:function(e){var s=t.qrCodeAbout.isAcceptOtherChannel,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&t.$set(t.qrCodeAbout,"isAcceptOtherChannel",s.concat([null])):n>-1&&t.$set(t.qrCodeAbout,"isAcceptOtherChannel",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.qrCodeAbout,"isAcceptOtherChannel",i)}}}),t._v(" "),s("label",{staticClass:"slds-checkbox__label checkbox-label",attrs:{for:"accept-other-channel"}},[s("span",{staticClass:"slds-checkbox_faux checkbox-span"}),t._v(" "),s("span",{staticClass:"slds-form-element__label checkbox-value"},[t._v(t._s(t.$t("channelLabel")))])])])])])]),t._v(" "),t.qrCodeAbout.isAcceptOtherChannel?s("div",{staticClass:"form-section"},[s("div",{staticClass:"slds-form-element field-item"},[s("label",{staticClass:"slds-form-element__label"},[t._v(t._s(t.$t("uponLabel"))),s("abbr",{staticClass:"slds-required"},[t._v(" *")])]),t._v(" "),s("div",{staticClass:"slds-form-element__control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.qrCodeAbout.otherChannelPrompt,expression:"qrCodeAbout.otherChannelPrompt"}],staticClass:"slds-input",attrs:{type:"text",placeholder:t.$t("moblileLabel")},domProps:{value:t.qrCodeAbout.otherChannelPrompt},on:{input:function(e){e.target.composing||t.$set(t.qrCodeAbout,"otherChannelPrompt",e.target.value)}}})])])]):t._e()]),t._v(" "),s("div",{staticClass:"slds-box slds-grid slds-grid_align-space slds-grid_vertical-align-center section-content-right",class:{"preview-none":!t.qrCodeAbout.isAcceptOnSiteRegistration},style:{backgroundColor:t.defaultPreviewBg}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.qrCodeAbout.isAcceptOnSiteRegistration&&t.currentForm.Id,expression:"qrCodeAbout.isAcceptOnSiteRegistration && currentForm.Id"}],ref:"previewContent",staticClass:"preview-container preview-form slds-scrollable_y",attrs:{id:t.previewFormId}}),t._v(" "),t.currentForm.Id?t._e():s("span",{staticClass:"preview-value"},[t._v(t._s(t.$t("previewLabel")))])])])]),t._v(" "),s("section",{staticClass:"check-in-setting-section"},[s("p",{staticClass:"check-in-title"},[t._v(t._s(t.$t("qrCodeLabel")))]),t._v(" "),s("create-qrcode",{ref:"createQRCode",attrs:{"check-in-form-link":t.currentForm.URL,"has-form":t.currentForm.Id,"register-flow":t.checkIn,"is-register":!1},on:{"confirm-submit":t.confirmSubmit}})],1),t._v(" "),t.showDropdown?s("dropdown",{attrs:{"is-single-selection":!1,options:t.statusOptionData.options,currents:t.statusOptionData.currentOptions,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e()],1),t._v(" "),s("section",{directives:[{name:"show",rawName:"v-show",value:"Pass"===t.methodBtn,expression:"methodBtn === 'Pass'"}]},[s("pass-check-in-method",{directives:[{name:"show",rawName:"v-show",value:"Pass"===t.methodBtn,expression:"methodBtn === 'Pass'"}],attrs:{"check-in-staff":t.checkInStaff},on:{"remove-staff":t.removeStaff,"add-staff":t.addStaff}})],1)]),t._v(" "),s("section",{staticClass:"slds-border_top footer"},[s("button",{staticClass:"slds-button slds-button_neutral btn-left",on:{click:function(e){return t.cancel()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand btn-right",attrs:{disabled:!t.canNextForm||!(t.$refs.createQRCode&&t.$refs.createQRCode.canNext)},on:{click:function(e){return t.next()}}},[t._v(t._s(t.$t("global.nextBtn")))])])])}),[],!1,null,"5ccb7825",null);"function"==typeof we.default&&Object(we.default)(be);var Ce=be.exports,_e=s("UPjd"),ye=s("5flY"),ke={components:{NoRecord:w.a,LdTable:_e.LdTable},props:{selectedItem:{type:Object,default:()=>({})}},data(){return{isLoading:!1,isLoadingMore:!1,pageSize:20,pageCount:0,searchKey:"",badgeList:[],selectedBadge:{},headers:[{text:this.$t("nameLabel"),value:"Name"},{text:this.$t("sizeLabel"),value:"Size"},{text:this.$t("lastDateLabel"),value:"LastModifiedDate"}],selectedIndex:-1,infiniteDisabled:!1}},computed:{isTableVisible(){return this.badgeList.length>0},confirmBtnDisabled(){return!this.selectedBadge.Id},noRecordVisible(){return 0===this.badgeList.length&&!this.isLoading}},created(){this.selectedBadge=this.selectedItem.Id?this.selectedItem:{},this.selectedIndex=this.getSelectedIndex()},async mounted(){this.$refs.Modal.open(),this.isLoading=!0,await this.getBadgesList()},watch:{badgeList(){this.selectedIndex=this.getSelectedIndex()}},methods:{sizeFilter(t){if(t){var e;const s=t.split("x");return H()(e="".concat(Number(s[0])," mm x ")).call(e,Number(s[1])," mm")}return t},async getBadgesList(){try{const e=await Object(ye.e)(this.pageSize*this.pageCount,this.pageSize,this.searchKey);if(this.isLoading=!1,this.isLoadingMore=!1,e.ok){if(e.data){var t;const s=JSON.parse(B.a.unescape(e.data));for(const t of s)this.selectedBadge.Id&&t.Id===this.selectedBadge.Id?this.$set(t,"isSelectedShow",!0):this.$set(t,"isSelectedShow",!1),t.LastModifiedDate=Object(R.e)(t.LastModifiedDate,this.$user.TimeZoneSidKey);this.badgeList=H()(t=this.badgeList).call(t,s),this.infiniteDisabled=s.length<this.pageSize,this.pageCount++}}else Object(M.f)(e)}catch(t){this.isLoading=!1,this.isLoadingMore=!1,Object(M.f)(t)}},onInfinite(){this.isLoadingMore||this.badgeList.length>=this.pageCount*this.pageSize&&(this.isLoadingMore=!0,this.getBadgesList())},search(){this.pageCount=0,this.badgeList=[],this.isLoading=!0,this.getBadgesList()},clearSearch(){this.searchKey="",this.search()},onClickCancel(){this.$emit("close")},onClickConfirm(){this.$emit("get-badge",[this.selectedBadge]),this.$emit("close")},onSelect(t){t.isSelectedShow=!t.isSelectedShow,t.isSelectedShow?this.selectedBadge=t:this.selectedBadge="";for(let e of this.badgeList)e.Id!==t.Id&&(e.isSelectedShow=!1);this.selectedIndex=this.getSelectedIndex()},getSelectedIndex(){var t;return this.selectedBadge?le()(t=this.badgeList).call(t,t=>t.Id===this.selectedBadge.Id):-1}}},xe=(s("Vvpt"),s("NlwA"),s("h3Rw")),Se=Object(z.a)(ke,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ld-modal",{ref:"Modal",staticClass:"badge-modal",class:{"modal-loaded":!t.isLoading},attrs:{width:"90%","min-width":"auto",title:t.$t("badgeTitle")},on:{close:function(e){return t.onClickCancel()}},scopedSlots:t._u([{key:"content",fn:function(){return[s("div",{staticClass:"slds-grid slds-grid_align-spread slds-border_bottom badge-modal__header"},[s("div",{staticClass:"badge-modal__search"},[s("search-input",{attrs:{placeholder:t.$t("global.searchPlaceholder")},on:{search:t.search,clear:t.clearSearch},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}})],1)]),t._v(" "),s("div",{staticClass:"badge-modal__list-view"},[t.isLoading?s("div",{staticClass:"loading-wrapper"},[s("ld-loading")],1):t._e(),t._v(" "),t.noRecordVisible?s("div",{staticClass:"no-record-wrapper"},[s("no-record")],1):t._e(),t._v(" "),t.isTableVisible?s("ld-table",{staticClass:"scroll-content",attrs:{headers:t.headers,rows:t.badgeList,"infinite-disabled":t.infiniteDisabled,"single-select":!0,"selected-index":t.selectedIndex},on:{infinite:t.onInfinite,select:t.onSelect},scopedSlots:t._u([{key:"item.Size",fn:function(e){var a=e.item;return[s("div",{staticClass:"slds-truncate slds-grid slds-grid_vertical-align-center row-item",attrs:{title:t.sizeFilter(a.Size)}},[t._v("\n            "+t._s(t.sizeFilter(a.Size))+"\n          ")])]}}],null,!1,449563651)}):t._e()],1)]},proxy:!0},{key:"footer",fn:function(){return[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.onClickCancel()}}},[t._v("\n      "+t._s(t.$t("global.cancelBtn"))+"\n    ")]),t._v(" "),s("button",{staticClass:"slds-button slds-button_neutral slds-button_brand",attrs:{disabled:t.confirmBtnDisabled},on:{click:function(e){return t.onClickConfirm()}}},[t._v("\n      "+t._s(t.$t("global.confirmBtn"))+"\n    ")])]},proxy:!0}])})}),[],!1,null,"58d35eba",null);"function"==typeof xe.default&&Object(xe.default)(Se);var Ie=Se.exports,Le=s("FK88"),Ne={props:{showFailedResponse:{type:Boolean,default:()=>!0},getSubmitMsg:{type:Boolean,default:()=>!1}},data:()=>({showBadgeListPopup:!1,selectedBadge:{},isSelectedBadge:!1,failedResponse:""}),components:{CompletionActions:Xt,SelectBadgeList:Ie,BadgePreview:Le.a},mounted(){this.$root.$on("fetch-check-in-data",async(t,e)=>{if(this.isSelectedBadge=t.CompletionActions.IsPrint,e.isPrint=t.CompletionActions.IsPrint,this.failedResponse=t.CompletionActions.FailedResponse,t.BadgeTemplates.length>0)try{const e=await Object(ye.c)(t.BadgeTemplates[0]),s=JSON.parse(B.a.unescape(e.data));this.selectedBadge=s[0]||{}}catch(t){Object(M.f)(t)}})},beforeDestroy(){this.$root.$off("fetch-check-in-data")},methods:{openBadgeListPopup(){this.showBadgeListPopup=!0},closeBadgeListPopup(){this.showBadgeListPopup=!1},getSelectedMessage(t){this.selectedBadge=t[0]},deleteBadge(){this.showBadgeListPopup=!1,this.selectedBadge={}},back(){this.$emit("back")},next(){this.$refs.completionActions.next();const t=this.$refs.completionActions.config;this.$emit("get-action",this.isSelectedBadge,this.selectedBadge,this.failedResponse,t)}}},Te=(s("NJYw"),s("C94/")),$e=Object(z.a)(Ne,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"charket-check-in-completion"},[s("section",{staticClass:"main"},[s("completion-actions",{ref:"completionActions",attrs:{"get-submit-msg":t.getSubmitMsg,"show-footer":!1}}),t._v(" "),s("section",{staticClass:"check-in-action"},[t.showFailedResponse?s("div",{staticClass:"slds-grid check-in-completion-section failed-section"},[s("label",[t._v(t._s(t.$t("failedResponseLabel")))]),t._v(" "),s("div",{staticClass:"slds-col"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.failedResponse,expression:"failedResponse"}],staticClass:"slds-textarea failed-response-textarea",domProps:{value:t.failedResponse},on:{input:function(e){e.target.composing||(t.failedResponse=e.target.value)}}})])]):t._e(),t._v(" "),s("div",{staticClass:"slds-grid check-in-completion-section",class:{"failed-section":!t.showFailedResponse}},[s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("span",{staticClass:"slds-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.isSelectedBadge,expression:"isSelectedBadge"}],attrs:{type:"checkbox",name:"options",id:"print-badge"},domProps:{checked:Array.isArray(t.isSelectedBadge)?t._i(t.isSelectedBadge,null)>-1:t.isSelectedBadge},on:{change:function(e){var s=t.isSelectedBadge,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&(t.isSelectedBadge=s.concat([null])):n>-1&&(t.isSelectedBadge=s.slice(0,n).concat(s.slice(n+1)))}else t.isSelectedBadge=i}}}),t._v(" "),s("label",{staticClass:"slds-checkbox__label checkbox-label",attrs:{for:"print-badge"}},[s("span",{staticClass:"slds-checkbox_faux checkbox-span"}),t._v(" "),s("span",{staticClass:"slds-form-element__label checkbox-value"},[t._v(t._s(t.$t("badgeLabel")))])])])])])]),t._v(" "),t.isSelectedBadge?s("div",{staticClass:"slds-grid check-in-completion-section"},[s("label",[t._v(t._s(t.$t("badgeTemplateLabel")))]),t._v(" "),t.selectedBadge.Id?s("div",{staticClass:"slds-box slds-col selected-message-content"},[s("div",{staticClass:"badge-preview-section"},[s("badge-preview",{attrs:{size:t.selectedBadge.Size,orientation:t.selectedBadge.Orientation,body:t.selectedBadge.Body}})],1),t._v(" "),s("div",{staticClass:"badge-action-section"},[s("span",{staticClass:"down-btn edit",on:{click:function(e){return t.openBadgeListPopup()}}},[s("icon",{attrs:{name:"editReplyIcon","class-name":"down-icon",width:"16px",height:"16px"}})],1),t._v(" "),s("span",{staticClass:"down-btn",on:{click:function(e){return t.deleteBadge()}}},[s("icon",{attrs:{name:"deleteReplyIcon","class-name":"down-icon",width:"16px",height:"16px"}})],1)])]):s("div",{staticClass:"slds-box slds-grid slds-grid_align-center slds-grid_vertical-align-center slds-col badge-section"},[s("div",{staticClass:"slds-grid slds-grid_vertical slds-grid_vertical-align-center action-section",on:{click:t.openBadgeListPopup}},[s("span",{staticClass:"down-btn action-icon"},[s("icon",{attrs:{name:"search","class-name":"down-icon",width:"20px",height:"20px"}})],1),t._v(" "),s("span",{staticClass:"action-value"},[t._v(t._s(t.$t("selectTemplateLabel")))])])])]):t._e()])],1),t._v(" "),s("section",{staticClass:"slds-border_top footer"},[s("button",{staticClass:"slds-button slds-button_neutral btn-left",on:{click:function(e){return t.back()}}},[t._v(t._s(t.$t("global.backBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand btn-right",on:{click:function(e){return t.next()}}},[t._v(t._s(t.$t("global.nextBtn")))])]),t._v(" "),t.showBadgeListPopup?s("select-badge-list",{attrs:{"selected-item":t.selectedBadge},on:{close:function(e){return t.closeBadgeListPopup()},"get-badge":t.getSelectedMessage}}):t._e()],1)}),[],!1,null,"50fce996",null);"function"==typeof Te.default&&Object(Te.default)($e);var De=$e.exports,Ae={computed:o()({},Object(P.c)({wechatCampaign:"wechatCampaign/campaign",checkInStepId:"wechatCampaign/checkInStepId"}),{getSubmitMsg(){return this.stepIndex<1}}),components:{Wizard:G,SelectCheckInMethod:Ce,CheckInCompletion:De,Confirmation:ae},data(){return{steps:[{label:this.$t("methodStepLabel"),title:this.$t("methodStepTitle"),value:this.$t("methodStepValue"),stepApi:"Select Check-in Method",page:0},{label:this.$t("actionStepLabel"),title:this.$t("actionStepTitle"),value:this.$t("actionStepValue"),stepApi:"Completion Actions",page:1},{label:this.$t("confirmStepLabel"),title:this.$t("confirmStepTitle"),value:this.$t("confirmStepValue"),stepApi:"Confirm & Save",page:2}],stepIndex:0,selectedIndex:0,currentStep:{},checkIn:{Step:"Select Check-in Method",QRCodes:[],Form:{Id:"",Title:"",Banner:"",ThankYouMessage:"",RedirectURL:"",FormURL:""},Type:"QRCode",CheckinStaff:[],IsAcceptOnSiteRegistration:!1,IsOnlyRegisteredCanCheckin:!1,AcceptedMemberStatus:[],IsAcceptOtherChannel:!1,OtherChannelPrompt:"",CompletionActions:{TemplateIds:[],MessageIds:[],PassId:"",CouponIds:[],SkillId:"",IsPrint:!1,SubmittedAction:"",FailedResponse:""},BadgeTemplates:[],flowStepPage:0},confirmData:{formName:"",messageLabel:[],qrcodes:[],isPrint:!1,campaignMemberStatus:""},currentFlow:{},qrModalContent:"",confirmCodes:[]}},async created(){"edit"===this.wechatCampaign.type?(await this.fetchCampaignFlowStepRules(),this.currentStep=this.steps[this.checkIn.flowStepPage],this.stepIndex=this.checkIn.flowStepPage,this.selectedIndex=this.checkIn.flowStepPage):(this.currentStep=this.steps[0],this.fetchCampaignStepId())},methods:o()({},Object(P.b)("wechatCampaign",["storeCheckInStepId"]),{async fetchCampaignStepId(){try{const t=await x(this.wechatCampaign.flowId,"Check-in",m()(this.checkIn)),e=JSON.parse(B.a.unescape(t.data));this.$route.query.flowStepId=e.wechatCampaignFlowStepId,this.storeCheckInStepId(e.wechatCampaignFlowStepId)}catch(t){Object(M.f)(t)}},async fetchCampaignFlowStepRules(){try{const t=await I(this.wechatCampaign.flowId,"Check-in"),e=JSON.parse(B.a.unescape(t.data));this.checkIn=e,this.checkIn.Step=this.checkIn.Step||"Select Check-in Method",this.checkIn.Type=this.checkIn.Type||"QRCode",this.checkIn,this.$root.$emit("fetch-check-in-data",this.checkIn,this.confirmData)}catch(t){Object(M.f)(t)}},cancel(){this.$emit("cancel-flow")},back(){document.querySelector(".flow-tab-right").scrollTop=0,this.selectedIndex=this.selectedIndex-1,this.currentStep=this.steps[this.selectedIndex]},next(){document.querySelector(".flow-tab-right").scrollTop=0,this.selectedIndex<this.stepIndex?this.selectedIndex=this.selectedIndex+1:(this.stepIndex=this.stepIndex+1,this.selectedIndex=this.stepIndex),this.currentStep=this.steps[this.selectedIndex],this.checkIn.Step=this.currentStep.stepApi,this.checkIn.flowStepPage<this.currentStep.page&&(this.checkIn.flowStepPage=this.currentStep.page),S(this.checkInStepId,m()(this.checkIn),this.confirmData.campaignMemberStatus)},selectStep(t){if(this.selectedIndex=t,this.currentStep=this.steps[t],t===this.steps.length-1){this.$children;const t=this.$refs.checkInCompletion,e=this.$refs.selectCheckInMethod,s=t.$refs.completionActions,a=e.$refs.createQRCode;s.addAction(),this.currentFlow={form:e.currentForm,actions:s.config,selectedBadge:t.selectedBadge,isSelectedBadge:t.isSelectedBadge,failedResponse:t.failedResponse,qrCodeAbout:e.qrCodeAbout,qrCodes:a.currentCode.qrcodes},"Show Thank You Message"===this.currentFlow.actions.submittedAction?this.currentFlow.actions.redirectUrl="":this.currentFlow.actions.thanksMsg="",this.checkIn.Form.Id=e.currentForm.Id,this.checkIn.Form.RedirectURL=this.currentFlow.actions.redirectUrl,this.checkIn.IsAcceptOnSiteRegistration=this.currentFlow.qrCodeAbout.isAcceptOnSiteRegistration,this.confirmData={qrcodes:this.currentFlow.qrCodes,messageLabel:this.currentFlow.actions.messageLabel,formName:this.currentFlow.form.Name,isPrint:this.currentFlow.isSelectedBadge,campaignMemberStatus:this.currentFlow.actions.campaignMemberStatus||""}}},removeStaff(t){let e=this.checkIn.CheckinStaff;he()(e).call(e,le()(e).call(e,e=>t===e),1)},addStaff(t){this.checkIn.CheckinStaff.push(t)},getMethod(t,e,s){this.confirmData.formName=t.Name,this.checkIn.Form.Id=t.Id,this.checkIn.Form.Title=t.Title,this.checkIn.Form.Banner=t.Banner,this.checkIn.Form.Title=t.Title,this.checkIn.Form.FormURL=t.URL,this.checkIn.QRCodes=[];for(const t of e.qrcodes)this.checkIn.QRCodes.push({Id:t.QRCodeId});this.confirmData.qrcodes=e.qrcodes,this.checkIn.IsAcceptOnSiteRegistration=s.isAcceptOnSiteRegistration,this.checkIn.IsOnlyRegisteredCanCheckin=s.isOnlyRegisteredCanCheckin,this.checkIn.IsAcceptOtherChannel=s.isAcceptOtherChannel,this.checkIn.OtherChannelPrompt=s.otherChannelPrompt,this.checkIn.Type=s.type,this.checkIn.AcceptedMemberStatus=[];for(const t of s.campaignMemberStatus)this.checkIn.AcceptedMemberStatus.push(t);this.next()},getAction(t,e,s,a){this.checkIn.BadgeTemplates=[],e.Id&&this.checkIn.BadgeTemplates.push(e.Id),this.checkIn.CompletionActions.IsPrint=t,this.confirmData.isPrint=t,this.checkIn.CompletionActions.FailedResponse=s,this.checkIn.CompletionActions.SubmittedAction=a.submittedAction||"",this.confirmData.campaignMemberStatus=a.campaignMemberStatus||"","Show Thank You Message"===this.checkIn.CompletionActions.SubmittedAction?(this.checkIn.Form.ThankYouMessage=a.thanksMsg,this.checkIn.Form.RedirectURL=""):(this.checkIn.Form.RedirectURL=a.redirectUrl,this.checkIn.Form.ThankYouMessage=""),this.confirmData.messageLabel=a.messageLabel,this.checkIn.CompletionActions.MessageIds=a.MessageIds,this.checkIn.CompletionActions.TemplateIds=a.TemplateIds,this.checkIn.CompletionActions.PassId=a.PassId,this.checkIn.CompletionActions.CouponIds=a.CouponIds,this.checkIn.CompletionActions.SkillId=a.SkillId,this.next()},async updateQRCodeResponses(t){try{const e=await F(this.checkInStepId,m()(this.checkIn));if(e.ok){const s=JSON.parse(B.a.unescape(e.data));if(s.QRCodeIdsToManualUpdate.length>0){this.confirmCodes=[];for(const e of s.QRCodeIdsToManualUpdate){let s=u()(t).call(t,t=>t.QRCodeId===e)||{};this.confirmCodes.push(s.Name)}this.confirmCodes,this.qrModalContent=this.$t("global.qrCodeConfirmContent",[this.$tc("global.checkInLabel",1)]),this.$refs.qrModal.open()}else await this.confirmSave(!0)}else Object(M.f)(e)}catch(t){Object(M.f)(t)}},async confirmSave(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.$refs.qrModal.close();try{var t;this.checkIn.QRCodes=J()(t=this.confirmData.qrcodes).call(t,t=>({Id:t.QRCodeId}));const e=await S(this.checkInStepId,m()(this.checkIn),this.confirmData.campaignMemberStatus);e.ok?this.$emit("flow-done"):Object(M.f)(e)}catch(t){Object(M.f)(t)}},saveFlow(){if(f()(this.currentFlow).length>0){var t;const e=this.currentFlow.qrCodeAbout,s=this.currentFlow.actions,a=J()(t=this.currentFlow.qrCodes).call(t,t=>({Id:t.QRCodeId}));this.checkIn={Step:this.checkIn.Step,QRCodes:a,Form:{Id:this.currentFlow.form.Id,Title:this.currentFlow.form.Title,Banner:this.currentFlow.form.Banner,ThankYouMessage:s.thanksMsg,RedirectURL:s.redirectUrl,FormURL:this.currentFlow.form.URL},Type:e.type,CheckinStaff:this.checkIn.CheckinStaff,IsAcceptOnSiteRegistration:e.isAcceptOnSiteRegistration,IsOnlyRegisteredCanCheckin:e.isOnlyRegisteredCanCheckin,AcceptedMemberStatus:e.campaignMemberStatus,IsAcceptOtherChannel:e.isAcceptOtherChannel,OtherChannelPrompt:e.otherChannelPrompt,CompletionActions:{TemplateIds:s.TemplateIds,MessageIds:s.MessageIds,PassId:s.PassId,CouponIds:s.CouponIds,SkillId:s.SkillId,IsPrint:this.currentFlow.isSelectedBadge,SubmittedAction:s.submittedAction||"",FailedResponse:this.currentFlow.failedResponse},BadgeTemplates:this.currentFlow.selectedBadge.Id?[this.currentFlow.selectedBadge.Id]:[],flowStepPage:this.checkIn.flowStepPage}}this.updateQRCodeResponses(this.$refs.selectCheckInMethod.$refs.createQRCode.currentCode.qrcodes)},onClickCancel(){this.$refs.qrModal.close()}})},Oe=(s("cuvP"),s("Xoz7")),Fe=Object(z.a)(Ae,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"wechat-check-in-flow"},[s("section",{staticClass:"wizard-section"},[s("wizard",{attrs:{steps:t.steps,"step-index":t.stepIndex,"select-index":t.selectedIndex},on:{"select-step":t.selectStep}})],1),t._v(" "),s("p",{staticClass:"step-title"},[t._v(t._s(t.currentStep.title))]),t._v(" "),s("p",{staticClass:"step-value"},[t._v(t._s(t.currentStep.value))]),t._v(" "),s("section",{staticClass:"content"},[s("select-check-in-method",{directives:[{name:"show",rawName:"v-show",value:0===t.currentStep.page,expression:"currentStep.page === 0"}],ref:"selectCheckInMethod",attrs:{"check-in-staff":t.checkIn.CheckinStaff,"check-in-data":t.checkIn},on:{"remove-staff":t.removeStaff,"add-staff":t.addStaff,"cancel-check-in":t.cancel,"get-method":t.getMethod}}),t._v(" "),s("check-in-completion",{directives:[{name:"show",rawName:"v-show",value:1===t.currentStep.page,expression:"currentStep.page === 1"}],ref:"checkInCompletion",attrs:{"get-submit-msg":t.getSubmitMsg,"show-failed-response":!t.checkIn.IsAcceptOnSiteRegistration},on:{back:t.back,"get-action":t.getAction}}),t._v(" "),s("confirmation",{directives:[{name:"show",rawName:"v-show",value:2===t.currentStep.page,expression:"currentStep.page === 2"}],attrs:{"confirm-data":t.confirmData,form:t.checkIn,"has-badge":!0,stepType:"CheckIn"},on:{back:t.back,save:t.saveFlow}})],1),t._v(" "),s("ld-modal",{ref:"qrModal",attrs:{title:t.$t("global.qrCodeConfirmHeader",[t.$tc("global.checkInLabel",2)])},scopedSlots:t._u([{key:"content",fn:function(){return[s("div",{staticClass:"slds-p-around_medium modal-content"},[s("p",{staticClass:"main-content"},[t._v(t._s(t.qrModalContent))]),t._v(" "),s("ul",t._l(t.confirmCodes,(function(e,a){return s("li",{key:a},[t._v("- "+t._s(e))])})),0)])]},proxy:!0},{key:"footer",fn:function(){return[s("ld-button",{attrs:{neutral:""},on:{click:function(e){return t.onClickCancel()}}},[t._v("\n        "+t._s(t.$t("global.cancelBtn"))+"\n      ")]),t._v(" "),s("ld-button",{attrs:{brand:""},on:{click:function(e){return t.confirmSave()}}},[t._v("\n        "+t._s(t.$t("global.confirmSaveBtn"))+"\n      ")])]},proxy:!0}])})],1)}),[],!1,null,"d1e8b4e2",null);"function"==typeof Oe.default&&Object(Oe.default)(Fe);var Me=Fe.exports,Pe=s("wA34"),Re=s("zUtI"),Ee={components:{NoRecord:w.a,LdTable:_e.LdTable},props:{notify:{type:Object,default:()=>({})},accountId:{type:String,default:()=>""},hasNextBtn:{type:Boolean,default:!1},hasSelectedNewNotify:{type:Boolean,default:()=>!1}},data(){return{notifies:[],notifySize:20,notifyCount:0,isLoading:!1,isLoadingMore:!1,searchKey:"",selectedNotify:{},headers:[{text:this.$t("titleLabel"),value:"Title"},{text:this.$t("keywordLabel"),value:"KeywordNames"},{text:this.$t("urlLabel"),value:"NotificationURL"},{text:this.$t("noteLabel"),value:"Note"},{text:this.$t("createdLabel"),value:"CreatedInfo"}],selectedIndex:-1,infiniteDisabled:!1}},computed:{isTableVisible(){return this.notifies.length>0},confirmBtnContent(){return this.hasNextBtn?this.$t("global.nextBtn"):this.$t("global.confirmBtn")},confirmBtnDisabled(){return!this.selectedNotify.Id},noRecordVisible(){return 0===this.notifies.length&&!this.isLoading}},watch:{notifies(){this.selectedIndex=this.getSelectedIndex()}},created(){this.selectedNotify=this.notify&&this.notify.Id?this.notify:{},this.selectedIndex=this.getSelectedIndex()},async mounted(){this.$refs.Modal.open(),this.isLoading=!0,await this.getNotifiesList()},methods:{formatDatetimeFilter:()=>R.e,async getNotifiesList(){try{const e=await Object(Re.c)(this.accountId||this.$route.params.accountId,this.notifySize,this.notifySize*this.notifyCount,this.searchKey);if(this.isLoading=!1,this.isLoadingMore=!1,e.ok){if(e.data){var t;const s=JSON.parse(B.a.unescape(e.data));for(const t of s)t.CreatedInfo={User:t.CreatedByUser,Date:t.CreatedDate},this.selectedNotify.Id&&t.Id===this.selectedNotify.Id?this.$set(t,"isSelected",!0):this.$set(t,"isSelected",!1);this.infiniteDisabled=s.length<this.notifySize,this.notifies=H()(t=this.notifies).call(t,s),this.notifyCount++}}else Object(M.f)(e)}catch(t){this.isLoading=!1,this.isLoadingMore=!1,Object(M.f)(t)}},onInfinite(){this.isLoadingMore||this.notifies.length>=this.notifyCount*this.notifySize&&(this.isLoadingMore=!0,this.getNotifiesList())},getSelectedIndex(){var t;return this.selectedNotify?le()(t=this.notifies).call(t,t=>t.Id===this.selectedNotify.Id):-1},selectNotify(t){t.isSelected=!t.isSelected,t.isSelected?this.selectedNotify=t:this.selectedNotify="",this.selectedIndex=this.getSelectedIndex();for(let e of this.notifies)e.Id!==t.Id&&(e.isSelected=!1)},onClickCancel(){this.$emit("close-notify-list")},onClickConfirm(){this.$emit("select-notify-item",this.selectedNotify)},searchMessages(){this.notifies=[],this.notifyCount=0,this.isLoading=!0,this.getNotifiesList()},clearSearch(){this.searchKey="",this.searchMessages()},onClickNewNotify(){this.$emit("new-notify")}}},Be=(s("58Zw"),s("+Bxx"),s("n1Yi")),je=Object(z.a)(Ee,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ld-modal",{ref:"Modal",staticClass:"notify-modal",class:{"modal-loaded":!t.isLoading},attrs:{width:"90%","min-width":"auto",title:t.$t("selectNotificationTemplateLabel")},on:{close:function(e){return t.onClickCancel()}},scopedSlots:t._u([{key:"content",fn:function(){return[s("div",{staticClass:"slds-grid slds-grid_align-spread slds-border_bottom notify-modal__header"},[s("div",{staticClass:"notify-modal__search"},[s("search-input",{attrs:{placeholder:t.$t("global.searchPlaceholder")},on:{search:t.searchMessages,clear:t.clearSearch},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}})],1),t._v(" "),s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.onClickNewNotify()}}},[t._v("\n        "+t._s(t.$t("global.newBtn"))+"\n      ")])]),t._v(" "),s("div",{staticClass:"notify-modal__list-view"},[t.isLoading?s("div",{staticClass:"loading-wrapper"},[s("ld-loading")],1):t._e(),t._v(" "),t.noRecordVisible?s("div",{staticClass:"no-record-wrapper"},[s("no-record")],1):t._e(),t._v(" "),t.isTableVisible?s("ld-table",{staticClass:"scroll-content",attrs:{headers:t.headers,rows:t.notifies,"infinite-disabled":t.infiniteDisabled,"single-select":!0,"selected-index":t.selectedIndex},on:{infinite:t.onInfinite,select:t.selectNotify},scopedSlots:t._u([{key:"item.KeywordNames",fn:function(e){var a=e.item;return[s("div",{staticClass:"slds-truncate notify-modal__keywords slds-grid slds-grid_vertical-align-center row-item",attrs:{title:a.KeywordNames}},t._l(a.KeywordNames,(function(e,a){return s("span",{key:a},[t._v("\n              "+t._s(e)+"\n            ")])})),0)]}},{key:"item.CreatedInfo",fn:function(e){var a=e.item;return[s("div",{staticClass:"slds-truncate",attrs:{title:a.CreatedByUser+", "+t.formatDatetimeFilter()(a.CreatedDate,t.$user.TimeZoneSidKey)}},[t._v("\n            "+t._s(a.CreatedByUser)+", "+t._s(t._f("formatDatetimeFilter")(a.CreatedDate,t.$user.TimeZoneSidKey))+"\n          ")])]}}],null,!1,439680114)}):t._e()],1)]},proxy:!0},{key:"footer",fn:function(){return[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.onClickCancel()}}},[t._v("\n      "+t._s(t.$t("global.cancelBtn"))+"\n    ")]),t._v(" "),s("button",{staticClass:"slds-button slds-button_neutral slds-button_brand",attrs:{disabled:t.confirmBtnDisabled},on:{click:function(e){return t.onClickConfirm()}}},[t._v("\n      "+t._s(t.confirmBtnContent)+"\n    ")])]},proxy:!0}])})}),[],!1,null,"10a77224",null);"function"==typeof Be.default&&Object(Be.default)(je);var ze=je.exports,Ue=s("fb3H"),qe=s("wbfU"),We=s("D7EL"),Qe={components:{Icon:Q.a,ErrorToast:xt.a,InputSelect:C.a,Dropdown:_.a,NotificationDetail:Pe.a,NotificationTemplates:ze,WechatNotification:Ue.a,NewNotificationPopup:qe.a,ImageUploader:We.a},mixins:[y.a],inject:["showErrorImg"],props:{currentPrize:{type:Object,default:()=>({})},newOrder:{type:Number,default:()=>0}},data(){return{prizeTitle:this.$tc("prizeTitle",1),statusOptionData:{options:[],currentOptions:[]},newPrize:{Order:0,PictureAttachmentId:"",RoundName:"",PrizeName:"",Quantity:"",NotificationTemplateId:"",NotificationTemplateTitle:"",QualifiedCampaignMemberStatus:[],Winners:[]},currentTemplateItem:null,isSubmitSave:!1,isShowNotify:!1,isNotifyDetailShow:!1,selectNotify:{},showWechatNotify:!1,showNewNotification:!1,selectedNotify:{},timeMaxCounts:15,imageBase:"",uploadIndex:0,chunkSize:5e4,photoName:"",imageType:"",cropImg:"",isUploadingPhoto:!1,cropperPhoto:"",errorToastMsg:"",isUpdating:!1,isGettingStatus:!1,thumbnailUrl:"../../assets/images/prize.png"}},computed:o()({},Object(P.c)({wechatCampaign:"wechatCampaign/campaign",luckyDrawStepId:"wechatCampaign/luckyDrawStepId"}),{canSave:function(){return this.newPrize.RoundName&&this.newPrize.PrizeName&&this.newPrize.Quantity}}),watch:{dropdownRefId:async function(){if(this.statusOptionData.options.length<=0&&!this.isGettingStatus){this.isGettingStatus=!0;try{let t=await $(this.wechatCampaign.flowId);if(t=JSON.parse(B.a.unescape(t.data)),t.Statuses.length>0)for(const e of t.Statuses)this.statusOptionData.options.push({Name:e,Value:e})}catch(t){Object(M.f)(t)}finally{this.isGettingStatus=!1}}}},async created(){if(this.currentPrize){this.isUpdating=!0,this.newPrize=JSON.parse(m()(this.currentPrize)),this.cropImg=this.newPrize.PictureAttachmentId?"/servlet/servlet.FileDownload?file=".concat(this.newPrize.PictureAttachmentId):"",this.statusOptionData.currentOptions=[];for(let t of this.newPrize.QualifiedCampaignMemberStatus)this.statusOptionData.currentOptions.push({Name:t,Value:t,isSelected:!0});await this.fetchNotify()}else this.isUpdating=!1,this.newPrize.Order=this.newOrder;this.newPrize},methods:{async asyncUploadImage(t){let{file:e,complete:s,error:a}=t;this.imageBase=e.data,this.photoName=e.name,this.imageType=e.type;try{this.isUploadingPhoto=!0;const t=await this.savePhoto();this.cropImg="/servlet/servlet.FileDownload?file=".concat(t),s(t)}catch(a){this.cropImg="",a(a),this.$handleError(a)}finally{this.isUploadingPhoto=!1}},clearPrizePhoto(){this.newPrize.PictureAttachmentId="",this.cropImg=""},onlyNum(t,e){let s;s=e?/\d/:/^[1-9]$/,t.returnValue=s.test(t.key)||8===t.keyCode},async fetchNotify(){if(this.newPrize.NotificationTemplateId)try{const t=await Object(Re.f)([this.newPrize.NotificationTemplateId]),e=JSON.parse(B.a.unescape(t.data));this.selectNotify=e[0],this.isNotifyDetailShow=!0}catch(t){Object(M.f)(t)}},selectPicklist(t){this.statusOptionData.currentOptions=t,this.newPrize.QualifiedCampaignMemberStatus=[];for(let e of t)this.newPrize.QualifiedCampaignMemberStatus.push(e.Value)},onClear(){this.clearPrizePhoto()},closeAddPrizeModal(){this.errorToastMsg="",this.$emit("close-add-prize-modal",!1)},replaceName:t=>t=t.replace(/\\n/g,"\\n").replace(/\\‘/g,"\\‘").replace(/\\“/g,"\\“").replace(/\\&/g,"\\&").replace(/\\r/g,"\\r").replace(/\\t/g,"\\t").replace(/\\b/g,"\\b").replace(/\\f/g,"\\f"),async savePrize(){this.isSubmitSave=!0,this.newPrize,this.newPrize.RoundName=this.replaceName(this.newPrize.RoundName),this.newPrize.PrizeName=this.replaceName(this.newPrize.PrizeName);const t=this.isUpdating?A:D;try{const e=await t(this.luckyDrawStepId,m()(this.newPrize));e.ok?(this.$emit("close-add-prize-modal",!0),this.$router.app.$emit("open-toast-notification",{content:this.$t("saveNotify"),type:"success"})):Object(M.f)(e)}catch(t){Object(M.f)(t)}finally{this.isSubmitSave=!1}},async savePhoto(t){let e="",s=!1;this.imageBase.length<=this.uploadIndex+this.chunkSize?(e=this.imageBase.substring(this.uploadIndex),s=!0):e=this.imageBase.substring(this.uploadIndex,this.uploadIndex+this.chunkSize);const a=await Ft.b.saveImage({flowStepId:this.luckyDrawStepId,name:this.photoName,body:e,contentType:this.imageType,attachmentId:t||""});return this.newPrize.PictureAttachmentId=a,s?this.uploadIndex=0:(this.uploadIndex+=this.chunkSize,await this.savePhoto(a)),a},showNotify(){this.isShowNotify=!0},closeNotify(){this.isShowNotify=!1},selectNotifyItem(t){t.Id?(this.isNotifyDetailShow=!0,this.isShowNotify=!1,this.selectNotify=t,this.newPrize.NotificationTemplateId=t.Id,this.newPrize.NotificationTemplateTitle=t.Title):this.isShowNotify=!1},deleteNotify(){this.isNotifyDetailShow=!1,this.selectNotify={},this.newPrize.NotificationTemplateId="",this.newPrize.NotificationTemplateTitle=""},newWechatNotify(){this.showWechatNotify=!0,this.isShowNotify=!1},closeWechatNotify(){this.showWechatNotify=!1,this.isShowNotify=!0},newNotification(t){this.showWechatNotify=!1,this.showNewNotification=!0,this.selectedNotify=t},closeNewNotificationPopup(){this.showNewNotification=!1,this.isShowNotify=!0}}},Ve=(s("mw6U"),s("9aMZ")),He=Object(z.a)(Qe,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"add-prize-modal"},[a("div",{staticClass:"slds-modal slds-modal_large slds-fade-in-open",staticStyle:{"z-index":"2"},attrs:{"aria-hidden":"false",role:"dialog"}},[a("div",{staticClass:"slds-modal__container show-selected-container new-width",attrs:{role:"document",tabindex:"0"}},[a("div",{staticClass:"slds-modal__header"},[a("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close",on:{click:function(e){return t.closeAddPrizeModal()}}},[a("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),a("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),a("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.prizeTitle))])]),t._v(" "),a("div",{staticClass:"slds-modal__content slds-p-around_medium new-height",attrs:{id:"modal-content"}},[t.errorToastMsg?a("error-toast",{attrs:{content:t.errorToastMsg}}):t._e(),t._v(" "),a("div",{staticClass:"slds-grid new-line-profile"},[a("image-uploader",{staticClass:"photo",attrs:{url:t.cropImg,"preview-title":t.$t("cropPhoto"),"thumbnail-action":t.$t("change"),"thumbnail-url":t.thumbnailUrl,"async-upload":t.asyncUploadImage,"enable-clear":!0},on:{clear:t.onClear},scopedSlots:t._u([{key:"no-image",fn:function(){return[a("div",{staticClass:"prize-image"},[a("img",{attrs:{src:s("zwj+"),alt:""}})])]},proxy:!0}])}),t._v(" "),a("div",{staticClass:"slds-col edit-photo-action"},[a("div",{staticClass:"new-title new-profile-title"},[a("span",[t._v("*")]),t._v(" "+t._s(t.$t("prizeName")))]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.newPrize.PrizeName,expression:"newPrize.PrizeName"}],staticClass:"slds-input new-input new-profile-input",attrs:{type:"text",name:"",placeholder:t.$t("prizeNameHolder")},domProps:{value:t.newPrize.PrizeName},on:{input:function(e){e.target.composing||t.$set(t.newPrize,"PrizeName",e.target.value)}}}),t._v(" "),a("div",{staticClass:"new-title new-profile-title"},[a("span",[t._v("*")]),t._v(" "+t._s(t.$t("quantity")))]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.newPrize.Quantity,expression:"newPrize.Quantity",modifiers:{number:!0}}],staticClass:"slds-input new-input new-profile-input",attrs:{type:"number",name:"",min:"1"},domProps:{value:t.newPrize.Quantity},on:{keydown:function(e){return t.onlyNum(e,t.newPrize.Quantity)},input:function(e){e.target.composing||t.$set(t.newPrize,"Quantity",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])],1),t._v(" "),a("div",{staticClass:"slds-grid slds-grid_vertical new-line"},[a("div",{staticClass:"new-title"},[a("span",[t._v("*")]),t._v(" "+t._s(t.$t("roundName")))]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.newPrize.RoundName,expression:"newPrize.RoundName"}],staticClass:"slds-input new-input",attrs:{type:"text",name:"",placeholder:t.$t("roundNameHolder")},domProps:{value:t.newPrize.RoundName},on:{input:function(e){e.target.composing||t.$set(t.newPrize,"RoundName",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"slds-grid slds-grid_vertical new-line"},[a("div",{staticClass:"new-title"},[t._v(t._s(t.$t("memberStatus")))]),t._v(" "),a("div",{staticClass:"new-line-picklist"},[a("input-select",{attrs:{"default-label":t.$t("global.all"),currents:t.statusOptionData.currentOptions,"is-single-selection":!1},on:{"close-dropdown":t.closeDropdown,"open-dropdown":t.openDropdown,resize:t.resizeDropdown,"remove-option":t.selectPicklist}})],1)]),t._v(" "),a("div",{staticClass:"slds-grid slds-grid_vertical new-line"},[a("div",{staticClass:"new-title"},[t._v(t._s(t.$t("notifyTemplate")))]),t._v(" "),a("div",{staticClass:"notify-container"},[t.isNotifyDetailShow?a("div",{key:"show-notify",staticClass:"slds-box selected-message-content"},[a("div",{staticClass:"select-msg-title"},[a("span",{staticClass:"down-btn",on:{click:function(e){return t.showNotify()}}},[a("icon",{attrs:{name:"editReplyIcon","class-name":"down-icon",width:"16px",height:"16px"}})],1),t._v(" "),a("span",{staticClass:"down-btn",on:{click:function(e){return t.deleteNotify()}}},[a("icon",{attrs:{name:"deleteReplyIcon","class-name":"down-icon",width:"16px",height:"16px"}})],1)]),t._v(" "),a("div",{staticClass:"notify-section"},[a("notification-detail",{attrs:{notify:t.selectNotify}})],1)]):a("div",{key:"show-notify"},[a("div",{staticClass:"slds-box slds-grid slds-grid_vertical-align-center slds-grid_vertical action-section"},[a("span",{staticClass:"down-btn action-icon",on:{click:function(e){return t.showNotify()}}},[a("icon",{attrs:{name:"search","class-name":"down-icon",width:"20px",height:"20px"}})],1),t._v(" "),a("span",{staticClass:"action-value",on:{click:function(e){return t.showNotify()}}},[t._v(t._s(t.$t("selectTemplateLabel")))])])])])])],1),t._v(" "),a("div",{staticClass:"slds-modal__footer"},[a("ld-button",{attrs:{disabled:t.isSubmitSave,neutral:""},on:{click:function(e){return t.closeAddPrizeModal()}}},[t._v("\n          "+t._s(t.$t("global.cancelBtn"))+"\n        ")]),t._v(" "),a("ld-button",{attrs:{disabled:!t.canSave||t.isSubmitSave||t.isUploadingPhoto,brand:""},on:{click:function(e){return t.savePrize()}}},[t._v("\n          "+t._s(t.$t("global.saveBtn"))+"\n        ")])],1)])]),t._v(" "),a("div",{staticClass:"slds-backdrop slds-backdrop_open",staticStyle:{"z-index":"1"}}),t._v(" "),t.showDropdown?a("dropdown",{attrs:{"is-single-selection":!1,options:t.statusOptionData.options,currents:t.statusOptionData.currentOptions,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e(),t._v(" "),t.isShowNotify?a("notification-templates",{attrs:{"account-id":t.wechatCampaign.account.id,notify:t.selectNotify},on:{"close-notify-list":t.closeNotify,"select-notify-item":t.selectNotifyItem,"new-notify":t.newWechatNotify}}):t._e(),t._v(" "),t.showWechatNotify?a("wechat-notification",{attrs:{"account-id":t.wechatCampaign.account.id},on:{close:t.closeWechatNotify,next:t.newNotification}}):t._e(),t._v(" "),t.showNewNotification?a("new-notification-popup",{attrs:{"acc-id":t.wechatCampaign.account.id,notify:t.selectedNotify},on:{close:t.closeNewNotificationPopup}}):t._e()],1)}),[],!1,null,"542f37c1",null);"function"==typeof Ve.default&&Object(Ve.default)(He);var Ke=He.exports,Je={components:{Icon:Q.a,NoRecord:w.a,LoadingSpinner:v.a,AddPrizeModal:Ke},inject:["showErrorImg"],props:{luckyDraw:{type:Object,default:()=>({})}},data:()=>({prizeList:[],isLoadingPrize:!1,editQuantityNum:0,newQuantityNum:"",currentEditPrize:null,showAddPrizeModal:!1,newPrizeOrder:0}),computed:o()({},Object(P.c)({luckyDrawStepId:"wechatCampaign/luckyDrawStepId"}),{showNoRecord(){return!this.prizeList||this.prizeList.length<=0},adjustedQuantiyNum:{get:function(){if(""===this.newQuantityNum)return null;{const t=Number(this.editQuantityNum),e=Number(this.newQuantityNum);return!t&&0!==t||!e&&0!==e?null:e-t}},set:function(t){const e=Number(this.editQuantityNum);if(""===t)this.newQuantityNum="";else{const s=Number(t);!s&&0!==s||!e&&0!==e||(this.newQuantityNum=e+s>0?Math.round(e+s):0)}}},canSaveNewQuantity(){return/^[0-9]\d*$/.test(this.newQuantityNum)}}),async created(){await this.fetchPrizes()},methods:{async fetchPrizes(){this.isLoadingPrize=!0;try{const s=await(e=this.luckyDrawStepId,Object(k.a)({method:"CampaignFlowRemoteActions.getPrizes",args:[e]}));if(s.ok){var t;const e=JSON.parse(B.a.unescape(s.data));this.prizeList=e.Prizes||[];for(let t of this.prizeList)this.$set(t,"showActionBox",!1);c()(t=this.prizeList).call(t,(function(t,e){return t.Order-e.Order}))}else Object(M.f)(s)}catch(t){Object(M.f)(t)}finally{this.isLoadingPrize=!1}var e},openEditQuantityModal(t){this.editQuantityNum=t.Quantity,this.currentEditPrize=t,this.$refs.quantityModal.open()},closeEditQuantityModal(){this.newQuantityNum="",this.$refs.quantityModal.close()},clearQuantityModalData(){this.newQuantityNum=""},onClickUpdateQuantityCancel(){this.closeEditQuantityModal()},async updateQuantity(){this.currentEditPrize.Quantity=this.newQuantityNum;try{const t=await A(this.luckyDrawStepId,m()(this.currentEditPrize));this.closeEditQuantityModal(),t.ok?(this.$router.app.$emit("open-toast-notification",{content:this.$t("updateNotify"),type:"success"}),this.fetchPrizes()):Object(M.f)(t)}catch(t){Object(M.f)(t)}},closeAllActionBox(){for(const t of this.prizeList)t.showActionBox=!1},openReplyBox(t){this.closeAllActionBox(),t.showActionBox=!0;const e=()=>{t.showActionBox=!1,window.removeEventListener("click",e)};window.addEventListener("click",e)},openDeletePrizeModal(t){if(!t.WinnersCount){this.currentEditPrize=t;const e=this.$confirm({title:this.$t("delModalHeader"),content:this.$t("delModalContent")});e.$on("ok",async()=>{try{const s=await function(t,e){return Object(k.a)({method:"CampaignFlowRemoteActions.deletePrize",args:[t,e]})}(this.luckyDrawStepId,this.currentEditPrize.Order);if(e.close(),s.ok){var t;if(await this.fetchPrizes(),!u()(t=this.prizeList).call(t,t=>t.Order===this.luckyDraw.CurrentRound)){let t=0;this.prizeList.length>0&&(t=this.prizeList[0].Order),await O(this.luckyDrawStepId,this.luckyDraw.Step,this.luckyDraw.FlowStepPage,t)}this.$router.app.$emit("open-toast-notification",{content:this.$t("delNotify"),type:"success"})}else s.error&&"AwardCompleted"===s.error?(this.$router.app.$emit("open-toast-notification",{content:this.$t("delErrNotify"),type:"error"}),this.fetchPrizes()):Object(M.f)(s)}catch(t){Object(M.f)(t),e.close()}})}},editCurrentPrize(t){this.currentEditPrize=t,this.showAddPrizeModal=!0},openAddPrizeModal(){this.currentEditPrize=null,this.newPrizeOrder=this.prizeList.length?this.prizeList[this.prizeList.length-1].Order+1:0,this.showAddPrizeModal=!0},closeAddPrizeModal(t){this.showAddPrizeModal=!1,t&&(this.fetchPrizes(),this.$emit("save",!1))},back(){this.$emit("back")},runLuckyDraw(t){var e;let s=H()(e="".concat(window.location.origin,"/apex/LuckyDraw?flowStepId=")).call(e,this.luckyDrawStepId);"test"===t&&(s="".concat(s,"&test=1")),window.open(s,"luckyDraw"),this.$emit("save",!0)}}},Ye=(s("/eHX"),s("jlPk")),Ge=Object(z.a)(Je,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"lucky-draw-list-page"},[a("div",{staticClass:"add-btn-action"},[a("button",{staticClass:"new-icon slds-button slds-button_icon-more",on:{click:function(e){return t.openAddPrizeModal()}}},[a("icon",{attrs:{name:"add",category:"utility","class-name":"slds-button__icon slds-button__icon_large","fill-color":"#706e6b",width:"15px",height:"15px"}}),t._v(" "),a("span",{staticClass:"add-info"},[t._v(t._s(t.$t("addBtn")))])],1)]),t._v(" "),a("section",{staticClass:"slds-grid main"},[a("table",{staticClass:"slds-table slds-table_bordered slds-no-row-hover lucky-draw-table",attrs:{role:"grid"}},[a("thead",[a("tr",{staticClass:"slds-line-height_reset",staticStyle:{height:"2rem"}},[a("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[a("div",{staticClass:"slds-truncate",attrs:{title:t.$t("order")}},[t._v(t._s(t.$t("order")))])]),t._v(" "),a("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[a("div",{staticClass:"slds-truncate",attrs:{title:t.$t("roundName")}},[t._v(t._s(t.$t("roundName")))])]),t._v(" "),a("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[a("div",{staticClass:"slds-truncate",attrs:{title:t.$t("prize")}},[t._v(t._s(t.$t("prize")))])]),t._v(" "),a("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[a("div",{staticClass:"slds-truncate",attrs:{title:t.$t("prizePicture")}},[t._v(t._s(t.$t("prizePicture")))])]),t._v(" "),a("th",{staticClass:"slds-is-sortable slds-is-resizable lucky-draw-tab-quantity",attrs:{focusable:"true",scope:"col"}},[a("div",{staticClass:"slds-truncate",attrs:{title:t.$t("quantity")}},[t._v(t._s(t.$t("quantity")))])]),t._v(" "),a("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[a("div",{staticClass:"slds-truncate",attrs:{title:t.$t("status")}},[t._v(t._s(t.$t("status")))])]),t._v(" "),a("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[a("div",{staticClass:"slds-truncate",attrs:{title:t.$t("notification")}},[t._v(t._s(t.$t("notification")))])]),t._v(" "),a("th",{staticClass:"slds-is-sortable slds-is-resizable action-tab-width",attrs:{focusable:"true"}},[a("div",{staticClass:"slds-truncate",attrs:{title:t.$t("action")}},[t._v(t._s(t.$t("action")))])])])]),t._v(" "),a("tbody",{directives:[{name:"show",rawName:"v-show",value:t.prizeList.length>0,expression:"prizeList.length > 0"}]},t._l(t.prizeList,(function(e,i){return a("tr",{staticClass:"slds-hint-parent"},[a("th",{attrs:{scope:"row"}},[a("div",{staticClass:"slds-truncate",attrs:{title:i+1}},[t._v("\n              "+t._s(i+1)+"\n            ")])]),t._v(" "),a("td",{attrs:{role:"gridcell"}},[a("div",{staticClass:"slds-truncate",attrs:{title:e.RoundName}},[t._v("\n              "+t._s(e.RoundName)+"\n            ")])]),t._v(" "),a("td",{attrs:{role:"gridcell"}},[a("div",{staticClass:"slds-truncate",attrs:{title:e.PrizeName}},[t._v("\n              "+t._s(e.PrizeName)+"\n            ")])]),t._v(" "),a("td",{attrs:{role:"gridcell"}},[a("div",{staticClass:"slds-truncate"},[a("div",{staticClass:"lucky-draw-pic"},[e.PictureAttachmentId?a("img",{attrs:{src:t._f("imgFilter")("/servlet/servlet.FileDownload?file="+e.PictureAttachmentId)},on:{error:function(e){return t.showErrorImg(e)}}}):a("img",{attrs:{src:s("zwj+"),alt:""}})])])]),t._v(" "),a("td",{staticClass:"slds-grid slds-grid_align-center slds-grid_vertical-align-center quantity-td",attrs:{role:"gridcell"}},[a("div",{staticClass:"slds-grid slds-grid_vertical-align-center slds-grid_align-end lucky-draw-quantity"},[a("div",{staticClass:"slds-truncate",attrs:{title:e.WinnersCount+"/"+e.Quantity}},[t._v("\n                "+t._s(t._f("addSeparators")(e.WinnersCount))+" / "+t._s(t._f("addSeparators")(e.Quantity))+"\n              ")]),t._v(" "),a("div",{staticClass:"quantity-edit-icon",on:{click:function(s){return t.openEditQuantityModal(e)}}},[a("span",{staticClass:"down-btn"},[a("icon",{attrs:{name:"editReplyIcon","class-name":"down-icon",height:"14px",width:"14px"}})],1)])])]),t._v(" "),a("td",{attrs:{role:"gridcell"}},[a("div",{staticClass:"slds-truncate"},[0===e.QualifiedCampaignMemberStatus.length?a("div",{staticClass:"slds-truncate",attrs:{title:t.$t("global.all")}},[t._v(t._s(t.$t("global.all")))]):t._l(e.QualifiedCampaignMemberStatus,(function(e){return a("div",{staticClass:"slds-truncate",attrs:{title:e}},[t._v(t._s(e))])}))],2)]),t._v(" "),a("td",{attrs:{role:"gridcell"}},[a("div",{staticClass:"slds-truncate",attrs:{title:e.NotificationTemplateTitle}},[t._v("\n              "+t._s(e.NotificationTemplateTitle)+"\n            ")])]),t._v(" "),a("td",{staticClass:"td-position",staticStyle:{width:"3.25rem"},attrs:{role:"gridcell"}},[a("div",{staticClass:"btn-position"},[a("button",{staticClass:"slds-button slds-button_icon-border-filled slds-button_icon-x-small down-btn",on:{click:function(s){return s.stopPropagation(),t.openReplyBox(e)}}},[a("icon",{attrs:{name:"down","class-name":"down-icon",width:"0.75rem",height:"0.75rem"}})],1),t._v(" "),e.showActionBox?a("div",{staticClass:"slds-box edit"},[a("div",{on:{click:function(s){return t.editCurrentPrize(e)}}},[t._v(t._s(t.$t("global.editBtn")))]),t._v(" "),a("div",{class:{"disabled-del":e.WinnersCount>0},on:{click:function(s){return t.openDeletePrizeModal(e)}}},[t._v(t._s(t.$t("global.deleteBtn")))])]):t._e()])])])})),0)]),t._v(" "),t.showNoRecord&&!t.isLoadingPrize?a("no-record",{attrs:{"custom-style":"top: 35px;"}}):t._e(),t._v(" "),a("loading-spinner",{attrs:{"is-loading":t.isLoadingPrize,"custom-style":"top: 35px;"}}),t._v(" "),a("ld-modal",{ref:"quantityModal",attrs:{title:t.$t("adjustQuantity"),"min-width":"490px"},on:{close:t.clearQuantityModalData},scopedSlots:t._u([{key:"content",fn:function(){return[a("div",{staticClass:"slds-p-around_medium"},[a("div",{staticClass:"slds-grid slds-grid_vertical adjust-quantity-form",attrs:{slot:"modalMainContent"},slot:"modalMainContent"},[a("div",{staticClass:"slds-grid slds-grid_align-spread adjust-quantity-item"},[a("label",{attrs:{for:"currentQuantity"}},[t._v(t._s(t.$t("currentQuantity")))]),t._v(" "),a("input",{staticClass:"slds-input",attrs:{type:"text",id:"currentQuantity",disabled:""},domProps:{value:t.editQuantityNum}})]),t._v(" "),a("div",{staticClass:"slds-grid slds-grid_align-spread adjust-quantity-item"},[a("label",{attrs:{for:"adjustQuantity"}},[t._v(t._s(t.$t("quantityAdjusted")))]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.adjustedQuantiyNum,expression:"adjustedQuantiyNum"}],staticClass:"slds-input",attrs:{type:"number",id:"adjustQuantity"},domProps:{value:t.adjustedQuantiyNum},on:{input:function(e){e.target.composing||(t.adjustedQuantiyNum=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"slds-grid slds-grid_align-spread adjust-quantity-item"},[a("label",{attrs:{for:"newQuantity"}},[t._v(t._s(t.$t("newQuantity")))]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.newQuantityNum,expression:"newQuantityNum"}],staticClass:"slds-input",attrs:{type:"number",id:"newQuantity"},domProps:{value:t.newQuantityNum},on:{input:function(e){e.target.composing||(t.newQuantityNum=e.target.value)}}})])])])]},proxy:!0},{key:"footer",fn:function(){return[a("ld-button",{attrs:{neutral:""},on:{click:function(e){return e.stopPropagation(),t.onClickUpdateQuantityCancel()}}},[t._v("\n          "+t._s(t.$t("global.saveBtn"))+"\n        ")]),t._v(" "),a("ld-button",{attrs:{disabled:!t.canSaveNewQuantity,brand:""},on:{click:function(e){return e.stopPropagation(),t.updateQuantity()}}},[t._v("\n          "+t._s(t.$t("global.saveBtn"))+"\n        ")])]},proxy:!0}])}),t._v(" "),t.showAddPrizeModal?a("add-prize-modal",{attrs:{"current-prize":t.currentEditPrize,"new-order":t.newPrizeOrder},on:{"close-add-prize-modal":t.closeAddPrizeModal}}):t._e()],1),t._v(" "),a("section",{staticClass:"slds-border_top footer"},[a("button",{staticClass:"slds-button slds-button_neutral btn-left",on:{click:function(e){return t.back()}}},[t._v(t._s(t.$t("global.backBtn")))]),t._v(" "),a("div",{staticClass:"btn-right"},[a("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.runLuckyDraw("test")}}},[t._v(t._s(t.$t("test")))]),t._v(" "),a("button",{staticClass:"slds-button slds-button_brand",on:{click:function(e){return t.runLuckyDraw("start")}}},[t._v(t._s(t.$t("start")))])])])])}),[],!1,null,"50828290",null);"function"==typeof Ye.default&&Object(Ye.default)(Ge);var Ze=Ge.exports,Xe=s("p5Y3"),ts={components:{Icon:Q.a,Lookup:ct.a,InputSelect:C.a,Dropdown:_.a},mixins:[y.a],inject:["showErrorImg"],data(){return{currentQRItem:null,qrMetadata:{name:"WeChatQRCode__c",label:this.$tc("qrcodeLabel",1),labelPural:this.$tc("qrcodeLabel",2),icon:"custom.qrcode",linkField:{name:"Name",label:this.$tc("qrcodeLabel",1)},fields:[]},uploadFileMsg:{},chunkSize:5e4,chunkCompleted:!0,statusOptionData:{options:[],currentOptions:[]},luckyDrawSettings:{Title:"",Theme:"Default",BackgroundAttachmentId:"",IsShowNumberOfParticipants:!0,IsShowLeadOrContactName:!1,QRCode:{QRCodeId:"",AttachmentId:""}},isLoadingSettings:!1,cancelUpload:!1,luckyDrawSettingsStatus:""}},computed:o()({},Object(P.c)({wechatCampaign:"wechatCampaign/campaign",checkInStepId:"wechatCampaign/checkInStepId",registerStepId:"wechatCampaign/registerStepId",luckyDrawStepId:"wechatCampaign/luckyDrawStepId",campaignFlowSteps:"wechatCampaign/campaignFlowSteps"}),{condition(){var t,e,s;const a=dt.a.getQualifiedName("WhatId__c"),i=dt.a.getQualifiedName("IsActive__c");return H()(t=H()(e=H()(s="".concat(a," in ('")).call(s,this.campaignStepId,"', '")).call(e,this.checkInStepId,"') and ")).call(t,i," = true")}}),watch:{dropdownRefId:async function(){if(this.statusOptionData.options.length<=0)try{var t;let e=await $(this.wechatCampaign.flowId);if(e=JSON.parse(B.a.unescape(e.data)),e.Statuses.length>0)for(const t of e.Statuses)this.statusOptionData.options.push({Name:t,Value:t});u()(t=this.statusOptionData.options).call(t,t=>"Lucky Draw Winner"===t.Value)||this.statusOptionData.options.push({Name:"Lucky Draw Winner",Value:"Lucky Draw Winner",isSelected:!1})}catch(t){Object(M.f)(t)}}},async mounted(){this.luckyDrawStepId&&await this.initData()},created(){this.luckyDrawSettings.Title=this.wechatCampaign.name;this.luckyDrawSettingsStatus="Lucky Draw Winner",this.luckyDrawSettings.CampaignMemberStatus="Lucky Draw Winner",this.statusOptionData.currentOptions=[{Name:"Lucky Draw Winner",Value:"Lucky Draw Winner"}]},beforeDestroy(){this.$root.$off("fetch-lucky-draw-data")},methods:{clearBgImg(){this.luckyDrawSettings.BackgroundAttachmentId=""},async initData(){for(const t of this.campaignFlowSteps)"LuckyDraw"===t.Type.Value&&(this.luckyDrawSettingsStatus=t.CampaignMemberStatus);this.luckyDrawSettingsStatus||(this.luckyDrawSettingsStatus="Lucky Draw Winner"),this.statusOptionData.currentOptions=[{Name:this.luckyDrawSettingsStatus,Value:this.luckyDrawSettingsStatus}],this.isLoadingSettings=!0;try{const e=await(t=this.luckyDrawStepId,Object(k.a)({method:"CampaignFlowRemoteActions.getLuckyDrawSettings",args:[t]}));if(e.ok){const t=JSON.parse(B.a.unescape(e.data));this.luckyDrawSettings=t.Settings,this.luckyDrawSettings.Title||(this.luckyDrawSettings.Title=this.wechatCampaign.name),this.luckyDrawSettings.QRCode.QRCodeId&&this.getQRCode()}else Object(M.f)(e)}catch(t){Object(M.f)(t)}finally{this.isLoadingSettings=!1}var t},async getQRCode(){try{const t=await Object(lt.d)(this.luckyDrawSettings.QRCode.QRCodeId);if(t.ok){const e=JSON.parse(B.a.unescape(t.data));this.currentQRItem={id:this.luckyDrawSettings.QRCode.QRCodeId,name:e.Name},this.luckyDrawSettings.QRCode.AttachmentId||(this.luckyDrawSettings.QRCode.AttachmentId=e.WeChatQrCodeUrl.split("file=")[1])}else Object(M.f)(t)}catch(t){Object(M.f)(t)}},async getCheckInQRCode(){if(this.checkInStepId)try{const t=await Object(lt.e)(this.checkInStepId);if(t.ok){const e=JSON.parse(B.a.unescape(t.data)).qrCodes;e.length>0?(this.currentQRItem={id:e[0].QRCodeId,name:e[0].Name},this.luckyDrawSettings.QRCode.QRCodeId=e[0].QRCodeId,this.luckyDrawSettings.QRCode.AttachmentId=e[0].WeChatQrCodeUrl.split("file=")[1]):this.currentQRItem=null}else Object(M.f)(t)}catch(t){Object(M.f)(t)}},onSelect(t){this.luckyDrawSettings.QRCode.QRCodeId=t?t.id:"",this.luckyDrawSettings.QRCode.AttachmentId=t?t.AttachmentId__c:""},onRemove(){this.luckyDrawSettings.QRCode.QRCodeId="",this.luckyDrawSettings.QRCode.AttachmentId=""},uploading(t){this.cancelUpload=!1,this.uploadFileMsg=t,this.chunkIndex=0,this.savePhoto()},async savePhoto(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.uploadFileMsg.body.length,s="";this.chunkCompleted=!1,e<=this.chunkIndex+this.chunkSize?(s=this.uploadFileMsg.body.substring(this.chunkIndex),this.chunkCompleted=!0):s=this.uploadFileMsg.body.substring(this.chunkIndex,this.chunkIndex+this.chunkSize);const a=await function(t,e,s,a,i){return Object(k.a)({method:"CampaignFlowRemoteActions.saveImage",args:[t,e,s,a,i]})}(this.wechatCampaign.flowId,this.uploadFileMsg.name,s,this.uploadFileMsg.type,t).catch(t=>{this.$root.$emit("upload-file-error",t.message)});a&&this.actionCallback(a,this.chunkCompleted)},actionCallback(t,e){t.ok?e?this.uploadFileMsg.body.length>this.chunkIndex+this.chunkSize?this.delAttachmentId(t.data):this.cancelUpload?(this.delAttachmentId(t.data),this.cancelUpload=!1):(this.luckyDrawSettings.BackgroundAttachmentId=t.data,this.$root.$emit("upload-file-success"),this.cancelUpload=!1):(this.chunkIndex+=this.chunkSize,this.savePhoto(t.data)):this.$root.$emit("upload-file-error",t.error)},finishUploadImage(){this.chunkCompleted=!0,this.cancelUpload=!!this.uploadFileMsg.body},async delAttachmentId(t){try{const e=await Object(Xe.a)(t);e.ok||Object(M.f)(e)}catch(t){Object(M.f)(t)}},selectPicklist(t){this.statusOptionData.currentOptions=t,this.luckyDrawSettingsStatus=t[0].Value,this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1},cancel(){this.$emit("cancel")},async saveSettingsData(){try{const a=await(t=this.luckyDrawStepId,e=m()(this.luckyDrawSettings),s=this.luckyDrawSettingsStatus,Object(k.a)({method:"CampaignFlowRemoteActions.saveLuckyDrawSettings",args:[t,e,s]}));a.ok||Object(M.f)(a)}catch(t){Object(M.f)(t)}var t,e,s},async next(){this.luckyDrawSettings.QRCode.QRCodeId&&!this.luckyDrawSettings.QRCode.AttachmentId&&await this.getQRCode(),this.saveSettingsData(),this.$emit("update-flow-step-page")}}},es=(s("rQWd"),s("Jz0g")),ss=Object(z.a)(ts,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"settings-section"},[a("section",{staticClass:"slds-box main"},[a("div",{staticClass:"slds-grid settings-item-section"},[a("label",[t._v(t._s(t.$t("titleLabel")))]),t._v(" "),a("div",{staticClass:"settings-action-wrapper"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.luckyDrawSettings.Title,expression:"luckyDrawSettings.Title"}],staticClass:"slds-input",attrs:{type:"text"},domProps:{value:t.luckyDrawSettings.Title},on:{input:function(e){e.target.composing||t.$set(t.luckyDrawSettings,"Title",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"slds-grid settings-item-section"},[a("label",[t._v(t._s(t.$t("bgImgLabel")))]),t._v(" "),a("div",{staticClass:"settings-action-wrapper slds-grid"},[a("div",{staticClass:"img-left"},[t.luckyDrawSettings.BackgroundAttachmentId?a("div",{staticClass:"bg-img-section"},[a("img",{key:"upload-image",attrs:{src:t._f("imgFilter")("/servlet/servlet.FileDownload?file="+t.luckyDrawSettings.BackgroundAttachmentId)},on:{error:function(e){return t.showErrorImg(e)}}}),t._v(" "),a("div",{staticClass:"cropper-clear-icon",on:{click:function(e){return t.clearBgImg()}}},[a("icon",{attrs:{name:"clear",width:"14px",height:"14px","fill-color":"#706e6b"}})],1)]):t._e(),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.luckyDrawSettings.BackgroundAttachmentId&&!t.isLoadingSettings,expression:"!luckyDrawSettings.BackgroundAttachmentId && !isLoadingSettings"}],staticClass:"bg-img-section"},[a("img",{attrs:{src:s("um3e"),alt:""}})])]),t._v(" "),a("div",{staticClass:"img-right"},[a("div",{staticClass:"upload-btn"},[a("upload-file",{attrs:{label:t.$t("uploadBtn"),"file-type":"Image"},on:{close:t.finishUploadImage,upload:t.uploading}})],1),t._v(" "),a("div",{staticClass:"upload-info"},[a("p",[t._v(t._s(t.$t("imgType")))]),t._v(" "),a("p",[t._v(t._s(t.$t("imgSize")))])])])])]),t._v(" "),a("div",{staticClass:"slds-grid settings-item-section"},[a("label",[t._v(t._s(t.$tc("qrcodeLabel",1)))]),t._v(" "),a("div",{staticClass:"settings-action-wrapper"},[a("div",{staticClass:"search-qr-container"},[a("lookup",{attrs:{"ld-selected-item":t.currentQRItem,"ld-metadatas":t.qrMetadata,condition:t.condition,"order-by":"LastModifiedDate DESC"},on:{select:function(e){return t.onSelect(e)},remove:function(e){return t.onRemove()}}})],1),t._v(" "),a("div",{staticClass:"info-msg"},[t._v(t._s(t.$t("qrcodeInfo")))])])]),t._v(" "),a("div",{staticClass:"slds-grid settings-item-section"},[a("label",{staticClass:"form-label"},[t._v(t._s(t.$t("campaignStatusLabel")))]),t._v(" "),a("div",{staticClass:"settings-action-wrapper"},[a("input-select",{attrs:{currents:t.statusOptionData.currentOptions,type:"status","default-label":t.$t("noneLabel")},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}}),t._v(" "),a("p",{staticClass:"info-msg"},[t._v(t._s(t.$t("statusInfo")))])],1)]),t._v(" "),a("div",{staticClass:"slds-grid settings-item-section"},[a("div",{staticClass:"checkbox-section"},[a("div",{staticClass:"slds-form-element"},[a("div",{staticClass:"slds-form-element__control"},[a("span",{staticClass:"slds-checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.luckyDrawSettings.IsShowNumberOfParticipants,expression:"luckyDrawSettings.IsShowNumberOfParticipants"}],attrs:{type:"checkbox",name:"options",id:"settings-num"},domProps:{checked:Array.isArray(t.luckyDrawSettings.IsShowNumberOfParticipants)?t._i(t.luckyDrawSettings.IsShowNumberOfParticipants,null)>-1:t.luckyDrawSettings.IsShowNumberOfParticipants},on:{change:function(e){var s=t.luckyDrawSettings.IsShowNumberOfParticipants,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&t.$set(t.luckyDrawSettings,"IsShowNumberOfParticipants",s.concat([null])):n>-1&&t.$set(t.luckyDrawSettings,"IsShowNumberOfParticipants",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.luckyDrawSettings,"IsShowNumberOfParticipants",i)}}}),t._v(" "),a("label",{staticClass:"slds-checkbox__label checkbox-label",attrs:{for:"settings-num"}},[a("span",{staticClass:"slds-checkbox_faux checkbox-span"}),t._v(" "),a("span",{staticClass:"slds-form-element__label checkbox-value"},[t._v(t._s(t.$t("showNumLabel")))])])])])])])]),t._v(" "),a("div",{staticClass:"slds-grid settings-item-section"},[a("div",{staticClass:"checkbox-section"},[a("div",{staticClass:"slds-form-element"},[a("div",{staticClass:"slds-form-element__control"},[a("span",{staticClass:"slds-checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.luckyDrawSettings.IsShowLeadOrContactName,expression:"luckyDrawSettings.IsShowLeadOrContactName"}],attrs:{type:"checkbox",name:"options",id:"settings-name"},domProps:{checked:Array.isArray(t.luckyDrawSettings.IsShowLeadOrContactName)?t._i(t.luckyDrawSettings.IsShowLeadOrContactName,null)>-1:t.luckyDrawSettings.IsShowLeadOrContactName},on:{change:function(e){var s=t.luckyDrawSettings.IsShowLeadOrContactName,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&t.$set(t.luckyDrawSettings,"IsShowLeadOrContactName",s.concat([null])):n>-1&&t.$set(t.luckyDrawSettings,"IsShowLeadOrContactName",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.luckyDrawSettings,"IsShowLeadOrContactName",i)}}}),t._v(" "),a("label",{staticClass:"slds-checkbox__label checkbox-label",attrs:{for:"settings-name"}},[a("span",{staticClass:"slds-checkbox_faux checkbox-span"}),t._v(" "),a("span",{staticClass:"slds-form-element__label checkbox-value"},[t._v(t._s(t.$t("showNameLabel")))])])])])])])])]),t._v(" "),a("section",{staticClass:"slds-border_top footer"},[a("button",{staticClass:"slds-button slds-button_neutral btn-left",on:{click:function(e){return t.cancel()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),a("button",{staticClass:"slds-button slds-button_brand btn-right",on:{click:function(e){return t.next()}}},[t._v(t._s(t.$t("global.nextBtn")))])]),t._v(" "),t.showDropdown?a("dropdown",{attrs:{options:t.statusOptionData.options,currents:t.statusOptionData.currentOptions,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e()],1)}),[],!1,null,"d15c96cc",null);"function"==typeof es.default&&Object(es.default)(ss);var as=ss.exports,is=s("7aFC"),ns={components:{NoRecord:w.a,LoadingSpinner:v.a},inject:["showErrorImg"],data:()=>({winners:[],isLoadingPrize:!1,currentEditWinner:null,searchKey:""}),computed:o()({},Object(P.c)({currentUser:"user/currentUser",luckyDrawStepId:"wechatCampaign/luckyDrawStepId"}),{showNoRecord(){return!this.filterWinners||this.filterWinners.length<=0},filterWinners(){var t;return kt()(t=this.winners).call(t,t=>{var e,s;return X()(e=Object(is.f)(t.FollowerName)).call(e,Object(is.f)(this.searchKey))>-1||X()(s=Object(is.f)(t.CampaignMemberName)).call(s,Object(is.f)(this.searchKey))>-1})}}),async created(){await this.fetchWinners()},methods:{clearSearchKey(){this.searchKey=""},formatDatetimeFilter:()=>R.e,async fetchWinners(){this.isLoadingPrize=!0;try{const e=await(t=this.luckyDrawStepId,Object(k.a)({method:"CampaignFlowRemoteActions.getWinners",args:[t]}));if(this.isLoadingPrize=!1,e.ok){const t=JSON.parse(B.a.unescape(e.data));this.winners=t.WinnersResult,this.winners}else Object(M.f)(e)}catch(t){this.isLoadingPrize=!1,Object(M.f)(t)}var t},openCollectModal(t){this.currentEditWinner=t;const e=this.$confirm({title:this.$t("collectModalHeader"),content:this.$t("collectModalContent")});e.$on("ok",async()=>{try{const t=await function(t,e,s){return Object(k.a)({method:"CampaignFlowRemoteActions.collect",args:[t,e,s]})}(this.luckyDrawStepId,this.currentEditWinner.CampaignMemberId,this.currentEditWinner.Order);if(t.ok){const s=JSON.parse(B.a.unescape(t.data));this.currentEditWinner.CollectedDate=s.CollectedDate,this.currentEditWinner.IsCollected=!0,e.close(),this.$root.$emit("open-toast-notification",{content:this.$t("collectNotify"),type:"success"})}else e.resume(),Object(M.f)(t)}catch(t){e.resume(),Object(M.f)(t)}})}}},os=(s("vMh3"),s("4lfF")),rs=Object(z.a)(ns,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"lucky-draw-winners-page"},[s("section",{staticClass:"slds-border_bottom slds-grid slds-grid_vertical-align-center slds-grid_align-spread filter-section"},[s("span",{staticClass:"winner-count"},[t._v(t._s(t._f("addSeparators")(t.filterWinners.length))),t.filterWinners.length>=1e3?s("i",{staticClass:"show-plus-sign"},[t._v("+")]):t._e(),t._v("\n      "+t._s(t.filterWinners.length>1?t.$tc("global.itemLabel",2):t.$tc("global.itemLabel",1))+"\n    ")]),t._v(" "),s("div",{staticClass:"filter-search"},[s("search-input",{attrs:{placeholder:t.$t("searchWinners")},on:{clear:t.clearSearchKey},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}})],1)]),t._v(" "),s("section",{staticClass:"slds-grid main"},[s("table",{directives:[{name:"show",rawName:"v-show",value:t.filterWinners.length>0&&!t.isLoadingPrize,expression:"filterWinners.length > 0 && !isLoadingPrize"}],staticClass:"slds-table slds-table_bordered slds-no-row-hover lucky-draw-table",attrs:{role:"grid"}},[s("thead",[s("tr",{staticClass:"slds-line-height_reset",staticStyle:{height:"2rem"}},[s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("div",{staticClass:"slds-truncate",attrs:{title:t.$t("name")}},[t._v(t._s(t.$t("name")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("div",{staticClass:"slds-truncate",attrs:{title:t.$t("leadOrContact")}},[t._v(t._s(t.$t("leadOrContact")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("div",{staticClass:"slds-truncate",attrs:{title:t.$t("roundName")}},[t._v(t._s(t.$t("roundName")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("div",{staticClass:"slds-truncate",attrs:{title:t.$t("prize")}},[t._v(t._s(t.$t("prize")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("div",{staticClass:"slds-truncate",attrs:{title:t.$t("wonDate")}},[t._v(t._s(t.$t("wonDate")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable",attrs:{focusable:"true",scope:"col"}},[s("div",{staticClass:"slds-truncate",attrs:{title:t.$t("collected")}},[t._v(t._s(t.$t("collected")))])]),t._v(" "),s("th",{staticClass:"slds-is-sortable slds-is-resizable lucky-draw-tab-quantity",attrs:{focusable:"true",scope:"col"}},[s("div",{staticClass:"slds-truncate",attrs:{title:t.$t("collectedDate")}},[t._v(t._s(t.$t("collectedDate")))])]),t._v(" "),t._m(0)])]),t._v(" "),s("tbody",t._l(t.filterWinners,(function(e){return s("tr",{staticClass:"slds-hint-parent"},[s("th",{attrs:{scope:"row"}},[s("div",{staticClass:"slds-truncate winner-info"},[s("div",{staticClass:"winner-pic"},[s("img",{attrs:{src:t._f("imgFilter")(e.FollowerUrl)},on:{error:function(e){return t.showErrorImg(e)}}})]),t._v(" "),s("div",{staticClass:"winner-name",attrs:{title:e.FollowerName}},[s("a",{attrs:{href:"/"+e.FollowerId,target:"_blank"}},[t._v(t._s(e.FollowerName))])])])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",attrs:{title:e.CampaignMemberName}},[s("a",{attrs:{href:"/"+e.LeadOrContactId,target:"_blank"}},[t._v("\n                "+t._s(e.CampaignMemberName)+"\n              ")])])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",attrs:{title:e.RoundName}},[t._v("\n              "+t._s(e.RoundName)+"\n            ")])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",attrs:{title:e.PrizeName}},[t._v("\n              "+t._s(e.PrizeName)+"\n            ")])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate",attrs:{title:""+t.formatDatetimeFilter()(e.WonDate,t.currentUser.TimeZoneSidKey)}},[t._v("\n              "+t._s(t._f("formatDatetimeFilter")(e.WonDate,t.currentUser.TimeZoneSidKey))+"\n            ")])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate"},[s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("span",{staticClass:"slds-checkbox"},[s("input",{attrs:{type:"checkbox",name:"options",disabled:"",value:"on"},domProps:{checked:e.IsCollected}}),t._v(" "),t._m(1,!0)])])])])]),t._v(" "),s("td",{attrs:{role:"gridcell"}},[s("div",{staticClass:"slds-truncate align-rignt",attrs:{title:""+t.formatDatetimeFilter()(e.CollectedDate,t.currentUser.TimeZoneSidKey)}},[t._v("\n              "+t._s(t._f("formatDatetimeFilter")(e.CollectedDate,t.currentUser.TimeZoneSidKey))+"\n            ")])]),t._v(" "),s("td",{staticClass:"td-position",staticStyle:{width:"3.25rem"},attrs:{role:"gridcell"}},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:e.IsCollected},on:{click:function(s){return t.openCollectModal(e)}}},[t._v(t._s(t.$t("collect")))])])])})),0)]),t._v(" "),t.showNoRecord&&!t.isLoadingPrize?s("no-record",{attrs:{"custom-style":"top: 45px;"}}):t._e(),t._v(" "),s("loading-spinner",{attrs:{"is-loading":t.isLoadingPrize,"custom-style":"top: 45px;"}})],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("th",{staticClass:"slds-is-sortable slds-is-resizable action-tab-width",attrs:{focusable:"true"}},[e("div",{staticClass:"slds-truncate"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{staticClass:"slds-checkbox__label"},[e("span",{staticClass:"slds-checkbox_faux"})])}],!1,null,"a627a8ba",null);"function"==typeof os.default&&Object(os.default)(rs);var cs={components:{Wizard:G,LuckyDrawList:Ze,LuckyDrawSettings:as,LuckyDrawWinners:rs.exports},props:{showWinners:{type:Boolean,default:()=>!1}},data(){return{steps:[{label:this.$t("settingsLabel"),title:this.$t("settingsTitle"),value:this.$t("settingsValue"),stepApi:"Settings",page:0},{label:this.$t("addPrizesLabel"),title:this.$t("addPrizesTitle"),value:this.$t("addPrizesSubtitle"),stepApi:"AddPrizes",page:1}],stepIndex:0,selectedIndex:0,currentStep:{},luckyDraw:{Step:"",FlowStepPage:0,CurrentRound:0,Settings:{Title:"",Theme:"Default",BackgroundAttachmentId:"",IsShowNumberOfParticipants:!0,IsShowLeadOrContactName:!1,QRCode:{QRCodeId:"",AttachmentId:""},CampaignMemberStatus:""},Prizes:[],BlockedMemberIds:[]}}},computed:o()({},Object(P.c)({wechatCampaign:"wechatCampaign/campaign",luckyDrawStepId:"wechatCampaign/luckyDrawStepId"})),watch:{"currentStep.stepApi":function(t){this.$emit("show-run-actions","Settings"===t)}},async created(){"edit"===this.wechatCampaign.type?(await this.getFlowStepPageData(),this.currentStep=this.steps[this.luckyDraw.FlowStepPage],this.stepIndex=this.luckyDraw.FlowStepPage,this.selectedIndex=this.luckyDraw.FlowStepPage):this.currentStep=this.steps[0]},methods:o()({},Object(P.b)("wechatCampaign",["storeLuckyDrawStepId"]),{async fetchCampaignStepId(){try{const t=await x(this.wechatCampaign.flowId,"LuckyDraw",m()(this.luckyDraw)),e=JSON.parse(B.a.unescape(t.data));this.$route.query.flowStepId=e.wechatCampaignFlowStepId,this.storeLuckyDrawStepId(e.wechatCampaignFlowStepId)}catch(t){Object(M.f)(t)}},async getFlowStepPageData(){try{const e=await(t=this.luckyDrawStepId,Object(k.a)({method:"CampaignFlowRemoteActions.getFlowStepPage",args:[t]}));if(e.data){const t=JSON.parse(B.a.unescape(e.data));this.luckyDraw.Step=t.Step||"Settings",this.luckyDraw.FlowStepPage=t.FlowStepPage,this.luckyDraw.CurrentRound=t.CurrentRound,this.$root.$emit("fetch-lucky-draw-data",this.luckyDraw)}}catch(t){Object(M.f)(t)}var t},back(){document.querySelector(".flow-tab-right").scrollTop=0,this.selectedIndex=this.selectedIndex-1,this.currentStep=this.steps[this.selectedIndex]},next(){document.querySelector(".flow-tab-right").scrollTop=0,this.selectedIndex<this.stepIndex?this.selectedIndex=this.selectedIndex+1:(this.stepIndex=this.stepIndex+1,this.selectedIndex=this.stepIndex),this.currentStep=this.steps[this.selectedIndex],this.luckyDraw.Step=this.currentStep.stepApi,this.luckyDraw.FlowStepPage<this.currentStep.page&&(this.luckyDraw.FlowStepPage=this.currentStep.page)},selectStep(t){this.selectedIndex=t,this.currentStep=this.steps[t]},cancel(){this.$emit("cancel-flow")},async updateFlow(){this.next();try{const t=await O(this.luckyDrawStepId,this.luckyDraw.Step,this.luckyDraw.FlowStepPage,this.luckyDraw.CurrentRound);t.ok||Object(M.f)(t)}catch(t){Object(M.f)(t)}},saveFlow(t){this.$emit("flow-done",t)}})},ls=(s("Fip8"),s("4+HD")),ds=Object(z.a)(cs,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"wechat-lucky-draw-flow"},[s("section",{directives:[{name:"show",rawName:"v-show",value:!t.showWinners,expression:"!showWinners"}],staticClass:"wechat-lucky-draw-flow"},[s("section",{staticClass:"wizard-section"},[s("wizard",{attrs:{steps:t.steps,"step-index":t.stepIndex,"select-index":t.selectedIndex},on:{"select-step":t.selectStep}})],1),t._v(" "),s("p",{staticClass:"step-title"},[t._v(t._s(t.currentStep.title))]),t._v(" "),s("p",{staticClass:"step-value"},[t._v(t._s(t.currentStep.value))]),t._v(" "),s("section",{staticClass:"content"},[0===t.currentStep.page?s("lucky-draw-settings",{on:{"update-flow-step-page":t.updateFlow,cancel:t.cancel}}):t._e(),t._v(" "),1===t.currentStep.page?s("lucky-draw-list",{attrs:{"lucky-draw":t.luckyDraw},on:{back:t.back,save:t.saveFlow}}):t._e()],1)]),t._v(" "),s("section",{directives:[{name:"show",rawName:"v-show",value:t.showWinners,expression:"showWinners"}],staticClass:"wechat-lucky-draw-flow"},[t.showWinners?s("lucky-draw-winners"):t._e()],1)])}),[],!1,null,"3a7eb0b6",null);"function"==typeof ls.default&&Object(ls.default)(ds);var hs=ds.exports,us={props:{flowType:{type:String,default:()=>""}},components:{RegisterFlow:re,CheckInFlow:Me,LuckyDrawFlow:hs},mounted(){this.$root.$on("fetch-register-data",t=>{0===t.flowStepPage?"Registration"===this.flowType?this.tabs[0].status="progress":this.tabs[0].status="start":3===t.flowStepPage?this.tabs[0].status="done":this.tabs[0].status="progress"}),this.$root.$on("fetch-check-in-data",t=>{0===t.flowStepPage?"Check-in"===this.flowType?this.tabs[1].status="progress":this.tabs[1].status="start":2===t.flowStepPage?this.tabs[1].status="done":this.tabs[1].status="progress"}),this.$root.$on("fetch-lucky-draw-data",t=>{0===t.FlowStepPage?"LuckyDraw"===this.flowType?this.tabs[2].status="progress":this.tabs[2].status="start":1===t.FlowStepPage&&(this.tabs[2].status="done")})},beforeDestroy(){let t=this.$root;t.$off("fetch-register-data"),t.$off("fetch-lucky-draw-data"),t.$off("fetch-check-in-data")},data(){return{tabs:[{label:this.$t("registerLabel"),value:"register",status:"start",isActive:!1,isActivate:!0},{label:this.$t("checkInLabel"),value:"checkIn",status:"start",isActive:!1,isActivate:!0},{label:this.$t("luckyDrawLabel"),value:"luckyDraw",status:"start",isActive:!1,isActivate:!0}],currentTab:{},luckyDrawTabs:["BUILDER","WINNERS"],currentLuckyDrawTab:"BUILDER",showRunLuckyDrawBtn:!1}},computed:o()({},Object(P.c)({checkInStepId:"wechatCampaign/checkInStepId",registerStepId:"wechatCampaign/registerStepId",luckyDrawStepId:"wechatCampaign/luckyDrawStepId",campaignFlowSteps:"wechatCampaign/campaignFlowSteps"}),{showWinners:function(){return"WINNERS"===this.currentLuckyDrawTab}}),created(){for(const t of this.campaignFlowSteps)"Registration"===t.Type.Value?this.tabs[0].isActivate=t.IsActive:"Check-in"===t.Type.Value?this.tabs[1].isActivate=t.IsActive:"LuckyDraw"===t.Type.Value&&(this.tabs[2].isActivate=t.IsActive);"Registration"===this.flowType?this.currentTab=this.tabs[0]:"Check-in"===this.flowType?this.currentTab=this.tabs[1]:this.currentTab=this.tabs[2],this.currentTab.isActive=!0,this.currentTab.status="progress"},methods:{showRunActions(t){this.showRunLuckyDrawBtn=!t},runLuckyDraw(t){var e;let s=H()(e="".concat(window.location.origin,"/apex/LuckyDraw?flowStepId=")).call(e,this.luckyDrawStepId);"test"===t&&(s="".concat(s,"&test=1")),window.open(s,"luckyDraw")},changeTab(t){this.currentLuckyDrawTab=t;const e=this.$refs.luckyDrawFlow.$children[2];"WINNERS"===this.currentLuckyDrawTab&&e&&e.fetchWinners()},async switchTab(t){document.querySelector(".flow-tab-right").scrollTop=0;for(const e of this.tabs)if(e.label===t.label){if(e.isActive=!0,"start"===e.status&&(e.status="progress"),"checkIn"===e.value)this.$router.replace({path:"/wechat-campaign/check-in",query:{flowId:this.$route.query.flowId,flowStepId:this.checkInStepId}});else if("register"===e.value)this.$router.replace({path:"/wechat-campaign/register",query:{flowId:this.$route.query.flowId,flowStepId:this.registerStepId}});else{if(!this.luckyDrawStepId){await this.$refs.luckyDrawFlow.fetchCampaignStepId();const t=this.$refs.luckyDrawFlow.$children[1];t&&await t.getCheckInQRCode()}this.$router.replace({path:"/wechat-campaign/lucky-draw",query:{flowId:this.$route.query.flowId,flowStepId:this.luckyDrawStepId}})}this.currentTab=e}else e.isActive=!1},cancelRegisterFlow(){this.$emit("cancel-flow")},cancelCheckInFlow(){this.$emit("cancel-flow")},cancelLuckyDrawFlow(){this.$emit("cancel-flow")},registerDone(){this.currentTab.status="done",this.$root.$emit("open-toast-notification",{content:this.$t("registerSuccessLabel"),type:"success"})},checkInDone(){this.currentTab.status="done",this.$root.$emit("open-toast-notification",{content:this.$t("checkInSuccessLabel"),type:"success"})},luckyDrawDone(t){this.currentTab.status="done",t&&this.$root.$emit("open-toast-notification",{content:this.$t("luckyDrawSuccessLabel"),type:"success"})}}},ps=(s("5FD4"),s("y61V"),s("S6PD")),ms=Object(z.a)(us,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"slds-grid wechat-flow-tab"},["luckyDraw"===t.currentTab.value?s("div",{staticClass:"slds-grid slds-grid_align-space lucky-draw-tabs"},[s("ul",{staticClass:"slds-grid"},t._l(t.luckyDrawTabs,(function(e){return s("li",{class:[e===t.currentLuckyDrawTab?"slds-border_left slds-border_right li-tab-active":""],on:{click:function(s){return t.changeTab(e)}}},[t._v(t._s(t.$t(e)))])})),0)]):t._e(),t._v(" "),t.showRunLuckyDrawBtn&&"luckyDraw"===t.currentTab.value?s("div",{staticClass:"lucky-draw-btns"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.runLuckyDraw("test")}}},[t._v(t._s(t.$t("test")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",on:{click:function(e){return t.runLuckyDraw("start")}}},[t._v(t._s(t.$t("start")))])]):t._e(),t._v(" "),s("section",{staticClass:"slds-border_right left"},t._l(t.tabs,(function(e){return s("nav",{staticClass:"tab",class:{active:e.isActive},on:{click:function(s){return t.switchTab(e)}}},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.isActive,expression:"tab.isActive"}],staticClass:"active-sign"}),t._v(" "),s("span",[t._v(t._s(e.label))]),t._v(" "),e.isActivate?s("span",[s("span",{directives:[{name:"show",rawName:"v-show",value:"progress"===e.status,expression:"tab.status === 'progress'"}],staticClass:"slds-progress__marker progress"}),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:"done"===e.status,expression:"tab.status === 'done'"}],staticClass:"check-in"},[s("icon",{attrs:{name:"checkIn","fill-color":"#0070d2",width:"15px",height:"15px","charket-icon":""}})],1),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:"start"===e.status,expression:"tab.status === 'start'"}],staticClass:"slds-progress__marker not-progress"})]):s("span",{staticClass:"disabled-icon"},[s("icon",{attrs:{name:"disabledIcon","fill-color":"#706E6B",width:"15px",height:"15px","charket-icon":""}})],1)])})),0),t._v(" "),s("section",{staticClass:"flow-tab-right slds-scrollable_y"},[s("register-flow",{directives:[{name:"show",rawName:"v-show",value:"register"===t.currentTab.value,expression:"currentTab.value === 'register'"}],on:{"cancel-flow":t.cancelRegisterFlow,"flow-done":t.registerDone}}),t._v(" "),s("check-in-flow",{directives:[{name:"show",rawName:"v-show",value:"checkIn"===t.currentTab.value,expression:"currentTab.value === 'checkIn'"}],on:{"cancel-flow":t.cancelCheckInFlow,"flow-done":t.checkInDone}}),t._v(" "),s("lucky-draw-flow",{directives:[{name:"show",rawName:"v-show",value:"luckyDraw"===t.currentTab.value,expression:"currentTab.value === 'luckyDraw'"}],ref:"luckyDrawFlow",attrs:{"show-winners":t.showWinners},on:{"cancel-flow":t.cancelLuckyDrawFlow,"flow-done":t.luckyDrawDone,"show-run-actions":t.showRunActions}})],1)])}),[],!1,null,"5dc5f871",null);"function"==typeof ps.default&&Object(ps.default)(ms);var gs=ms.exports,fs={mixins:[y.a],props:{headerContent:{type:String,default:""},campaign:{type:Object,default:()=>({})}},data(){return{errorToastMsg:"",currentItem:null,campaignMetadata:{name:"Campaign",label:this.$tc("global.campaignName",1),labelPural:this.$tc("global.campaignName",2),icon:"campaign",linkField:{name:"Name",label:this.$tc("global.campaignName",1)},fields:[],newObjectLink:"/701/e"},newCampaign:{Name:"",CampaignId:"",WeChatAccountId:"",WeChatTags:[],IsOverwriteFollowerTag:!1},accounts:{options:[],currentOptions:[]},tagOptions:[],isSubmitSave:!1}},components:{Lookup:ct.a,ErrorToast:xt.a,InputSelect:C.a,Dropdown:_.a,TagDropdown:St.a},created(){for(const t of f()(this.accountList)){const e=this.accountList[t];"Service Account"===e.Type&&this.accounts.options.push(JSON.parse(m()(e)))}if(this.campaign.Id){this.newCampaign.CampaignId=this.campaign.CampaignId,this.currentItem={id:this.campaign.CampaignId,name:this.campaign.CampaignName},this.newCampaign.Name=this.campaign.CampaignName,this.newCampaign.WeChatAccountId=this.campaign.WeChatAccountId,this.$router.replace({name:"wechat-campaign",query:{campaignId:this.campaign.CampaignId,campaignName:this.campaign.CampaignName}}),this.accounts.currentOptions.push({Id:this.campaign.WeChatAccountId,Name:this.campaign.WeChatAccountName}),this.newCampaign.IsOverwriteFollowerTag=this.campaign.IsOverwriteFollowerTag;for(const t of this.campaign.WeChatTags)this.newCampaign.WeChatTags.push({Id:t.Id,Name:t.Name}),this.tagOptions.push({Id:t.Id,Name:t.Name})}else this.campaign.CampaignId&&(this.newCampaign.CampaignId=this.campaign.CampaignId,this.currentItem={id:this.campaign.CampaignId,name:this.campaign.CampaignName},this.newCampaign.Name=this.campaign.CampaignName)},computed:o()({},Object(P.c)({accountList:"sidebar/wechatAccounts"}),{isDisabled(){return!(this.newCampaign.CampaignId&&this.newCampaign.WeChatAccountId&&!this.isSubmitSave)},isAccPicklistDisabled(){return!!this.campaign.Id}}),methods:o()({},Object(P.b)("wechatCampaign",["storeCampaign","storeRegisterStepId","storeCheckInStepId","storeLuckyDrawStepId","storeFlowSteps"]),{onSelect(t){this.newCampaign.CampaignId=t?t.id:"",this.newCampaign.Name=t?t.name:"",t&&this.$router.replace({name:"wechat-campaign",query:{campaignId:t.id,campaignName:t.name}})},onRemove(){this.newCampaign.CampaignId="",this.newCampaign.Name="",this.$router.replace({name:"wechat-campaign"}),this.$root.$emit("close-other-dropdown",null)},closeNewCampaign(){this.$router.replace({name:"wechat-campaign"}),this.$emit("close-new-campaign")},async saveCampaign(){if(this.isSubmitSave=!0,this.storeRegisterStepId(""),this.storeCheckInStepId(""),this.storeLuckyDrawStepId(""),this.campaign.Id)try{this.newCampaign.Id=this.campaign.Id;const e=await(t=m()(this.newCampaign),Object(k.a)({method:"CampaignFlowRemoteActions.updateCampaignFlow",args:[t]}));if(e.ok){let t;for(const e of this.campaign.CampaignFlowSteps)"Registration"===e.Type.Value?(this.storeRegisterStepId(e.Id),t=e.Id):"Check-in"===e.Type.Value?this.storeCheckInStepId(e.Id):"LuckyDraw"===e.Type.Value&&this.storeLuckyDrawStepId(e.Id);const e=this.accounts.currentOptions[0],s={id:this.newCampaign.CampaignId,flowId:this.campaign.Id,tags:this.tagOptions,isOverwriteFollowerTag:this.newCampaign.IsOverwriteFollowerTag,name:this.newCampaign.Name,account:{id:e.Id,name:e.Name,type:e.Type},type:"edit"};this.$router.replace({path:"/wechat-campaign/register",query:{flowId:this.campaign.Id,flowStepId:t}}),this.storeCampaign(s),this.$emit("close-new-campaign",!0)}else this.errorToastMsg=e.error,this.isSubmitSave=!1}catch(t){this.errorToastMsg=t.message,this.isSubmitSave=!1}else try{const t=await function(t){return Object(k.a)({method:"CampaignFlowRemoteActions.createCampaignFlow",args:[t]})}(m()(this.newCampaign));if(t.ok){this.storeFlowSteps([]);const e=JSON.parse(B.a.unescape(t.data)),s=this.accounts.currentOptions[0],a={id:this.newCampaign.CampaignId,flowId:e.WeChatCampaignFlowId,tags:this.tagOptions,isOverwriteFollowerTag:this.newCampaign.IsOverwriteFollowerTag,name:this.newCampaign.Name,account:{id:s.Id,name:s.Name,type:s.Type}};this.$emit("close-new-campaign",!0),this.$router.replace({path:"/wechat-campaign/register",query:{flowId:e.WeChatCampaignFlowId}}),this.storeCampaign(a),this.isSubmitSave=!1}else this.errorToastMsg=t.error,this.isSubmitSave=!1}catch(t){this.errorToastMsg=t.message,this.isSubmitSave=!1}var t},selectPicklist(t){this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1,this.accounts.currentOptions=t,this.newCampaign.WeChatAccountId=0!==t.length?t[0].Id:"",this.newCampaign.WeChatTags=[],this.tagOptions=[],this.newCampaign.IsOverwriteFollowerTag=!1},selectTags(t){this.newCampaign.WeChatTags=[];for(let e of t)this.newCampaign.WeChatTags.push({Id:e.Id,Name:e.Name});this.tagOptions=t},removeOption(t){this.newCampaign.WeChatTags=[];for(let e of t)this.newCampaign.WeChatTags.push({Id:e.Id,Name:e.Name});this.tagOptions=t,this.showTagDropdown&&(this.$root.$emit("close-other-dropdown",null),this.showTagDropdown=!1)}})},vs=(s("V7Tw"),s("Poeg"),s("NIFb")),ws=Object(z.a)(fs,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"wechat-campaign"}},[s("div",{staticClass:"slds-modal slds-modal_large slds-fade-in-open",attrs:{id:"campaignPopup","aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container campaign-popup-container",attrs:{role:"document",tabindex:"0"}},[s("div",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close",on:{click:function(e){return t.closeNewCampaign()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s("Edit WeChat Campaign"===t.headerContent?t.$t("editTitle"):t.$t("newTitle")))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium campaign-content-section"},[t.errorToastMsg?s("error-toast",{attrs:{content:t.errorToastMsg}}):t._e(),t._v(" "),s("div",{staticClass:"new-line new-campaign"},[s("div",{staticClass:"new-title"},[s("span",[t._v("*")]),t._v(" "+t._s(t.$tc("global.campaignName",1)))]),t._v(" "),s("div",{staticClass:"new-campaign-lookup"},[s("lookup",{attrs:{"ld-selected-item":t.currentItem,"ld-metadatas":t.campaignMetadata},on:{select:t.onSelect,remove:function(e){return t.onRemove()}}})],1)]),t._v(" "),s("div",{staticClass:"new-line"},[s("div",{staticClass:"new-title"},[s("span",[t._v("*")]),t._v(" "+t._s(t.$t("accountLabel")))]),t._v(" "),s("input-select",{attrs:{currents:t.accounts.currentOptions,"is-disabled":t.isAccPicklistDisabled,type:"accounts"},on:{"open-dropdown":t.openDropdown,"close-dropdown":t.closeDropdown,resize:t.resizeDropdown}})],1),t._v(" "),s("div",{staticClass:"new-line"},[s("div",{staticClass:"new-title"},[t._v(" "+t._s(t.$t("tagsLabel")))]),t._v(" "),s("input-select",{attrs:{"is-disabled":!t.newCampaign.WeChatAccountId,currents:t.tagOptions,"limit-length":5},on:{"close-dropdown":t.closeDropdown,"open-dropdown":t.openTagDropdown,resize:t.resizeDropdown,"remove-option":t.removeOption}})],1),t._v(" "),s("div",{staticClass:"new-line"},[s("div",{staticClass:"slds-form-element"},[s("div",{staticClass:"slds-form-element__control"},[s("span",{staticClass:"slds-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.newCampaign.IsOverwriteFollowerTag,expression:"newCampaign.IsOverwriteFollowerTag"}],attrs:{type:"checkbox",name:"options",id:"follower-tag",disabled:!t.newCampaign.WeChatAccountId},domProps:{checked:Array.isArray(t.newCampaign.IsOverwriteFollowerTag)?t._i(t.newCampaign.IsOverwriteFollowerTag,null)>-1:t.newCampaign.IsOverwriteFollowerTag},on:{change:function(e){var s=t.newCampaign.IsOverwriteFollowerTag,a=e.target,i=!!a.checked;if(Array.isArray(s)){var n=t._i(s,null);a.checked?n<0&&t.$set(t.newCampaign,"IsOverwriteFollowerTag",s.concat([null])):n>-1&&t.$set(t.newCampaign,"IsOverwriteFollowerTag",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.newCampaign,"IsOverwriteFollowerTag",i)}}}),t._v(" "),s("label",{staticClass:"slds-checkbox__label checkbox-label",attrs:{for:"follower-tag"}},[s("span",{staticClass:"slds-checkbox_faux checkbox-span"}),t._v(" "),s("span",{staticClass:"slds-form-element__label checkbox-value"},[t._v(t._s(t.$t("overwriteLabel")))])])])])])]),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.accounts.options,currents:t.accounts.currentOptions,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth,"default-label":!0},on:{"select-option":t.selectPicklist,close:t.closeDropdown}}):t._e(),t._v(" "),t.showTagDropdown?s("tag-dropdown",{attrs:{"account-id":t.newCampaign.WeChatAccountId,currents:t.tagOptions,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth,"is-single-selection":!1,"limit-length":5},on:{"select-option":t.selectTags,close:t.closeDropdown}}):t._e()],1),t._v(" "),s("div",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.closeNewCampaign()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),t._t("negative",[s("button",{staticClass:"slds-button slds-button_neutral slds-button_brand",attrs:{disabled:t.isDisabled},on:{click:function(e){return t.saveCampaign()}}},[t._v(t._s(t.$t("global.nextBtn")))])])],2)])]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open",attrs:{id:"Modal"}})])}),[],!1,null,"1ce3a09b",null);"function"==typeof vs.default&&Object(vs.default)(ws);var bs=ws.exports,Cs={components:{Icon:Q.a,WechatCampaignList:W,FlowTab:gs,NewWechatCampaign:bs},mounted(){this.$root.$on("campaign-entrance-clicked",this.refreshList)},data(){return{showNewCampaign:!1,showFlow:!1,showCampaignList:!1,headerContent:"New WeChat Campaign",flowType:"Registration",currentCampaign:{},documentTitle:"".concat(this.$t("title")," | Charket"),isEdittingName:!1,weChatCampaignName:"",isUpdateName:!1}},async created(){const t=this.$route.query.flowId;if("/wechat-campaign/register"===this.$route.path)await this.fetchFlowCampaign(t),this.flowType="Registration",this.showFlow=!0;else if("/wechat-campaign/check-in"===this.$route.path)await this.fetchFlowCampaign(t),this.flowType="Check-in",this.showFlow=!0;else if("/wechat-campaign/lucky-draw"===this.$route.path)await this.fetchFlowCampaign(t),this.flowType="LuckyDraw",this.showFlow=!0;else if("/wechat-campaign"===this.$route.path&&this.$route.query.campaignId){const t=this.$route.query.campaignId,e=this.$route.query.campaignName;this.showCampaignList=!0,this.currentCampaign={CampaignId:t,CampaignName:e},this.showNewCampaign=!0,this.headerContent="New WeChat Campaign"}else this.showCampaignList=!0},computed:o()({},Object(P.c)({wechatCampaign:"wechatCampaign/campaign"})),methods:o()({},Object(P.b)("wechatCampaign",["storeCampaign","storeRegisterStepId","storeCheckInStepId","storeLuckyDrawStepId","updateCampaignName","storeFlowSteps"]),{editCampaignNameData(){this.isEdittingName=!0,this.$nextTick((function(){this.$refs.editCampaignNameInput.focus()})),this.weChatCampaignName=this.wechatCampaign.name;const t=()=>{this.isEdittingName=!1,window.removeEventListener("click",t)};i()(()=>{window.addEventListener("click",t)},0)},async changeCampaignName(){this.isUpdateName=!0;try{const s=await(t=this.wechatCampaign.flowId,e=this.weChatCampaignName,Object(k.a)({method:"CampaignFlowRemoteActions.editCampaignFlowName",args:[t,e]}));s.ok?this.updateCampaignName(this.weChatCampaignName):Object(M.f)(s)}catch(t){Object(M.f)(t)}finally{this.isUpdateName=!1}var t,e},async fetchFlowCampaign(t){try{const e=await N(t),s=JSON.parse(B.a.unescape(e.data)).campaignFlow;let a={id:s.CampaignId,flowId:t,name:s.CampaignName,isOverwriteFollowerTag:s.IsOverwriteFollowerTag,tags:s.WeChatTags,account:{id:s.WeChatAccountId,name:s.WeChatAccountName,type:s.WeChatAccountType},type:"edit"};this.storeCampaign(a);for(const t of s.CampaignFlowSteps)"Registration"===t.Type.Value?this.storeRegisterStepId(t.Id):"Check-in"===t.Type.Value?this.storeCheckInStepId(t.Id):"LuckyDraw"===t.Type.Value&&this.storeLuckyDrawStepId(t.Id);this.storeFlowSteps(s.CampaignFlowSteps)}catch(t){Object(M.f)(t)}},refreshList(){this.flowType="Registration",this.showFlow=!1,this.showCampaignList=!0,this.$refs.wechatCampaignList&&this.$refs.wechatCampaignList.refreshCampaignList(),this.$router.replace({path:"/wechat-campaign"})},toggleWeChatAccounts(){this.$root.$emit("show-nav-box")},showNewWechatCampaign(){this.showNewCampaign=!0,this.headerContent="New WeChat Campaign"},closeNewCampaign(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.showNewCampaign=!1,this.currentCampaign={},t&&(this.showFlow=!0,this.showCampaignList=!1)},editCampaign(t){this.storeFlowSteps(t.CampaignFlowSteps),this.showNewCampaign=!0,this.currentCampaign=t,this.headerContent="Edit WeChat Campaign"},cancelFlow(){this.flowType="Registration",this.showFlow=!1,this.showCampaignList=!0,this.$router.replace({name:"wechat-campaign"})}}),beforeDestroy(){this.$root.$off("campaign-entrance-clicked")}},_s=(s("Dpxe"),s("D1u0")),ys=Object(z.a)(Cs,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"wechat-campaign-page"},[s("div",{staticClass:"slds-border_bottom slds-grid slds-grid_align-spread campaign-page-header"},[s("div",{staticClass:"slds-grid header-left"},[s("div",{staticClass:"account-btn"},[t.showFlow?s("a",{staticClass:"down-btn",on:{click:t.refreshList}},[s("icon",{attrs:{name:"back","class-name":"down-icon",width:"18px",height:"18px"}})],1):s("a",{staticClass:"down-btn",on:{click:t.toggleWeChatAccounts}},[s("icon",{attrs:{name:"menuIcon","class-name":"down-icon",width:"18px",height:"18px"}})],1),t._v(" "),s("span",{staticClass:"header-line"})]),t._v(" "),t.showFlow?t._e():s("span",{staticClass:"campaign-value"},[t._v(t._s(t.$t("title")))])]),t._v(" "),t.showFlow?s("div",{staticClass:"dream-title",class:{"show-input-left":t.isEdittingName}},[s("div",{staticClass:"campaign-name-area",on:{click:function(e){return t.editCampaignNameData()}}},[s("input",{directives:[{name:"show",rawName:"v-show",value:t.isEdittingName,expression:"isEdittingName"},{name:"model",rawName:"v-model",value:t.weChatCampaignName,expression:"weChatCampaignName"}],ref:"editCampaignNameInput",staticClass:"slds-box campaign-name-input",attrs:{type:"text"},domProps:{value:t.weChatCampaignName},on:{click:function(t){t.stopPropagation()},change:function(e){return t.changeCampaignName()},input:function(e){e.target.composing||(t.weChatCampaignName=e.target.value)}}}),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEdittingName,expression:"!isEdittingName"}],staticClass:"slds-truncate campaign-name-area-span"},[t._v(t._s(t.isUpdateName?t.weChatCampaignName:t.wechatCampaign.name))]),t._v(" "),t.isEdittingName?t._e():s("span",{staticClass:"down-btn"},[s("icon",{attrs:{name:"editReplyIcon","class-name":"down-icon",width:"14px",height:"14px","charket-icon":""}})],1)])]):t._e(),t._v(" "),s("div",{staticClass:"header-right"},[t.showFlow?t._e():s("button",{staticClass:"slds-button slds-button_neutral",on:{click:t.showNewWechatCampaign}},[t._v(t._s(t.$t("global.newBtn")))])])]),t._v(" "),s("div",{staticClass:"campaign-main-content"},[t.showCampaignList?s("wechat-campaign-list",{ref:"wechatCampaignList",on:{"edit-campaign":t.editCampaign,"edit-campaign-name":t.closeNewCampaign}}):t._e(),t._v(" "),t.showFlow?s("flow-tab",{attrs:{"flow-type":t.flowType},on:{"cancel-flow":t.cancelFlow}}):t._e()],1),t._v(" "),t.showNewCampaign?s("new-wechat-campaign",{attrs:{campaign:t.currentCampaign,"header-content":t.headerContent},on:{"close-new-campaign":t.closeNewCampaign}}):t._e()],1)}),[],!1,null,"55fcd2c6",null);"function"==typeof _s.default&&Object(_s.default)(ys);e.default=ys.exports},S6PD:function(t,e,s){"use strict";var a=s("bve2"),i=s.n(a);e.default=i.a},Sd7o:function(t,e,s){},"T/be":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"formActionLabel":"表单提交后","thanksMsgLabel":"提示文字","urlLabel":"打开其他网页","redirectUrlLabel":"网页地址","responseLabel":"响应消息","campaignStatusLabel":"市场活动成员状态","noneLabel":"--无--","showThanksMsgLabel":"显示提示文字","editThankYouMessage":"编辑提示文字","textMsgLabel":"文本","imageMsgLabel":"图片","strucMsgLabel":"图文消息","voiceMsgLabel":"语音","videoMsgLabel":"视频","passMsgLabel":"凭证","notifyMsgLabel":"模板消息","couponMsgLabel":"卡券","miniProgramLabel":"小程序卡片","acceptedLabel":"已接受","attendedLabel":"已签到","skillLabel":"技能","passLimitLabel":"只允许添加 1 张门票。"},"en":{"formActionLabel":"Form Submitted Action","thanksMsgLabel":"Thank You Message","urlLabel":"Redirect URL","redirectUrlLabel":"Redirect URL","responseLabel":"Completion Response(s)","campaignStatusLabel":"Campaign Member Status","noneLabel":"--None--","showThanksMsgLabel":"Show Thank You Message","editThankYouMessage":"Edit Thank You Message","textMsgLabel":"text message","imageMsgLabel":"image","strucMsgLabel":"structured message","voiceMsgLabel":"voice","videoMsgLabel":"video","passMsgLabel":"pass","notifyMsgLabel":"notification","couponMsgLabel":"coupon","miniProgramLabel":"mini program page","acceptedLabel":"Accepted","attendedLabel":"Attended","skillLabel":"skill","passLimitLabel":"Only 1 pass can be added."}}'),delete t.options._Ctor}},TCjm:function(t,e,s){},TJfr:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"searchWinners":"搜索中奖名单","name":"姓名","leadOrContact":"潜在客户/联系人","roundName":"奖项名称","prize":"奖品","collected":"已兑换","collectedDate":"兑换时间","wonDate":"中奖时间","collect":"兑换","collectModalHeader":"兑换奖品","collectModalContent":"确定要兑换这个奖品吗？","collectNotify":"奖品已兑换。"},"en":{"searchWinners":"Search Winners","name":"Name","leadOrContact":"Lead/Contact","roundName":"Round Name","prize":"Prize","collected":"Collected","collectedDate":"Collected Date","wonDate":"Won Date","collect":"Collect","collectModalHeader":"Collect Prize","collectModalContent":"Are you sure you want to collect this prize?","collectNotify":"The prize was collected."}}'),delete t.options._Ctor}},Tsgj:function(t,e,s){},UQyY:function(t,e,s){},V7Tw:function(t,e,s){"use strict";var a=s("NCd6");s.n(a).a},VIrk:function(t,e,s){},VK6O:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"title":"微信市场活动"},"en":{"title":"WeChat Campaigns"}}'),delete t.options._Ctor}},Vvpt:function(t,e,s){"use strict";var a=s("6CHZ");s.n(a).a},W9Ow:function(t,e,s){},WzbI:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"newStrucTitle":"新建链接图文消息","notifyContent":"图文消息保存成功。"},"en":{"newStrucTitle":"New Link Structured Message","notifyContent":"Structured message was saved."}}'),delete t.options._Ctor}},"Xn/o":function(t,e,s){"use strict";var a=s("IzIm"),i=s.n(a);e.default=i.a},Xoz7:function(t,e,s){"use strict";var a=s("ze0W"),i=s.n(a);e.default=i.a},YdbM:function(t,e,s){"use strict";var a=s("W9Ow");s.n(a).a},ZBZF:function(t,e,s){},ZUrg:function(t,e,s){},ZXNS:function(t,e,s){"use strict";var a=s("EcAN"),i=s.n(a);e.default=i.a},aF8D:function(t,e,s){"use strict";var a=s("dOfv"),i=s("UZn8"),n={mixins:[a.a],components:{SetTextLink:i.a},props:{descriptionData:{type:String,defualt:""},ueditorTitle:{type:String,default(){return this.$t("descriptionEditor")}}},mounted(){this.$on("ready",()=>{this.editorReady=!0})},data:()=>({editorReady:!1,showSetUrlBox:!1,customImageUrl:""}),watch:{descriptionData(){this.descriptionData&&this.editorReady&&this.editor.setContent(this.descriptionData)}},methods:{closeEditor(){this.$refs.SetTextLink.close(),this.$emit("close-editor")},saveEdit(){const t=this.getContent();this.$emit("update-description",t)},openSetUrlBox(){this.showSetUrlBox=!0},setCustomUrlImage(){this.editor.iframe.focus();const t='<p><img src="'.concat(this.customImageUrl,'" /></p>');this.editor.execCommand("inserthtml",t),this.closeSetImageUrlBox()},onClickInsertLink(t){this.editor.selection.getRange().select();const e=this.editor.selection.getText();this.$refs.SetTextLink.open({text:e,type:"Normal Link",el:t.currentTarget,position:"right-bottom"})},onClickTextLinkOk(t){let{text:e,url:s}=t;this.editor.iframe.focus(),this.editor.execCommand("link",{href:s,target:"_blank",textValue:e,style:"color: #006dcc; text-decoration: none;"}),this.$refs.SetTextLink.close()},closeSetImageUrlBox(){this.showSetUrlBox=!1,this.customImageUrl=""}}},o=(s("iiLD"),s("KHd+")),r=s("rxPh"),c=Object(o.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"form-description-area"},[s("div",{staticClass:"slds-modal slds-modal_large slds-fade-in-open",attrs:{"aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container form-description-container",attrs:{role:"document",tabindex:"0"}},[s("div",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close",on:{click:function(e){return t.closeEditor()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v(t._s(t.$t("global.closeBtn")))])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.ueditorTitle))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium modal-content-custom"},[s("div",{staticClass:"slds-grid slds-grid_vertical editor-toolbar"},[s("div",{staticClass:"slds-grid top-bar"},[s("div",{staticClass:"slds-grid re-undo"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onUndo()}}},[s("icon",{attrs:{name:"undo",width:"17px",height:"17px","fill-color":0!==t.toolStates.undo?"#d0d0d0":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onRedo()}}},[s("icon",{attrs:{name:"redo",width:"17px",height:"17px","fill-color":0!==t.toolStates.redo?"#d0d0d0":"#aaa","charket-icon":""}})],1)]),t._v(" "),s("a",{staticClass:"slds-grid font-size",attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openFontSizeList()}}},[s("div",{staticClass:"font-size-value"},[t._v("\n                "+t._s(t.toolValues.fontsize)+"\n              ")]),t._v(" "),s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showFontSizeList,expression:"showFontSizeList"}],staticClass:"font-size-list"},t._l(t.fontSizeList,(function(e){return s("li",{style:{fontSize:e},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.onFontsizeChange(e)}}},[t._v(t._s(e))])})),0)],1),t._v(" "),s("div",{staticClass:"slds-grid quot-dash"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onBlockquote()}}},[s("icon",{attrs:{name:"quot",width:"17px",height:"17px","fill-color":t.toolStates.blockquote?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onHorizontal()}}},[s("icon",{attrs:{name:"dash",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}})],1)]),t._v(" "),s("div",{staticClass:"slds-grid clear-or-brush"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onRemoveFormat()}}},[s("icon",{attrs:{name:"clearFormat",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onFormatmatch()}}},[s("icon",{attrs:{name:"brushFormat",width:"17px",height:"17px","fill-color":t.toolStates.formatmatch?"#5268ee":"#aaa","charket-icon":""}})],1)]),t._v(" "),s("div",{staticClass:"insert-link"},[s("span",{on:{click:function(e){return e.preventDefault(),t.onClickInsertLink(e)}}},[s("icon",{attrs:{name:"textLink",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}})],1)]),t._v(" "),s("div",{staticClass:"insert-image"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.openSetUrlBox()}}},[s("icon",{attrs:{name:"image",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),t.showSetUrlBox?s("div",{staticClass:"set-image-url"},[s("div",{staticClass:"set-image-main"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.customImageUrl,expression:"customImageUrl"}],staticClass:"slds-input",attrs:{type:"text"},domProps:{value:t.customImageUrl},on:{input:function(e){e.target.composing||(t.customImageUrl=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_align-end set-image-footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.closeSetImageUrlBox()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_neutral slds-button_brand",on:{click:function(e){return t.setCustomUrlImage()}}},[t._v(t._s(t.$t("global.confirmBtn")))])])]):t._e()])]),t._v(" "),s("div",{staticClass:"slds-grid bottom-bar"},[s("div",{staticClass:"slds-grid slds-wrap font-style"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onBold()}}},[s("icon",{attrs:{name:"bold",width:"19px",height:"19px","fill-color":t.toolStates.bold?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onItalic()}}},[s("icon",{attrs:{name:"italic",width:"19px",height:"19px","fill-color":t.toolStates.italic?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onUnderline()}}},[s("icon",{attrs:{name:"underline",width:"19px",height:"19px","fill-color":t.toolStates.underline?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),s("div",{staticClass:"slds-grid font-color"},[s("a",{staticClass:"slds-grid slds-grid_vertical",attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onFontColor(t.recentForeColor.hex)}}},[s("icon",{attrs:{name:"textColor",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("div",{staticClass:"color-bar",style:{backgroundColor:t.recentForeColor.hex}})],1),t._v(" "),s("button",{attrs:{name:"button",type:"button",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openFontColorList()}}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("color-picker",{ref:"colorList",attrs:{value:t.recentForeColor.hex?t.recentForeColor:t.defaultColor},on:{"get-color":t.onFontColor}})],1),t._v(" "),s("div",{staticClass:"slds-grid bg-color"},[s("a",{staticClass:"slds-grid slds-grid_vertical",attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onBgColor(t.recentBackColor.hex)}}},[s("icon",{attrs:{name:"text",width:"15px",height:"15px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("div",{staticClass:"color-bar",style:{backgroundColor:t.recentBackColor.hex}})],1),t._v(" "),s("button",{attrs:{name:"button",type:"button",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openBgColorList()}}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("color-picker",{ref:"bgColorList",attrs:{value:t.recentBackColor.hex?t.recentBackColor:t.defaultColor},on:{"get-color":t.onBgColor}})],1)]),t._v(" "),s("div",{staticClass:"slds-grid style-paragraph"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),t.onParagraphStyle("indent")}}},[s("icon",{attrs:{name:"textIndent",width:"17px",height:"17px","fill-color":t.toolStates.indent?"#5268ee":"#aaa","charket-icon":""}})],1),t._v(" "),t._l(t.paragraphStyle,(function(e){return s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(s){return s.preventDefault(),t.onParagraphStyle(e.value)}}},[s("icon",{attrs:{name:e.label,width:"17px",height:"17px","fill-color":t.toolValues.justify===e.value?"#5268ee":"#aaa","charket-icon":""}})],1)}))],2),t._v(" "),s("div",{staticClass:"slds-grid style-list"},[s("div",{staticClass:"ol-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openOlList()}}},[s("icon",{attrs:{name:"olList",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showOlList,expression:"showOlList"}]},t._l(t.toolOptions.orderedlist,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.setListStyle("ol",e.value)}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.insertunorderedlist===e.value,expression:"toolValues.insertunorderedlist === style.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)]),t._v(" "),s("div",{staticClass:"ul-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openUlList()}}},[s("icon",{attrs:{name:"ulList",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showUlList,expression:"showUlList"}]},t._l(t.toolOptions.unorderedlist,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.setListStyle("ul",e.value)}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.insertunorderedlist===e.value,expression:"toolValues.insertunorderedlist === style.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)])]),t._v(" "),s("div",{staticClass:"slds-grid paragraph-line-space"},[s("div",{staticClass:"line-height-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openLineHeightList()}}},[s("icon",{attrs:{name:"lineHeight",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showLineHeightList,expression:"showLineHeightList"}]},t._l(t.toolOptions.lineheight,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.onLineHeight(e.value)}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.lineheight===e.value,expression:"toolValues.lineheight === val.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)]),t._v(" "),s("div",{staticClass:"spacing-top-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openSpacingTopList()}}},[s("icon",{attrs:{name:"pMarginTop",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showSpacingTopList,expression:"showSpacingTopList"}]},t._l(t.toolOptions.rowspacing,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.onRowSpacing(e.value,"top")}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.rowspacingtop===e.value,expression:"toolValues.rowspacingtop === val.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)]),t._v(" "),s("div",{staticClass:"spacing-bottom-list"},[s("a",{attrs:{href:"#",tabindex:"-1"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openSpacingBottomList()}}},[s("icon",{attrs:{name:"pMarginBottom",width:"17px",height:"17px","fill-color":"#aaa","charket-icon":""}}),t._v(" "),s("button",{attrs:{type:"button",name:"button",tabindex:"-1"}},[s("icon",{attrs:{name:"down",width:"8px",height:"8px","fill-color":"#aaa","charket-icon":""}})],1)],1),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.showSpacingBottomList,expression:"showSpacingBottomList"}]},t._l(t.toolOptions.rowspacing,(function(e){return s("li",{staticClass:"slds-grid check-list",on:{click:function(s){return t.onRowSpacing(e.value,"bottom")}}},[s("div",{staticClass:"list-icon"},[s("icon",{directives:[{name:"show",rawName:"v-show",value:t.toolValues.rowspacingbottom===e.value,expression:"toolValues.rowspacingbottom === val.value"}],attrs:{name:"check",width:"14px",height:"14px","fill-color":"#aaa","charket-icon":""}})],1),t._v(" "),s("a",{staticClass:"slds-col",attrs:{href:"#",tabindex:"-1"},on:{click:function(t){t.preventDefault()}}},[t._v(t._s(e.label))])])})),0)])])])]),t._v(" "),s("div",{staticClass:"editor-container"},[s("div",{ref:"editor"})])]),t._v(" "),s("div",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.closeEditor()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),t._t("negative",[s("button",{staticClass:"slds-button slds-button_neutral slds-button_brand",on:{click:function(e){return t.saveEdit()}}},[t._v(t._s(t.$t("global.confirmBtn")))])])],2)])]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open"}),t._v(" "),s("set-text-link",{ref:"SetTextLink",on:{ok:t.onClickTextLinkOk}})],1)}),[],!1,null,"2ca67452",null);"function"==typeof r.default&&Object(r.default)(c);e.a=c.exports},auqV:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"selectNotificationTemplateLabel":"选择模板消息","urlLabel":"跳转链接","titleLabel":"标题","createdLabel":"创建人","keywordLabel":"关键字","noteLabel":"备注"},"en":{"selectNotificationTemplateLabel":"Select Notification Template","urlLabel":"Notification URL","titleLabel":"Title","createdLabel":"Created By","keywordLabel":"Keywords","noteLabel":"Note"}}'),delete t.options._Ctor}},bve2:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"registerLabel":"注册流程","registerSuccessLabel":"注册流程已保存。","checkInLabel":"签到流程","checkInSuccessLabel":"签到流程已保存。","luckyDrawLabel":"幸运抽奖","luckyDrawSuccessLabel":"幸运抽奖流程已保存。","BUILDER":"构建","WINNERS":"中奖名单","test":"测试","start":"开始"},"en":{"registerLabel":"Registration","registerSuccessLabel":"The Registration Step was saved.","checkInLabel":"Check-in","checkInSuccessLabel":"The Check-in Step was saved.","luckyDrawLabel":"Lucky Draw","luckyDrawSuccessLabel":"The Lucky Draw Step was saved.","BUILDER":"BUILDER","WINNERS":"WINNERS","test":"Test","start":"Start"}}'),delete t.options._Ctor}},bwDH:function(t,e,s){"use strict";var a=s("naGm");s.n(a).a},cMbL:function(t,e,s){"use strict";var a=s("mPj3");s.n(a).a},cuvP:function(t,e,s){"use strict";var a=s("9177");s.n(a).a},dOfv:function(t,e,s){"use strict";var a=s("rZkV"),i=s.n(a),n=s("+Bun"),o=s.n(n),r=s("ejTr"),c=s.n(r),l=s("autp"),d=s.n(l),h=s("vkTm");e.a={components:{ColorPicker:h.a},mounted(){this.$nextTick(()=>{this.$refs.editor.id=this.id,this.editor=this.UE.getEditor(this.id,this.config),this.editor.ready(()=>{this.bindContentChange(),this.bindSelectionChange(),this.bindPaste(),this.bindFocusBlur(),this.editor.setContent(this.$t("defaultContent")),this.$emit("ready")})})},data(){return{id:"charket_editor"+Math.random(10),UE:window.UE||null,showFontSizeList:!1,showOlList:!1,showUlList:!1,showLineHeightList:!1,showSpacingTopList:!1,showSpacingBottomList:!1,editor:null,recentForeColor:{hex:null},recentBackColor:{hex:null},defaultColor:{hex:"#194d33"},fontSizeList:["12px","14px","15px","16px","18px","20px","24px"],paragraphStyle:[{label:"alignLeft",value:"left"},{label:"alignCenter",value:"center"},{label:"alignRight",value:"right"}],toolStates:{undo:-1,redo:-1,blockquote:0,horizontal:0,removeformat:0,formatmatch:0,bold:0,italic:0,underline:0,indent:0},toolValues:{fontsize:"16px",forecolor:"#ffffff",backcolor:"#ffffff",justify:"",imagefloat:"",lineheight:"",rowspacing:"",rowspacingtop:"",rowspacingbottom:"",insertorderedlist:"",insertunorderedlist:""},toolOptions:{rowspacing:[{label:"5",value:"5"},{label:"10",value:"10"},{label:"15",value:"15"},{label:"20",value:"20"},{label:"25",value:"25"}],lineheight:[{label:"1",value:"1"},{label:"1.5",value:"1.5"},{label:"1.75",value:"1.75"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"5",value:"5"}],orderedlist:[{label:"1,2,3...",value:"decimal"},{label:"a,b,c...",value:"lower-alpha"},{label:"i,ii,iii...",value:"lower-roman"},{label:"A,B,C...",value:"upper-alpha"},{label:"Ⅰ,Ⅱ,Ⅲ...",value:"upper-roman"}],unorderedlist:[{label:"○ "+this.$t("global.ueditor.circle"),value:"circle"},{label:"● "+this.$t("global.ueditor.disc"),value:"disc"},{label:"■ "+this.$t("global.ueditor.square"),value:"square"}]},listVisible:!0,toolbarMaskVisible:!1,imagefloatvisible:!1,config:{toolbars:[[]],enableAutoSave:!1,initialFrameWidth:null,initialFrameHeight:400,autoHeightEnabled:!0,imagePopup:!1,imageScaleEnabled:!1}}},methods:{closeAllList(){this.showFontSizeList=!1,this.showOlList=!1,this.showUlList=!1,this.showLineHeightList=!1,this.showSpacingTopList=!1,this.showSpacingBottomList=!1,this.$refs.colorList.close(),this.$refs.bgColorList.close()},openFontColorList(){this.closeAllList(),this.$refs.colorList.open()},openBgColorList(){this.closeAllList(),this.$refs.bgColorList.open()},openFontSizeList(){this.closeAllList(),this.showFontSizeList=!this.showFontSizeList;const t=()=>{this.showFontSizeList=!1,window.removeEventListener("click",t)};d()(()=>{window.addEventListener("click",t)},100)},openOlList(t){this.closeAllList(),this.showOlList=!this.showOlList;const e=()=>{this.showOlList=!1,window.removeEventListener("click",e)};d()(()=>{window.addEventListener("click",e)},200)},openUlList(){this.closeAllList(),this.showUlList=!this.showUlList;const t=()=>{this.showUlList=!1,window.removeEventListener("click",t)};d()(()=>{window.addEventListener("click",t)},200)},openLineHeightList(){this.closeAllList(),this.showLineHeightList=!0;const t=()=>{this.showLineHeightList=!1,window.removeEventListener("click",t)};d()(()=>{window.addEventListener("click",t)},200)},openSpacingTopList(){this.closeAllList(),this.showSpacingTopList=!0;const t=()=>{this.showSpacingTopList=!1,window.removeEventListener("click",t)};d()(()=>{window.addEventListener("click",t)},200)},openSpacingBottomList(){this.closeAllList(),this.showSpacingBottomList=!0;const t=()=>{this.showSpacingBottomList=!1,window.removeEventListener("click",t)};d()(()=>{window.addEventListener("click",t)},200)},bindContentChange(){this.editor.addListener("contentChange",()=>{this.$emit("onchange",this.getContent())})},bindSelectionChange(){this.editor.addListener("selectionchange",()=>{const t=c()(this.toolStates),e=c()(this.toolValues),s=t.length,a=e.length;for(let e=0;e<s;e++)this.toolStates[t[e]]=this.editor.queryCommandState(t[e]);for(let t=0;t<a;t++){var i;o()(i=e[t]).call(i,"rowspacing")>-1?this.toolValues[e[t]]=this.editor.queryCommandValue("rowspacing",e[t].replace("rowspacing","")):this.toolValues[e[t]]=this.editor.queryCommandValue(e[t])+""}const n=this.editor.selection.getRange().getClosedNode();n&&"IMG"===n.tagName?this.imagefloatvisible=!0:this.imagefloatvisible=!1})},bindPaste(){this.editor.addListener("beforepaste",(t,e)=>{const s=document.createElement("div");s.innerHTML=e.html;let a=null,n=0;a=(t=>{const e={};const s=t=>{if(t.childNodes.length>0)for(const a of t.childNodes)if("IMG"===a.nodeName)a.src&&(a.id="transUrl"+n,n++,e[a.id]=a.src);else if(1===a.nodeType){if(a.style.backgroundImage){a.id="transUrl"+n,n++;let t=a.style.backgroundImage;e[a.id]=i()(t).call(t,5,-2)}s(a)}};return s(t),e})(s),this.replaceImgUrl(a),e.html=s.innerHTML})},replaceImgUrl(t){},bindFocusBlur(){this.editor.addListener("focus",()=>{this.$emit("editorFocus"),this.closeAllList(),this.toolbarMaskVisible=!1,this.listVisible=!1;const t=this.editor.getContent();o()(t).call(t,'id="initContent"')>-1&&(this.editor.execCommand("cleardoc"),this.editor.reset())}),this.editor.addListener("blur",()=>{this.listVisible=!0,d()(()=>{var t;const e=this.editor.hasContents(["span","strong","hr","ul","ol","blockquote","em"]),s=o()(t=this.editor.body.innerHTML).call(t,'style="')>-1;e||s||this.editor.setContent(this.$t("defaultContent"))},100)})},onUndo(){this.editor.execCommand("undo")},onRedo(){this.editor.execCommand("redo")},onFontsize(t){this.checkPlaceHolder(),this.editor.execCommand("fontsize",t),this.showFontSizeList=!1},onBlockquote(){this.checkPlaceHolder(),this.editor.execCommand("blockquote")},onHorizontal(){this.checkPlaceHolder(),this.editor.execCommand("horizontal")},onRemoveFormat(){this.editor.execCommand("removeformat"),this.editor.iframe.focus()},onFormatmatch(){this.checkPlaceHolder(),this.editor.execCommand("formatmatch")},onBold(){this.checkPlaceHolder(),this.editor.execCommand("bold")},onItalic(){this.checkPlaceHolder(),this.editor.execCommand("italic")},onUnderline(){this.checkPlaceHolder(),this.editor.execCommand("underline")},onIndent(){this.checkPlaceHolder(),this.editor.execCommand("indent"),this.editor.iframe.focus()},onJustify(t){this.checkPlaceHolder(),this.editor.execCommand("justify",t),this.editor.iframe.focus()},onLineHeight(t){this.checkPlaceHolder(),this.editor.execCommand("lineheight",t),this.editor.iframe.focus()},onRowSpacing(t,e){this.checkPlaceHolder(),this.editor.execCommand("rowspacing",t,e),this.editor.iframe.focus()},onMaskShow(){this.toolbarMaskVisible=!0},onFontsizeChange(t){this.checkPlaceHolder(),this.toolValues.fontsize=t,this.showFontSizeList=!1,this.onFontsize(t),this.$refs.editor.focus()},onFontColor(t){this.checkPlaceHolder(),t&&("none"===t?this.editor.execCommand("removeformat","span","color"):(this.editor.execCommand("forecolor",t),this.recentForeColor={hex:t},this.editor.iframe.focus()))},onBgColor(t){this.checkPlaceHolder(),t&&("none"===t?this.editor.execCommand("removeformat","span","background-color"):(this.editor.execCommand("backcolor",t),this.recentBackColor={hex:t},this.editor.iframe.focus()))},onRemoveFormatColor(t,e,s){this.editor.execCommand("removeformat",e)},onParagraphStyle(t){this.checkPlaceHolder(),"indent"===t?this.editor.execCommand("indent"):(this.editor.execCommand("justify",t),this.toolValues.justify=t)},setListStyle(t,e){this.checkPlaceHolder(),this.editor.execCommand("insertunorderedlist",e),this.editor.iframe.focus()},onImageFloat(t){this.imagefloatvisible&&(this.editor.execCommand("imagefloat",t),this.toolValues.imagefloat=t)},inputImage(t){this.editor.iframe.focus();const e='<p><img src="'.concat(t,'" /></p>');this.editor.execCommand("inserthtml",e)},getImages(){this.$emit("getImages")},updateContent(t){t?this.editor.setContent(t):(this.editor.reset(),this.editor.setContent(this.$t("defaultContent")))},checkPlaceHolder(){var t;o()(t=this.editor.body.innerHTML).call(t,'id="initContent"')>-1&&this.editor.execCommand("cleardoc")},getContent(){return this.editor.getContent(()=>{var t;return!(o()(t=this.editor.body.innerHTML).call(t,'id="initContent"')>-1||!this.editor.hasContents(["span","strong","hr","ul","ol","blockquote","em"]))})}}}},eAJ0:function(t,e,s){"use strict";var a=s("ivHz");s.n(a).a},enNt:function(t,e,s){},"f/VK":function(t,e,s){},f9CC:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"titleLabel":"标题","bgImgLabel":"背景图片","uploadBtn":"上传","imgType":"JPG 或者 PNG","imgSize":"1920 X 1080像素","qrcodeLabel":"二维码","qrNameLabel":"二维码名称","typeLabel":"类型","expireLabel":"过期时间","qrcodeInfo":"二维码将显示在幸运抽奖页面中。","campaignStatusLabel":"市场活动成员状态","statusInfo":"中奖的市场活动成员将被设为当前状态。","noneLabel":"--无--","showNumLabel":"显示参加人数","showNameLabel":"显示潜在客户/联系人姓名"},"en":{"titleLabel":"Title","bgImgLabel":"Background Image","uploadBtn":"Upload","imgType":"JPG or PNG","imgSize":"1920 by 1080 pixels","qrcodeLabel":"QR Code | QR Codes","qrNameLabel":"QR Code Name","typeLabel":"Type","expireLabel":"Expiration Date","qrcodeInfo":"This QR Code will be shown in the lucky draw page.","campaignStatusLabel":"Campaign Member Status","statusInfo":"Status for lucky draw winners.","noneLabel":"--None--","showNumLabel":"Show number of participants","showNameLabel":"Show lead/contact name"}}'),delete t.options._Ctor}},fGFX:function(t,e,s){},fOvr:function(t,e,s){"use strict";var a=s("OWFR"),i=s.n(a);e.default=i.a},fb3H:function(t,e,s){"use strict";var a=s("w2Vt"),i=s("zUtI"),n=s("4B+h"),o=s("LQ5e"),r=s.n(o),c={props:{accountId:String,default:()=>""},components:{LoadingSpinner:a.a},data:()=>({notifies:[],isNotifyLoading:!1,selectedNotify:{}}),created(){this.isNotifyLoading=!0,this.fetchNotifies()},methods:{async fetchNotifies(){try{const t=await Object(i.g)(this.accountId||this.$route.params.accountId);if(t.ok){this.isNotifyLoading=!1,this.notifies=JSON.parse(r.a.unescape(t.data));for(let t of this.notifies)this.$set(t,"type","example"),this.$set(t,"isSelectedShow",!1);this.$nextTick((function(){this.renderGrid()}))}else this.isNotifyLoading=!1,Object(n.f)(t)}catch(t){Object(n.f)(t)}},closeNotify(){this.$emit("close")},renderGrid(){const t=document.getElementsByClassName("template-item");let e,s,a=0;for(let i=0;i<t.length;i++)i>0&&(t[i-3]&&(e=t[i-3].offsetTop+t[i-3].offsetHeight+20,t[i].style.top=e+"px"),i%3>0&&(s=t[i-1].offsetLeft+t[i-1].offsetWidth+20,t[i].style.left=s+"px")),a=Math.max(a,t[i].offsetTop+t[i].offsetHeight+60);const i=document.getElementsByClassName("template-content")[0];i&&(i.style.height=a-35+"px");for(let e=0;e<t.length;e++)t[e].style.height=t[e].offsetHeight+10+"px"},selectNotify(t,e){e.isSelectedShow=!e.isSelectedShow;for(let t of this.notifies)t.TemplateId!==e.TemplateId&&(t.isSelectedShow=!1);this.selectedNotify=e.isSelectedShow?e:{}},switchTemplate(t,e){t.type=e},goToWeChatPlatform(){this.$emit("close"),window.open("https://mp.weixin.qq.com")},next(){this.$emit("next",this.selectedNotify)}}},l=(s("vyV3"),s("KHd+")),d=s("HaPu"),h=Object(l.a)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{attrs:{id:"wechat-notification-list"}},[s("div",{staticClass:"slds-modal slds-modal_large slds-fade-in-open",attrs:{"aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container container-width",attrs:{role:"document",tabindex:"0"}},[s("div",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close",on:{click:function(e){return t.closeNotify()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.$t("selectNotificationTemplateLabel")))])]),t._v(" "),t.isNotifyLoading?t._e():s("div",{staticClass:"slds-modal__content"},[s("div",{staticClass:"template-content"},[s("ul",{staticClass:"select-template-list"},[t._l(t.notifies,(function(e){return s("li",{staticClass:"slds-box template-item",on:{click:function(s){return s.stopPropagation(),t.selectNotify(s,e)}}},[s("div",{staticClass:"template-container"},[s("div",{staticClass:"slds-grid template-section"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"example"===e.type&&e.Example,expression:"notify.type === 'example' && notify.Example"}]},[s("span",{staticClass:"slds-text-heading_small title"},[t._v(t._s(e.Title))]),t._v(" "),s("pre",{staticClass:"slds-text-body_regular content"},[t._v(t._s(e.Example))])]),t._v(" "),s("div",[s("span",{staticClass:"slds-text-heading_small title"},[t._v(t._s(e.Title))]),t._v(" "),s("pre",{staticClass:"slds-text-body_regular content"},[t._v(t._s(e.Content))])])])]),t._v(" "),s("div",{staticClass:"switch-section"},[s("p",{directives:[{name:"show",rawName:"v-show",value:e.Example,expression:"notify.Example"}],staticClass:"left",class:{selected:"example"===e.type},on:{click:function(s){return s.stopPropagation(),t.switchTemplate(e,"example")}}}),t._v(" "),s("p",{class:{selected:"content"===e.type||!e.Example},on:{click:function(s){return s.stopPropagation(),t.switchTemplate(e,"content")}}})]),t._v(" "),e.isSelectedShow?s("div",{staticClass:"selected-notify"},[s("div",{staticClass:"selected-bg"}),t._v(" "),s("div",{staticClass:"selected-icon"},[s("icon",{attrs:{name:"check","fill-color":"white",width:"48px",height:"48px"}})],1)]):t._e()])})),t._v(" "),s("li",{staticClass:"slds-box template-item default"},[s("span",{staticClass:"default-icon down-btn",on:{click:function(e){return t.goToWeChatPlatform()}}},[s("icon",{attrs:{name:"add","class-name":"down-icon",width:"32px",height:"32px"}})],1),t._v(" "),s("p",{staticClass:"default-value"},[t._v(t._s(t.$t("newTemplateLabel")))])])],2)])]),t._v(" "),s("loading-spinner",{attrs:{"is-loading":t.isNotifyLoading,"custom-style":"position: relative;padding: 40px;background-color: white"}}),t._v(" "),s("div",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",on:{click:function(e){return t.closeNotify()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:!t.selectedNotify.TemplateId},on:{click:function(e){return t.next()}}},[t._v(t._s(t.$t("global.nextBtn")))])])],1)]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open"})])])}),[],!1,null,"1a576594",null);"function"==typeof d.default&&Object(d.default)(h);e.a=h.exports},ffUB:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"titleLabel":"编辑二维码","nameLabel":"名称","tagLabel":"微信关注者标签","overwriteTagLabel":"覆盖现有的关注者的标签","scanLabel":"扫描后的响应","saveQrcodeLabel":"二维码保存成功！"},"en":{"titleLabel":"Edit QR Code","nameLabel":"Name","tagLabel":"WeChat Follower Tags","overwriteTagLabel":"Overwrite existing followers’ tag(s)","scanLabel":"Scan Response","saveQrcodeLabel":"The WeChat QR code was saved."}}'),delete t.options._Ctor}},frfo:function(t,e,s){"use strict";var a=s("N3N8"),i=s.n(a);e.default=i.a},g6H1:function(t,e,s){"use strict";var a=s("vQrK"),i=s.n(a),n=s("XmpP"),o=s("HnSg"),r=s("YjsE"),c=s("NAIw"),l=s("ZKhp"),d=s("Y/WH"),h=s("xEMq"),u=s("4B+h"),p=s("CjVY"),m=s.n(p),g=s("cybb"),f=s("L2JU"),v=s("LsMU"),w={props:{currentType:{type:String,default:""},messages:{type:Array,default:()=>[]},hideTextBorder:{type:Boolean,default:!1},modalLeft:{type:Boolean,default:!1},pageName:{type:String,default:""}},mixins:[n.a],inject:["showErrorImg"],components:{LimitedTextarea:o.a,StruMessageDetail:r.a,VideoDetailCard:c.VideoDetailCard,VoiceDetailCard:l.VoiceDetailCard,MiniProgramDetail:d.a,SkillDetailCard:v.SkillDetailCard},computed:i()({},Object(f.c)({currentUser:"user/currentUser"})),watch:{messages(){"text"===this.currentType&&this.messages.length>0&&(this.textContent=this.messages[0].content?this.messages[0].content:this.messages[0].textBody)}},data:()=>({showEditTextPopup:!1,canSaveTextMsg:!0,textContent:"",canSave:!1,textLimit:2e3}),created(){"text"===this.currentType&&this.messages.length>0&&(this.textContent=this.messages[0].content||this.messages[0].textBody)},methods:{getDisplayedDatetime(t){return Object(g.e)(t,this.currentUser.TimeZoneSidKey)},decorateTextMessage:t=>m.a.decorateText(t),editText(){this.showEditTextPopup=!0},closeEditText(){this.showEditTextPopup=!1,this.showSetLink=!1,this.textContent=this.messages[0].content||this.messages[0].textBody},async saveText(){if(this.messages[0].id){this.canSaveTextMsg=!1;try{const t=await Object(h.k)(this.textContent,this.messages[0].id);this.canSaveTextMsg=!0,t.ok?(this.$emit("update",this.textContent),this.showEditTextPopup=!1,this.$router.app.$emit("open-toast-notification",{content:this.$t("notifyContent"),type:"success"})):Object(u.f)(t)}catch(t){this.canSaveTextMsg=!0,Object(u.f)(t)}}else this.showEditTextPopup=!1,this.$emit("update",this.textContent)},onLimitedTextareaChange(t){let{content:e,size:s}=t;this.textContent=e,this.canSave=!(0===s||s>this.textLimit)},selectMergeField(t){this.textContent=this.textContent+t,this.$root.$emit("merge-field-value",this.textContent),this.closeMergeField()}}},b=(s("hN3G"),s("KHd+")),C=s("NflP"),_=Object(b.a)(w,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"charket-message-detail"}},["structureMessage"===t.currentType?s("div",{staticClass:"select-news-wrapper"},[s("stru-message-detail",{attrs:{"structure-message":t.messages[0]}})],1):t._e(),t._v(" "),"video"===t.currentType?s("div",{staticClass:"select-video-wrapper"},[s("video-detail-card",{attrs:{title:t.messages[0].name,date:t.getDisplayedDatetime(t.messages[0].updateDateTime),description:t.messages[0].description}})],1):t._e(),t._v(" "),"voice"===t.currentType&&t.messages[0]?s("div",{staticClass:"select-video-wrapper"},[s("voice-detail-card",{attrs:{title:t.messages[0].name,image:t.messages[0].imageIcon,date:t._f("formatDatetimeFilter")(t.messages[0].updateDateTime,t.$user.TimeZoneSidKey)}})],1):t._e(),t._v(" "),"image"===t.currentType&&t.messages[0]?s("div",[s("img",{staticClass:"select-image-url",attrs:{src:t._f("imgFilter")(t.messages[0].url)},on:{error:function(e){return t.showErrorImg(e)}}})]):t._e(),t._v(" "),"text"===t.currentType&&t.messages.length>0?s("div",{staticClass:"text-mes-content",class:{"text-no-border":t.hideTextBorder}},[s("pre",{staticClass:"text-pre text-body",domProps:{innerHTML:t._s(t.decorateTextMessage(t.textContent))}}),t._v(" "),t.hideTextBorder?t._e():s("span",{staticClass:"text-edit-icon down-btn",on:{click:function(e){return t.editText()}}},[s("icon",{attrs:{name:"editReplyIcon","class-name":"down-icon",width:"16px",height:"16px"}})],1)]):t._e(),t._v(" "),t.messages.length>0&&("coupon"===t.currentType||"pass"===t.currentType)?s("div",{staticClass:"slds-box slds-grid coupon-block"},[s("div",{staticClass:"logo-content"},[s("div",{staticClass:"coupon-logo",style:{"background-image":"url("+t.messages[0].logoUrl+")"}})]),t._v(" "),s("div",{staticClass:"slds-grid slds-grid_vertical slds-truncate"},[s("div",{staticClass:"slds-truncate slds-text-heading_small coupon-name",attrs:{title:t.messages[0].name}},[t._v(t._s(t.messages[0].name))]),t._v(" "),"coupon"===t.currentType?s("div",{staticClass:"slds-truncate coupon-type"},[t._v(t._s(t.messages[0].type))]):t._e(),t._v(" "),"pass"===t.currentType?s("div",{staticClass:"slds-truncate coupon-type"},[t._v(t._s(t.messages[0].brandName))]):t._e()])]):t._e(),t._v(" "),t.messages.length>0&&"skill"===t.currentType?s("skill-detail-card",{attrs:{name:t.messages[0].name,outlined:!t.hideTextBorder,internal:t.messages[0].isInternal}}):t._e(),t._v(" "),"miniProgramPage"===t.currentType?s("div",{staticClass:"select-mini-program-page-wrapper"},[s("mini-program-detail",{attrs:{miniProgramPage:t.messages[0]}})],1):t._e(),t._v(" "),t.showEditTextPopup?s("div",[s("div",{staticClass:"slds-modal slds-modal_large slds-fade-in-open",attrs:{"aria-hidden":"false",role:"dialog"}},[s("div",{staticClass:"slds-modal__container show-selected-container new-width",class:{"modal-left":t.modalLeft},attrs:{role:"document",tabindex:"0"}},[s("div",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon-inverse slds-modal__close",on:{click:function(e){return t.closeEditText()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium"},[t._v(t._s(t.$t("editTextTitle")))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium new-height"},[s("limited-textarea",{attrs:{content:t.textContent,sum:t.textLimit,"double-modal":t.modalLeft,"show-merge-field":!!t.pageName},on:{change:t.onLimitedTextareaChange,"open-field":t.openMergeField}})],1),t._v(" "),s("div",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:!t.canSaveTextMsg},on:{click:function(e){return t.closeEditText()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:!t.canSaveTextMsg||!t.canSave},on:{click:function(e){return t.saveText()}}},[t._v(t._s(t.$t("global.saveBtn")))])])])]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open"})]):t._e()],1)}),[],!1,null,"6eef78ba",null);"function"==typeof C.default&&Object(C.default)(_);e.a=_.exports},h3Rw:function(t,e,s){"use strict";var a=s("+XWK"),i=s.n(a);e.default=i.a},hG8I:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"newTextMessage":"新建文本消息","textMessages":"文本消息","designer":{"linkIcon":"添加链接","miniProgramIcon":"添加小程序链接","actionIcon":"添加动作","mergeFieldIcon":"插入合并字段","changeBtn":"更改","removeBtn":"删除","linkUrl":"链接网址","illegalUrl":"不合法的网址","appId":"App ID","pagePath":"页面路径","name":"名称","value":"值","selectAField":"选择一个字段","fieldTitle":"你已选择以下字段","findObjectPlaceholder":"查找对象...","labelFilterPlaceholder":"键入以过滤列表...","type":"类型","apiName":"API名","currentSelection":"当前选择","noMatchesFound":"没有发现匹配项"}},"en":{"newTextMessage":"New Text Message","textMessages":"Text Messages","designer":{"linkIcon":"Add link","miniProgramIcon":"Add mini program link","actionIcon":"Add action","mergeFieldIcon":"Insert merge field","changeBtn":"Change","removeBtn":"Remove","linkUrl":"Link URL","illegalUrl":"Invalid URL","appId":"App ID","pagePath":"Page Path","name":"Name","value":"Value","selectAField":"Select A Field","fieldTitle":"You have selected the following field","findObjectPlaceholder":"Find An Object...","labelFilterPlaceholder":"Type here to filter the list...","type":"Type","apiName":"API Name","currentSelection":"Current Selection","noMatchesFound":"No matches found"}}}'),delete t.options._Ctor}},hN3G:function(t,e,s){"use strict";var a=s("hNF5");s.n(a).a},hNF5:function(t,e,s){},hkfk:function(t,e,s){"use strict";var a=s("fGFX");s.n(a).a},iiLD:function(t,e,s){"use strict";var a=s("3zWd");s.n(a).a},ivHz:function(t,e,s){},jGbS:function(t,e,s){"use strict";var a=s("WzbI"),i=s.n(a);e.default=i.a},jhb7:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"prizeTitle":"添加奖品","roundName":"奖项名称","prizeName":"奖品名称","quantity":"数量","notifyTemplate":"通知模板","memberStatus":"市场活动成员状态","change":"更改","template":"模板消息","title":"标题","keywords":"关键字","notificationUrl":"跳转链接","note":"备注","createdBy":"创建人","selectTemplateLabel":"选择模板","saveNotify":"奖品已保存。","cropPhoto":"裁剪奖品图片","prizeNameHolder":"例如：iPad","roundNameHolder":"例如：一等奖"},"en":{"prizeTitle":"Add Prize","roundName":"Round Name","prizeName":"Prize Name","quantity":"Quantity","notifyTemplate":"Notification Template","memberStatus":"Qualified Campaign Member Statuses","change":"Change","template":"template | Templates","title":"TITLE","keywords":"KEYWORDS","notificationUrl":"NOTIFICATION URL","note":"NOTE","createdBy":"CREATED BY","selectTemplateLabel":"Select Template","saveNotify":"The prize was saved.","cropPhoto":"Crop Prize Picture","prizeNameHolder":"e.g. iPad","roundNameHolder":"e.g. First Prize"}}'),delete t.options._Ctor}},jlPk:function(t,e,s){"use strict";var a=s("vjcd"),i=s.n(a);e.default=i.a},"k/9o":function(t,e,s){"use strict";var a=s("qVZU"),i=s.n(a);e.default=i.a},kmVQ:function(t,e,s){},lNHh:function(t,e,s){"use strict";var a=s("svHN"),i=s.n(a);e.default=i.a},"m+vl":function(t,e,s){},"m5/F":function(t,e,s){},mPj3:function(t,e,s){},miT4:function(t,e,s){"use strict";var a=s("r1bT"),i=s.n(a);e.default=i.a},miio:function(t,e,s){"use strict";s.d(e,"g",(function(){return i})),s.d(e,"h",(function(){return n})),s.d(e,"a",(function(){return o})),s.d(e,"b",(function(){return r})),s.d(e,"d",(function(){return c})),s.d(e,"k",(function(){return l})),s.d(e,"i",(function(){return d})),s.d(e,"f",(function(){return h})),s.d(e,"j",(function(){return u})),s.d(e,"l",(function(){return p})),s.d(e,"e",(function(){return m})),s.d(e,"c",(function(){return g}));s("Yvyk");var a=s("00Ee");function i(t,e,s){return Object(a.a)({method:"FormRemoteActions.getForms",args:[t,e,s]})}function n(){return Object(a.a)({method:"FormRemoteActions.getObjects",args:[]})}function o(t){return Object(a.a)({method:"FormRemoteActions.createForm",args:[t]})}function r(t){return Object(a.a)({method:"FormRemoteActions.deleteForm",args:[t]})}function c(t){return Object(a.a)({method:"FormRemoteActions.getForm",args:[t]})}function l(t,e){return Object(a.a)({method:"FormRemoteActions.updateForm",args:[t,e]})}function d(t,e){return Object(a.a)({method:"FormRemoteActions.setStatus",args:[t,e]})}function h(t){return Object(a.a)({method:"FormRemoteActions.getFormUrl",args:[t]})}function u(t,e){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(a.a)({method:"FormRemoteActions.setSettings",args:[t,e,s]})}function p(t,e){return Object(a.a)({method:"FormRemoteActions.updateFormBasicInfo",args:[t,e]})}function m(){return Object(a.a)({method:"FormRemoteActions.getFormStatus",args:[]})}function g(t,e){return Object(a.a)({method:"FormRemoteActions.editFormName",args:[t,e]})}},mw6U:function(t,e,s){"use strict";var a=s("QvEr");s.n(a).a},n1Yi:function(t,e,s){"use strict";var a=s("auqV"),i=s.n(a);e.default=i.a},nCab:function(t,e,s){},nOmU:function(t,e,s){"use strict";var a=s("yWOo");s.n(a).a},"nWn+":function(t,e,s){"use strict";var a=s("m+vl");s.n(a).a},naGm:function(t,e,s){},ngDp:function(t,e,s){"use strict";var a=s("T/be"),i=s.n(a);e.default=i.a},o86H:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"statusDefaultValue":"状态","accountDefaultValue":"微信公众号","searchLabel":"搜索微信市场活动","actionEdit":"编辑","actionDelete":"删除","actionDeactivate":"禁用","actionActivate":"启用","actionDeactivateContent":"你确定要禁用","actionActivateContent":"你确定要启用","deactivateSuccessLabel":"{0}步骤已禁用。","activateSuccessLabel":"{0}步骤已启用。","actionDeleteTitle":"删除微信市场活动","actionDeleteContent":"你确定要删除这个微信市场活动吗?","deleteSuccessLabel":"市场活动已删除。","actionStep":"步骤","memberLabel":"成员","itemLabel":"项目","modifiedLabel":"上次修改人","orderFirstLabel":"最近创建日期","orderSecondLabel":"最早创建日期","filteredByLabel":"过滤条件","weChatAccLabel":"微信公众号"},"en":{"statusDefaultValue":"Status","accountDefaultValue":"WeChat Account","searchLabel":"Search WeChat Campaigns","actionEdit":"Edit","actionDelete":"Delete","actionDeactivate":"Deactivate ","actionActivate":"Activate ","actionDeactivateContent":"Are you sure you want to deactivate this ","actionActivateContent":"Are you sure you want to activate this ","deactivateSuccessLabel":"{0} Step was deactivated.","activateSuccessLabel":"{0} Step was activated.","actionDeleteTitle":"Delete WeChat Campaign","actionDeleteContent":"Are you sure you want to delete this WeChat Campaign?","deleteSuccessLabel":"The WeChat campaign was deleted.","actionStep":" Step","memberLabel":"Member | Members","itemLabel":"item | items","modifiedLabel":"Last modified by","orderFirstLabel":"Last Created Date","orderSecondLabel":"First Created Date","filteredByLabel":"Filtered By","weChatAccLabel":"WeChat Account"}}'),delete t.options._Ctor}},pUDi:function(t,e,s){"use strict";var a=s("SLhn"),i=s.n(a),n=s("3O4B"),o=s.n(n),r=s("WE60"),c=s.n(r),l=s("wG3i"),d=s.n(l),h=s("Ip10"),u=s.n(h),p=s("+Bun"),m=s.n(p),g=s("0G99"),f=s.n(g),v=s("vQrK"),w=s.n(v),b=s("mdEO"),C=s("TDue"),_=s("vkTm"),y=s("ngIk"),k=s("dcdS"),x=s("oWfJ"),S=s("L2JU"),I={components:{SelectField:C.a,ColorPicker:_.a,InputSelect:y.a,Dropdown:k.a,PhoneFrameCard:b.PhoneFrameCard},mixins:[x.a],props:{notify:{type:Object,default:()=>({contentTemplate:{keywords:[]}})},selectedMiniProgram:{type:Object,default:function(){return{}}},wechatAccountId:{type:String,default:()=>""}},data(){return{colorPickerPosition:"",newNotify:{},notifyColor:{first:"#000000",keywords:[],remark:"#000000"},colorType:"",mergeFieldType:"",keywords:[],notificationURL:"",note:"",showMergeField:!1,notifyFirst:"",notifyRemark:"",showFirst:"",showRemark:"",fieldObj:{},redirectOptionData:{options:[{Name:this.$t("urlLabel"),Value:"URL"},{Name:this.$t("global.miniProgramLabel"),Value:"Mini Program Page"}],currents:[{Name:this.$t("urlLabel"),Value:"URL"}]},selectedMiniProgramPage:{}}},computed:w()({},Object(S.c)({currentAccount:"sidebar/currentAccount"}),{isRedirectToURL(){return"URL"===this.redirectOptionData.currents[0].Value},isShowDetail(){return this.notificationURL||this.selectedMiniProgramPage.messageId}}),created(){this.newNotify=this.notify,this.notificationURL=this.newNotify.NotificationURL||"";let t=this.newNotify.Content.split(/{{.*?}}/gm),e=this.newNotify.Content.match(/{{.*?}}/gm),s=[];if(f()(t).call(t,(t,a)=>{s.push({name:t,value:e[a],key:e[a],color:"#000000"})}),this.$set(this.newNotify,"contentTemplate",s),this.notify.Id){var a,i;this.fieldObj=this.newNotify.mergeFieldObject;let t=u()(a=this.newNotify.contentTemplate).call(a,t=>{var e;return t.key&&0===m()(e=t.key).call(e,"{{first.")}),s=u()(i=this.newNotify.contentTemplate).call(i,t=>{var e;return t.key&&0===m()(e=t.key).call(e,"{{remark.")});t&&(t.color=this.newNotify.ContentMapping.first.color,t.value=this.newNotify.ContentMapping.first.value,this.notifyFirst=this.newNotify.ContentMapping.first.value,this.notifyColor.first=this.newNotify.ContentMapping.first.color),s&&(s.color=this.newNotify.ContentMapping.remark.color,s.value=this.newNotify.ContentMapping.remark.value,this.notifyRemark=this.newNotify.ContentMapping.remark.value,this.notifyColor.remark=this.newNotify.ContentMapping.remark.color),f()(e).call(e,(t,e)=>{if(0===m()(t).call(t,"{{first."))this.showFirst=t;else if(0===m()(t).call(t,"{{remark."))this.showRemark=t;else{var s;let e=t.match(/({{=?)(\S*)(?=.DATA)/g);const a=e[0].substr(2,e[0].length-1);this.keywords.push({label:a,value:this.newNotify.ContentMapping[a].value}),this.notifyColor.keywords.push(this.newNotify.ContentMapping[a].color);let i=u()(s=this.newNotify.contentTemplate).call(s,t=>t.key.replace(/{{/,"").replace(/.DATA}}/,"")===a);i.value=this.newNotify.ContentMapping[a].value,i.color=this.newNotify.ContentMapping[a].color}}),this.notificationURL=this.newNotify.ContentMapping.url||this.notificationURL}else f()(e).call(e,(t,e)=>{if(0===m()(t).call(t,"{{first."))this.showFirst=t;else if(0===m()(t).call(t,"{{remark."))this.showRemark=t;else{let e=t.match(/({{=?)(\S*)(?=.DATA)/g);this.keywords.push({label:e[0].substr(2,e[0].length-1),value:""}),this.notifyColor.keywords.push("#000000")}});this.note=this.newNotify.Note||"",this.selectedMiniProgram.messageId&&(this.redirectOptionData.currents=[{Name:this.$t("global.miniProgramLabel"),Value:"Mini Program Page"}],this.selectedMiniProgramPage=JSON.parse(d()(this.selectedMiniProgram)))},methods:{changeFirst(t){var e;u()(e=this.newNotify.contentTemplate).call(e,t=>{var e;return 0===m()(e=t.key).call(e,"{{first.")}).value=this.notifyFirst},changeRemark(){var t;u()(t=this.newNotify.contentTemplate).call(t,t=>{var e;return 0===m()(e=t.key).call(e,"{{remark.")}).value=this.notifyRemark},changeKey(t,e,s){var a;u()(a=this.newNotify.contentTemplate).call(a,t=>t.key.replace(/{{/,"").replace(/.DATA}}/,"")===s).value=t.target.value,this.keywords[e].value=t.target.value},onBgColor(t){if("first"===this.colorType){var e;this.notifyColor.first=t,u()(e=this.newNotify.contentTemplate).call(e,t=>{var e;return 0===m()(e=t.key).call(e,"{{first.")}).color=t}else if("remark"===this.colorType){var s;this.notifyColor.remark=t,u()(s=this.newNotify.contentTemplate).call(s,t=>{var e;return 0===m()(e=t.key).call(e,"{{remark.")}).color=t}else{var a,i,n;const e=c()(a=this.keywords).call(a,t=>t.label===this.colorType);o()(i=this.notifyColor.keywords).call(i,e,1,t),u()(n=this.newNotify.contentTemplate).call(n,t=>t.key.replace(/{{/,"").replace(/.DATA}}/,"")===this.colorType).color=t}},openColorPicker(t,e,s){var a;this.$refs.bgColorList.close(),this.colorType=s,this.colorPickerPosition=i()(a="position: absolute; left: ".concat(e,"px; top: ")).call(a,t,"px;"),this.$refs.bgColorList.open()},openSelectField(t){this.showMergeField=!0,this.mergeFieldType=t},closeSelectFiled(){this.showMergeField=!1},selectMergeField(t,e){if(this.fieldObj.label!==e.label&&(this.fieldObj=JSON.parse(d()(e))),"first"===this.mergeFieldType){var s;u()(s=this.newNotify.contentTemplate).call(s,t=>{var e;return 0===m()(e=t.key).call(e,"{{first.")}).value=this.notifyFirst+t,this.notifyFirst=this.notifyFirst+t}else if("remark"===this.mergeFieldType){var a;u()(a=this.newNotify.contentTemplate).call(a,t=>{var e;return 0===m()(e=t.key).call(e,"{{remark.")}).value=this.notifyRemark+t,this.notifyRemark=this.notifyRemark+t}else if("url"===this.mergeFieldType)this.notificationURL=t;else{var i,n;let e=u()(i=this.newNotify.contentTemplate).call(i,t=>{var e;return m()(e=t.key).call(e,this.mergeFieldType)>=0});const s=c()(n=this.keywords).call(n,t=>t.label===this.mergeFieldType);e.value=this.keywords[s].value,e.value=e.value+t,this.keywords[s].value=this.keywords[s].value+t}this.showMergeField=!1},prepareUpdatedData(){var t,e;let s={ContentMapping:{}};return s.Note=this.note,s.Title=this.newNotify.Title,this.showFirst&&(s.ContentMapping.first={value:this.notifyFirst,color:this.notifyColor.first}),f()(t=this.keywords).call(t,(t,e)=>{s.ContentMapping[t.label]={value:t.value,color:this.notifyColor.keywords[e]}}),this.showRemark&&(s.ContentMapping.remark={value:this.notifyRemark,color:this.notifyColor.remark}),this.isRedirectToURL?(s.NotificationURL=this.notificationURL,this.selectedMiniProgramPage={}):(this.notificationURL="",s.MiniProgramPageId=this.selectedMiniProgramPage.messageId||""),m()(e=this.notificationURL).call(e,"{!")>=0&&(s.NotificationURL="",s.ContentMapping.url=this.notificationURL),s},prepareCreatedData(){let t=this.prepareUpdatedData();return t.Content=this.newNotify.Content,this.newNotify.Industry&&(t.Industry=this.newNotify.Industry),this.newNotify.Sample&&(t.Sample=this.newNotify.Sample),t.TemplateId=this.newNotify.TemplateId,t},onChangeRedirectTo(t){this.redirectOptionData.currents=t,this.$root.$emit("close-other-dropdown",null),this.showDropdown=!1},onMiniProgramChanged(t){this.selectedMiniProgramPage=t}}},L=(s("Fblv"),s("KHd+")),N=s("A3YL"),T=Object(L.a)(I,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"slds-grid slds-grid_vertical-align-start new-notification-page"},[s("phone-frame-card",{staticClass:"phone-model-outer",attrs:{name:t.currentAccount.Name}},[s("div",{attrs:{slot:"app-name"},slot:"app-name"},[t._v(t._s(t.$t("global.wechatLabel")))]),t._v(" "),s("span",{attrs:{slot:"back-label"},slot:"back-label"},[t._v(t._s(t.$t("global.backBtn")))]),t._v(" "),s("div",{staticClass:"phone-model-body",attrs:{slot:"content"},slot:"content"},[s("div",{staticClass:"slds-box template-container"},[s("div",{staticClass:"template-section",class:{"has-padding":!t.isShowDetail}},[s("span",{staticClass:"slds-text-heading_small title",class:{"key-title":!t.showFirst}},[t._v(t._s(t.newNotify.Title))]),t._v(" "),t._l(t.newNotify.contentTemplate,(function(e){return[e.name?s("pre",{staticClass:"keyword"},[t._v(t._s(e.name))]):t._e(),t._v(" "),e.value?s("pre",{staticClass:"keyword",style:{color:e.color}},[t._v(t._s(e.value))]):t._e()]})),t._v(" "),t.isShowDetail?s("div",{staticClass:"detail-section",class:{"mini-program-detail":!t.isRedirectToURL}},[t.isRedirectToURL?t._e():s("icon",{staticClass:"mini-program-icon",attrs:{name:"miniProIcon",width:"16px",height:"16px","fill-color":"#706e6b","charket-icon":""}}),t._v(" "),t.isRedirectToURL?s("span",{staticClass:"slds-text-body_regular detail-value"},[t._v("\n              "+t._s(t.$t("detailsLabel"))+"\n            ")]):t._e(),t._v(" "),s("span",{staticClass:"detail-icon"},[s("icon",{attrs:{name:"chevronright","fill-color":"#b0adab",width:"14px",height:"14px"}})],1)],1):t._e()],2)])]),t._v(" "),s("div",{staticClass:"slds-col phone-model-footer",attrs:{slot:"action"},slot:"action"},[s("icon",{attrs:{name:"add","fill-color":"slds-icon_container slds-icon-text-default",width:"20px",height:"20px"}})],1)]),t._v(" "),s("div",{staticClass:"right"},[s("div",{staticClass:"right-content"},[s("span",{staticClass:"slds-text-heading_small content-title"},[t._v(t._s(t.$t("templateSettingLabel")))]),t._v(" "),t.showFirst?s("div",{staticClass:"input-section"},[s("label",[t._v("First")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.notifyFirst,expression:"notifyFirst"}],staticClass:"slds-textarea value first",style:{color:t.notifyColor.first},domProps:{value:t.notifyFirst},on:{keyup:function(e){return t.changeFirst(e)},input:function(e){e.target.composing||(t.notifyFirst=e.target.value)}}}),t._v(" "),s("span",{staticClass:"insert-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openSelectField("first")}}},[s("icon",{attrs:{name:"insertTag","class-name":"down-icon",width:"15px",height:"15px"}})],1),t._v(" "),s("span",{staticClass:"color-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openColorPicker(100,755,"first")}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1)]):t._e(),t._v(" "),t._l(t.keywords,(function(e,a){return s("div",{staticClass:"input-section"},[s("label",[t._v(t._s(e.label))]),t._v(" "),s("input",{staticClass:"slds-input value",style:{color:t.notifyColor.keywords[a]},attrs:{type:"text"},domProps:{value:e.value},on:{keyup:function(s){return t.changeKey(s,a,e.label)}}}),t._v(" "),s("span",{staticClass:"insert-icon short-icon down-btn",on:{click:function(s){return s.stopPropagation(),t.openSelectField(e.label)}}},[s("icon",{attrs:{name:"insertTag","class-name":"down-icon",width:"15px",height:"15px"}})],1),t._v(" "),t.showFirst?s("span",{staticClass:"color-icon short-icon down-btn",on:{click:function(s){return s.stopPropagation(),t.openColorPicker(212+70*a,755,e.label)}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1):t._e(),t._v(" "),t.showFirst?t._e():s("span",{staticClass:"color-icon short-icon down-btn",on:{click:function(s){return s.stopPropagation(),t.openColorPicker(110+70*a,755,e.label)}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1)])})),t._v(" "),t.showRemark?s("div",{staticClass:"input-section"},[s("label",[t._v("Remark")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.notifyRemark,expression:"notifyRemark"}],staticClass:"slds-textarea value",style:{color:t.notifyColor.remark},domProps:{value:t.notifyRemark},on:{keyup:function(e){return t.changeRemark()},input:function(e){e.target.composing||(t.notifyRemark=e.target.value)}}}),t._v(" "),s("span",{staticClass:"insert-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openSelectField("remark")}}},[s("icon",{attrs:{name:"insertTag","class-name":"down-icon",width:"15px",height:"15px"}})],1),t._v(" "),t.showFirst?s("span",{staticClass:"color-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openColorPicker(204+70*t.keywords.length,755,"remark")}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1):t._e(),t._v(" "),t.showFirst?t._e():s("span",{staticClass:"color-icon down-btn",on:{click:function(e){return e.stopPropagation(),t.openColorPicker(102+70*t.keywords.length,755,"remark")}}},[s("icon",{attrs:{name:"colorSelect","class-name":"down-icon",width:"15px",height:"15px"}})],1)]):t._e(),t._v(" "),s("div",{staticClass:"input-section"},[s("label",[t._v("Redirect To")]),t._v(" "),s("div",{staticClass:"redirect-section"},[s("input-select",{staticClass:"redirect-section__picklist",attrs:{currents:t.redirectOptionData.currents},on:{"close-dropdown":t.closeDropdown,"open-dropdown":t.openDropdown,resize:t.resizeDropdown}}),t._v(" "),t.isRedirectToURL?s("div",{staticClass:"redirect-section__content"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.notificationURL,expression:"notificationURL"}],staticClass:"slds-input",attrs:{type:"text",placeholder:t.$t("placeholderLabel")},domProps:{value:t.notificationURL},on:{input:function(e){e.target.composing||(t.notificationURL=e.target.value)}}}),t._v(" "),s("span",{staticClass:"insert-icon down-btn",on:{click:function(e){return t.openSelectField("url")}}},[s("icon",{attrs:{name:"insertTag","class-name":"down-icon",width:"15px",height:"15px"}})],1)]):s("div",{staticClass:"redirect-section__content"},[s("mini-program-selector",{attrs:{selected:t.selectedMiniProgramPage,"wechat-account-id":t.wechatAccountId},on:{changed:function(e){return t.onMiniProgramChanged(e)}}})],1)],1)]),t._v(" "),s("span",{staticClass:"slds-text-heading_small content-title"},[t._v(t._s(t.$t("informationLabel")))]),t._v(" "),s("div",{staticClass:"input-section"},[s("label",[t._v(t._s(t.$t("noteLabel")))]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.note,expression:"note"}],staticClass:"slds-textarea value note",attrs:{placeholder:t.$t("placeholderLabel")},domProps:{value:t.note},on:{input:function(e){e.target.composing||(t.note=e.target.value)}}})])],2)]),t._v(" "),s("div",{style:t.colorPickerPosition},[s("color-picker",{ref:"bgColorList",attrs:{value:""},on:{"get-color":t.onBgColor}})],1),t._v(" "),t.showMergeField?s("select-field",{attrs:{"title-name":"Campaigin Members","field-obj":t.fieldObj,"primary-disabled":!!t.notify.Id},on:{"close-merge-field":function(e){return t.closeSelectFiled()},"select-merge-field":t.selectMergeField}}):t._e(),t._v(" "),t.showDropdown?s("dropdown",{attrs:{options:t.redirectOptionData.options,currents:t.redirectOptionData.currents,left:t.dropdownLeft,top:t.dropdownTop,width:t.dropdownWidth},on:{"select-option":function(e){return t.onChangeRedirectTo(e)},close:function(e){return t.closeDropdown()}}}):t._e()],1)}),[],!1,null,"57709f2e",null);"function"==typeof N.default&&Object(N.default)(T);e.a=T.exports},pehn:function(t,e,s){"use strict";var a=s("2n3x"),i=s.n(a);e.default=i.a},q6or:function(t,e,s){},qVZU:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"preTitle":"上一页","nextTitle":"下一页"},"en":{"preTitle":"Previous Page","nextTitle":"Next Page"}}'),delete t.options._Ctor}},r1bT:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"methodLabel":"签到方式","settingLabel":"签到设置","onsiteLabel":"接受现场注册","attendLabel":"只有注册成功者才能签到","channelLabel":"接受非微信渠道的注册","uponLabel":"扫描二维码时提示","acceptStatusLabel":"允许签到的活动成员状态","memberStatusLabel":"成员状态","moblileLabel":"例如，请输入你注册活动时候使用的手机号完成签到。","previewLabel":"表单预览","qrCodeLabel":"创建签到二维码","formLabel":"表单","formNameLabel":"表单名称","nameLabel":"名称","sfObjectLabel":"关联对象","recordLabel":"记录类型","noteLabel":"备注","titleLabel":"标题","bannerLabel":"横幅","qrCodeMethodBtnLabel":"二维码","passMethodBtnLabel":"凭证","confirmInfo":"选择现场注册表单"},"en":{"methodLabel":"Check-in Method","settingLabel":"Check-in Settings","onsiteLabel":"Accept onsite registration","attendLabel":"Only registered attendees can check in","channelLabel":"Accept registrations from non-WeChat channels","uponLabel":"Prompt upon Check-in","acceptStatusLabel":"Accepted Campaign Member Statuses","memberStatusLabel":"Member Status","moblileLabel":"E.g. What’s the mobile number you used to sign up this event?","previewLabel":"Form Preview","qrCodeLabel":"Create Check-in QR Codes","formLabel":"Form | Forms","formNameLabel":"Form Name","nameLabel":"Name","sfObjectLabel":"Salesforce Object","recordLabel":"Record Type","noteLabel":"Note","titleLabel":"Title","bannerLabel":"Banner","qrCodeMethodBtnLabel":"QR Code","passMethodBtnLabel":"Pass","confirmInfo":"Select a Form for the onsite registration"}}'),delete t.options._Ctor}},rEsM:function(t,e,s){"use strict";var a=s("HA+Y");s.n(a).a},rQWd:function(t,e,s){"use strict";var a=s("ZUrg");s.n(a).a},rU8W:function(t,e,s){"use strict";var a=s("m5/F");s.n(a).a},rxPh:function(t,e,s){"use strict";var a=s("1MG1"),i=s.n(a);e.default=i.a},s7xp:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"checkInStaffLabel":"登记人员","addLabel":"添加","noRecordLabel":"没有数据","saveStaffLabel":"登记人员已添加！","nameLabel":"名字","relatedObjLabel":"潜在客户/联系人","followerNameLabel":"关注者姓名","addCheckInStaffLabel":"添加登记人员","deleteStaffContentLabel":"你确定要删除此登记人员吗？","deleteStaffHeaderLabel":"删除登记人员","weChatFollowerLabel":"微信关注者","displayNameLabel":"展示名"},"en":{"checkInStaffLabel":"Check-in Staff","addLabel":"Add","noRecordLabel":"No Records","saveStaffLabel":"Check-in Staff was added.","nameLabel":"NAME | Name","relatedObjLabel":"LEAD/CONTACT","followerNameLabel":"Follower Name","addCheckInStaffLabel":"Add Check-in Staff","deleteStaffContentLabel":"Are you sure you want to delete this check-in sfaff?","deleteStaffHeaderLabel":"Delete Staff","weChatFollowerLabel":"WeChat Follower | WeChat Followers","displayNameLabel":"Display Name"}}'),delete t.options._Ctor}},svHN:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"newNotifyLabel":"新建通知","saveNotifyLabel":"模板消息保存成功！"},"en":{"newNotifyLabel":"New Notification","saveNotifyLabel":"The notification was saved."}}'),delete t.options._Ctor}},szQD:function(t,e,s){},t29s:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"urlLabel":"跳转链接","titleLabel":"标题","createdLabel":"创建人","keywordLabel":"关键字","noteLabel":"备注"},"en":{"urlLabel":"Notification URL","titleLabel":"Title","createdLabel":"Created By","keywordLabel":"Keywords","noteLabel":"Note"}}'),delete t.options._Ctor}},tAMZ:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"selectSkillLabel":"选择技能","nameLabel":"技能名称","knowledgeSourceLabel":"知识源","relatedToLabel":"相关项","descriptionLabel":"描述","validForLabel":"有效时间(分钟)","displayInLiveChatLabel":"在 Live Chat 中显示","internalLabel":"内部","lastModifiedByLabel":"上次修改人"},"en":{"selectSkillLabel":"Select Skill","nameLabel":"Name","knowledgeSourceLabel":"Knowledge Source","relatedToLabel":"Related To","descriptionLabel":"Description","validForLabel":"Valid For (mins)","displayInLiveChatLabel":"Display in Live Chat","internalLabel":"Internal","lastModifiedByLabel":"Last Modified By"}}'),delete t.options._Ctor}},tJr4:function(t,e,s){"use strict";var a=s("Tsgj");s.n(a).a},tVRX:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"formStepLabel":"选择表单","formStepTitle":"选择表单","formStepValue":"为参会者选择报名表单","qrCodeStepLabel":"创建二维码","qrCodeStepTitle":"创建二维码","qrCodeStepValue":"创建报名二维码。","actionStepLabel":"完成操作后","actionStepTitle":"完成操作后","actionStepValue":"完成注册流程后的动作。","confirmStepLabel":"确认和保存","confirmStepTitle":"确认和保存","confirmStepValue":"请确认你的选择。"},"en":{"formStepLabel":"SELECT FORM","formStepTitle":"Select Form","formStepValue":"Select a form which event attendees will use to sign up the event.","qrCodeStepLabel":"CREATE QR CODES","qrCodeStepTitle":"Create QR Codes","qrCodeStepValue":"Create QR code(s) for event registration.","actionStepLabel":"COMPLETION ACTIONS","actionStepTitle":"Completion Actions","actionStepValue":"Completion actions for event registration.","confirmStepLabel":"CONFIRM & SAVE","confirmStepTitle":"Confirm & Save","confirmStepValue":"Please confirm your selections."}}'),delete t.options._Ctor}},um3e:function(t,e,s){t.exports=s.p+"static/images/bg_img.jpg"},utAx:function(t,e,s){"use strict";var a=s("46Re");s.n(a).a},vMh3:function(t,e,s){"use strict";var a=s("VIrk");s.n(a).a},vjcd:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"addBtn":"添加","order":"序号","roundName":"奖项名称","prize":"奖品","prizePicture":"奖品图片","quantity":"数量","status":"可参与抽奖的市场活动成员状态","notification":"通知模板","action":"操作","adjustQuantity":"调整数量","newQuantity":"新的数量","quantityAdjusted":"调整数量","currentQuantity":"当前数量","delModalHeader":"删除奖品","delModalContent":"确定要删除这个奖品吗？","delNotify":"奖品已删除。","delErrNotify":"已经抽取的奖品不能被删除。","updateNotify":"奖品数量已修改。","test":"测试","start":"开始"},"en":{"addBtn":"Add","order":"Order","roundName":"Round Name","prize":"Prize","prizePicture":"Prize Picture","quantity":"Quantity","status":"Qualified Campaign Member Statuses","notification":"Notification Template","action":"Actions","adjustQuantity":"Adjust Quantity","newQuantity":"New Quantity","quantityAdjusted":"Quantity Adjusted","currentQuantity":"Current Quantity","delModalHeader":"Delete Prize","delModalContent":"Are you sure you want to delete this prize?","delNotify":"The prize was deleted.","delErrNotify":"You can not delete a drawn prize.","updateNotify":"The prize quantity was changed.","test":"Test","start":"Start"}}'),delete t.options._Ctor}},vyV3:function(t,e,s){"use strict";var a=s("AScg");s.n(a).a},"w/3m":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"editTextTitle":"编辑文本消息","notifyContent":"修改已保存。"},"en":{"editTextTitle":"Edit Text Message","notifyContent":"Your changes are saved."}}'),delete t.options._Ctor}},wOuw:function(t,e,s){},wbfU:function(t,e,s){"use strict";var a=s("wG3i"),i=s.n(a),n=s("pUDi"),o=s("zUtI"),r=s("4B+h"),c={props:{notify:{type:Object,default:()=>({contentTemplate:{keywords:[]}})},accId:{type:String,default:()=>""}},components:{NewNotification:n.a},data:()=>({isSaveNotify:!1}),methods:{closeModal(t){this.$emit("close",t)},async saveNotify(){const t=this.accId||this.$route.params.accountId,e=this.$refs.newNotifyPage.prepareCreatedData();if(t)try{this.isSaveNotify=!0;const s=await Object(o.a)(t,i()(e));s.ok?(this.$router.app.$emit("open-toast-notification",{content:this.$t("saveNotifyLabel"),type:"success"}),this.closeModal(s),this.isSaveNotify=!1):(Object(r.f)(s),this.isSaveNotify=!1)}catch(t){Object(r.f)(t),this.isSaveNotify=!1}}}},l=(s("rEsM"),s("KHd+")),d=s("lNHh"),h=Object(l.a)(c,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"new-notification-popup"},[s("section",{staticClass:"slds-modal slds-fade-in-open",attrs:{role:"dialog",tabindex:"-1","aria-labelledby":"modal-heading-01","aria-modal":"true","aria-describedby":"modal-content-id-1"}},[s("div",{staticClass:"slds-modal__container notify-width"},[s("header",{staticClass:"slds-modal__header"},[s("button",{staticClass:"slds-button slds-button_icon slds-modal__close slds-button_icon-inverse",attrs:{disabled:t.isSaveNotify},on:{click:function(e){return t.closeModal()}}},[s("icon",{attrs:{name:"close",category:"utility","class-name":"slds-button__icon slds-button__icon_large"}}),t._v(" "),s("span",{staticClass:"slds-assistive-text"},[t._v("Close")])],1),t._v(" "),s("h2",{staticClass:"slds-text-heading_medium slds-hyphenate",attrs:{id:"modal-heading-01"}},[t._v(t._s(t.$t("newNotifyLabel")))])]),t._v(" "),s("div",{staticClass:"slds-modal__content slds-p-around_medium modal-content-custom",attrs:{id:"modal-content-id-1"}},[s("new-notification",{ref:"newNotifyPage",attrs:{notify:t.notify,"wechat-account-id":t.accId}})],1),t._v(" "),s("footer",{staticClass:"slds-modal__footer"},[s("button",{staticClass:"slds-button slds-button_neutral",attrs:{disabled:t.isSaveNotify},on:{click:function(e){return t.closeModal()}}},[t._v(t._s(t.$t("global.cancelBtn")))]),t._v(" "),s("button",{staticClass:"slds-button slds-button_brand",attrs:{disabled:t.isSaveNotify},on:{click:function(e){return t.saveNotify()}}},[t._v(t._s(t.$t("global.saveBtn")))])])])]),t._v(" "),s("div",{staticClass:"slds-backdrop slds-backdrop_open"})])}),[],!1,null,"5fadaa67",null);"function"==typeof d.default&&Object(d.default)(h);e.a=h.exports},xPXm:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"failedResponseLabel":"签到失败回复","badgeLabel":"打印名牌","badgeTemplateLabel":"名牌模板","selectTemplateLabel":"选择名牌模板"},"en":{"failedResponseLabel":"Failed Check-in Response","badgeLabel":"Print Name Badge","badgeTemplateLabel":"Name Badge Template","selectTemplateLabel":"Select Name Badge Template"}}'),delete t.options._Ctor}},xecf:function(t,e,s){"use strict";var a=s("/FlB");s.n(a).a},xncO:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"replyModeLabel":"回复模式","replyModeAll":"全部","replyModeRandom":"随机","nameLabel":"名称","changeSavedNofity":"修改已保存。","uploader":{"imageTitle":"上传图片","videoTitle":"上传视频","voiceTitle":"上传音频","titleLabel":"标题","descriptionLabel":"说明","cancelBtn":"取消","uploadBtn":"上传","uploadingBtn":"上传中","tooLarge":"最大文件大小为 2 MB。"},"exclusive":{"skillAddTitle":"移除已添加回复","skillAddContent":"技能无法和其他类型自动回复同时运行。添加当前技能会移除已添加回复。确定吗？","skillRemoveTitle":"移除已添加技能","skillRemoveContent":"技能无法和其他类型自动回复同时运行。添加当前回复会移除已添加技能。确定吗？"}},"en":{"replyModeLabel":"Reply Mode","replyModeAll":"All","replyModeRandom":"Random","nameLabel":"Name","changeSavedNofity":"Your changes are saved.","uploader":{"imageTitle":"Upload Image","videoTitle":"Upload Video","voiceTitle":"Upload Voice Clip","titleLabel":"Title","descriptionLabel":"Description","cancelBtn":"Cancel","uploadBtn":"Upload","uploadingBtn":"Uploading","tooLarge":"The maximum file size is 2 MB."},"exclusive":{"skillAddTitle":"Remove Added Responses","skillAddContent":"A skill cannot be executed along with any other auto responses. Adding this skill response removes all other auto responses. Are you sure?","skillRemoveTitle":"Remove Added Skill","skillRemoveContent":"A skill cannot be executed along with any other auto responses. Adding this auto response removes the previously added skill response. Are you sure?"}}}'),delete t.options._Ctor}},xswR:function(t,e,s){"use strict";var a=s("xncO"),i=s.n(a);e.default=i.a},y61V:function(t,e,s){"use strict";var a=s("Sd7o");s.n(a).a},yWOo:function(t,e,s){},zUtI:function(t,e,s){"use strict";s.d(e,"c",(function(){return i})),s.d(e,"e",(function(){return n})),s.d(e,"g",(function(){return o})),s.d(e,"d",(function(){return r})),s.d(e,"b",(function(){return c})),s.d(e,"h",(function(){return l})),s.d(e,"a",(function(){return d})),s.d(e,"f",(function(){return h}));var a=s("00Ee");function i(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return Object(a.a)({method:"NotificationTemplateRemoteActions.getNotificationTemplates",args:[t,e,s,i]})}function n(t,e,s,i){return Object(a.a)({method:"NotificationTemplateRemoteActions.getTemplates",args:[t,e,s,i]})}function o(t){return Object(a.a)({method:"NotificationTemplateRemoteActions.getWeChatPrivateTemplates",args:[t]})}function r(t){return Object(a.a)({method:"NotificationTemplateRemoteActions.getTemplate",args:[t]})}function c(t){return Object(a.a)({method:"NotificationTemplateRemoteActions.deleteTemplate",args:[t]})}function l(t,e){return Object(a.a)({method:"NotificationTemplateRemoteActions.updateTemplate",args:[t,e]})}function d(t,e){return Object(a.a)({method:"NotificationTemplateRemoteActions.createTemplate",args:[t,e]})}function h(t){return Object(a.a)({method:"NotificationTemplateRemoteActions.getWeChatNotifications",args:[t]})}},ze0W:function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"cn":{"methodStepLabel":"选择签到方式","methodStepTitle":"选择表单","methodStepValue":"指定你希望参会者签到的方式。","actionStepLabel":"完成操作后","actionStepTitle":"完成操作后","actionStepValue":"完成签到流程后的动作。","confirmStepLabel":"确认和保存","confirmStepTitle":"确认和保存","confirmStepValue":"请确认你的选择。"},"en":{"methodStepLabel":"SELECT CHECK-IN METHOD","methodStepTitle":"Select a check-in method","methodStepValue":"Specify how you want event attendees to check in the event.","actionStepLabel":"COMPLETION ACTIONS","actionStepTitle":"Completion Actions","actionStepValue":"Completion actions for event registration.","confirmStepLabel":"CONFIRM & SAVE","confirmStepTitle":"Confirm & Save","confirmStepValue":"Please confirm your selections."}}'),delete t.options._Ctor}},"zwj+":function(t,e,s){t.exports=s.p+"static/images/prize.png"}}]);