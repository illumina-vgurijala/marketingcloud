(function(){var a=SVMX.Package("com.servicemax.client.qbm.ui.desktop.api");a.init=function(){var b=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("CQL");Ext.define("com.servicemax.client.qbm.ui.desktop.api.RootContainer",{extend:"com.servicemax.client.ui.components.composites.impl.SVMXSection",alias:"widget.qbm.rootcontainer",layout:"border",cls:"qbm-root-container",__resultsViewPanel:null,__runOpts:null,height:"100%",__parent:this,constructor:function(d){var e="/apex/"+SVMX.OrgNamespace+"__CONF_SetupHome";var c=window.location.search.substring(1);var f=b.T("TAG002","Back To Setup Home");if(c&&c.indexOf("isStandAloneChecklist")!=-1){e="/apex/"+SVMX.OrgNamespace+"__CONF_FeatureSetup";f=b.T("COMM008","Back To Feature Setup");}else{if((typeof sforce!="undefined")&&(sforce!=null)){e="/lightning/n/"+SVMX.OrgNamespace+"__ServiceMax_Setup";}}d=Ext.apply({header:{items:[{xtype:"svmx.button",itemId:"BackButton",padding:"0",text:f,handler:function(j,i,g,h){if((typeof sforce!="undefined")&&(sforce!=null)){sforce.one.navigateToURL(e);}else{window.location=e;}}}]},collapsible:false,title:SVMX.getClient().getApplicationParameter("svmx-sfm-hide-title-bar")?"":b.T("TAG003","Checklist Question Library"),titleAlign:"center",layout:{type:"border"}},d||{});this.callParent([d]);},run:function(d){var g=this;this.__runOpts=d;this.__mainPanel=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXContainer",{region:"center",width:"100%",layout:{type:"vbox",align:"stretch"}});this.add(this.__mainPanel);this.__libraryPanel=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXContainer",{region:"center",width:"100%",flex:1,hidden:true,layout:{type:"vbox",align:"stretch"}});this.__mainPanel.add(this.__libraryPanel);this.__editPanel=SVMX.create("com.servicemax.client.qbm.ui.desktop.EditPanel",{region:"center",width:"100%",flex:1,hidden:true,__parent:this});this.__mainPanel.add(this.__editPanel);var f=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXToolbar",{dock:"top",flex:0.5});var j=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXText",{cls:"svmx-text-filter-icon",width:300,emptyText:b.T("TAG004","Search for Questions"),selectOnFocus:false,style:{marginLeft:"20px",marginRight:"2px",marginTop:"0px",marginBottom:"0px"},listeners:{change:function(l,m){var k=j.getValue();g.__resultsViewPanel.__questionListStore.clearFilter();g.__resultsViewPanel.__questionListStore.filter("question",new RegExp(Ext.escapeRe(k),"i"));}}});f.addItemsLeft(j);var h=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXButton",{text:b.T("TAG005","Add"),tootip:b.T("TODO","Create a Question"),style:{marginLeft:"2px",marginRight:"2px",marginTop:"0px",marginBottom:"0px"},handler:function(){g.showEditPanel(false);}});f.addItemsRight(h);var i=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXButton",{text:b.T("TAG006","Delete"),tootip:b.T("TODO","Delete a Question"),disabled:true,style:{marginLeft:"2px",marginRight:"2px",marginTop:"0px",marginBottom:"0px"},handler:function(){var k=g.__resultsViewPanel.getSelectedItems();if(k.length===1){Ext.Msg.confirm(b.T("TAG007","Confirm Delete"),b.T("TAG008","The question will be deleted. This action cannot be undone"),function(l){if(l==="yes"){g.blockApplication();g.deliveryEngine.deleteQuestion(k[0]);}},this);}}});f.addItemsRight(i);var e=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXButton",{text:b.T("TAG009","PREVIOUS"),tootip:b.T("TODO","Get Previous List of Question"),style:{marginLeft:"2px",marginRight:"2px",marginTop:"0px",marginBottom:"0px"},handler:function(){g.blockApplication();g.deliveryEngine.previousQuestionList();}});f.addItemsRight(e);var c=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXButton",{text:b.T("TAG010","NEXT"),tootip:b.T("TODO","Get Next List of Question"),style:{marginLeft:"2px",marginRight:"2px",marginTop:"0px",marginBottom:"0px"},handler:function(){g.blockApplication();g.deliveryEngine.nextQuestionList();}});f.addItemsRight(c);this.__libraryPanel.add(f);this.__toolbar=f;this.__deleteButton=i;this.__resultsViewPanel=SVMX.create("com.servicemax.client.qbm.ui.desktop.Grid",{metaModel:this.metaModel,__parent:this,deliveryEngine:this.deliveryEngine,style:{marginLeft:"2px",marginRight:"2px",marginTop:"2px",marginBottom:"2px"},flex:9.5});this.__libraryPanel.add(this.__resultsViewPanel);this.resize();this.showLibraryPanel();},showLibraryPanel:function(){this.__editPanel.hide();this.__libraryPanel.show();},showEditPanel:function(d,c){this.__libraryPanel.hide();this.__editPanel.show();this.__editPanel.setActiveQuestion(d,c);},setAndSaveQuestionData:function(){var m=this.__editPanel.formPanel.getData();var k=false;var c=false;var f=m.questionText&&m.questionText.trim();if(m.answers!=undefined){var n=SVMX.typeOf(m.answers)==="string"?[m.answers]:m.answers;var e=n.length;for(var g=0;g<e;g++){var h=Ext.String.htmlEncode(n[g].trim());
if(!(h!=""&&h.length>0)){k=true;}}}var d=["Checkbox","Radio Button","Picklist","Multi-select Picklist"];var j=d.indexOf(m.response_Type);if(j!=-1&&m.newResponseSetName!=undefined&&m.newResponseSetName.trim()==""){c=true;}if(f!=""&&f.length>0&&!k&&!c){this.blockApplication();this.deliveryEngine.saveQuestion(m);}else{Ext.Msg.alert(b.T("TAG011","Failure"),b.T("TAG012","Please fill all the Required fields"));}},showMessage:function(d){var c=Ext.Msg.alert(b.T("TAG013","Success"),Ext.String.htmlEncode(d),function(e,f){if(e=="ok"){this.showLibraryPanel();}},this);},onFailure:function(e,c){this.unblockApplication();if(c==="DUPLICATE_RESPONSE_SET"){var d=Ext.Msg.alert(b.T("TAG011","Failure"),Ext.String.htmlEncode(e),function(f,g){},this);}else{var d=Ext.Msg.alert(b.T("TAG011","Failure"),Ext.String.htmlEncode(e),function(f,g){if(f=="ok"){this.showLibraryPanel();}},this);}},onDeleteFailure:function(f,g){f=Ext.String.htmlEncode(f);var e,c=g&&g.length;f=f+"<ol>";for(e=0;e<c;e++){f=f+"<li>"+Ext.String.htmlEncode(g[e])+"</li>";if(e===3){break;}}f=f+"</ol>";if(e===3&&c>e+1){f=f+"<br>"+b.T("TAG015","and")+" "+(c-(e+1))+" "+b.T("TAG016","more");}this.unblockApplication();var d=Ext.Msg.alert(b.T("TAG014","Unable To Delete"),f);},onSaveFailure:function(f,g){f=Ext.String.htmlEncode(f);var e,c=g&&g.length;f=f+"<ol>";for(e=0;e<c;e++){f=f+"<li>"+Ext.String.htmlEncode(g[e])+"</li>";if(e===3){break;}}f=f+"</ol>";if(e===3&&c>e+1){f=f+"<br>"+b.T("TAG015","and")+" "+(c-(e+1))+" "+b.T("TAG016","more");}this.unblockApplication();var d=Ext.Msg.alert(b.T("TAG047","Unable To Save"),f);},resize:function(c){if(!this.getEl()){return SVMX.timer.job(this.id+".resize",10,this,"resize");}if(!c){c=this.getEl().getViewSize();}if(c.width){c.width=c.width-4;}if(c.height){c.height=c.height-6;}if(c.width){this.setWidth(c.width);}if(c.height){this.setHeight(c.height);}},blockApplication:function(f){var e=f||{request:{state:"block",deliveryEngine:this.getDeliveryEngine()},responder:{}};var d=this.getDeliveryEngine().getEventBus();var c=SVMX.create("com.servicemax.client.lib.api.Event","QBM.CHANGE_APP_STATE",this,e);d.triggerEvent(c);},unblockApplication:function(f){var e=f||{request:{state:"unblock",deliveryEngine:this.getDeliveryEngine()},responder:{}};var d=this.getDeliveryEngine().getEventBus();var c=SVMX.create("com.servicemax.client.lib.api.Event","QBM.CHANGE_APP_STATE",this,e);d.triggerEvent(c);},getDeliveryEngine:function(){return this.deliveryEngine;}});Ext.define("com.servicemax.client.qbm.ui.desktop.EditPanel",{extend:"com.servicemax.client.ui.components.composites.impl.SVMXContainer",alias:"widget.svmx.qbm.editpanel",constructor:function(c){c=Ext.apply({layout:{type:"vbox",align:"stretch"}},c||{});this.callParent([c]);},initComponent:function(){this.callParent(arguments);var c=this;var f=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXToolbar",{dock:"top",flex:0.5});var e=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXButton",{text:b.T("TAG017","Cancel"),tootip:b.T("TODO","Back to Question listing page"),style:{marginLeft:"2px",marginRight:"2px",marginTop:"0px",marginBottom:"0px"},handler:function(){c.__parent.showLibraryPanel();}});f.addItemsLeft(e);var d=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXButton",{text:b.T("TAG018","Save"),tootip:b.T("TODO","Save a Question"),style:{marginLeft:"2px",marginRight:"2px",marginTop:"0px",marginBottom:"0px"},handler:function(){c.__parent.setAndSaveQuestionData();}});f.addItemsRight(d);this.add(f);this.formPanel=SVMX.create("com.servicemax.client.qbm.ui.desktop.editQuestion.EditQuestionPanel",{titleAlign:"center",width:"90%",__parent:this,flex:9.5});this.add(this.formPanel);},setActiveQuestion:function(d,c){if(!d){this.formPanel.setTitle(b.T("TAG019","Add Question"));this.formPanel.radioButton.hide();this.formPanel.__newResponseSetName.hide();}else{this.formPanel.radioButton.show();this.formPanel.setTitle(b.T("TAG020","Edit Question"));}this.formPanel.loadQuestionDataInEditMode(d,c||{});}});Ext.define("com.servicemax.client.qbm.ui.desktop.Grid",{extend:"com.servicemax.client.ui.components.composites.impl.SVMXListComposite",alias:"widget.svmx.qbm.grid",constructor:function(e){var f=this;var c=SVMX.create("Ext.selection.CheckboxModel",{showHeaderCheckbox:false,mode:"SINGLE",setLastFocused:function(i,h){var j=this,g=i;j.lastFocused=i;if(i!==g){j.onLastFocusChanged(g,i,h);}},onRowMouseDown:function(k,l,o,q,n){var p=this,r=n.getTarget("."+Ext.baseCSSPrefix+"grid-row-checker"),m;if(!p.allowRightMouseSelection(n)){return;}if(p.checkOnly&&!r){return;}if(r){m=p.getSelectionMode();if(m!=="SINGLE"){p.setSelectionMode("SIMPLE");}p.doSelect(l,true);p.setSelectionMode(m);}else{p.doSelect(l,true);}},listeners:{selectionchange:function(g,h){f.__parent.__deleteButton.setDisabled(h.length==0);}}});var d=this.__questionListStore=Ext.create("Ext.data.Store",{storeId:"questionListStore",fields:[{name:"id"},{name:"question"},{name:"dataType"},{name:"lastModifiedDate",type:"date"}],data:[]});
e=Ext.apply({store:d,selModel:c,columns:[{text:b.T("TAG021","Question"),dataIndex:"question",width:"50%"},{text:b.T("TAG022","Type"),dataIndex:"dataType",width:"25%"},{text:b.T("TAG023","Edited"),xtype:"datecolumn",format:"m-d-Y",dataIndex:"lastModifiedDate",width:"25%"}],listeners:{celldblclick:SVMX.proxy(this,function(g,j,h,i){this.__parent.blockApplication();this.deliveryEngine.editQuestion(this.getSelectionModel().getLastSelected());})}},e||{});this.callParent([e]);},initComponent:function(){this.callParent(arguments);this.loadData();},loadData:function(){this.__questionListStore.loadData(this.__parent.metaModel.getQuestionInfo());},getSelectedItems:function(){var d=[],e=this.selModel.getSelection();if(e.length>0){for(var c=0;c<e.length;c++){d.push(e[c].data.id);}}return d;}});};})();(function(){var a=SVMX.Package("com.servicemax.client.qbm.ui.desktop.boxselect");a.init=function(){Ext.define("com.servicemax.client.qbm.ui.desktop.boxselect.BoxSelect",{extend:"Ext.form.field.ComboBox",alias:["widget.comboboxselect","widget.boxselect"],requires:["Ext.selection.Model","Ext.data.Store"],multiSelect:true,forceSelection:true,createNewOnEnter:false,createNewOnBlur:false,encodeSubmitValue:false,triggerOnClick:true,stacked:false,pinList:true,filterPickList:false,selectOnFocus:true,grow:true,growMin:false,growMax:false,fieldSubTpl:['<div id="{cmpId}-listWrapper" class="x-boxselect {fieldCls} {typeCls}">','<ul id="{cmpId}-itemList" class="x-boxselect-list">','<li id="{cmpId}-inputElCt" class="x-boxselect-input">','<div id="{cmpId}-emptyEl" class="{emptyCls}">{emptyText}</div>','<input id="{cmpId}-inputEl" type="{type}" ','<tpl if="name">name="{name}" </tpl>','<tpl if="value"> value="{[Ext.util.Format.htmlEncode(values.value)]}"</tpl>','<tpl if="size">size="{size}" </tpl>','<tpl if="tabIdx">tabIndex="{tabIdx}" </tpl>','<tpl if="disabled"> disabled="disabled"</tpl>','class="x-boxselect-input-field {inputElCls}" autocomplete="off">',"</li>","</ul>","</div>",{compiled:true,disableFormats:true}],childEls:["listWrapper","itemList","inputEl","inputElCt","emptyEl"],componentLayout:"boxselectfield",emptyInputCls:"x-boxselect-emptyinput",initComponent:function(){var c=this,b=c.typeAhead;if(b&&!c.editable){Ext.Error.raise("If typeAhead is enabled the combo must be editable: true -- please change one of those settings.");}Ext.apply(c,{typeAhead:false});c.callParent();c.typeAhead=b;c.selectionModel=new Ext.selection.Model({store:c.valueStore,mode:"MULTI",lastFocused:null,onSelectChange:function(d,f,e,g){g();}});if(!Ext.isEmpty(c.delimiter)&&c.multiSelect){c.delimiterRegexp=new RegExp(String(c.delimiter).replace(/[$%()*+.?\[\\\]{|}]/g,"\\$&"));}},initEvents:function(){var b=this;b.callParent(arguments);if(!b.enableKeyEvents){b.mon(b.inputEl,"keydown",b.onKeyDown,b);}b.mon(b.inputEl,"paste",b.onPaste,b);b.mon(b.listWrapper,"click",b.onItemListClick,b);b.mon(b.selectionModel,{selectionchange:function(c,d){b.applyMultiselectItemMarkup();b.fireEvent("valueselectionchange",b,d);},focuschange:function(c,e,d){b.fireEvent("valuefocuschange",b,e,d);},scope:b});},onBindStore:function(b,c){var d=this;if(b){d.valueStore=new Ext.data.Store({model:b.model,proxy:{type:"memory"}});d.mon(d.valueStore,"datachanged",d.applyMultiselectItemMarkup,d);if(d.selectionModel){d.selectionModel.bindStore(d.valueStore);}}},onUnbindStore:function(b){var c=this,d=c.valueStore;if(d){if(c.selectionModel){c.selectionModel.setLastFocused(null);c.selectionModel.deselectAll();c.selectionModel.bindStore(null);}c.mun(d,"datachanged",c.applyMultiselectItemMarkup,c);d.destroy();c.valueStore=null;}c.callParent(arguments);},createPicker:function(){var c=this,b=c.callParent(arguments);c.mon(b,{beforerefresh:c.onBeforeListRefresh,scope:c});if(c.filterPickList){b.addCls("x-boxselect-hideselections");}return b;},onDestroy:function(){var b=this;Ext.destroyMembers(b,"valueStore","selectionModel");b.callParent(arguments);},getSubTplData:function(){var b=this,c=b.callParent(),d=b.emptyText&&c.value.length<1;c.value="";if(d){c.emptyText=b.emptyText;c.emptyCls=b.emptyCls;c.inputElCls=b.emptyInputCls;}else{c.emptyText="";c.emptyCls=b.emptyInputCls;c.inputElCls="";}return c;},afterRender:function(){var b=this;if(Ext.supports.Placeholder&&b.inputEl&&b.emptyText){delete b.inputEl.dom.placeholder;}b.bodyEl.applyStyles("vertical-align:top");if(b.grow){if(Ext.isNumber(b.growMin)&&(b.growMin>0)){b.listWrapper.applyStyles("min-height:"+b.growMin+"px");}if(Ext.isNumber(b.growMax)&&(b.growMax>0)){b.listWrapper.applyStyles("max-height:"+b.growMax+"px");}}if(b.stacked===true){b.itemList.addCls("x-boxselect-stacked");}if(!b.multiSelect){b.itemList.addCls("x-boxselect-singleselect");}b.applyMultiselectItemMarkup();b.callParent(arguments);},findRecord:function(e,d){var c=this.store,b;if(!c){return false;}b=c.queryBy(function(f,g){return f.isEqual(f.get(e),d);});return(b.getCount()>0)?b.first():false;},onLoad:function(){var c=this,b=c.valueField,d=c.valueStore,e=false;if(d){if(!Ext.isEmpty(c.value)&&(d.getCount()==0)){c.setValue(c.value,false,true);
}d.suspendEvents();d.each(function(h){var g=c.findRecord(b,h.get(b)),f=g?d.indexOf(h):-1;if(f>=0){d.removeAt(f);d.insert(f,g);e=true;}});d.resumeEvents();if(e){d.fireEvent("datachanged",d);}}c.callParent(arguments);},isFilteredRecord:function(b){var g=this,c=g.store,e=g.valueField,f,d=false;f=c.findExact(e,b.get(e));d=((f===-1)&&(!c.snapshot||(g.findRecord(e,b.get(e))!==false)));d=d||(!d&&(f===-1)&&(g.forceSelection!==true)&&(g.valueStore.findExact(e,b.get(e))>=0));return d;},doRawQuery:function(){var b=this,c=b.inputEl.dom.value;if(b.multiSelect){c=c.split(b.delimiter).pop();}if(c.length>0){this.doQuery(c,false,true);}this.focus();this.selectText(c.length,c.length);},onBeforeListRefresh:function(){this.ignoreSelection++;},onListRefresh:function(){this.callParent(arguments);if(this.ignoreSelection>0){--this.ignoreSelection;}},onListSelectionChange:function(d,g){var c=this,e=c.valueStore,f=[],b;if((c.ignoreSelection<=0)&&c.isExpanded){e.each(function(h){if(Ext.Array.contains(g,h)||c.isFilteredRecord(h)){f.push(h);}});f=Ext.Array.merge(f,g);b=Ext.Array.intersect(f,e.getRange()).length;if((b!=f.length)||(b!=c.valueStore.getCount())){c.setValue(f,false);if(!c.multiSelect||!c.pinList){Ext.defer(c.collapse,1,c);}if(e.getCount()>0){c.fireEvent("select",c,e.getRange());}}c.inputEl.focus();if(!c.pinList){c.inputEl.dom.value="";}if(c.selectOnFocus){c.inputEl.dom.select();}}},syncSelection:function(){var g=this,e=g.picker,d=g.valueField,b,f,c;if(e){b=e.store;f=[];if(g.valueStore){g.valueStore.each(function(j){var h=b.findExact(d,j.get(d));if(h>=0){f.push(b.getAt(h));}});}g.ignoreSelection++;c=e.getSelectionModel();c.deselectAll();if(f.length>0){c.select(f);}if(g.ignoreSelection>0){--g.ignoreSelection;}}},doAlign:function(){var e=this,d=e.picker,b="-above",c;e.picker.alignTo(e.listWrapper,e.pickerAlign,e.pickerOffset);c=d.el.getY()<e.inputEl.getY();e.bodyEl[c?"addCls":"removeCls"](e.openCls+b);d[c?"addCls":"removeCls"](d.baseCls+b);},alignPicker:function(){var d=this,c=d.picker,b=c.getTargetEl().dom.scrollTop;d.callParent(arguments);if(d.isExpanded){if(d.matchFieldWidth){c.setWidth(d.listWrapper.getWidth());}c.getTargetEl().dom.scrollTop=b;}},getCursorPosition:function(){var b;if(Ext.isIE){b=document.selection.createRange();b.collapse(true);b.moveStart("character",-this.inputEl.dom.value.length);b=b.text.length;}else{b=this.inputEl.dom.selectionStart;}return b;},hasSelectedText:function(){var c,b;if(Ext.isIE){c=document.selection;b=c.createRange();return(b.parentElement()==this.inputEl.dom);}else{return this.inputEl.dom.selectionStart!=this.inputEl.dom.selectionEnd;}},onKeyDown:function(f,j){var g=this,i=f.getKey(),c=Ext.String.htmlEncode(g.inputEl.dom.value),k=g.valueStore,d=g.selectionModel,b=false;if(g.readOnly||g.disabled||!g.editable){return;}if(g.isExpanded&&(i==f.A&&f.ctrlKey)){g.select(g.getStore().getRange());d.setLastFocused(null);d.deselectAll();g.collapse();g.inputEl.focus();b=true;}else{if((k.getCount()>0)&&((c=="")||((g.getCursorPosition()===0)&&!g.hasSelectedText()))){var h=(d.getCount()>0)?k.indexOf(d.getLastSelected()||d.getLastFocused()):-1;if((i==f.BACKSPACE)||(i==f.DELETE)){if(h>-1){if(d.getCount()>1){h=-1;}g.valueStore.remove(d.getSelection());}else{g.valueStore.remove(g.valueStore.last());}d.clearSelections();g.setValue(g.valueStore.getRange());if(h>0){d.select(h-1);}b=true;}else{if((i==f.RIGHT)||(i==f.LEFT)){if((h==-1)&&(i==f.LEFT)){d.select(k.last());b=true;}else{if(h>-1){if(i==f.RIGHT){if(h<(k.getCount()-1)){d.select(h+1,f.shiftKey);b=true;}else{if(!f.shiftKey){d.setLastFocused(null);d.deselectAll();b=true;}}}else{if((i==f.LEFT)&&(h>0)){d.select(h-1,f.shiftKey);b=true;}}}}}else{if(i==f.A&&f.ctrlKey){d.selectAll();b=f.A;}}}g.inputEl.focus();}}if(b){g.preventKeyUpEvent=b;f.stopEvent();return;}if(g.isExpanded&&(i==f.ENTER)&&g.picker.highlightedItem){g.preventKeyUpEvent=true;}if(g.enableKeyEvents){g.callParent(arguments);}if(!f.isSpecialKey()&&!f.hasModifier()){g.selectionModel.setLastFocused(null);g.selectionModel.deselectAll();g.inputEl.focus();}},onKeyUp:function(f,b){var c=this,d=Ext.String.htmlEncode(c.inputEl.dom.value);if(c.preventKeyUpEvent){f.stopEvent();if((c.preventKeyUpEvent===true)||(f.getKey()===c.preventKeyUpEvent)){delete c.preventKeyUpEvent;}return;}if(c.multiSelect&&(c.delimiterRegexp&&c.delimiterRegexp.test(d))||((c.createNewOnEnter===true)&&f.getKey()==f.ENTER)){d=Ext.Array.clean(d.split(c.delimiterRegexp));c.inputEl.dom.value="";c.setValue(c.valueStore.getRange().concat(d));c.inputEl.focus();}c.callParent([f,b]);},onPaste:function(g,b){var c=this,f=c.inputEl.dom.value,d=(g&&g.browserEvent&&g.browserEvent.clipboardData)?g.browserEvent.clipboardData:false;if(c.multiSelect&&(c.delimiterRegexp&&c.delimiterRegexp.test(f))){if(d&&d.getData){if(/text\/plain/.test(d.types)){f=d.getData("text/plain");}else{if(/text\/html/.test(d.types)){f=d.getData("text/html");}}}f=Ext.Array.clean(f.split(c.delimiterRegexp));c.inputEl.dom.value="";c.setValue(c.valueStore.getRange().concat(f));c.inputEl.focus();
}},onExpand:function(){var c=this,b=c.listKeyNav;c.callParent(arguments);if(b||!c.filterPickList){return;}b=c.listKeyNav;b.highlightAt=function(f){var e=this.boundList,g=e.all.item(f),d=e.all.getCount(),h;if(g&&g.hasCls("x-boundlist-selected")){if((f==0)||!e.highlightedItem||(e.indexOf(e.highlightedItem)<f)){h=1;}else{h=-1;}do{f=f+h;g=e.all.item(f);}while((f>0)&&(f<d)&&g.hasCls("x-boundlist-selected"));if(g.hasCls("x-boundlist-selected")){return;}}if(g){g=g.dom;e.highlightItem(g);e.getTargetEl().scrollChildIntoView(g,false);}};},onTypeAhead:function(){var g=this,f=g.displayField,i=g.inputEl.dom,k=g.valueStore,j=g.getPicker(),d,b,e,c;if(g.filterPickList){var h=this.createFilterFn(f,i.value);d=g.store.findBy(function(l){return((k.indexOfId(l.getId())===-1)&&h(l));});d=(d===-1)?false:g.store.getAt(d);}else{d=g.store.findRecord(f,i.value);}if(d){b=d.get(f);e=b.length;c=i.value.length;j.highlightItem(j.getNode(d));if(c!==0&&c!==e){i.value=b;g.selectText(c,b.length);}}},onItemListClick:function(b,d,f){var e=this,c=b.getTarget(".x-boxselect-item"),g=c?b.getTarget(".x-boxselect-item-close"):false;if(e.readOnly||e.disabled){return;}b.stopPropagation();if(c){if(g){e.removeByListItemNode(c);if(e.valueStore.getCount()>0){e.fireEvent("select",e,e.valueStore.getRange());}}else{e.toggleSelectionByListItemNode(c,b.shiftKey);}e.inputEl.focus();}else{if(e.selectionModel.getCount()>0){e.selectionModel.setLastFocused(null);e.selectionModel.deselectAll();}if(e.triggerOnClick){e.onTriggerClick();}}},getMultiSelectItemMarkup:function(){var b=this;if(!b.multiSelectItemTpl){if(!b.labelTpl){b.labelTpl=Ext.create("Ext.XTemplate","{[values."+b.displayField+"]}");}else{if(Ext.isString(b.labelTpl)||Ext.isArray(b.labelTpl)){b.labelTpl=Ext.create("Ext.XTemplate",b.labelTpl);}}b.multiSelectItemTpl=['<tpl for=".">','<li class="x-boxselect-item ','<tpl if="this.isSelected(values.'+b.valueField+')">'," selected","</tpl>",'" qtip="{[typeof values === "string" ? values : values.'+b.displayField+']}">','<div class="x-boxselect-item-text">{[typeof values === "string" ? values : this.getItemLabel(values)]}</div>','<div class="x-tab-close-btn x-boxselect-item-close"></div>',"</li>","</tpl>",{compile:true,disableFormats:true,isSelected:function(d){var c=b.valueStore.findExact(b.valueField,d);if(c>=0){return b.selectionModel.isSelected(b.valueStore.getAt(c));}return false;},getItemLabel:function(c){return b.getTpl("labelTpl").apply(c);}}];}return this.getTpl("multiSelectItemTpl").apply(Ext.Array.pluck(this.valueStore.getRange(),"data"));},applyMultiselectItemMarkup:function(){var d=this,b=d.itemList,c;if(b){while((c=d.inputElCt.prev())!=null){c.remove();}d.inputElCt.insertHtml("beforeBegin",d.getMultiSelectItemMarkup());}Ext.Function.defer(function(){if(d.picker&&d.isExpanded){d.alignPicker();}if(d.hasFocus&&d.inputElCt&&d.listWrapper){d.inputElCt.scrollIntoView(d.listWrapper);}},15);},getRecordByListItemNode:function(c){var e=this,d=0,b=e.itemList.dom.firstChild;while(b&&b.nextSibling){if(b==c){break;}d++;b=b.nextSibling;}d=(b==c)?d:false;if(d===false){return false;}return e.valueStore.getAt(d);},toggleSelectionByListItemNode:function(c,e){var d=this,f=d.getRecordByListItemNode(c),b=d.selectionModel;if(f){if(b.isSelected(f)){if(b.isFocused(f)){b.setLastFocused(null);}b.deselect(f);}else{b.select(f,e);}}},removeByListItemNode:function(b){var c=this,d=c.getRecordByListItemNode(b);if(d){c.valueStore.remove(d);c.setValue(c.valueStore.getRange());}},getRawValue:function(){var c=this,d=c.inputEl,b;c.inputEl=false;b=c.callParent(arguments);c.inputEl=d;return Ext.String.htmlDecode(b);},setRawValue:function(d){d=Ext.String.htmlEncode(d);var c=this,e=c.inputEl,b;c.inputEl=false;b=c.callParent([d]);c.inputEl=e;return b;},addValue:function(c){c=Ext.String.htmlEncode(c);var b=this;if(c){b.setValue(Ext.Array.merge(b.value,Ext.Array.from(c)));}},removeValue:function(c){c=Ext.String.htmlDecode(c);var b=this;if(c){b.setValue(Ext.Array.difference(b.value,Ext.Array.from(c)));}},setValue:function(m,c,n){var l=this,p=l.valueStore,o=l.valueField,g,j,e,b,f,k=[];if(Ext.isEmpty(m)){m=null;}if(Ext.isString(m)&&l.multiSelect){m=m.split(l.delimiter);}m=Ext.Array.from(m,true);for(e=0,j=m.length;e<j;e++){g=m[e];if(!g||!g.isModel){b=p.findExact(o,g);if(b>=0){m[e]=p.getAt(b);}else{b=l.findRecord(o,g);if(!b){if(l.forceSelection){k.push(g);}else{b={};b[l.valueField]=g;b[l.displayField]=g;b=new l.valueStore.model(b);}}if(b){m[e]=b;}}}}if((n!==true)&&(k.length>0)&&(l.queryMode==="remote")){var d={};d[l.valueParam||l.valueField]=k.join(l.delimiter);l.store.load({params:d,callback:function(){if(l.itemList){l.itemList.unmask();}l.setValue(m,c,true);l.autoSize();l.lastQuery=false;}});return false;}if(!l.multiSelect&&(m.length>0)){for(e=m.length-1;e>=0;e--){if(m[e].isModel){m=m[e];break;}}if(Ext.isArray(m)){m=m[m.length-1];}}return l.callParent([m,c]);},getValueRecords:function(){return this.valueStore.getRange();},getSubmitData:function(){var b=this,c=b.callParent(arguments);if(b.multiSelect&&b.encodeSubmitValue&&c&&c[b.name]){c[b.name]=Ext.encode(c[b.name]);
}return c;},mimicBlur:function(){var b=this;if(b.selectOnTab&&b.picker&&b.picker.highlightedItem){b.inputEl.dom.value="";}b.callParent(arguments);},assertValue:function(){var b=this,d=b.inputEl.dom.value,e=!Ext.isEmpty(d)?b.findRecordByDisplay(d):false,c=false;if(!e&&!b.forceSelection&&b.createNewOnBlur&&!Ext.isEmpty(d)){c=d;}else{if(e){c=e;}}if(c){b.addValue(c);}b.inputEl.dom.value="";b.collapse();},checkChange:function(){var f=this,h=f.valueStore,j=h.getRange(),g=f.value;var e=[];SVMX.array.forEach(f.valueModels,function(i){i.data.name=i.data.name.replace(/^\s+|\s+$/g,"");});var b={};for(var d=0;d<f.valueModels.length;d++){if(f.valueModels[d].data.name!=""&&!(b[f.valueModels[d].data.name.toUpperCase()])){b[f.valueModels[d].data.name.toUpperCase()]=f.valueModels[d];}}f.valueModels=new Array();for(var c in b){f.valueModels.push(b[c]);}if((Ext.encode(g)!==Ext.encode(f.lastValue))||(Ext.isArray(g)&&(j.length!=g.length))){h.suspendEvents();h.removeAll();f.value=g;if(Ext.isArray(f.valueModels)){h.add(f.valueModels);}h.resumeEvents();h.fireEvent("datachanged",h);}f.callParent(arguments);},isEqual:function(j,h){var c=Ext.Array.from,d=this.valueField,e,b,g,f;j=c(j);h=c(h);b=j.length;if(b!==h.length){return false;}for(e=0;e<b;e++){g=j[e].isModel?j[e].get(d):j[e];f=h[e].isModel?h[e].get(d):h[e];if(g!==f){return false;}}return true;},applyEmptyText:function(){var c=this,b=c.emptyText,d,e;if(c.rendered&&b){e=Ext.isEmpty(c.value)&&!c.hasFocus;d=c.inputEl;if(e){d.dom.value="";c.emptyEl.update(b);c.emptyEl.addCls(c.emptyCls);c.emptyEl.removeCls(c.emptyInputCls);c.listWrapper.addCls(c.emptyCls);c.inputEl.addCls(c.emptyInputCls);}else{c.emptyEl.addCls(c.emptyInputCls);c.emptyEl.removeCls(c.emptyCls);c.listWrapper.removeCls(c.emptyCls);c.inputEl.removeCls(c.emptyInputCls);}c.autoSize();}},preFocus:function(){var c=this,d=c.inputEl,b=c.emptyText,e=(d.dom.value=="");c.emptyEl.addCls(c.emptyInputCls);c.emptyEl.removeCls(c.emptyCls);c.listWrapper.removeCls(c.emptyCls);c.inputEl.removeCls(c.emptyInputCls);if(c.selectOnFocus||e){d.dom.select();}},onFocus:function(){var d=this,c=d.focusCls,b=d.itemList;if(c&&b){b.addCls(c);}d.callParent(arguments);},onBlur:function(){var d=this,c=d.focusCls,b=d.itemList;if(c&&b){b.removeCls(c);}d.callParent(arguments);},renderActiveError:function(){var e=this,d=e.invalidCls,c=e.itemList,b=e.hasActiveError();if(d&&c){c[b?"addCls":"removeCls"](e.invalidCls+"-field");}e.callParent(arguments);},autoSize:function(){var c=this,b;if(c.grow&&c.rendered){c.autoSizing=true;c.updateLayout();}return c;},afterComponentLayout:function(){var c=this,b;if(c.autoSizing){height=c.getHeight();if(height!==c.lastInputHeight){if(c.isExpanded){c.alignPicker();}c.fireEvent("autosize",c,height);c.lastInputHeight=height;delete c.autoSizing;}}}});Ext.define("Ext.ux.layout.component.field.BoxSelectField",{alias:["layout.boxselectfield"],extend:"Ext.layout.component.field.Trigger",type:"boxselectfield",waitForOuterWidthInDom:true,beginLayout:function(d){var c=this,b=c.owner;c.callParent(arguments);d.inputElCtContext=d.getEl("inputElCt");b.inputElCt.setStyle("width","");c.skipInputGrowth=!b.grow||!b.multiSelect;},beginLayoutFixed:function(e,c,f){var d=this,b=e.target;b.triggerEl.setStyle("height","24px");d.callParent(arguments);if(e.heightModel.fixed&&e.lastBox){b.listWrapper.setStyle("height",e.lastBox.height+"px");b.itemList.setStyle("height","100%");}},publishInnerWidth:function(f){var e=this,b=e.owner,d=b.itemList.getWidth(true)-10,c=b.inputElCt.prev(null,true);if(c&&!b.stacked){c=Ext.fly(c);d=d-c.getOffsetsTo(c.up(""))[0]-c.getWidth();}if(!e.skipInputGrowth&&(d<35)){d=d-10;}else{if(d<1){d=1;}}f.inputElCtContext.setWidth(d);}});};})();(function(){var a=SVMX.Package("com.servicemax.client.qbm.ui.desktop.editQuestion");a.init=function(){var b=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("CQL");Ext.define("com.servicemax.client.qbm.ui.desktop.editQuestion.EditQuestionPanel",{extend:"Ext.form.FormPanel",__actionType:null,constructor:function(c){c=Ext.apply({layout:"anchor",defaultType:"textfield",bodyPadding:25,autoScroll:true,border:false,defaults:{anchor:"100%"},fieldDefaults:{labelAlign:"top",labelWidth:100},},c||{});this.callParent([c]);},initComponent:function(){this.callParent(arguments);var k=this;Ext.define("State",{extend:"Ext.data.Model",fields:[{type:"string",name:"name"},]});var i=Ext.create("Ext.data.Store",{model:"State",data:[],proxy:{type:"memory"}});this.__tagstore=i;var d=Ext.create("com.servicemax.client.qbm.ui.desktop.boxselect.BoxSelect",{fieldLabel:b.T("TAG024","Tags"),displayField:"name",name:"TagField",id:"tagsList",anchor:"50%",multiSelect:true,forceSelection:false,hideTrigger:true,editable:true,store:i,queryMode:"local",createNewOnEnter:true,createNewOnBlur:true,filterPickList:true,triggerOnClick:false,pinList:false,delimiter:",",});k.add({fieldLabel:b.T("TAG025","Question Text"),name:"questionText",id:SVMX.OrgNamespace+"__Question__c",anchor:"50%",allowBlank:false,padding:"0 0 15",blankText:b.T("TAG054","This field is required")});
k.add({fieldLabel:"Question ID",name:"questionId",id:SVMX.OrgNamespace+"__QuestionID__c",anchor:"50%",padding:"0 0 15",hidden:"true"});k.add({fieldLabel:b.T("TAG051","Default Answer"),name:"defaultResponseText",id:"defaultResponseText",anchor:"50%",padding:"0 0 15",xtype:"textfield",maxLength:255,enforceMaxLength:true});k.add({fieldLabel:b.T("TAG051","Default Answer"),name:"defaultResponseNumber",id:"defaultResponseNumber",anchor:"50%",padding:"0 0 15",xtype:"numberfield",hidden:"true",enforceMaxLength:true,maxLength:14});var g=SVMX.create("Ext.data.Store",{fields:["value","label"],data:{items:[{label:b.T("COMM002","Value"),value:"Value"},{label:b.T("COMM001","Function"),value:"Function",}]},proxy:{type:"memory",reader:{type:"json",root:"items"}}});var c={xtype:"combobox",padding:"0 0 15",id:"valueFunctionCombo",name:"valueFunctionCombo",fieldLabel:b.T("TAG051","Default Answer"),labelField:"label",valueField:"value",displayField:"label",defaultValue:"Value",value:"Value",queryMode:"local",editable:false,anchor:"50%",store:g,hidden:true,listeners:{change:function(r,q,p){var s=Ext.getCmp("defaultResponseDate");var o=Ext.getCmp("literalCombo");if(q==="Value"){o.hide();s.reset();s.show();}else{if(q==="Function"){s.hide();o.reset();o.show();}}},afterrender:function(o){o.setValue(this.defaultValue);}},listConfig:{getInnerTpl:function(o){return"{[Ext.String.htmlEncode(values."+o+")]}";}},};var l={xtype:"datefield",name:"defaultResponseDate",id:"defaultResponseDate",anchor:"50%",padding:"0 0 15",editable:false,hidden:true,};var h=Ext.create("Ext.data.Store",{fields:["value","label","type"],data:{items:[{label:b.T("COMM004","Today"),value:"Today",type:"DateAns"},{label:b.T("COMM005","Tomorrow"),value:"Tomorrow",type:"DateAns"},{label:b.T("COMM006","Yesterday"),value:"Yesterday",type:"DateAns"},{label:b.T("COMM007","Now"),value:"Now",type:"DateTimeAns"}]},proxy:{type:"memory",reader:{type:"json",root:"items"}},sorters:[{property:"label",direction:"ASC"}]});var n={xtype:"combobox",padding:"0 0 15",id:"literalCombo",name:"literalCombo",labelField:"label",valueField:"value",displayField:"label",queryMode:"local",editable:false,anchor:"50%",store:h,hidden:true,emptyText:b.T("COMM003","Select"),listeners:{expand:function(p){var o=Ext.getCmp(SVMX.OrgNamespace+"__Response_Type__c").getValue();if(o!==null&&o!==""&&o==="Date"){p.store.filter("type","DateAns");}}},listConfig:{getInnerTpl:function(o){return"{[Ext.String.htmlEncode(values."+o+")]}";}},};k.add(c);k.add(l);k.add(n);k.add({fieldLabel:b.T("TAG044","Help URL"),name:"helpURL",id:SVMX.OrgNamespace+"__Help_URL__c",anchor:"50%",padding:"0 0 15"});var f=SVMX.create("Ext.data.ArrayStore",{fields:["Id","response_Type"],data:[["Text",b.T("TAG026","Text")],["Checkbox",b.T("TAG027","Checkbox")],["Radio Button",b.T("TAG028","Radio Button")],["Picklist",b.T("TAG029","Picklist")],["Multi-select Picklist",b.T("TAG030","Multi-select Picklist")],["Number",b.T("TAG031","Number")],["DateTime",b.T("TAG032","DateTime")],["Date",b.T("TAG033","Date")],["Attachment",b.T("TAG048","Attachment")]],sorters:[{property:"response_Type",direction:"ASC"}]});this.__responseTypeDropDown=k.add({xtype:"combobox",padding:"0 0 15",id:SVMX.OrgNamespace+"__Response_Type__c",name:"response_Type",fieldLabel:b.T("TAG034","Answer Type"),labelField:"label",valueField:"Id",displayField:"response_Type",defaultValue:"Text",value:"Text",queryMode:"local",editable:false,anchor:"50%",store:f,listeners:{change:function(r,q,o){var p=Ext.getCmp("literalCombo");if(p!=null){p.store.clearFilter();}if(q==="Checkbox"||q==="Picklist"||q==="Multi-select Picklist"||q==="Radio Button"){k.showHideResponseSetDropDown(true);k.showResponseOptions(true);k.showHideNewResponseSetName(true);}else{k.showHideResponseSetDropDown(false);k.showResponseOptions(false);k.showHideNewResponseSetName(false);}if(q==="Attachment"){k.showHideOpdocDescriptionFields(true);}else{k.showHideOpdocDescriptionFields(false);}k.hideAllDefaultAnsCmp();if(q==="Text"||q==="Number"||q==="Date"||q==="DateTime"){switch(q){case"Text":k.resetAndShowCmp("defaultResponseText");break;case"Number":k.resetAndShowCmp("defaultResponseNumber");break;case"Date":case"DateTime":k.resetAndShowCmp("valueFunctionCombo");k.resetAndShowCmp("defaultResponseDate");break;}}if(q==="Attachment"){Ext.getCmp("clearDefault").hide();}else{Ext.getCmp("clearDefault").show();}},afterrender:function(o){o.setValue(this.defaultValue);}},listConfig:{getInnerTpl:function(o){return"{[Ext.String.htmlEncode(values."+o+")]}";}},});k.add({xtype:"checkbox",boxLabel:b.T("TAG049","Include in Output Document"),name:"includeInOpDoc",id:SVMX.OrgNamespace+"__SM_Show_In_Smart_Doc__c",anchor:"50%",padding:"0 0 15",hidden:true});k.add({xtype:"checkbox",boxLabel:b.T("TAG050","Description required"),name:"descriptionRequired",id:SVMX.OrgNamespace+"__SM_Description_Required__c",anchor:"50%",padding:"0 0 15",hidden:true});var j=SVMX.create("Ext.data.ArrayStore",{fields:["Id","responseSetName","responseSetValues"],data:[]});
this.__responseSetStore=j;this.__responseSetDropDown=k.add({xtype:"combobox",padding:"0 0 15",hidden:"true",id:SVMX.OrgNamespace+"__Response_Set__c",name:"responseSetName",fieldLabel:b.T("TAG035","Response Set"),labelField:"label",valueField:"Id",displayField:"responseSetName",defaultValue:"CreateNew",value:"CreateNew",queryMode:"local",editable:false,anchor:"50%",store:j,listeners:{change:function(v,u,p){if(u==="CreateNew"){k.showHideNewResponseSetName(true);k.__activeRecord.responseOptions=[""];k.showResponseOptions(true);}else{var r=[""];var o=k.__responseSetDropDown.store;var t=o.data.items||[];for(var q=0;q<t.length;q++){var s=t[q].data;if(s.Id===u){k.__newResponseSetName.setValue(s.responseSetName);r=s.responseSetValues&&s.responseSetValues.split(";");if(r&&r.length>0){r.splice(r.length-1,1);}break;}}k.__activeRecord.responseOptions=r;k.showResponseOptions(true);}},afterrender:function(o){}},listConfig:{getInnerTpl:function(o){return"{[Ext.String.htmlEncode(values."+o+")]}";}}});this.__newResponseSetName=k.add({fieldLabel:b.T("TAG036","Response Set Name"),name:"newResponseSetName",id:"Name",anchor:"50%",allowBlank:false,padding:"0 0 15",blankText:b.T("TAG054","This field is required")});k.add(d);var m=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXButton",{id:"clearDefault",text:b.T("TAG052","Clear Default"),__parent:this,style:{marginLeft:"0px",marginRight:"0px",marginTop:"10px",marginBottom:"5px"},handler:function(){var o=Ext.getCmp(SVMX.OrgNamespace+"__Response_Type__c").getValue();switch(o){case"Text":Ext.getCmp("defaultResponseText").reset();break;case"Number":Ext.getCmp("defaultResponseNumber").reset();break;case"Date":case"DateTime":Ext.getCmp("valueFunctionCombo").reset();Ext.getCmp("defaultResponseDate").reset();Ext.getCmp("literalCombo").reset();break;case"Radio Button":case"Picklist":var s=this.__parent.__responseOptionsPanel.__fields,p=s.length;for(var r=0;r<p;r++){var v=s[r].radioField.getId();if(v!=null){var q=Ext.getCmp(v);if(q){q.setValue(false);}}}case"Multi-select Picklist":case"Checkbox":var s=this.__parent.__responseOptionsPanel.__fields,p=s.length;for(var r=0;r<p;r++){var u=s[r].checkboxField.getId();if(u!=null){var t=Ext.getCmp(u);if(t){t.setValue(false);}}}}}});var e=Ext.create("Ext.form.Panel",{layout:"vbox",border:false,anchor:"50%"});e.add(m);k.add(e);this.radioButton=k.add({xtype:"radiogroup",id:"operationTypeCmp",columns:1,vertical:true,items:[{boxLabel:b.T("TAG037","Update library (all checklists using this question will be updated)"),name:"Operationtype",inputValue:"SAVE",checked:true},{boxLabel:b.T("TAG038","Save as a new question in the library"),name:"Operationtype",inputValue:"SAVEAS"}],listeners:{change:function(q,r,o,p){k.__actionType=r.Operationtype;}}});this.showResponseOptions();},hideAllDefaultAnsCmp:function(){Ext.getCmp("defaultResponseText").hide();Ext.getCmp("defaultResponseNumber").hide();Ext.getCmp("valueFunctionCombo").hide();Ext.getCmp("defaultResponseDate").hide();Ext.getCmp("literalCombo").hide();},resetAndShowCmp:function(d){var c=Ext.getCmp(d);c.reset();c.show();},showHideOpdocDescriptionFields:function(c){var e=Ext.getCmp(SVMX.OrgNamespace+"__SM_Show_In_Smart_Doc__c");var d=Ext.getCmp(SVMX.OrgNamespace+"__SM_Description_Required__c");if(c){e.setValue(true);d.setValue(true);e.show();d.show();}else{e.setValue(false);d.setValue(false);e.hide();d.hide();}},showHideResponseSetDropDown:function(c){if(c){this.__responseSetDropDown.reset();this.__responseSetDropDown.show();}else{this.__responseSetDropDown.hide();}},showHideNewResponseSetName:function(c){if(c){this.__newResponseSetName.reset();this.__newResponseSetName.show();}else{this.__newResponseSetName.hide();}},showResponseOptions:function(c){if(this.__responseOptionsPanel){this.__responseOptionsPanel.destroy();}if(!c){return;}this.__responseOptionsPanel=SVMX.create("com.servicemax.client.qbm.ui.desktop.editQuestion.ResponseOptionsPanel",{data:(this.__activeRecord&&this.__activeRecord.responseOptions)||null,defaultValueForRadio:(this.__activeRecord&&this.__activeRecord.defaultValueForRadio)||null,defaultValueForCheckbox:(this.__activeRecord&&this.__activeRecord.defaultValueForCheckbox)||null});var d=(!this.radioButton.hidden&&this.items.length-3)||this.items.length-3;this.add(d,this.__responseOptionsPanel);},loadQuestionDataInEditMode:function(e,c){this.resetComponentData();if(c&&c[SVMX.OrgNamespace+"__Response_Type__c"]&&c[SVMX.OrgNamespace+"__Response_Type__c"]==="Attachment"){this.showHideOpdocDescriptionFields(true);}else{this.showHideOpdocDescriptionFields(false);}this.showHideNewResponseSetName(false);if(!e){this.showResponseOptions(false);this.showHideResponseSetDropDown(false);}this.hideAllDefaultAnsCmp();this.resetAndShowCmp("defaultResponseText");var d=c&&c[SVMX.OrgNamespace+"__Response_Type__c"]&&c[SVMX.OrgNamespace+"__Response_Type__c"];if(d==="Date"||d==="DateTime"){this.resetAndShowCmp("valueFunctionCombo");if(c.valueFunctionCombo&&c.valueFunctionCombo==="Value"){this.resetAndShowCmp("defaultResponseDate");
}else{if(c.valueFunctionCombo&&c.valueFunctionCombo==="Function"){this.resetAndShowCmp("literalCombo");}}}if(d==="Attachment"){Ext.getCmp("clearDefault").hide();}else{Ext.getCmp("clearDefault").show();}this.__activeRecord=c;this.getForm().setValues(c);if(c&&c[SVMX.OrgNamespace+"__Response_Type__c"]&&c[SVMX.OrgNamespace+"__Response_Type__c"]==="Text"){this.showResponseOptions(false);}if(e){this.__actionType="SAVE";}else{this.__actionType="SAVEAS";}},resetComponentData:function(){Ext.getCmp(SVMX.OrgNamespace+"__Question__c").reset();Ext.getCmp(SVMX.OrgNamespace+"__QuestionID__c").reset();Ext.getCmp("defaultResponseText").reset();Ext.getCmp("defaultResponseNumber").reset();Ext.getCmp("valueFunctionCombo").reset();Ext.getCmp("defaultResponseDate").reset();Ext.getCmp("literalCombo").reset();Ext.getCmp(SVMX.OrgNamespace+"__Help_URL__c").reset();Ext.getCmp(SVMX.OrgNamespace+"__SM_Show_In_Smart_Doc__c").reset();Ext.getCmp(SVMX.OrgNamespace+"__SM_Description_Required__c").reset();Ext.getCmp(SVMX.OrgNamespace+"__Response_Type__c").reset();Ext.getCmp("tagsList").reset();Ext.getCmp("operationTypeCmp").reset();},getData:function(){var c=this.getForm().getFieldValues();c.Operationtype=this.__actionType;if(this.__actionType==="SAVE"){c.Id=this.__activeRecord.Id;}return c;},resetData:function(){this.getForm().reset();},getActionType:function(){return this.__actionType;}});Ext.define("com.servicemax.client.qbm.ui.desktop.editQuestion.ResponseOptionsPanel",{extend:"Ext.form.FieldSet",constructor:function(c){c=Ext.apply({title:b.T("TAG039","Answer Values"),layout:"vbox",border:true,anchor:"50%"},c||{});this.callParent([c]);},initComponent:function(){this.callParent(arguments);var g=this;this.__addButton=g.add({xtype:"button",text:"+"+b.T("TAG040","Add Answer"),anchor:"10%",margins:"8 8",disabled:true,listeners:{click:function(){g.addOption();g.__addButton.setDisabled(true);g.__disableDeleteButton();}}});this.__fields=[];var d=this.defaultValueForRadio;var j=this.defaultValueForCheckbox;var h=this.data||[""],e,c=h.length,f;for(e=0;e<c;e++){f=h[e];g.addOption(f,d,j);}this.__disableDeleteButton();},addOption:function(q,n,j){var o=this;q=q||"";var f=false;if(q===n){f=true;}var k=Ext.getCmp(SVMX.OrgNamespace+"__Response_Type__c").getValue();var c=false;if(j!=null&&j.length>0){var l=j.length;for(var h=0;h<l;h++){if(q===j[h]){c=true;break;}}}var e=this.add(this.items.length-1,{layout:"hbox",width:"100%",border:false,flex:1,padding:"8 8"});var g=e.add({xtype:"textfield",name:"answers",flex:0.9,allowBlank:false,padding:"0 5",blankText:b.T("TAG054","This field is required"),value:q,listeners:{change:function(){var i=Ext.getCmp(SVMX.OrgNamespace+"__Response_Type__c").getValue();if(i==="Radio Button"||i==="Picklist"){o.__setValueOfRadio();}o.__addButton.setDisabled(!o.__isValid());}}});var m=Ext.create("Ext.form.field.Checkbox",{name:"defaultAnsForCheckbox",boxLabel:b.T("TAG053","Default"),value:q,checked:c});if(k==="Checkbox"||k==="Multi-select Picklist"){e.add(m);}var p=Ext.create("Ext.form.field.Radio",{xtype:"radiofield",name:"defaultAnsForRadio",boxLabel:b.T("TAG053","Default"),inputValue:q,checked:f,listeners:{change:function(s,t,i,r){o.__setValueOfRadio();}}});if(k==="Radio Button"||k==="Picklist"){e.add(p);}var d=e.add({xtype:"button",name:"del",text:"X",flex:0.1,margin:"0 0 0 5",listeners:{click:function(){e.destroy();o.__disableDeleteButton(true);}}});this.__fields.push({fld:g,btn:d,radioField:p,checkboxField:m});},__setValueOfRadio:function(){var d=this.__fields,c=d.length;for(var e=0;e<c;e++){d[e].radioField.inputValue=d[e].fld.getValue();}},__isValid:function(){var d=this.__fields,e,c=d.length,f;for(e=0;e<c;e++){f=d[e];if(f&&!f.fld.isDestroyed&&!f.fld.getValue()){return false;}}return true;},__disableDeleteButton:function(){var d=this.__fields,f,c=d.length,h,e,g=0;for(f=0;f<c;f++){h=d[f];if(h&&!h.btn.isDestroyed){h.btn.setDisabled(false);if(!g){e=h.btn;}g++;}}if(g===1&&e){e.setDisabled(true);}this.__addButton.setDisabled(!this.__isValid());}});};})();(function(){var a=SVMX.Package("com.servicemax.client.qbm.ui.desktop.impl");a.Class("Module",com.servicemax.client.lib.api.ModuleActivator,{__constructor:function(){this.__base();},beforeInitialize:function(){},initialize:function(){},afterInitialize:function(){com.servicemax.client.qbm.ui.desktop.api.init();com.servicemax.client.qbm.ui.desktop.editQuestion.init();com.servicemax.client.qbm.ui.desktop.boxselect.init();}},{instance:null});})();