(function(){var a=SVMX.Package("com.servicemax.client.entitlement.ui.desktop.api.entitlement");a.init=function(){var b=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("ENTITLEMENT");Ext.define("com.servicemax.client.entitlement.ui.desktop.api.EntitlementPanel",{extend:"com.servicemax.client.ui.components.composites.impl.SVMXSection",width:"100%",height:"100%",border:false,id:"workDetailPannel",constructor:function(c){this.callParent([c]);},initComponent:function(){this.callParent(arguments);var g=this;Ext.define("DetailLines",{extend:"Ext.data.Model",fields:[{name:"selectEntitlementName"},{name:"productName"},{name:"recordName"},{name:"installedBaseName"},{name:"description"},{name:"selectedEntitlementInfo",type:"object"},{name:"updatedEntitlementInfo",type:"object"},{name:"recordID"},{name:"entitlementPerformed"},{name:"listEntitlementInfo",type:"object"}]});var i=this.__entitlementSelectionWindow=SVMX.create("Ext.window.Window",{id:"entitlementSelectionWindow",layout:"anchor",border:false,title:b.T("TAG072","Select Warranty/Contract"),header:{titleAlign:"center",},closable:true,hidden:true,closeAction:"hide",width:"60%",__parentWin:g,resizable:false,overflowY:"auto",cls:"entitlement-root-container",listeners:{beforehide:function(k,j){var l=Ext.getCmp("selectionWindowTab");l.items.items[0].setVisible(true);Ext.getCmp("entHisPanel").loadEntHis([]);l.items.each(function(n,m){if(m!=0&&m!=1){l.remove(n);}});},hide:function(k,j){k.hide();Ext.getCmp("selectEntBtn").setDisabled(true);k.__parentWin.enable();}}});g.add(i);var d=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXToolbar",{width:"100%",dock:"bottom",border:false,style:"margin-top: 20px",});var f=SVMX.create("Ext.Toolbar.Fill",{});d.add(f);var h=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXButton",{text:b.T("TAG021","Select"),id:"selectEntBtn",disabled:true,scale:"medium",height:30,handler:function(k,m){var o={};var l=Ext.getCmp("entitlementSelection");o.recordID=l.__parentData.recordID;o.entitlementInfo=l.__selectedEntitlement;l.__parentData.selectedPSEntitlement=o;l.__selectedEntitlement=null;var n=Ext.getCmp("saveEnttoDatabase");n.setDisabled(false);k.setDisabled(true);i.hide();i.__parentWin.enable();var j=i.__workdetailSelected;j.set("updatedEntitlementInfo",l.__parentData.selectedPSEntitlement.entitlementInfo);j.store.fireEvent("refresh");}});d.add(h);var e=20;g.workDetailstore=SVMX.create("Ext.data.Store",{model:"DetailLines",data:[],storeId:"entitlement_store",autoLoad:false,pageSize:e,proxy:{type:"memory",reader:{type:"array",root:"data",totalProperty:"total"}},allData:[],listeners:{beforeload:function(r,j,o){var m=this.allData||[];var q=j.start;var k=j.limit;var s=m.slice(q,q+k);var n=[];for(var l=0;l<s.length;l++){var p=Ext.create("DetailLines",s[l]);n.push(p);}r.proxy.data={data:n,total:m.length,};}}});var c=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXListComposite",{autoScroll:true,maxHeight:450,margin:"5 10",anchor:"100%",store:g.workDetailstore,border:false,emptyText:b.T("TAG077","No valid Products Serviced lines to display"),viewConfig:{deferEmptyText:false,},columns:[{xtype:"rownumberer",text:b.T("TAG080","No."),align:"left",flex:1/5},{flex:1,text:b.T("TAG045","Warranties/Service Contracts"),dataIndex:"selectEntitlementName",align:"left",resizable:true,readOnly:true,renderer:function(o,n,j,p,l,k){var m="";if(j.data.updatedEntitlementInfo!=""&&j.data.updatedEntitlementInfo!=undefined){m=j.data.updatedEntitlementInfo.recordName!=undefined?j.data.updatedEntitlementInfo.recordName:b.T("TAG068","Not Covered");n.tdCls="svmx-ent-uncommitedChanges";}else{if((j.data.selectedEntitlementInfo!=null&&j.data.selectedEntitlementInfo!=undefined)&&j.data.entitlementPerformed){if(j.data.selectedEntitlementInfo.warrantyOrScon=="notcovered"){n.tdCls="svmx-ent-notCovered";m=b.T("TAG068","Not Covered");}else{m=j.data.selectedEntitlementInfo.recordName!=null?j.data.selectedEntitlementInfo.recordName:j.data.selectedEntitlementInfo.warrantyTermName;}}else{n.tdCls="svmx-ent-emptytext";n.style="font-style: italic !important";m=b.T("TAG081","Select for Contract/Warranty options");}}return Ext.String.htmlEncode(m);}},{flex:1,text:b.T("TAG073","Product"),dataIndex:"productName",align:"left",resizable:false,readOnly:true,sortable:true,renderer:function(n,m,j,o,l,k){return Ext.String.htmlEncode(n);}},{flex:1,text:b.T("TAG074","Installed Product"),dataIndex:"installedBaseName",align:"left",resizable:false,readOnly:true,sortable:true,renderer:function(n,m,j,o,l,k){return Ext.String.htmlEncode(n);}},{flex:1,text:b.T("TAG075","Description"),dataIndex:"description",align:"left",resizable:false,readOnly:true,sortable:false,renderer:function(n,m,j,o,l,k){return Ext.String.htmlEncode(n);}}],dockedItems:[{xtype:"pagingtoolbar",store:g.workDetailstore,dock:"bottom",displayInfo:false,layout:{pack:"center"},beforePageText:b.T("TAG079","Page"),listeners:{afterrender:function(){this.child("#refresh").hide();
}}}],listeners:{cellclick:function(l,p,k,j,m,o,n){i.add(g.__parent.showEntitlementSelectionPanel(i,j));i.add(d);i.show();i.__parentWin.disable();}}});g.add(c);},loadData:function(c){this.workDetailstore.allData=c;this.workDetailstore.loadPage(1);},});};})();