(function(){var a=SVMX.Package("com.servicemax.client.entitlement.ui.desktop.api.entitlementHistory");a.init=function(){var b=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("ENTITLEMENT");Ext.define("com.servicemax.client.entitlement.ui.desktop.api.EntitlementHistoryPanel",{extend:"com.servicemax.client.ui.components.composites.impl.SVMXSection",autoScroll:true,cls:"entitlement-root-container",id:"entHisPanel",constructor:function(c){this.callParent([c]);},initComponent:function(){this.callParent(arguments);var c=this;c.entHisStore=SVMX.create("Ext.data.Store",{fields:[{name:"warrantyOrSconName"},{name:"warrantyOrSconId"},{name:"startDate"},{name:"endDate"},{name:"slaTermName"},{name:"slaTermID"},{name:"dateOfEntitlement"},{name:"coveredBy"},{name:"recordId"},{name:"recordName"},],data:[],storeId:"entitlementHis_store",});var d=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXListComposite",{autoScroll:true,margin:"5 10",anchor:"100%",store:c.entHisStore,emptyText:b.T("TAG095","No Entitlement History Available"),border:false,id:"entHistoryGrid",height:330,viewConfig:{deferEmptyText:false,},columns:[{flex:1,text:b.T("TAG017","Entitlement History"),dataIndex:"recordName",resizable:true,readOnly:true,sortable:true,renderer:function(j,i,f,k,h,g){if(f.data.recordName!=null){return'<a class="entHistoryRecord" href="#">'+f.data.recordName+"</a>";}else{return" ";}}},{flex:1,text:b.T("TAG045","Warranties/Service Contracts"),dataIndex:"warrantyOrSconName",resizable:true,readOnly:true,sortable:true,renderer:function(j,i,f,k,h,g){if(f.data.warrantyOrSconName!=null){return'<a class="sconWarrantyRecord" href="#">'+Ext.String.htmlEncode(f.data.warrantyOrSconName)+"</a>";}else{return" ";}}},{flex:1,text:b.T("TAG055","SLA Terms"),dataIndex:"slaTermName",align:"center",resizable:false,readOnly:true,sortable:true,renderer:function(j,i,f,k,h,g){if(f.data.slaTermName!=null){return'<a class="slaRecord" href="#">'+Ext.String.htmlEncode(f.data.slaTermName)+"</a>";}else{return" ";}}},{flex:1,text:b.T("TAG052","Start Date"),dataIndex:"startDate",align:"center",resizable:false,readOnly:true,sortable:true,},{flex:1,text:b.T("TAG053","End Date"),dataIndex:"endDate",align:"center",resizable:false,readOnly:true,sortable:true,},{flex:1,text:b.T("TAG096","Date of Entitlement"),dataIndex:"dateOfEntitlement",align:"center",resizable:false,readOnly:true,hidden:true,sortable:true},],listeners:{cellclick:function(h,m,g,f,j,l,k){var i=h.store.getAt(l);k.preventDefault();if(k.getTarget("a.entHistoryRecord")){c.__parent.findDuplicateTab(Ext.getCmp("selectionWindowTab"),Ext.getCmp("entitlementSelection"),f.data.recordName,f.data.recordId);}if(k.getTarget("a.sconWarrantyRecord")){c.__parent.findDuplicateTab(Ext.getCmp("selectionWindowTab"),Ext.getCmp("entitlementSelection"),f.data.warrantyOrSconName,f.data.warrantyOrSconId);}if(k.getTarget("a.slaRecord")){c.__parent.findDuplicateTab(Ext.getCmp("selectionWindowTab"),Ext.getCmp("entitlementSelection"),f.data.slaTermName,f.data.slaTermID);}},}});c.add(d);var e=SVMX.create("com.servicemax.client.ui.components.composites.impl.SVMXToolbar",{width:"100%",dock:"bottom",border:false});},callEntHisWebservice:function(){var d=this;var c={};c.headerId=d.__parentRecordID;var e=d.__engine.getEntitlementHistory(c,function(f){if(f.headerRecord.entitlementHistoryMap!=null){d.loadEntHis(f.headerRecord.entitlementHistoryMap[c.headerId]);}});},loadEntHis:function(d){if(this.__parent.__parent.__showDetailView){var c=Ext.getCmp("entHistoryGrid");c.down("[dataIndex=slaTermName]").hide();}this.entHisStore.loadData(d);}});};})();