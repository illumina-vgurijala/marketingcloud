(function(){var a=SVMX.Package("com.servicemax.client.sal.sfmsearch.model.impl");a.Class("Module",com.servicemax.client.lib.api.ModuleActivator,{useJsr:false,__logger:null,__constructor:function(){this.__base();this.__self.instance=this;this.__logger=SVMX.getLoggingService().getLogger("SAL-SEARCH-MODEL");},beforeInitialize:function(){com.servicemax.client.sal.model.sfmsearchdelivery.operations.init();},initialize:function(){var b=SVMX.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr");if(b&&b===true){this.useJsr=true;this.__logger.info("JSR is enabled. Will use this for server communication.");}else{this.useJsr=false;}},setUserInfo:function(b){var d=SVMX.getClient().getServiceRegistry().getService("com.servicemax.client.cache").getInstance();var c=b.UserId+"-SFMSEARCHDELIVERY-USERLANGUAGE",f=d.getItem(c);if(f){if(f!=b.Language){this.__logger.info("User language OR User login has changed. Will clear cache");this.clearCache();}}if(UserContext){var e=UserContext.timeFormat;b.TimeFormat=e;}a.ModelState.getInstance().add("userInfo",b);d.setItem(c,b.Language);SVMX.getCurrentApplication().setUserInfo(b);},clearCache:function(){var b=SVMX.getClient().getServiceRegistry().getService("com.servicemax.client.cache");var c=b.getInstance();this.__logger.info("Clearing cache...");c.reset();},registerForSALEvents:function(b,c){if(!c){SVMX.getLoggingService().getLogger().warn("registerForSALEvents was invoked without operationObj!");}b.bind("REQUEST_ERROR",function(g){var d="";try{d+="::"+g.data.xhr.statusText+"=>"+g.data.xhr.responseText;}catch(f){}this.__logger.error(d);},this);},createServiceRequest:function(d,c){var b=SVMX.getClient().getServiceRegistry().getService("com.servicemax.client.sal.service.factory");b.getInstanceAsync({handler:function(e){var f=d.options||{};var h={type:f.type||"REST",endPoint:f.endPoint||"SFMSearchDeliveryServiceIntf",nameSpace:f.namespace===null?null:SVMX.OrgNamespace};var i=e.createServiceManager(h);var g=i.createService();this.registerForSALEvents(g,c);d.handler.call(d.context,g);},context:this});},checkResponseStatus:function(c,d,b,e){return true;}},{instance:null});a.Class("ModelState",com.servicemax.client.lib.api.Object,{__state:null,__constructor:function(){this.__state={};},add:function(b,c){this.__state[b]=c;},get:function(b){return this.__state[b];},remove:function(b){var d=null;try{d=this.__state[b];}catch(c){}this.__state[b]=null;return d;}},{getInstance:function(){if(this.__instance==null){this.__instance=new a.ModelState();}return this.__instance;},__instance:null});a.Class("PlatformSpecifics",com.servicemax.client.lib.api.Object,{__constructor:function(){},showRecord:function(c){var b=SVMX.getClient().getApplicationParameter("svmx-base-url")||"";if(b&&b.indexOf("/")!=0){b="/"+b;}SVMX.openInBrowserWindow(b+"/"+c.key+"?isdtp=");}},{});})();