(function(){var a=SVMX.Package("com.servicemax.client.sal.sfmconsole.model.impl");a.Class("Module",com.servicemax.client.lib.api.ModuleActivator,{useJsr:false,__constructor:function(){this.__base();this.__self.instance=this;this.__logger=SVMX.getLoggingService().getLogger("SAL-MODEL");},beforeInitialize:function(){},initialize:function(){var b=SVMX.getClient().getApplicationParameter("svmx-sfm-sal-model-use-jsr");if(b&&b===true){this.useJsr=true;this.__logger.info("JSR is enabled. Will use this for server communication.");}else{this.useJsr=false;}},afterInitialize:function(){com.servicemax.client.sal.model.sfmconsole.operations.init();},registerForSALEvents:function(b,c){if(!c){SVMX.getLoggingService().getLogger().warn("registerForSALEvents was invoked without operationObj!");}b.bind("REQUEST_ERROR",function(j){var f=c?c.getEventBus():SVMX.getCurrentApplication();var d=SVMX.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.CHANGE_APP_STATE",this,{request:{state:"unblock"},responder:{}});f.triggerEvent(d);var h=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("SFMDELIVERY");var g=h.T("TAG015");try{g+="::"+j.data.xhr.statusText+"=>"+j.data.xhr.responseText;}catch(i){}d=SVMX.create("com.servicemax.client.lib.api.Event","SFMDELIVERY.NOTIFY_APP_ERROR",this,{request:{message:g},responder:{}});f.triggerEvent(d);this.__logger.error(g);},this);},createServiceRequest:function(d,c){var b=SVMX.getClient().getServiceRegistry().getService("com.servicemax.client.sal.service.factory");b.getInstanceAsync({handler:function(e){var f=d.options||{};var h={type:f.type||"REST",endPoint:f.endPoint||"SFMDeliveryServiceIntf",nameSpace:f.namespace===null?null:SVMX.OrgNamespace};var i=e.createServiceManager(h);var g=i.createService();this.registerForSALEvents(g,c);d.handler.call(d.context,g);},context:this});},getErrorMessage:function(e){var c=true,d="",b="";if(e){if(e.response&&(e.response.success===false||e.response.success==="false")){c=false;if(e.response.msgDetails&&e.response.msgDetails.message){d=e.response.msgDetails.message;b=e.response.msgDetails.details;}else{d=e.response.message;}}else{if(e.success===false||e.success==="false"){c=false;if(e.msgDetails&&e.msgDetails.message){d=e.msgDetails.message;b=e.msgDetails.details;}else{d=e.message;}}}}if(b){this.__logger.error(d+"; "+b);}return d||!c;}},{instance:null});})();