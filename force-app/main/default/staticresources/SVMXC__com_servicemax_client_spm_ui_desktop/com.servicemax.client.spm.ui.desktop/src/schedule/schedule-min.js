(function(){var a=SVMX.Package("com.servicemax.client.spm.ui.desktop.api.schedule");a.init=function(){var b=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("SPM");Ext.define("com.servicemax.client.spm.ui.desktop.api.schedule.Schedule",{extend:"com.servicemax.client.ui.components.composites.impl.SVMXSection",alias:"widget.spm.schedule",title:b.T("TAG003","Schedule & Notifications"),layout:"fit",border:false,autoScroll:true,constructor:function(c){c=Ext.apply({dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"tbfill"},{tooltip:"Save",xtype:"svmx.button",text:"Save",handler:SVMX.proxy(this,function(){this.__parent.saveProcessConfig({processId:this.processId,scheduleInfo:this.getData()});})}]}]},c||{});this.callParent(arguments);},initComponent:function(c){this.callParent(arguments);this.topPanel=this.add({title:"SPM Report Schedule",header:false,anchor:"100%",autoScroll:true,border:false});},loadRecord:function(c){this.scheduleId=c.data?c.data.details.scheduleId:null;this.editRecord(c);},getData:function(){var c=this.topPanel.down("form").getForm().getValues();c.scheduleId=this.scheduleId;return c;},loadData:function(c){},editRecord:function(c){if(this.topPanel.editPanel){this.topPanel.editPanel.destroy();}this.topPanel.editPanel=this.topPanel.add({xtype:"spm.schedule.scheduleform",itemId:"scheduleform",anchor:"100%",metaModel:this.metaModel,processId:this.processId});if(c.data){var d=this.topPanel.editPanel.getForm();d.setValues(c.data.details);if(c.data.details.weekOn){d.findField("weekOn").setValue(c.data.details.weekOn);}if(c.data.details.dayToRun){d.findField("dayToRun").setValue(c.data.details.dayToRun);}}}});Ext.define("com.servicemax.client.spm.ui.desktop.api.reports.ScheduleListPanel",{extend:"Ext.grid.Panel",alias:"widget.spm.report.schedulelistpanel",constructor:function(c){var d=this;c=Ext.apply({autoScroll:false,columns:[{text:"SPM Report Name",dataIndex:"processName",flex:1,renderer:function(e){return Ext.String.htmlEncode(e);}},{text:"Period",dataIndex:"period",flex:1,renderer:function(e){return Ext.String.htmlEncode(e);}},{text:"Last Modified",dataIndex:"lastModified",flex:1,renderer:function(e){return Ext.String.htmlEncode(e);}}],store:{storeId:c.itemId+"_store",fields:c.fields,proxy:{type:"memory"}},listeners:{select:function(h,e,f,g){}}},c||{});this.callParent(arguments);}});Ext.define("com.servicemax.client.spm.ui.desktop.api.schedule.ScheduleForm",{extend:"Ext.form.Panel",alias:"widget.spm.schedule.scheduleform",layout:"anchor",padding:10,border:false,autoScroll:true,bodyPadding:5,defaults:{labelAlign:"top",anchor:"100%",padding:"10px"},buttonAlign:"left",constructor:function(c){c=Ext.apply({},c||{});this.callParent(arguments);},initComponent:function(){this.callParent(arguments);var m=this;m.TS={T:function(r,s){return s;}};var k=SVMX.create("Ext.data.ArrayStore",{fields:["Id","weekOn"],data:[["Monday",b.T("TAG036","Monday")],["Tuesday",b.T("TAG037","Tuesday")],["Wednesday",b.T("TAG038","Wednesday")],["Thursday",b.T("TAG039","Thursday")],["Friday",b.T("TAG040","Friday")],["Saturday",b.T("TAG041","Saturday")],["Sunday",b.T("TAG042","Sunday")]]});var o=SVMX.create("Ext.data.ArrayStore",{fields:["Id","timeAt"],data:[[1,"12:00 "+b.T("TAG072","am")],[2,"1:00 "+b.T("TAG072","am")],[3,"2:00 "+b.T("TAG072","am")],[4,"3:00 "+b.T("TAG072","am")],[5,"4:00 "+b.T("TAG072","am")],[6,"5:00 "+b.T("TAG072","am")],[7,"6:00 "+b.T("TAG072","am")],[8,"7:00 "+b.T("TAG072","am")],[9,"8:00 "+b.T("TAG072","am")],[10,"9:00 "+b.T("TAG072","am")],[11,"10:00 "+b.T("TAG072","am")],[12,"11:00 "+b.T("TAG072","am")],[13,"12:00 "+b.T("TAG073","pm")],[14,"1:00 "+b.T("TAG073","pm")],[15,"2:00 "+b.T("TAG073","pm")],[16,"3:00 "+b.T("TAG073","pm")],[17,"4:00 "+b.T("TAG073","pm")],[18,"5:00 "+b.T("TAG073","pm")],[19,"6:00 "+b.T("TAG073","pm")],[20,"7:00 "+b.T("TAG073","pm")],[21,"8:00 "+b.T("TAG073","pm")],[22,"9:00 "+b.T("TAG073","pm")],[23,"10:00 "+b.T("TAG073","pm")],[24,"11:00 "+b.T("TAG073","pm")]]});var d=SVMX.create("Ext.data.ArrayStore",{fields:["Id","period"],data:[["Daily",b.T("TAG043","Daily")],["Weekly",b.T("TAG044","Weekly")],["Monthly",b.T("TAG045","Monthly")]]});var g=SVMX.create("Ext.data.ArrayStore",{fields:["Id","day"],data:[[1,"1"],[2,"2"],[3,"3"],[4,"4"],[5,"5"],[6,"6"],[7,"7"],[8,"8"],[9,"9"],[10,"10"],[11,"11"],[12,"12"],[13,"13"],[14,"14"],[15,"15"],[16,"16"],[17,"17"],[18,"18"],[19,"19"],[20,"20"],[21,"21"],[22,"22"],[23,"23"],[24,"24"],[25,"25"],[26,"26"],[27,"27"],[28,"28"],[29,"29"],[30,"30"],[31,"31"]]});var i=SVMX.create("Ext.data.ArrayStore",{fields:["Id","name"],proxy:{type:"memory"},data:m.metaModel.getTimezoneList()});var q=SVMX.create("Ext.form.FieldSet",{title:b.T("TAG053","Choose the times and days to run metric generation engine"),layout:"anchor",padding:"10"});m.add(q);var j=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{itemId:"timezone",name:"timezone",fieldLabel:b.T("TAG018","Time Zone"),labelField:"label",valueField:"Id",displayField:"name",margins:"0 5 0 0",queryMode:"local",editable:false,anchor:"50%",flex:1,store:i,labelAlign:"top",padding:"10",listConfig:{getInnerTpl:function(r){return"{[Ext.String.htmlEncode(values."+r+")]}";
}}});var c=q.add({xtype:"fieldcontainer",layout:{type:"hbox",align:"spaced"},anchor:"100%",fieldDefaults:{labelAlign:"top"},});q.add(c);c.add(j);c.add({xtype:"tbspacer",flex:1});c.add({xtype:"label",anchor:"50%",align:"right",style:"text-decoration: underline !important;",html:'<a href="#" align: "right" style: "text-decoration: underline !important;">'+b.T("TAG049","Run Now")+"</a>",listeners:{afterRender:function(){this.el.on("click",function(){m.metaModel.executeBatch(m.processId,function(r){if(r){Ext.Msg.alert(r.success?"Success":"Failed",r.message);}});});}}});var l=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{itemId:"period",name:"period",fieldLabel:b.T("TAG017","Period"),labelField:"period",valueField:"Id",displayField:"period",defaultValue:"Daily",value:"Daily",queryMode:"local",editable:false,store:d,flex:1,anchor:"30%",labelAlign:"top",padding:"10",listeners:{change:function(t,s,r){switch(s){case b.T("TAG043","Daily"):m.__on.reset();m.__on.setValue(["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]);m.__on.hide();m.__dayToRun.hide();break;case b.T("TAG044","Weekly"):m.__dayToRun.hide();m.__on.reset();m.__on.setValue([b.T("TAG036","Monday")]);m.__on.show();break;case b.T("TAG045","Monthly"):m.__on.reset();m.__on.hide();m.__dayToRun.show();}}},listConfig:{getInnerTpl:function(r){return"{[Ext.String.htmlEncode(values."+r+")]}";}}});q.add(l);var h=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{itemId:"weekOn",name:"weekOn",fieldLabel:b.T("TAG020","Create Schedule on"),labelField:"label",valueField:"Id",displayField:"weekOn",queryMode:"local",editable:false,multiSelect:true,anchor:"30%",flex:1,store:k,value:"Monday",hidden:true,labelAlign:"top",padding:"10",listConfig:{getInnerTpl:function(r){return"{[Ext.String.htmlEncode(values."+r+")]}";}}});m.__on=q.add(h);var n=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{itemId:"dayToRun",name:"dayToRun",fieldLabel:b.T("TAG021","Day"),labelField:"label",valueField:"Id",displayField:"day",queryMode:"local",editable:false,multiSelect:false,anchor:"30%",flex:1,store:g,value:1,hidden:true,labelAlign:"top",padding:"10",listConfig:{getInnerTpl:function(r){return"{[Ext.String.htmlEncode(values."+r+")]}";}}});m.__dayToRun=q.add(n);var f=SVMX.create("com.servicemax.client.ui.components.controls.impl.SVMXPicklist",{itemId:"timeAt",name:"timeAt",fieldLabel:b.T("TAG019","At"),labelField:"label",valueField:"timeAt",displayField:"timeAt",queryMode:"local",editable:false,anchor:"30%",margins:"0 0 0 5",flex:1,store:o,labelAlign:"top",padding:"10",listConfig:{getInnerTpl:function(r){return"{[Ext.String.htmlEncode(values."+r+")]}";}}});q.add(f);var e=SVMX.create("Ext.form.FieldSet",{title:b.T("TAG054","Specify recipients of notifications and alerts"),layout:"anchor",padding:"10"});m.add(e);var p=e.add({xtype:"textfield",fieldLabel:b.T("TAG022","Email on Job Execution"),name:"emailOnSuccess",anchor:"50%",labelAlign:"top",padding:"10",margins:"0 0 0 5"});}});};})();