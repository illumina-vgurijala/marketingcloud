(function(){var a=SVMX.Package("com.servicemax.client.opt.ui.desktop.api.setting");a.init=function(){var d=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("OPT");var e=Ext.create("Ext.data.ArrayStore",{storeId:"productiveHoursComputation",fields:["name","label"],autoLoad:true,data:{},proxy:{type:"memory",reader:{type:"json",root:"items"}}});Ext.create("Ext.data.ArrayStore",{storeId:"availableHoursComputation",fields:["name","label"],data:{},proxy:{type:"memory",reader:{type:"json",root:"items"}}});function b(g,f){differenceInArr=[];coupledArr=g.concat(f);for(i=0;i<=coupledArr.length;i++){current=coupledArr[i];if(coupledArr.indexOf(current)==coupledArr.lastIndexOf(current)){if(current!==undefined){differenceInArr.push(current);}}}return differenceInArr;}function c(f,h){var g=f.length;while(g--){if(f[g]===h){return true;}}return false;}Ext.define("com.servicemax.client.opt.ui.settings.setting",{extend:"com.servicemax.client.ui.components.composites.impl.SVMXSection",alias:"widget.svmx.setting",layout:"column",id:"opt-right-container",title:d.T("TAG073","Settings"),__runOpts:null,constructor:function(g){var f=g.engine;g=Ext.apply({items:[{margin:"0 0 0 10",columnWidth:0.5,xtype:"fieldset",title:d.T("TAG074","Productive Hours Computation"),layout:"anchor",defaultType:"textfield",items:[{xtype:"combobox",margin:"-8 0 1 0",editable:false,columnWidth:1,width:350,padding:10,id:"productive-hours-computation",fieldLabel:d.T("TAG078","Select one or more type(s) of activity for Productive Hour Computation"),labelAlign:"top",multiSelect:true,name:"label",labelField:"label",valueField:"name",displayField:"label",queryMode:"local",deliveryEngine:f,store:Ext.data.StoreManager.lookup("productiveHoursComputation"),valueField:"label",listeners:{change:function(h,n,m){var j=Ext.getCmp("available-hours-computation");var l=j.getValue();var r=b(n,m);if(m!==undefined){if(r!="Drive Time"){if(l.length!=0){var q=n;copyOfproductiveHourValues=q.slice(0);for(var k=0;k<copyOfproductiveHourValues.length;k++){if(copyOfproductiveHourValues[k]==="Drive Time"){copyOfproductiveHourValues.splice(k,1);break;}}var p=l.concat(copyOfproductiveHourValues);var o=p.filter(function(s,t){return p.indexOf(s)==t;});j.setValue(o);}else{for(var k=0;k<n.length;k++){if(n[k]==="Drive Time"){n.splice(k,1);break;}}j.setValue(n);}}}else{if(r!="Drive Time"){if(l.length!=0){var q=n;var p=l.concat(q);var o=p.filter(function(s,t){return p.indexOf(s)==t;});j.setValue(o);}else{j.setValue(n);}}}}}}]},{fieldDefaults:{labelAlign:"left",labelWidth:90,anchor:"100%",msgTarget:"side"},margin:"0 10 0 10",xtype:"fieldset",columnWidth:0.5,title:d.T("TAG075","Available Hours Computation"),layout:"anchor",defaultType:"textfield",items:[{xtype:"combobox",editable:false,columnWidth:1,width:350,padding:10,margin:"-8 0 1 0",id:"available-hours-computation",cls:"spm-opt-config-date",fieldLabel:d.T("TAG079","Select one or more type(s) of activity for Available Hour Computation"),labelAlign:"top",multiSelect:true,name:"label",labelField:"label",valueField:"name",displayField:"label",queryMode:"local",deliveryEngine:f,store:Ext.data.StoreManager.lookup("availableHoursComputation"),valueField:"label",listeners:{change:function(h,o,n){var l=Ext.getCmp("productive-hours-computation");var k=Ext.getCmp("available-hours-computation");var m=k.getValue();var q=l.getValue();var m=o;if(n!==undefined){var r=b(o,n);var p=c(n,r[0]);if(p){var s=c(q,r[0]);if(s){m.push(r[0]);var j=m.filter(function(t,u){return m.indexOf(t)==u;});k.setValue(m);}}}}}}]},{margin:"30 11 0 10",padding:"20 0 20 20",xtype:"fieldset",columnWidth:1,layout:"anchor",items:[{xtype:"component",cls:"text-strong",html:d.T("TAG022","Send success notifications to this email address:"),margin:"0 0 10 0",anchor:"90%"},{xtype:"textfield",id:"notification-email-opt",name:"email",anchor:"60%",vtype:"email",msgTarget:"start",allowBlank:false}]},{margin:"30 0 0 10",xtype:"fieldset",columnWidth:1,layout:"anchor",border:false,align:"right",layout:{type:"vbox",align:"right"},items:[{xtype:"tbfill"},{xtype:"svmx.button",text:d.T("TAG094","Save"),cls:"spm-opt-button",id:"opt-save-configuration-btn",deliveryEngine:f,handler:function(){var j=[];var h=Ext.getCmp("available-hours-computation").displayTplData;for(var l=0;l<h.length;l++){j.push(h[l].label);}var m=[];var n=Ext.getCmp("productive-hours-computation").displayTplData;for(var l=0;l<n.length;l++){m.push(n[l].label);}var k=Ext.getCmp("notification-email-opt").getValue();configurationParam={settings:{emailId:k,availableHours:j.toString(),productiveHours:m.toString()}};this.deliveryEngine.saveOptConfigurationHandler(configurationParam);Ext.getCmp("opt-save-configuration-btn").disable();}}]}]},g||{});this.callParent([g]);}});};})();