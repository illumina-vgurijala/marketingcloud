(function(){var a=SVMX.Package("com.servicemax.client.opt.ui.desktop.api.execution");a.init=function(){var b=SVMX.getClient().getServiceRegistry().getServiceInstance("com.servicemax.client.translation").getDictionary("OPT");Ext.create("Ext.data.Store",{storeId:"jobsStoreExecution",fields:["jobId","processName","startDate","endDate"],data:{},proxy:{type:"memory",reader:{type:"json",root:"items"}}});Ext.create("Ext.data.ArrayStore",{storeId:"dispatchProcessName",fields:["name","label"],data:{},proxy:{type:"memory",reader:{type:"json",root:"items"}}});Ext.define("com.servicemax.client.opt.ui.execution.execution",{extend:"com.servicemax.client.ui.components.composites.impl.SVMXSection",alias:"widget.svmx.execution",layout:"column",title:b.T("TAG080","Execution"),__runOpts:null,constructor:function(d){var c=d.engine;d=Ext.apply({items:[{margin:"10 20 0 10",xtype:"fieldset",columnWidth:1,border:false,layout:{type:"vbox",align:"center"},items:[{xtype:"button",text:b.T("TAG095","Report Latest Run"),cls:"spm-opt-button",id:"opt-report-latest-run-btn",deliveryEngine:c,handler:function(){this.deliveryEngine.processLatestRunHandler();Ext.getCmp("opt-report-latest-run-btn").disable();}}]},{margin:"10 0 8 0",xtype:"fieldset",columnWidth:1,border:false,layout:{type:"vbox",align:"center"},items:[{xtype:"label",text:"-"+b.T("TAG082","Or")+"-"}]},{margin:"0 0 20 10",columnWidth:1,xtype:"fieldset",title:b.T("TAG083","Report by Timeframe"),layout:"anchor",minHeight:551,defaultType:"textfield",items:[{margin:"10 0 20 0",width:812,padding:"10 10 10 10",xtype:"fieldset",title:b.T("TAG084","Select Filters"),items:[{layout:"column",border:false,items:[{columnWidth:0.5,xtype:"datefield",anchor:"100%",fieldLabel:b.T("TAG089","Start Date"),cls:"spm-opt-config-start-date",margin:"0 30 0 0",name:"from_date",format:"Y-m-d",maxValue:new Date(),id:"execution_from_date",value:new Date()},{columnWidth:0.5,xtype:"datefield",anchor:"100%",fieldLabel:b.T("TAG090","End Date"),cls:"spm-opt-config-end-date",margin:"0 30 0 0",id:"execution_to_date",format:"Y-m-d",name:"to_date",value:new Date()}]},{layout:"column",border:false,items:[{margin:"30 30 20 0",columnWidth:1,xtype:"combobox",fieldLabel:b.T("TAG085","Dispatch Process Name"),displayField:"label",valueField:"name",cls:"spm-opt-dispatch-process",labelWidth:150,id:"dispatch-process-name-execution",deliveryEngine:c,name:"label",labelField:"label",valueField:"name",displayField:"label",queryMode:"local",editable:false,getLoader:function(){this.deliveryEngine.loadDispatchProcessNamesHandler();},store:Ext.data.StoreManager.lookup("dispatchProcessName")}]},{xtype:"fieldset",columnWidth:1,border:false,margin:"0 20 0 0",layout:{type:"vbox",align:"right"},items:[{xtype:"svmx.button",text:b.T("TAG086","Find Runs"),id:"opt-find-run-btn",cls:"spm-opt-button",deliveryEngine:c,handler:function(){var e=Ext.getCmp("execution_from_date").getSubmitValue();var f=Ext.getCmp("execution_to_date").getSubmitValue();if(Ext.getCmp("dispatch-process-name-execution").displayTplData!=undefined||Ext.getCmp("dispatch-process-name-execution").displayTplData!=null){var g=Ext.getCmp("dispatch-process-name-execution").displayTplData[0].label;}param={startDate:e,endDate:f,processName:g,isPurge:"fasle"};if((Date.parse(e)>Date.parse(f))){Ext.MessageBox.alert("Status",b.T("TAG097","Start Date should be earlier that End Date"));return false;}else{if(e==""){Ext.MessageBox.alert("Status",b.T("TAG098","Select Start Date"));return false;}else{if(f==""){Ext.MessageBox.alert("Status",b.T("TAG099","Select End Date"));return false;}}}this.deliveryEngine.getJobListForExecutionHandler(param);Ext.getCmp("opt-find-run-btn").disable();}}]}]},executionTable=Ext.create("Ext.grid.Panel",{title:b.T("TAG096","All Runs"),selType:"checkboxmodel",minHeight:250,height:250,width:812,selModel:{checkOnly:false,mode:"MULTI",columnSelect:true,checkboxSelect:true,pruneRemoved:false},id:"getexecutiondatagrid",xtype:"checkboxgroup",store:Ext.data.StoreManager.lookup("jobsStoreExecution"),columns:[{text:b.T("TAG087","Job Id"),dataIndex:"jobId",width:110,sortable:false,menuDisabled:true},{text:b.T("TAG088","Dispatch Process Name"),dataIndex:"processName",width:300,sortable:false,menuDisabled:true},{text:b.T("TAG089","Start Date"),dataIndex:"startDate",width:200,sortable:false,menuDisabled:true},{text:b.T("TAG090","End Date"),dataIndex:"endDate",width:200,sortable:false,menuDisabled:true}]}),executionTable.on("viewready",function(){executionTable.getSelectionModel().selectAll();}),{margin:"10 20 0 10",xtype:"fieldset",columnWidth:1,border:false,layout:{type:"vbox",align:"right"},items:[{xtype:"button",text:b.T("TAG081","Report Selected Runs"),id:"execution-selected-run-btn",cls:"spm-opt-button",deliveryEngine:c,handler:function(){var f=Ext.getCmp("getexecutiondatagrid");var h=f.getSelectionModel();var e=[];for(i=0;i<f.store.getCount();i++){if(h.isSelected(i)){e.push(f.store.getAt(i).data.jobId);}}var g=e.toString();param={jobsId:g};if(e.length<=0){Ext.MessageBox.alert("Status",b.T("TAG100","Select one or more job(s)"));
return false;}this.deliveryEngine.executionSelectedRunsHandler(param);Ext.getCmp("execution-selected-run-btn").disable();}}]}]}]},d||{});this.callParent([d]);}});};})();